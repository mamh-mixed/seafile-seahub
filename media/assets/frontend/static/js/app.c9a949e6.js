/*! For license information please see app.c9a949e6.js.LICENSE.txt */
(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[2143],{78334:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(1168),c=n(3885),d=n(66367),u=n.n(d),p=n(42995),h=n(61805),f=n(83854),m=n(46417),g=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).close=function(){if(o.setState({isClosed:!0}),navigator.cookieEnabled){var e=new Date,t=document.cookie.split("; "),n=!1,r=h.JR+"_";e.setTime(e.getTime()+12096e5),r+="; expires="+e.toGMTString()+"; path="+h.ze;for(var i=0,s=t.length;i<s;i++)if("info_id"==t[i].split("=")[0]){n=!0,document.cookie="info_id="+t[i].split("=")[1]+r;break}n||(document.cookie="info_id="+r)}},o.state={isClosed:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){return!h._n||this.state.isClosed?null:(0,m.jsxs)("div",{id:"info-bar",className:"d-flex justify-content-between",children:[(0,m.jsx)("p",{id:"info-bar-info",className:"m-0",dangerouslySetInnerHTML:{__html:h._n}}),(0,m.jsx)("button",{className:"close sf2-icon-x1",title:(0,h.ih)("Close"),"aria-label":(0,h.ih)("Close"),onClick:this.close})]})}}]),n}(a.Component),v=g,y=n(77275),x=n(62429),w=n(93433),b=n(70816),S=n.n(b),C=n(4514),D=n(51282),k=(0,o.Z)((function e(t){(0,r.Z)(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.obj_type=t.obj_type,this.commit_id=t.commit_id,this.path=t.path,this.name=t.name,this.author_email=t.author_email,this.author_name=t.author_name,this.author_contact_email=t.author_contact_email,this.avatar_url=t.avatar_url,this.time=t.time,this.op_type=t.op_type,this.createdFilesCount=0,this.createdFilesList=[],"clean-up-trash"===t.op_type?this.days=t.days:"rename"===t.op_type&&"repo"===t.obj_type?this.old_repo_name=t.old_repo_name:"move"===t.op_type&&["dir","file"].includes(t.obj_type)?this.old_path=t.old_path:"rename"===t.op_type&&["dir","file"].includes(t.obj_type)?(this.old_path=t.old_path,this.old_name=t.old_name):"publish"===t.op_type&&(this.old_path=t.old_path)})),j=n(43216),I=n(12756),M=n(12213),_=n(82573),N=n(7764),R=n(21303),T=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).toggle=function(t){e.props.toggleCancel(t)},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.activity;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:(0,h.ih)("Created Files")}),(0,m.jsx)(M.Z,{children:(0,m.jsxs)(_.Z,{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"75%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"25%",children:(0,h.ih)("Time")})]})}),(0,m.jsx)("tbody",{children:e.createdFilesList.map((function(e,t){var n="".concat(h.ze,"lib/").concat(e.repo_id,"/file").concat(f.c.encodePath(e.path)),r=(0,m.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",children:e.name});return e.name.endsWith("(draft).md")&&(r=e.name),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:r}),(0,m.jsx)("td",{children:S()(e.time).fromNow()})]},t)}))})]})}),(0,m.jsx)(N.Z,{children:(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggle.bind(this,e),children:(0,h.ih)("Close")})})]})}}]),n}(a.Component),O=T,E=n(68164);S().locale(window.app.config.lang);var P=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onListCreatedFilesToggle=function(){o.setState({isListCreatedFiles:!o.state.isListCreatedFiles})},o.state={isListCreatedFiles:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e,t,n=this.props.isDesktop,r=this.props,o=r.item,i=r.index,s=r.items,l=!1,c="".concat(h.ze,"profile/").concat(encodeURIComponent(o.author_email),"/"),d=h.ze+"library/"+o.repo_id+"/"+encodeURIComponent(o.repo_name)+"/",u=(0,m.jsx)("a",{href:d,children:o.repo_name}),p=(0,m.jsx)("a",{className:"small text-secondary",href:d,children:o.repo_name});if("repo"==o.obj_type)switch(o.op_type){case"create":e=(0,h.ih)("Created library"),t=u;break;case"rename":e=(0,h.ih)("Renamed library"),t=(0,m.jsxs)("span",{children:[o.old_repo_name," => ",u]});break;case"delete":e=(0,h.ih)("Deleted library"),t=o.repo_name;break;case"recover":e=(0,h.ih)("Restored library"),t=u;break;case"clean-up-trash":e=(0,h.ih)("Cleaned trash"),t=0==o.days?(0,h.ih)("Removed all items from trash."):(0,h.ih)("Removed items older than {n} days from trash.").replace("{n}",o.days),l=!0}else if("files"==o.obj_type){var g="".concat(h.ze,"lib/").concat(o.repo_id,"/file").concat(f.c.encodePath(o.path)),v="<a href=".concat(g,' target="_blank">').concat(o.name,"</a>"),y=o.createdFilesCount-1,x=(0,h.ih)("{file} and {n} other files").replace("{file}",v).replace("{n}",y);e=(0,h.ih)("Created {n} files").replace("{n}",o.createdFilesCount),t=(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("p",{className:"m-0 d-inline",dangerouslySetInnerHTML:{__html:x}}),n&&(0,m.jsx)("button",{type:"button",onClick:this.onListCreatedFilesToggle,className:"activity-details text-secondary ml-2 border-0 p-0 bg-transparent",children:(0,h.ih)("details")})]}),l=!0}else if("file"==o.obj_type){var w=o.name.endsWith("(draft).md"),b=w?"":"".concat(h.ze,"lib/").concat(o.repo_id,"/file").concat(f.c.encodePath(o.path)),C=(0,m.jsx)("a",{href:b,target:"_blank",rel:"noreferrer",children:o.name});switch(w&&(C=o.name),o.op_type){case"create":e=w?(0,h.ih)("Created draft"):(0,h.ih)("Created file"),t=C,l=!0;break;case"delete":e=w?(0,h.ih)("Deleted draft"):(0,h.ih)("Deleted file"),t=o.name,l=!0;break;case"recover":e=(0,h.ih)("Restored file"),t=C,l=!0;break;case"rename":e=(0,h.ih)("Renamed file"),t=(0,m.jsxs)("span",{children:[o.old_name," => ",C]}),l=!0;break;case"move":var D=(0,m.jsx)("a",{href:b,children:o.path});e=(0,h.ih)("Moved file"),t=(0,m.jsxs)("span",{children:[o.old_path," => ",D]}),l=!0;break;case"edit":e=w?(0,h.ih)("Updated draft"):(0,h.ih)("Updated file"),t=C,l=!0}}else{var k=h.ze+"library/"+o.repo_id+"/"+encodeURIComponent(o.repo_name)+f.c.encodePath(o.path),j=(0,m.jsx)("a",{href:k,target:"_blank",rel:"noreferrer",children:o.name});switch(o.op_type){case"create":e=(0,h.ih)("Created folder"),t=j,l=!0;break;case"delete":e=(0,h.ih)("Deleted folder"),t=o.name,l=!0;break;case"recover":e=(0,h.ih)("Restored folder"),t=j,l=!0;break;case"rename":e=(0,h.ih)("Renamed folder"),t=(0,m.jsxs)("span",{children:[o.old_name," => ",j]}),l=!0;break;case"move":var I=(0,m.jsx)("a",{href:k,children:o.path});e=(0,h.ih)("Moved folder"),t=(0,m.jsxs)("span",{children:[o.old_path," => ",I]}),l=!0}}var M=!0;if(i>0){var _=s[i-1].time;M=!S()(o.time).isSame(_,"day")}return(0,m.jsxs)(a.Fragment,{children:[M&&(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:n?5:3,className:"border-top-0",children:S()(o.time).format("YYYY-MM-DD")})}),n?(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:o.avatar_url,alt:"",width:"32",height:"32",className:"avatar"})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:c,children:o.author_name})}),(0,m.jsx)("td",{children:e}),(0,m.jsxs)("td",{children:[t,l&&(0,m.jsx)("br",{}),l&&p]}),(0,m.jsx)("td",{className:"text-secondary",children:(0,m.jsx)("time",{datetime:o.time,is:"relative-time",title:S()(o.time).format("llll"),children:S()(o.time).fromNow()})})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"text-center align-top",children:(0,m.jsx)("img",{src:o.avatar_url,alt:"",width:"32",height:"32",className:"avatar"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)("a",{href:c,children:o.author_name}),(0,m.jsx)("p",{className:"m-0 text-secondary",children:e}),t]}),(0,m.jsxs)("td",{className:"text-right align-top",children:[(0,m.jsx)("span",{className:"text-secondary mobile-activity-time",children:(0,m.jsx)("time",{datetime:o.time,is:"relative-time",title:S()(o.time).format("llll"),children:S()(o.time).fromNow()})}),l&&(0,m.jsx)("br",{}),l&&u]})]}),this.state.isListCreatedFiles&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(O,{activity:o,toggleCancel:this.onListCreatedFilesToggle})})]})}}]),n}(a.Component);S().locale(window.app.config.lang);var Z=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=f.c.isDesktop(),t=this.props,n=t.items,r=t.isLoadingMore;if(!n.length)return(0,m.jsx)(j.Z,{children:(0,m.jsx)("p",{children:(0,h.ih)("No more activities")})});var o=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"8%"}),(0,m.jsx)("th",{width:"15%",children:(0,h.ih)("User")}),(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Operation")}),(0,m.jsxs)("th",{width:"37%",children:[(0,h.ih)("File")," / ",(0,h.ih)("Library")]}),(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Time")})]})}),i=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"15%"}),(0,m.jsx)("th",{width:"53%"}),(0,m.jsx)("th",{width:"32%"})]})});return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("table",{className:"table-hover table-thead-hidden",children:[e?o:i,(0,m.jsx)("tbody",{children:n.map((function(t,r){return(0,m.jsx)(P,{isDesktop:e,item:t,index:r,items:n},r)}))})]}),r?(0,m.jsx)("span",{className:"loading-icon loading-tip"}):""]})}}]),n}(a.Component),F=Z,L=n(5684),A=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleOutsideClick=function(e){o.state.isPopoverOpen&&!o.userSelector.contains(e.target)&&o.togglePopover()},o.togglePopover=function(){o.setState({isPopoverOpen:!o.state.isPopoverOpen},(function(){if(!o.state.isPopoverOpen){var e=o.props.availableUsers.filter((function(e){return e.isSelected}));o.props.setTargetUsers(e)}}))},o.onToggleClick=function(e){e.stopPropagation(),o.togglePopover()},o.onQueryChange=function(e){o.setState({query:e.target.value})},o.toggleSelectItem=function(e,t){e.stopPropagation(),o.props.toggleSelectUser(t)},o.state={isPopoverOpen:!1,query:""},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleOutsideClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleOutsideClick)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isPopoverOpen,r=t.query,o=this.props,i=o.currentSelectedUsers,s=o.availableUsers,a=s.filter((function(e){return e.isSelected})),l=r.trim()?s.filter((function(e){return-1!=e.contact_email.indexOf(r.trim())||-1!=e.name.indexOf(r.trim())})):s;return(0,m.jsxs)("div",{className:"mt-4 position-relative",children:[(0,m.jsxs)("span",{className:"cur-activity-modifiers d-inline-block p-2 rounded",onClick:this.onToggleClick,children:[i.length>0?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:(0,h.ih)("Modified by:")}),(0,m.jsx)("span",{className:"d-inline-block ml-1",children:i.map((function(e){return e.name})).join(", ")})]}):(0,h.ih)("Modified by"),(0,m.jsx)("i",{className:"sf3-font sf3-font-down ml-2 toggle-icon"})]}),n&&(0,m.jsxs)("div",{className:"position-absolute activity-modifier-selector-container rounded shadow",ref:function(t){return e.userSelector=t},children:[(0,m.jsx)("ul",{className:"activity-selected-modifiers px-3 py-1 list-unstyled",children:a.map((function(t,n){return(0,m.jsxs)("li",{className:"activity-selected-modifier",children:[(0,m.jsx)("img",{src:t.avatar_url,className:"avatar w-5 h-5",alt:""}),(0,m.jsx)("span",{className:"activity-user-name ml-2",children:t.name}),(0,m.jsx)("i",{className:"sf2-icon-close unselect-activity-user ml-2",onClick:function(n){e.toggleSelectItem(n,t)}})]},n)}))}),(0,m.jsx)("div",{className:"px-3 pt-3",children:(0,m.jsx)(L.Z,{type:"text",placeholder:(0,h.ih)("Find modifiers"),value:r,onChange:this.onQueryChange})}),(0,m.jsx)("ul",{className:"activity-user-list list-unstyled p-3 o-auto",children:l.map((function(t,n){return(0,m.jsxs)("li",{className:"activity-user-item h-6 p-1 rounded d-flex justify-content-between align-items-center",onClick:function(n){e.toggleSelectItem(n,t)},children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("img",{src:t.avatar_url,className:"avatar w-5 h-5",alt:""}),(0,m.jsx)("span",{className:"activity-user-name ml-2",children:t.name})]}),t.isSelected&&(0,m.jsx)("i",{className:"sf2-icon-tick text-gray font-weight-bold"})]},n)}))})]})]})}}]),n}(a.Component);S().locale(window.app.config.lang);var U=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).mergePublishEvents=function(e){e.forEach((function(e){"publish"===e.op_type&&(o.curPathList.push(e.path),o.oldPathList.push(e.old_path))}));for(var t=[],n=0;n<e.length;n++)"file"===e[n].obj_type?"delete"===e[n].op_type&&o.oldPathList.includes(e[n].path)?o.oldPathList.splice(o.oldPathList.indexOf(e[n].path),1):"edit"===e[n].op_type&&o.curPathList.includes(e[n].path)?o.curPathList.splice(o.curPathList.indexOf(e[n].path),1):"rename"===e[n].op_type&&o.oldPathList.includes(e[n].old_path)?o.oldPathList.splice(o.oldPathList.indexOf(e[n].old_path),1):t.push(e[n]):t.push(e[n]);return t},o.mergeFileCreateEvents=function(e){for(var t=[],n=null,r=0;r<e.length;r++){var o="file"===e[r].obj_type&&"create"===e[r].op_type&&e[r+1]&&"file"===e[r+1].obj_type&&"create"===e[r+1].op_type&&e[r+1].repo_name===e[r].repo_name&&e[r+1].author_email===e[r].author_email;if(null!=n){if(n.createdFilesCount++,n.createdFilesList.push(e[r]),o)continue;t.push(n),n=null}else o?((n=new k(e[r])).obj_type="files",n.createdFilesCount++,n.createdFilesList.push(e[r])):t.push(e[r])}return t},o.filterEvents=function(e){var t=o.props.onlyMine,n=o.state.targetUsers;return t?e.filter((function(e){return e.author_email==h.b6})):n.length?e.filter((function(e){return-1!=n.map((function(e){return e.email})).indexOf(e.author_email)})):e},o.setTargetUsers=function(e){o.setState({targetUsers:e},(function(){var e=o.filterEvents(o.state.allItems);o.setState({items:e},(function(){e.length<25&&o.state.hasMore&&o.getMore()}))}))},o.toggleSelectUser=function(e){var t=o.state.availableUsers;o.setState({availableUsers:t.map((function(t){return t.email==e.email&&(t.isSelected=!e.isSelected),t}))})},o.handleScroll=function(e){if(!o.state.isLoadingMore&&o.state.hasMore){var t=e.target.clientHeight,n=e.target.scrollHeight;t+e.target.scrollTop+1>=n&&o.setState({isLoadingMore:!0},(function(){o.getMore()}))}},o.state={errorMsg:"",isFirstLoading:!0,isLoadingMore:!1,currentPage:1,hasMore:!0,allItems:[],items:[],availableUsers:[],targetUsers:[]},o.avatarSize=72,o.curPathList=[],o.oldPathList=[],o.availableUserEmails=new Set,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.state,n=t.currentPage,r=t.availableUsers;C.I.listActivities(n,this.avatarSize).then((function(t){var o=e.mergePublishEvents(t.data.events);(o=e.mergeFileCreateEvents(o)).forEach((function(t){e.availableUserEmails.has(t.author_email)||(e.availableUserEmails.add(t.author_email),r.push({email:t.author_email,name:t.author_name,contact_email:t.author_contact_email,avatar_url:t.avatar_url,isSelected:!1}))}));var i=e.filterEvents(o);e.setState({allItems:o,items:i,availableUsers:r,currentPage:n+1,isFirstLoading:0==i.length,hasMore:!0}),e.state.items.length<25&&e.getMore()})).catch((function(t){e.setState({isFirstLoading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"getMore",value:function(){var e=this,t=this.state,n=t.currentPage,r=t.availableUsers,o=t.targetUsers;C.I.listActivities(n,this.avatarSize).then((function(t){var i=e.mergePublishEvents(t.data.events);(i=e.mergeFileCreateEvents(i)).forEach((function(t){e.availableUserEmails.has(t.author_email)||(e.availableUserEmails.add(t.author_email),r.push({email:t.author_email,name:t.author_name,contact_email:t.author_contact_email,avatar_url:t.avatar_url,isSelected:!1}))}));var s=e.filterEvents(i),a=[].concat((0,w.Z)(e.state.items),(0,w.Z)(s));e.setState({allItems:[].concat((0,w.Z)(e.state.allItems),(0,w.Z)(i)),items:a,availableUsers:r,currentPage:n+1,isFirstLoading:0==a.length,isLoadingMore:!1,hasMore:0!==t.data.events.length}),e.state.items.length<25&&e.state.hasMore&&(o.length&&100==n||e.getMore())})).catch((function(t){e.setState({isFirstLoading:!1,isLoadingMore:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.props.onlyMine,t=this.state,n=t.targetUsers,r=t.availableUsers;return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"activities",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsxs)("ul",{className:"nav",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.rU,{to:"".concat(h.ze,"dashboard/"),className:"nav-link".concat(e?"":" active"),children:(0,h.ih)("All Activities")})}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.rU,{to:"".concat(h.ze,"my-activities/"),className:"nav-link".concat(e?" active":""),children:(0,h.ih)("My Activities")})})]})}),(0,m.jsxs)("div",{className:"cur-view-content d-block",onScroll:this.handleScroll,children:[this.state.isFirstLoading&&(0,m.jsx)(D.Z,{}),!this.state.isFirstLoading&&this.state.errorMsg&&(0,m.jsx)("p",{className:"error text-center",children:this.state.errorMsg}),!this.state.isFirstLoading&&(0,m.jsxs)(a.Fragment,{children:[!e&&(0,m.jsx)(A,{availableUsers:r,currentSelectedUsers:n,setTargetUsers:this.setTargetUsers,toggleSelectUser:this.toggleSelectUser}),(0,m.jsx)(F,{items:this.state.items,isLoadingMore:this.state.isLoadingMore})]})]})]})})}}]),n}(a.Component),z=U,B=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsx)(z,{onlyMine:!0})}}]),n}(a.Component),G=B,H=n(13380),Y=n(25417),V=n(57124),W=n(1303),K=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.items;if(t)return(0,m.jsx)(D.Z,{});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var o=(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No favorites")}),(0,m.jsx)("p",{children:(0,h.ih)("You have not added any libraries, folders or files to your favorites yet. A favorite gives you quick access to your most frequently used objects. You can add a library, folder or file to your favorites by clicking the star to the left of its name.")})]}),i=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"40%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"32%",children:(0,h.ih)("Library")}),(0,m.jsx)("th",{width:"18%",children:(0,h.ih)("Last Update")}),(0,m.jsx)("th",{width:"6%"})]})}),s=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),a=f.c.isDesktop();return r.length?(0,m.jsxs)("table",{className:"table-hover ".concat(a?"":"table-thead-hidden"),children:[a?i:s,(0,m.jsx)(q,{items:r})]}):o}}]),n}(a.Component),q=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).state={items:o.props.items},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.getThumbnails()}},{key:"getThumbnails",value:function(){var e=this.state.items.filter((function(e){return(f.c.imageCheck(e.obj_name)||h.eA&&f.c.videoCheck(e.obj_name)||h.mh&&f.c.pdfCheck(e.obj_name))&&!e.repo_encrypted&&!e.encoded_thumbnail_src&&!e.deleted}));if(0!=e.length){var t=e.length,n=this;!function r(o){var i=e[o];C.I.createThumbnail(i.repo_id,i.path,48).then((function(e){i.encoded_thumbnail_src=e.data.encoded_thumbnail_src})).catch((function(e){})).then((function(){o<t-1?r(++o):n.setState({items:n.state.items})}))}(0)}}},{key:"render",value:function(){var e=this.state.items.map((function(e,t){return"/"===e.path?e.item_icon_url=f.c.getDefaultLibIconUrl(!1):e.item_icon_url=e.is_dir?f.c.getFolderIconUrl(!1):f.c.getFileIconUrl(e.obj_name),e.encoded_path=f.c.encodePath(e.path),e.thumbnail_url=e.encoded_thumbnail_src?"".concat(h.ze).concat(e.encoded_thumbnail_src):"",e.dirent_view_url=e.is_dir?"".concat(h.ze,"library/").concat(e.repo_id,"/").concat(e.repo_name).concat(e.encoded_path):"".concat(h.ze,"lib/").concat(e.repo_id,"/file").concat(e.encoded_path),"/"!==e.encoded_path&&(e.dirent_view_url=e.dirent_view_url.replace(/\/+$/,"")),e.mtime_relative=S()(e.mtime).fromNow(),(0,m.jsx)($,{data:e},t)}),this);return(0,m.jsx)("tbody",{children:e})}}]),n}(a.Component),$=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleOpMenu=function(){o.setState({isOpMenuOpen:!o.state.isOpMenuOpen})},o.handleMouseOver=function(){o.setState({showOpIcon:!0})},o.handleMouseOut=function(){o.setState({showOpIcon:!1})},o.unstar=function(e){e.preventDefault();var t=o.props.data;C.I.unstarItem(t.repo_id,t.path).then((function(e){o.setState({unstarred:!0})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.visitItem=function(){var e=o.props.data;e.is_dir?(0,c.c4)(e.dirent_view_url):window.open(e.dirent_view_url)},o.state={showOpIcon:!1,unstarred:!1,isOpMenuOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){if(this.state.unstarred)return null;var e=this.props.data,t="sf2-icon-x3 unstar action-icon";t+=this.state.showOpIcon?"":" invisible";var n=e.dirent_view_url,r=(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{className:"text-center",children:e.thumbnail_url?(0,m.jsx)("img",{className:"thumbnail",src:e.thumbnail_url,alt:""}):(0,m.jsx)("img",{src:e.item_icon_url,alt:(0,h.ih)("icon"),width:"24"})}),(0,m.jsx)(a.Fragment,{children:e.deleted?(0,m.jsxs)("td",{children:[e.obj_name," ",(0,m.jsx)("span",{style:{color:"red"},children:(0,h.ih)("deleted")})]}):(0,m.jsx)("td",{children:e.is_dir?(0,m.jsx)(c.rU,{to:n,children:e.obj_name}):(0,m.jsx)("a",{className:"normal",href:n,target:"_blank",rel:"noreferrer",children:e.obj_name})})}),(0,m.jsx)("td",{children:e.repo_name}),(0,m.jsx)("td",{dangerouslySetInnerHTML:{__html:e.mtime_relative}}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button",className:t,title:(0,h.ih)("Unstar"),"aria-label":(0,h.ih)("Unstar"),onClick:this.unstar})})]}),o=(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"text-center",onClick:this.visitItem,children:e.thumbnail_url?(0,m.jsx)("img",{className:"thumbnail",src:e.thumbnail_url,alt:""}):(0,m.jsx)("img",{src:e.item_icon_url,alt:(0,h.ih)("icon"),width:"24"})}),(0,m.jsxs)("td",{onClick:this.visitItem,children:[e.is_dir?(0,m.jsx)(c.rU,{to:n,children:e.obj_name}):(0,m.jsx)("a",{className:"normal",href:e.dirent_view_url,target:"_blank",rel:"noreferrer",children:e.obj_name}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:e.repo_name}),(0,m.jsx)("span",{className:"item-meta-info",dangerouslySetInnerHTML:{__html:e.mtime_relative}})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(H.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.unstar,children:(0,h.ih)("Unstar")})})]})]})})]});return f.c.isDesktop()?r:o}}]),n}(a.Component),X=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).state={loading:!0,errorMsg:"",items:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.listStarredItems().then((function(t){e.setState({loading:!1,items:t.data.starred_item_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"starred",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.ih)("Favorites")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(K,{data:this.state})})]})})}}]),n}(a.Component),J=n(99338),Q=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.items;if(t)return(0,m.jsx)("span",{className:"loading-icon loading-tip"});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var o=(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No linked devices")}),(0,m.jsx)("p",{children:(0,h.ih)("You have not accessed your files with any client (desktop or mobile) yet. Configure clients on your devices to access your data more comfortably.")})]}),i=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"13%",children:(0,h.ih)("Platform")}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("Device Name")}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("IP")}),(0,m.jsx)("th",{width:"17%",children:(0,h.ih)("Last Access")}),(0,m.jsx)("th",{width:"10%"})]})}),s=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"92%"}),(0,m.jsx)("th",{width:"8%"})]})}),a=f.c.isDesktop();return r.length?(0,m.jsxs)("table",{className:"table-hover ".concat(a?"":"table-thead-hidden"),children:[a?i:s,(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsx)(ee,{data:e,isDesktop:a},t)}))})]}):o}}]),n}(a.Component),ee=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleOpMenu=function(){o.setState({isOpMenuOpen:!o.state.isOpMenuOpen})},o.handleMouseOver=function(){o.setState({isOpIconShown:!0})},o.handleMouseOut=function(){o.setState({isOpIconShown:!1})},o.toggleDialog=function(){o.setState({isConfirmUnlinkDialogOpen:!o.state.isConfirmUnlinkDialogOpen})},o.handleClick=function(e){if(e.preventDefault(),o.props.data.is_desktop_client)o.toggleDialog();else{o.unlinkDevice(!0)}},o.unlinkDevice=function(e){var t=o.props.data;C.I.unlinkDevice(t.platform,t.device_id,e).then((function(e){o.setState({unlinked:!0});var n=(0,h.ih)("Successfully unlinked %(name)s.");n=n.replace("%(name)s",t.device_name),W.Z.success(n)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={isOpMenuOpen:!1,isOpIconShown:!1,unlinked:!1,isConfirmUnlinkDialogOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){if(this.state.unlinked)return null;var e=this.props.data,t="sf3-font-delete1 sf3-font unlink-device action-icon";t+=this.state.isOpIconShown?"":" invisible";var n=(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{children:e.platform}),(0,m.jsx)("td",{children:e.device_name}),(0,m.jsx)("td",{children:e.last_login_ip}),(0,m.jsx)("td",{children:S()(e.last_accessed).fromNow()}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",className:t,title:(0,h.ih)("Unlink"),role:"button","aria-label":(0,h.ih)("Unlink"),onClick:this.handleClick})})]}),r=(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{children:[e.device_name,(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:e.last_login_ip}),(0,m.jsx)("span",{className:"item-meta-info",children:S()(e.last_accessed).fromNow()}),(0,m.jsx)("span",{className:"item-meta-info",children:e.platform})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(H.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.handleClick,children:(0,h.ih)("Unlink")})})]})]})})]});return(0,m.jsxs)(a.Fragment,{children:[this.props.isDesktop?n:r,this.state.isConfirmUnlinkDialogOpen&&(0,m.jsx)(J.Z,{executeOperation:this.unlinkDevice,toggleDialog:this.toggleDialog})]})}}]),n}(a.Component),te=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).state={loading:!0,errorMsg:"",items:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.listLinkedDevices().then((function(t){e.setState({loading:!1,items:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"linked-devices",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.ih)("Linked Devices")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(Q,{data:this.state})})]})})}}]),n}(a.Component),ne=n(45361),re=(0,o.Z)((function e(t){(0,r.Z)(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.share_type=t.share_type,this.share_permission=t.share_permission,this.share_permission_name=t.share_permission_name,this.modifier_name=t.modifier_name,this.modifier_email=t.modifier_email,this.modifier_contact_email=t.modifier_contact_email,this.encrypted=t.encrypted,"personal"===this.share_type?(this.is_admin=t.is_admin,this.user_name=t.user_name,this.user_email=t.user_email,this.contact_email=t.contact_email):"group"===this.share_type&&(this.is_admin=t.is_admin,this.group_id=t.group_id,this.group_name=t.group_name)})),oe=n(65407),ie=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).listCustomPermissions=function(){var e=o.props.repoID;C.I.listCustomPermissions(e).then((function(e){var t=e.data.permission_list.map((function(e){return new oe.Z(e)}));o.setState({isLoading:!1,customPermissions:t})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t),o.setState({isLoading:!1})}))},o.switchOption=function(e){if(e.target.checked){var t=e.target.value;o.setState({currentOption:t}),o.props.changePerm(t),o.props.toggleDialog()}},o.translatePermission=function(e){var t=f.c.sharePerms(e);if(!t){var n=o.state.customPermissions.find((function(t){return t.id+""===e}));t=n&&n.name}return t},o.translateExplanation=function(e){var t=f.c.sharePermsExplanation(e);if(!t){var n=o.state.customPermissions.find((function(t){return t.id+""===e}));t=n&&n.description}return t},o.getPermissions=function(){var e=o.props.permissions.slice(),t=o.state.customPermissions;return o.customPermissions||(t.length>0&&t.forEach((function(t){e.push(t.id+"")})),o.customPermissions=e),o.customPermissions},o.state={isLoading:!0,currentOption:o.props.currentPerm,customPermissions:[]},o.customPermissions=null,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.props.repoID?this.listCustomPermissions():this.setState({isLoading:!1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoading,r=t.currentOption,o=[];return n||(o=this.getPermissions()),(0,m.jsx)(p.Z,{isOpen:!0,toggle:this.props.toggleDialog,children:(0,m.jsxs)(M.Z,{style:{maxHeight:"400px",overflow:"auto"},children:[n&&(0,m.jsx)(D.Z,{}),!n&&o.map((function(t,n){return(0,m.jsxs)("div",{className:"d-flex",children:[(0,m.jsx)("input",{id:"option-".concat(n),className:"mt-1",type:"radio",name:"permission",value:t,checked:r==t,onChange:e.switchOption}),(0,m.jsxs)("label",{htmlFor:"option-".concat(n),className:"ml-2",children:[e.translatePermission(t),(0,m.jsx)("p",{className:"text-secondary small m-0",children:e.translateExplanation(t)})]})]},n)}))]})})}}]),n}(a.Component),se=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).sortByName=function(t){t.preventDefault();var n="asc"==e.props.sortOrder?"desc":"asc";e.props.sortItems("name",n)},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,o=e.sortBy,i=e.sortOrder;if(t)return(0,m.jsx)("span",{className:"loading-icon loading-tip"});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var s=(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No libraries shared")}),(0,m.jsx)("p",{children:(0,h.ih)('You have not shared any libraries with other users yet. You can share a library with other users by clicking the share icon to the right of a library\'s name in "My Libraries".')})]}),a="name"==o,l="asc"==i?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),c=f.c.isDesktop(),d=(0,m.jsxs)("table",{className:"table-hover ".concat(c?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:c?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"34%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,h.ih)("Name")," ",a&&l]})}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("Share To")}),(0,m.jsx)("th",{width:"24%",children:(0,h.ih)("Permission")}),(0,m.jsx)("th",{width:"8%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsx)(ae,{isDesktop:c,item:e},t)}))})]});return r.length?d:s}}]),n}(a.Component),ae=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).toggleOpMenu=function(){o.setState({isOpMenuOpen:!o.state.isOpMenuOpen})},o.togglePermSelectDialog=function(){o.setState({isPermSelectDialogOpen:!o.state.isPermSelectDialogOpen})},o.onMouseEnter=function(){o.setState({isOpIconShown:!0})},o.onMouseLeave=function(){o.setState({isOpIconShown:!1})},o.changePerm=function(e){var t=o.props.item,n=t.share_type,r={share_type:n,permission:e};"personal"==n?r.user=t.user_email:"group"==n&&(r.group_id=t.group_id),C.I.updateRepoSharePerm(t.repo_id,r).then((function(){o.setState({share_permission:"admin"==e?"rw":e,is_admin:"admin"==e}),W.Z.success((0,h.ih)("Successfully modified permission."))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.unshare=function(e){e.preventDefault();var t=o.props.item,n=t.share_type,r={share_type:n};"personal"==n?r.user=t.user_email:"group"==n&&(r.group_id=t.group_id),C.I.unshareRepo(t.repo_id,r).then((function(e){o.setState({unshared:!0});var n=(0,h.ih)("Successfully unshared {name}").replace("{name}",t.repo_name);W.Z.success(n)})).catch((function(e){var t=f.c.getErrorMsg(e);(0,W.Z)(t)}))},o.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),o.setState({isShowPermEditor:!0})};var i=o.props.item;o.state={share_permission:i.share_permission,share_permission_name:i.share_permission_name,is_admin:i.is_admin,isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,unshared:!1,isShowPermEditor:!1};var s=["rw","r"];return o.permissions=s,o.showAdmin=h._y&&"public"!==i.share_type,o.showAdmin&&s.push("admin"),h._y&&s.push("cloud-edit","preview"),o}return(0,o.Z)(n,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.state,t=e.share_permission,n=e.share_permission_name,r=e.is_admin,o=e.isOpIconShown,i=e.isPermSelectDialogOpen,s=e.isShowPermEditor,l=this.props.item;Object.assign(l,{share_permission:t,is_admin:r});var d,u=f.c.getLibIconUrl(l),p=f.c.getLibIconTitle(l),g="".concat(h.ze,"library/").concat(l.repo_id,"/").concat(encodeURIComponent(l.repo_name),"/"),v=l.share_type;"personal"==v?d=l.user_name:"group"==v?d=l.group_name:"public"==v&&(d=(0,h.ih)("all members")),this.showAdmin&&r&&(t="admin"),t.startsWith("custom-")&&(t=t.slice(7));var y=(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:u,title:p,alt:p,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)(c.rU,{to:g,children:l.repo_name})}),(0,m.jsx)("td",{children:"personal"==l.share_type?(0,m.jsx)("span",{title:l.contact_email,children:d}):d}),(0,m.jsxs)("td",{children:[!s&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:f.c.sharePerms(t)||n}),o&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.ih)("Edit"),title:(0,h.ih)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),s&&(0,m.jsx)(ne.Z,{repoID:l.repo_id,isTextMode:!0,isEditing:!0,autoFocus:!0,isEditIconShow:this.state.isOpIconShown,currentPermission:t,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.ih)("Unshare"),className:"action-icon sf2-icon-x3 ".concat(o?"":"invisible"),title:(0,h.ih)("Unshare"),onClick:this.unshare})})]}),x=(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:u,title:p,alt:p,width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.rU,{to:g,children:l.repo_name}),(0,m.jsx)("span",{className:"item-meta-info-highlighted",children:f.c.sharePerms(t)}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:"".concat((0,h.ih)("Share To:")," ").concat(d)})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(H.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog,children:(0,h.ih)("Permission")}),(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.unshare,children:(0,h.ih)("Unshare")})]})]})]})})]}),i&&(0,m.jsx)(ie,{repoID:l.repo_id,currentPerm:t,permissions:this.permissions,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog})]});return this.props.isDesktop?y:x}}]),n}(a.Component),le=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).sortItems=function(e,t){o.setState({sortBy:e,sortOrder:t,items:f.c.sortRepos(o.state.items,e,t)})},o.state={loading:!0,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.listSharedRepos().then((function(t){var n=t.data.map((function(e){return new re(e)}));e.setState({loading:!1,items:f.c.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"share-admin-libs",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.ih)("Libraries")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(se,{errorMsg:this.state.errorMsg,loading:this.state.loading,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})})]})})}}]),n}(a.Component),ce=(0,o.Z)((function e(t){(0,r.Z)(this,e),this.path=t.path,this.folder_name=t.folder_name,this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.share_type=t.share_type,this.share_permission=t.share_permission,this.share_permission_name=t.share_permission_name,"group"===t.share_type?(this.group_id=t.group_id,this.group_name=t.group_name):(this.user_name=t.user_name,this.user_email=t.user_email,this.contact_email=t.contact_email)})),de=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).sortByName=function(t){t.preventDefault();var n="asc"==e.props.sortOrder?"desc":"asc";e.props.sortItems("name",n)},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,o=e.sortBy,i=e.sortOrder;if(t)return(0,m.jsx)(D.Z,{});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var s=(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No folders shared")}),(0,m.jsx)("p",{children:(0,h.ih)("You have not shared any folders with other users yet. You can share a folder with other users by clicking the share icon to the right of a folder's name.")})]}),a="name"==o,l="asc"==i?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),c=f.c.isDesktop(),d=(0,m.jsxs)("table",{className:"table-hover ".concat(c?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:c?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"34%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,h.ih)("Name")," ",a&&l]})}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("Share To")}),(0,m.jsx)("th",{width:"24%",children:(0,h.ih)("Permission")}),(0,m.jsx)("th",{width:"8%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsx)(ue,{isDesktop:c,item:e},t)}))})]});return r.length?d:s}}]),n}(a.Component),ue=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleOpMenu=function(){o.setState({isOpMenuOpen:!o.state.isOpMenuOpen})},o.togglePermSelectDialog=function(){o.setState({isPermSelectDialogOpen:!o.state.isPermSelectDialogOpen})},o.onMouseEnter=function(){o.setState({isOpIconShown:!0})},o.onMouseLeave=function(){o.setState({isOpIconShown:!1})},o.unshare=function(e){e.preventDefault();var t=o.props.item,n={p:t.path};"personal"==t.share_type?Object.assign(n,{share_type:"user",username:t.user_email}):Object.assign(n,{share_type:t.share_type,group_id:t.group_id}),C.I.unshareFolder(t.repo_id,n).then((function(e){o.setState({unshared:!0});var n=(0,h.ih)("Successfully unshared {name}").replace("{name}",t.folder_name);W.Z.success(n)})).catch((function(e){var t=f.c.getErrorMsg(e);(0,W.Z)(t)}))},o.changePerm=function(e){var t=o.props.item,n={permission:e},r={p:t.path};"personal"==t.share_type?Object.assign(r,{share_type:"user",username:t.user_email}):Object.assign(r,{share_type:t.share_type,group_id:t.group_id}),C.I.updateFolderSharePerm(t.repo_id,n,r).then((function(t){o.setState({share_permission:e}),W.Z.success((0,h.ih)("Successfully modified permission."))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),o.setState({isShowPermEditor:!0})},o.state={share_permission:o.props.item.share_permission,share_permission_name:o.props.item.share_permission_name,isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,unshared:!1,isShowPermEditor:!1},o.permissions=["rw","r"],h._y&&o.permissions.push("cloud-edit","preview"),o}return(0,o.Z)(n,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.props.item,t=this.state,n=t.share_permission,r=t.share_permission_name,o=t.isOpIconShown,i=t.isPermSelectDialogOpen,s=t.isShowPermEditor,l=!1;"r"!=n&&"preview"!=n||(l=!0);var d=f.c.getFolderIconUrl(l),u=f.c.getFolderIconTitle({permission:n}),p="".concat(h.ze,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)).concat(f.c.encodePath(e.path));n.startsWith("custom-")&&(n=n.slice(7));var g=(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:d,title:u,alt:u,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)(c.rU,{to:p,children:e.folder_name})}),(0,m.jsx)("td",{children:"personal"==e.share_type?(0,m.jsx)("span",{title:e.contact_email,children:e.user_name}):e.group_name}),(0,m.jsxs)("td",{children:[!s&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:f.c.sharePerms(n)||r}),o&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.ih)("Edit"),title:(0,h.ih)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),s&&(0,m.jsx)(ne.Z,{repoID:e.repo_id,isTextMode:!0,isEditIconShow:o,isEditing:!0,autoFocus:!0,currentPermission:n,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.ih)("Unshare"),className:"action-icon sf2-icon-x3 ".concat(o?"":"invisible"),title:(0,h.ih)("Unshare"),onClick:this.unshare})})]}),v=(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:d,title:u,alt:u,width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.rU,{to:p,children:e.folder_name}),(0,m.jsx)("span",{className:"item-meta-info-highlighted",children:f.c.sharePerms(n)}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:"".concat((0,h.ih)("Share To:")," ").concat("personal"==e.share_type?e.user_name:e.group_name)})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(H.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog,children:(0,h.ih)("Permission")}),(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.unshare,children:(0,h.ih)("Unshare")})]})]})]})})]}),i&&(0,m.jsx)(ie,{repoID:e.repo_id,currentPerm:n,permissions:this.permissions,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog})]});return this.props.isDesktop?g:v}}]),n}(a.Component),pe=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e))._sortItems=function(e,t,n){var r;switch("".concat(t,"-").concat(n)){case"name-asc":r=function(e,t){return f.c.compareTwoWord(e.folder_name,t.folder_name)};break;case"name-desc":r=function(e,t){return-f.c.compareTwoWord(e.folder_name,t.folder_name)}}return e.sort(r),e},o.sortItems=function(e,t){o.setState({sortBy:e,sortOrder:t,items:o._sortItems(o.state.items,e,t)})},o.state={loading:!0,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.listSharedFolders().then((function(t){var n=t.data.map((function(e){return new ce(e)}));e.setState({loading:!1,items:e._sortItems(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"share-admin-libs",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.ih)("Folders")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(de,{errorMsg:this.state.errorMsg,loading:this.state.loading,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})})]})})}}]),n}(a.Component),he=n(82746),fe=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).switchOption=function(e){if(e.target.checked){var t=e.target.value;o.setState({currentOption:t}),o.props.changePerm(t),o.props.toggleDialog()}},o.state={currentOption:o.props.currentPerm},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props.permissions,n=this.state.currentOption;return(0,m.jsx)(p.Z,{isOpen:!0,toggle:this.props.toggleDialog,children:(0,m.jsx)(M.Z,{children:t.map((function(t,r){return(0,m.jsxs)("div",{className:"d-flex",children:[(0,m.jsx)("input",{id:"option-".concat(r),className:"mt-1",type:"radio",name:"permission",value:t,checked:n==t,onChange:e.switchOption}),(0,m.jsx)("label",{htmlFor:"option-".concat(r),className:"ml-2",children:f.c.getShareLinkPermissionObject(t).text})]},r)}))})})}}]),n}(a.Component),me=n(42123),ge=n(29439),ve=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).switchOption=function(e){if(e.target.checked){o.setState({currentOption:e.target.value});var t=e.target.value.split("-"),n=(0,ge.Z)(t,2),r=n[0],i=n[1];o.props.sortItems(r,i),o.props.toggleDialog()}},o.sortOptions=o.props.sortOptions||[{value:"name-asc",text:(0,h.ih)("By name ascending")},{value:"name-desc",text:(0,h.ih)("By name descending")},{value:"size-asc",text:(0,h.ih)("By size ascending")},{value:"size-desc",text:(0,h.ih)("By size descending")},{value:"time-asc",text:(0,h.ih)("By time ascending")},{value:"time-desc",text:(0,h.ih)("By time descending")}];var i=o.props,s=i.sortBy,a=i.sortOrder;return o.state={currentOption:"".concat(s,"-").concat(a)},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this;return(0,m.jsx)(p.Z,{isOpen:!0,toggle:this.props.toggleDialog,children:(0,m.jsx)(M.Z,{children:this.sortOptions.map((function(t,n){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("input",{id:"option-".concat(n),className:"align-middle",type:"radio",name:"sort-option",value:t.value,checked:e.state.currentOption==t.value,onChange:e.switchOption}),(0,m.jsx)("label",{htmlFor:"option-".concat(n),className:"align-middle m-2",children:t.text}),(0,m.jsx)("br",{})]},n)}))})})}}]),n}(a.Component),ye=n(64185),xe=n(86358),we=n(87147),be=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleItemFreezed=function(e){o.setState({isItemFreezed:e})},o.sortByName=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortItems("name",t)},o.sortByTime=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortItems("time",t)},o.state={isItemFreezed:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,i=t.sortBy,s=t.sortOrder;if(n)return(0,m.jsx)(D.Z,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var a=(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No share links")}),(0,m.jsx)("p",{children:(0,h.ih)("You have not created any share links yet. A share link can be used to share files and folders with anyone. You can create a share link for a file or folder by clicking the share icon to the right of its name.")})]}),l="name"==i,c="time"==i,d="asc"==s?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),u=f.c.isDesktop(),p=h._y?["14%","7%","14%"]:["21%","14%","20%"],g=(0,m.jsxs)("table",{className:"".concat(u?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:u?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"31%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,h.ih)("Name")," ",l&&d]})}),(0,m.jsx)("th",{width:p[0],children:(0,h.ih)("Library")}),h._y&&(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Permission")}),(0,m.jsx)("th",{width:p[1],children:(0,h.ih)("Visits")}),(0,m.jsx)("th",{width:p[2],children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,h.ih)("Expiration")," ",c&&d]})}),(0,m.jsx)("th",{width:"10%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(Se,{isDesktop:u,item:t,onRemoveLink:e.props.onRemoveLink,isItemFreezed:e.state.isItemFreezed,toggleItemFreezed:e.toggleItemFreezed},n)}))})]});return o.length?(0,m.jsxs)(m.Fragment,{children:[g,this.props.isLoadingMore&&(0,m.jsx)("div",{className:"flex-shrink-0",children:(0,m.jsx)(D.Z,{})})]}):a}}]),n}(a.Component),Se=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).updatePermissionOptions=function(){var e=o.props.item,t=e.is_dir?"/"===e.path?"library":"dir":"file",n=e.repo_folder_permission,r=f.c.getShareLinkPermissionList(t,n,e.path,e.can_edit),i=f.c.getShareLinkPermissionStr(o.props.item.permissions);o.setState({permissionOptions:r,currentPermission:i})},o.toggleOpMenu=function(){o.setState({isOpMenuOpen:!o.state.isOpMenuOpen})},o.togglePermSelectDialog=function(){o.setState({isPermSelectDialogOpen:!o.state.isPermSelectDialogOpen})},o.toggleLinkDialog=function(){o.setState({isLinkDialogOpen:!o.state.isLinkDialogOpen})},o.handleMouseEnter=function(){o.props.isItemFreezed||o.setState({isOpIconShown:!0,highlight:!0})},o.handleMouseLeave=function(){o.props.isItemFreezed||o.setState({isOpIconShown:!1,highlight:!1})},o.viewLink=function(e){e.preventDefault(),o.toggleLinkDialog()},o.removeLink=function(e){e.preventDefault(),o.props.onRemoveLink(o.props.item)},o.renderExpiration=function(){var e=o.props.item;if(!e.expire_date)return"--";var t=S()(e.expire_date).format("YYYY-MM-DD"),n=S()(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return(0,m.jsx)("span",{className:e.is_expired?"error":"",title:n,children:t})},o.changePermission=function(e){o.changePerm(e.value)},o.changePerm=function(e){var t=o.props.item,n=f.c.getShareLinkPermissionObject(e).permissionDetails;C.I.updateShareLink(t.token,JSON.stringify(n)).then((function(){o.setState({currentPermission:e});var t=(0,h.ih)("Successfully modified permission.");W.Z.success(t)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={highlight:!1,isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,isLinkDialogOpen:!1,permissionOptions:[],currentPermission:""},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){h._y&&this.updatePermissionOptions()}},{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.currentPermission,r=t.permissionOptions,o=t.isOpIconShown,i=t.isPermSelectDialogOpen,s=t.isLinkDialogOpen;this.permOptions=r.map((function(e){return{value:e,text:f.c.getShareLinkPermissionObject(e).text,isSelected:e==n}}));var l,d,u=this.permOptions.filter((function(e){return e.isSelected}))[0]||{};if(e.is_dir){var p="/"===e.path?"/":e.path.slice(0,e.path.length-1);l=f.c.getFolderIconUrl(!1),d="".concat(h.ze,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)).concat(f.c.encodePath(p))}else l=f.c.getFileIconUrl(e.obj_name),d="".concat(h.ze,"lib/").concat(e.repo_id,"/file").concat(f.c.encodePath(e.path));var g=""===e.obj_id?(0,m.jsx)("span",{style:{color:"red"},children:(0,h.ih)("(deleted)")}):null,v=(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onFocus:this.handleMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:l,width:"24",alt:""})}),(0,m.jsxs)("td",{children:[e.is_dir?(0,m.jsx)(c.rU,{to:d,children:e.obj_name}):(0,m.jsx)("a",{href:d,target:"_blank",rel:"noreferrer",children:e.obj_name}),g]}),(0,m.jsx)("td",{children:(0,m.jsx)(c.rU,{to:"".concat(h.ze,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name),"/"),children:e.repo_name})}),h._y&&(0,m.jsx)("td",{children:(0,m.jsx)(we.Z,{isDropdownToggleShown:o&&!e.is_expired,currentSelectedOption:u,options:this.permOptions,selectOption:this.changePermission,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,m.jsx)("td",{children:e.view_cnt}),(0,m.jsx)("td",{children:this.renderExpiration()}),(0,m.jsxs)("td",{children:[!e.is_expired&&(0,m.jsx)("a",{href:"#",className:"sf2-icon-link action-icon op-icon ".concat(o?"":"invisible"),title:(0,h.ih)("View"),"aria-label":(0,h.ih)("View"),role:"button",onClick:this.viewLink}),(0,m.jsx)("a",{href:"#",className:"sf3-font-delete1 sf3-font action-icon op-icon ".concat(o?"":"invisible"),title:(0,h.ih)("Remove"),"aria-label":(0,h.ih)("Remove"),role:"button",onClick:this.removeLink})]})]}),y=(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:l,alt:"",width:"24"})}),(0,m.jsxs)("td",{children:[e.is_dir?(0,m.jsx)(c.rU,{to:d,children:e.obj_name}):(0,m.jsx)("a",{href:d,target:"_blank",rel:"noreferrer",children:e.obj_name}),h._y&&(0,m.jsx)("span",{className:"item-meta-info-highlighted",children:f.c.getShareLinkPermissionObject(n).text}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{children:e.repo_name}),(0,m.jsx)("br",{}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,h.ih)("Visits"),": ",e.view_cnt]}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,h.ih)("Expiration"),": ",this.renderExpiration()]})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(H.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[h._y&&!e.is_expired&&(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog,children:(0,h.ih)("Permission")}),!e.is_expired&&(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.viewLink,children:(0,h.ih)("View")}),(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.removeLink,children:(0,h.ih)("Remove")})]})]})]})})]}),i&&(0,m.jsx)(fe,{currentPerm:n,permissions:r,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog})]});return(0,m.jsxs)(a.Fragment,{children:[this.props.isDesktop?v:y,s&&(0,m.jsx)(me.Z,{link:e.link,toggleDialog:this.toggleLinkDialog})]})}}]),n}(a.Component),Ce=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e))._sortItems=function(e,t,n){var r;switch("".concat(t,"-").concat(n)){case"name-asc":r=function(e,t){return f.c.compareTwoWord(e.obj_name,t.obj_name)};break;case"name-desc":r=function(e,t){return-f.c.compareTwoWord(e.obj_name,t.obj_name)};break;case"time-asc":r=function(e,t){return e.expire_date<t.expire_date?-1:1};break;case"time-desc":r=function(e,t){return e.expire_date<t.expire_date?1:-1}}return e.sort((function(e,t){return e.is_dir&&!t.is_dir?-1:!e.is_dir&&t.is_dir?1:r(e,t)})),e},o.sortItems=function(e,t){o.setState({sortBy:e,sortOrder:t,items:o._sortItems(o.state.items,e,t)})},o.handleScroll=function(e){if(!o.state.isLoadingMore&&o.state.hasMore){var t=e.target.clientHeight,n=e.target.scrollHeight;t+e.target.scrollTop+1>=n&&o.setState({isLoadingMore:!0},(function(){o.getMore()}))}},o.getMore=function(){var e=o.state.page;C.I.listShareLinks({page:e+1}).then((function(t){var n=t.data.map((function(e){return new he.Z(e)}));o.setState({isLoadingMore:!1,hasMore:25==t.data.length,page:e+1,items:o._sortItems(o.state.items.concat(n),o.state.sortBy,o.state.sortOrder)})})).catch((function(e){o.setState({isLoadingMore:!1,errorMsg:f.c.getErrorMsg(e,!0)})}))},o.onRemoveLink=function(e){C.I.deleteShareLink(e.token).then((function(){var t=o.state.items.filter((function(t){return t.token!==e.token}));o.setState({items:t});var n=(0,h.ih)("Successfully deleted 1 item.");W.Z.success(n)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.toggleSortOptionsDialog=function(){o.setState({isSortOptionsDialogOpen:!o.state.isSortOptionsDialogOpen})},o.toggleCleanInvalidShareLinksDialog=function(){o.setState({isCleanInvalidShareLinksDialogOpen:!o.state.isCleanInvalidShareLinksDialogOpen})},o.cleanInvalidShareLinks=function(){C.I.cleanInvalidShareLinks().then((function(e){var t=o.state.items.filter((function(e){return""!==e.obj_id})).filter((function(e){return!e.is_expired}));o.setState({items:t}),W.Z.success((0,h.ih)("Successfully cleaned invalid share links."))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={isCleanInvalidShareLinksDialogOpen:!1,loading:!0,hasMore:!1,isLoadingMore:!1,page:1,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},o.sortOptions=[{value:"name-asc",text:(0,h.ih)("By name ascending")},{value:"name-desc",text:(0,h.ih)("By name descending")},{value:"time-asc",text:(0,h.ih)("By expiration ascending")},{value:"time-desc",text:(0,h.ih)("By expiration descending")}],o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.listUserShareLinks()}},{key:"listUserShareLinks",value:function(){var e=this,t=this.state.page;C.I.listShareLinks({page:t}).then((function(t){var n=t.data.map((function(e){return new he.Z(e)}));e.setState({loading:!1,hasMore:25==t.data.length,items:e._sortItems(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(xe.Z,{onShowSidePanel:this.props.onShowSidePanel,onSearchedClick:this.props.onSearchedClick,children:(0,m.jsx)(R.Z,{className:"operation-item d-none d-md-block",onClick:this.toggleCleanInvalidShareLinksDialog,children:(0,h.ih)("Clean invalid share links")})}),(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path share-upload-nav",children:[(0,m.jsxs)("ul",{className:"nav",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.rU,{to:"".concat(h.ze,"share-admin-share-links/"),className:"nav-link active",children:(0,h.ih)("Share Links")})}),h.$g&&(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.rU,{to:"".concat(h.ze,"share-admin-upload-links/"),className:"nav-link",children:(0,h.ih)("Upload Links")})})]}),!f.c.isDesktop()&&this.state.items.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})]}),(0,m.jsx)("div",{className:"cur-view-content",onScroll:this.handleScroll,children:(0,m.jsx)(be,{loading:this.state.loading,isLoadingMore:this.state.isLoadingMore,errorMsg:this.state.errorMsg,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,onRemoveLink:this.onRemoveLink})})]})}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(ve,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortOptions:this.sortOptions,sortItems:this.sortItems}),this.state.isCleanInvalidShareLinksDialogOpen&&(0,m.jsx)(ye.Z,{title:(0,h.ih)("Clean invalid share links"),message:(0,h.ih)("Are you sure you want to clean invalid share links?"),executeOperation:this.cleanInvalidShareLinks,confirmBtnText:(0,h.ih)("Clean"),toggleDialog:this.toggleCleanInvalidShareLinksDialog})]})}}]),n}(a.Component),De=n(6626),ke=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items;if(n)return(0,m.jsx)(D.Z,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var i=(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No upload links")}),(0,m.jsx)("p",{children:(0,h.ih)("You have not created any upload links yet. An upload link allows anyone to upload files to a folder or library. You can create an upload link for a folder or library by clicking the share icon to the right of its name.")})]}),s=f.c.isDesktop(),a=(0,m.jsxs)("table",{className:"table-hover ".concat(s?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:s?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"24%",children:(0,h.ih)("Library")}),(0,m.jsx)("th",{width:"16%",children:(0,h.ih)("Visits")}),(0,m.jsx)("th",{width:"16%",children:(0,h.ih)("Expiration")}),(0,m.jsx)("th",{width:"10%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(je,{isDesktop:s,item:t,onRemoveLink:e.props.onRemoveLink},n)}))})]});return o.length?a:i}}]),n}(a.Component),je=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleOpMenu=function(){o.setState({isOpMenuOpen:!o.state.isOpMenuOpen})},o.toggleLinkDialog=function(){o.setState({isLinkDialogOpen:!o.state.isLinkDialogOpen})},o.handleMouseOver=function(){o.setState({isOpIconShown:!0})},o.handleMouseOut=function(){o.setState({isOpIconShown:!1})},o.viewLink=function(e){e.preventDefault(),o.toggleLinkDialog()},o.removeLink=function(e){e.preventDefault(),o.props.onRemoveLink(o.props.item)},o.renderExpiration=function(){var e=o.props.item;if(!e.expire_date)return"--";var t=S()(e.expire_date).format("YYYY-MM-DD"),n=S()(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return(0,m.jsx)("span",{className:e.is_expired?"error":"",title:n,children:t})},o.state={isOpIconShown:!1,isOpMenuOpen:!1,isLinkDialogOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isLinkDialogOpen,o=f.c.getFolderIconUrl(!1),i="".concat(h.ze,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)),s="".concat(i).concat(f.c.encodePath(e.path)),l=""===e.obj_id?(0,m.jsx)("span",{style:{color:"red"},children:(0,h.ih)("(deleted)")}):null,d=(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:o,alt:"",width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.rU,{to:s,children:e.obj_name}),l]}),(0,m.jsx)("td",{children:(0,m.jsx)(c.rU,{to:i,children:e.repo_name})}),(0,m.jsx)("td",{children:e.view_cnt}),(0,m.jsx)("td",{children:this.renderExpiration()}),(0,m.jsxs)("td",{children:[!e.is_expired&&(0,m.jsx)("a",{href:"#",className:"sf2-icon-link action-icon op-icon ".concat(n?"":"invisible"),title:(0,h.ih)("View"),"aria-label":(0,h.ih)("View"),role:"button",onClick:this.viewLink}),(0,m.jsx)("a",{href:"#",className:"sf3-font-delete1 sf3-font action-icon op-icon ".concat(n?"":"invisible"),title:(0,h.ih)("Remove"),"aria-label":(0,h.ih)("Remove"),role:"button",onClick:this.removeLink})]})]}),u=(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:o,alt:"",width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.rU,{to:s,children:e.obj_name}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{children:e.repo_name}),(0,m.jsx)("br",{}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,h.ih)("Visits"),": ",e.view_cnt]}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,h.ih)("Expiration"),": ",this.renderExpiration()]})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(H.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[!e.is_expired&&(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.viewLink,children:(0,h.ih)("View")}),(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.removeLink,children:(0,h.ih)("Remove")})]})]})]})})]});return(0,m.jsxs)(a.Fragment,{children:[this.props.isDesktop?d:u,r&&(0,m.jsx)(me.Z,{link:e.link,toggleDialog:this.toggleLinkDialog})]})}}]),n}(a.Component),Ie=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onRemoveLink=function(e){C.I.deleteUploadLink(e.token).then((function(){var t=o.state.items.filter((function(t){return t.token!==e.token}));o.setState({items:t});var n=(0,h.ih)("Successfully deleted 1 item.");W.Z.success(n)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.toggleCleanInvalidUploadLinksDialog=function(){o.setState({isCleanInvalidUploadLinksDialogOpen:!o.state.isCleanInvalidUploadLinksDialogOpen})},o.cleanInvalidUploadLinks=function(){C.I.cleanInvalidUploadLinks().then((function(e){var t=o.state.items.filter((function(e){return""!==e.obj_id})).filter((function(e){return!e.is_expired}));o.setState({items:t}),W.Z.success((0,h.ih)("Successfully cleaned invalid upload links."))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={isCleanInvalidUploadLinksDialogOpen:!1,loading:!0,errorMsg:"",items:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.listUserUploadLinks()}},{key:"listUserUploadLinks",value:function(){var e=this;C.I.listUserUploadLinks().then((function(t){var n=t.data.map((function(e){return new De.Z(e)}));e.setState({loading:!1,items:n})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(xe.Z,{onShowSidePanel:this.props.onShowSidePanel,onSearchedClick:this.props.onSearchedClick,children:(0,m.jsx)(R.Z,{className:"operation-item d-none d-md-block",onClick:this.toggleCleanInvalidUploadLinksDialog,children:(0,h.ih)("Clean invalid upload links")})}),(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path share-upload-nav",children:(0,m.jsxs)("ul",{className:"nav",children:[h.Fl&&(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.rU,{to:"".concat(h.ze,"share-admin-share-links/"),className:"nav-link",children:(0,h.ih)("Share Links")})}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.rU,{to:"".concat(h.ze,"share-admin-upload-links/"),className:"nav-link active",children:(0,h.ih)("Upload Links")})})]})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(ke,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,onRemoveLink:this.onRemoveLink})})]})}),this.state.isCleanInvalidUploadLinksDialogOpen&&(0,m.jsx)(ye.Z,{title:(0,h.ih)("Clean invalid upload links"),message:(0,h.ih)("Are you sure you want to clean invalid upload links?"),executeOperation:this.cleanInvalidUploadLinks,confirmBtnText:(0,h.ih)("Clean"),toggleDialog:this.toggleCleanInvalidUploadLinksDialog})]})}}]),n}(a.Component),Me=n(72611),_e=n(11621),Ne=(0,o.Z)((function e(t){(0,r.Z)(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.permission=t.permission,this.size_original=t.size,this.size=f.c.bytesToSize(t.size),this.owner_name=t.owner_name,this.owner_email=t.owner_email,this.owner_contact_email=t.owner_contact_email,this.encrypted=t.encrypted,this.last_modified=t.last_modified,this.modifier_contact_email=t.modifier_contact_email,this.modifier_email=t.modifier_email,this.modifier_name=t.modifier_name,this.type=t.type,this.starred=t.starred,this.monitored=t.monitored,this.status=t.status,this.storage_name=t.storage_name,void 0!=t.is_admin&&(this.is_admin=t.is_admin)}));var Re=function(){return(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.ih)("Library Type")})}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.ih)("Actions")})})]})})},Te=n(63876),Oe=n(48128),Ee=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.repoID,n=e.className;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("i",{id:"watching-".concat(t),className:"sf3-font-monitor sf3-font ".concat(n||"")}),(0,m.jsx)(Oe.Z,{placement:"bottom",target:"#watching-".concat(t),children:(0,h.ih)("You are watching file changes of this library.")})]})}}]),n}(a.Component),Pe=Ee,Ze=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).freezeItem=function(e){o.setState({isItemFreezed:e})},o.sortByName=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortItems("name",t)},o.sortByTime=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortItems("time",t)},o.sortBySize=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortItems("size",t)},o.state={isItemFreezed:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,i=t.sortBy,s=t.sortOrder,a=t.theadHidden,l=t.inAllLibs,c=t.currentViewMode,d=l?(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(c,"-mode"),children:(0,h.ih)("No shared libraries")}):(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No shared libraries")}),(0,m.jsx)("p",{children:(0,h.ih)("No libraries have been shared directly with you. A shared library can be shared with full or restricted permission. If you need access to a library owned by another user, ask the user to share the library with you.")})]});if(n)return(0,m.jsx)(D.Z,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var u="name"==i,p="time"==i,g="size"==i,v="asc"==s?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),y=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.ih)("Library Type")})}),(0,m.jsx)("th",{width:"35%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,h.ih)("Name")," ",u&&v]})}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.ih)("Actions")})}),(0,m.jsx)("th",{width:"14%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize,children:[(0,h.ih)("Size")," ",g&&v]})}),(0,m.jsx)("th",{width:"17%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,h.ih)("Last Update")," ",p&&v]})}),(0,m.jsx)("th",{width:"17%",children:(0,h.ih)("Owner")})]})}),x=f.c.isDesktop(),w=(0,m.jsx)(m.Fragment,{children:o.map((function(t,n){return(0,m.jsx)(Fe,{data:t,isDesktop:x,isItemFreezed:e.state.isItemFreezed,freezeItem:e.freezeItem,onMonitorRepo:e.props.onMonitorRepo,currentViewMode:c},n)}))}),b="list"==c?(0,m.jsxs)("table",{className:x&&!a?"":"table-thead-hidden",children:[x?y:(0,m.jsx)(Re,{}),(0,m.jsx)("tbody",{children:w})]}):(0,m.jsx)("div",{className:"d-flex justify-content-between flex-wrap",children:w});return o.length?b:d}}]),n}(a.Component),Fe=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleOpMenu=function(){o.setState({isOpMenuOpen:!o.state.isOpMenuOpen},(function(){o.props.freezeItem(o.state.isOpMenuOpen)}))},o.handleMouseOver=function(){o.props.isItemFreezed||o.setState({highlight:!0,showOpIcon:!0})},o.handleMouseOut=function(){o.props.isItemFreezed||o.setState({highlight:!1,showOpIcon:!1})},o.share=function(e){e.preventDefault(),o.setState({isShowSharedDialog:!0})},o.leaveShare=function(e){e.preventDefault();var t,n=o.props.data;if(-1==n.owner_email.indexOf("@seafile_group")){var r={share_type:"personal",from:n.owner_email};t=C.I.leaveShareRepo(n.repo_id,r)}else t=C.I.leaveShareGroupOwnedRepo(n.repo_id);t.then((function(e){o.setState({unshared:!0});var t=(0,h.ih)("Successfully unshared {name}").replace("{name}",n.repo_name);W.Z.success(t)})).catch((function(e){var t=f.c.getErrorMsg(e);t===(0,h.ih)("Error")&&(t=(0,h.ih)("Failed to unshare {name}").replace("{name}",n.repo_name)),(0,W.Z)(t)}))},o.toggleShareDialog=function(){o.setState({isShowSharedDialog:!1})},o.onToggleStarRepo=function(e){e.preventDefault();var t=o.props.data.repo_name;o.state.isStarred?C.I.unstarItem(o.props.data.repo_id,"/").then((function(){o.setState({isStarred:!o.state.isStarred});var e=(0,h.ih)("Successfully unstarred {library_name_placeholder}.").replace("{library_name_placeholder}",t);W.Z.success(e)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})):C.I.starItem(o.props.data.repo_id,"/").then((function(){o.setState({isStarred:!o.state.isStarred});var e=(0,h.ih)("Successfully starred {library_name_placeholder}.").replace("{library_name_placeholder}",t);W.Z.success(e)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.visitRepo=function(){(0,c.c4)(o.repoURL)},o.watchFileChanges=function(){var e=o.props.data;C.I.monitorRepo(e.repo_id).then((function(){o.props.onMonitorRepo(e,!0)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.unwatchFileChanges=function(){var e=o.props.data;C.I.unMonitorRepo(e.repo_id).then((function(){o.props.onMonitorRepo(e,!1)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={highlight:!1,showOpIcon:!1,unshared:!1,isShowSharedDialog:!1,isStarred:o.props.data.starred,isOpMenuOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.state.isStarred,t=this.props,n=t.data,r=t.currentViewMode,o=void 0===r?"list":r,i="grid"==o;n.icon_url=f.c.getLibIconUrl(n,i),n.icon_title=f.c.getLibIconTitle(n);var s=this.state.showOpIcon?"":" invisible",l="op-icon sf3-font-share sf3-font repo-share-btn"+s,d="op-icon sf2-icon-x3"+s,u=this.repoURL="".concat(h.ze,"library/").concat(n.repo_id,"/").concat(f.c.encodePath(n.repo_name),"/"),p=h._y&&("r"==n.permission||"rw"==n.permission),g=(0,m.jsxs)(a.Fragment,{children:["list"==o?(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("i",{role:"button",title:this.state.isStarred?(0,h.ih)("Unstar"):(0,h.ih)("Star"),"aria-label":this.state.isStarred?(0,h.ih)("Unstar"):(0,h.ih)("Star"),onClick:this.onToggleStarRepo,className:"op-icon m-0 ".concat(this.state.isStarred?"sf3-font-star":"sf3-font-star-empty"," sf3-font")})}),(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:n.icon_url,title:n.icon_title,alt:n.icon_title,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(c.rU,{to:u,children:n.repo_name}),n.monitored&&(0,m.jsx)(Pe,{repoID:n.repo_id,className:"ml-1 op-icon"})]})}),(0,m.jsxs)("td",{children:[h._y&&n.is_admin&&(0,m.jsx)("a",{href:"#",className:l,title:(0,h.ih)("Share"),role:"button","aria-label":(0,h.ih)("Share"),onClick:this.share}),(0,m.jsx)("a",{href:"#",className:d,title:(0,h.ih)("Leave Share"),role:"button","aria-label":(0,h.ih)("Leave Share"),onClick:this.leaveShare}),p&&(0,m.jsxs)(H.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font ".concat(s),title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsx)(Me.Z,{children:(0,m.jsx)(V.Z,{onClick:n.monitored?this.unwatchFileChanges:this.watchFileChanges,children:n.monitored?(0,h.ih)("Unwatch File Changes"):(0,h.ih)("Watch File Changes")})})]})]}),(0,m.jsx)("td",{children:n.size}),(0,m.jsx)("td",{title:S()(n.last_modified).format("llll"),children:S()(n.last_modified).fromNow()}),(0,m.jsx)("td",{title:n.owner_contact_email,children:n.owner_name})]}):(0,m.jsxs)("div",{className:"library-grid-item px-3 d-flex justify-content-between align-items-center",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center text-truncate",children:[(0,m.jsx)("img",{src:n.icon_url,title:n.icon_title,alt:n.icon_title,width:"36",className:"mr-2"}),(0,m.jsx)(c.rU,{to:u,className:"text-truncate library-name",title:n.repo_name,children:n.repo_name}),e&&(0,m.jsx)("i",{role:"button",title:(0,h.ih)("Unstar"),"aria-label":(0,h.ih)("Unstar"),onClick:this.onToggleStarRepo,className:"op-icon library-grid-item-icon sf3-font-star sf3-font"}),n.monitored&&(0,m.jsx)(Pe,{repoID:n.repo_id,className:"op-icon library-grid-item-icon"})]}),(0,m.jsxs)("div",{className:"flex-shrink-0",children:[h._y&&n.is_admin&&(0,m.jsx)("a",{href:"#",className:l,title:(0,h.ih)("Share"),role:"button","aria-label":(0,h.ih)("Share"),onClick:this.share}),(0,m.jsx)("a",{href:"#",className:d,title:(0,h.ih)("Leave Share"),role:"button","aria-label":(0,h.ih)("Leave Share"),onClick:this.leaveShare}),p&&(0,m.jsxs)(H.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font ".concat(s),title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsx)(Me.Z,{children:(0,m.jsx)(V.Z,{onClick:n.monitored?this.unwatchFileChanges:this.watchFileChanges,children:n.monitored?(0,h.ih)("Unwatch File Changes"):(0,h.ih)("Watch File Changes")})})]})]})]}),this.state.isShowSharedDialog&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Te.Z,{itemType:"library",itemName:n.repo_name,itemPath:"/",repoID:n.repo_id,repoEncrypted:n.encrypted,enableDirPrivateShare:!0,userPerm:n.permission,isAdmin:!0,toggleDialog:this.toggleShareDialog})})]}),v=(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{onClick:this.visitRepo,children:(0,m.jsx)("img",{src:n.icon_url,title:n.icon_title,alt:n.icon_title,width:"24"})}),(0,m.jsxs)("td",{onClick:this.visitRepo,children:[(0,m.jsx)(c.rU,{to:u,children:n.repo_name}),n.monitored&&(0,m.jsx)(Pe,{repoID:n.repo_id,className:"ml-1 op-icon"}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",title:n.owner_contact_email,children:n.owner_name}),(0,m.jsx)("span",{className:"item-meta-info",children:n.size}),(0,m.jsx)("span",{className:"item-meta-info",title:S()(n.last_modified).format("llll"),children:S()(n.last_modified).fromNow()})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(H.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.onToggleStarRepo,children:this.state.isStarred?(0,h.ih)("Unstar"):(0,h.ih)("Star")}),h._y&&n.is_admin&&(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.share,children:(0,h.ih)("Share")}),(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.leaveShare,children:(0,h.ih)("Leave Share")}),p&&(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:n.monitored?this.unwatchFileChanges:this.watchFileChanges,children:n.monitored?(0,h.ih)("Unwatch File Changes"):(0,h.ih)("Watch File Changes")})]})]})]})})]}),this.state.isShowSharedDialog&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Te.Z,{itemType:"library",itemName:n.repo_name,itemPath:"/",repoID:n.repo_id,repoEncrypted:n.encrypted,enableDirPrivateShare:!0,userPerm:n.permission,isAdmin:!0,toggleDialog:this.toggleShareDialog})})]});return this.props.isDesktop?g:v}}]),n}(a.Component),Le=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).sortItems=function(e,t){_e.ZP.save("seafile-repo-dir-sort-by",e),_e.ZP.save("seafile-repo-dir-sort-order",t),o.setState({sortBy:e,sortOrder:t,items:f.c.sortRepos(o.state.items,e,t)})},o.toggleSortOptionsDialog=function(){o.setState({isSortOptionsDialogOpen:!o.state.isSortOptionsDialogOpen})},o.onMonitorRepo=function(e,t){var n=o.state.items.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));o.setState({items:n})},o.renderContent=function(){var e=o.props,t=e.inAllLibs,n=void 0!==t&&t,r=e.currentViewMode,i=void 0===r?"list":r,s=e.repoList,a=o.state.items;return(0,m.jsx)(Ze,{loading:o.state.loading,errorMsg:o.state.errorMsg,items:n?s:a,sortBy:o.state.sortBy,sortOrder:o.state.sortOrder,sortItems:o.sortItems,onMonitorRepo:o.onMonitorRepo,theadHidden:n,inAllLibs:n,currentViewMode:i})},o.renderSortIconInMobile=function(){return(0,m.jsx)(m.Fragment,{children:!f.c.isDesktop()&&o.state.items.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:o.toggleSortOptionsDialog})})},o.state={loading:!0,errorMsg:"",items:[],sortBy:_e.ZP.load("seafile-repo-dir-sort-by")||"name",sortOrder:_e.ZP.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.repoList?this.setState({loading:!1,items:this.props.repoList}):C.I.listRepos({type:"shared"}).then((function(t){var n=t.data.repos.map((function(e){return new Ne(e)}));e.setState({loading:!1,items:f.c.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.props,t=e.inAllLibs,n=void 0!==t&&t,r=e.currentViewMode,o=void 0===r?"list":r;return(0,m.jsxs)(a.Fragment,{children:[n?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat("list"==o?"sf-border-bottom":""),children:[(0,m.jsxs)("h4",{className:"sf-heading m-0",children:[(0,m.jsx)("span",{className:"sf3-font-share-with-me sf3-font nav-icon","aria-hidden":"true"}),(0,h.ih)("Shared with me")]}),this.renderSortIconInMobile()]}),this.renderContent()]}):(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,h.ih)("Shared with me")}),this.renderSortIconInMobile()]}),(0,m.jsx)("div",{className:"cur-view-content",children:this.renderContent()})]})}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(ve,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})]})}}]),n}(a.Component),Ae=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,i=(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No libraries have been shared with you")}),(0,m.jsx)("p",{children:(0,h.ih)("No libraries have been shared with you from other servers.")})]});if(n)return(0,m.jsx)(D.Z,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var s=(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Shared by")}),(0,m.jsx)("th",{width:"26%",children:(0,h.ih)("At server")}),(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Time")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(Ue,{item:t,leaveShare:e.props.leaveShare},n)}))})]});return o.length?s:i}}]),n}(a.Component),Ue=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleMouseOver=function(){o.setState({isOpIconShown:!0})},o.handleMouseOut=function(){o.setState({isOpIconShown:!1})},o.leaveShare=function(e){e.preventDefault(),o.props.leaveShare(o.props.item)},o.state={isOpIconShown:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.item,t=this.state.isOpIconShown;e.icon_url=f.c.getLibIconUrl(e),e.icon_title=f.c.getLibIconTitle(e);var n="".concat(h.ze,"remote-library/").concat(this.props.item.provider_id,"/").concat(this.props.item.repo_id,"/").concat(f.c.encodePath(this.props.item.repo_name),"/");return(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:e.icon_url,title:e.icon_title,alt:e.icon_title,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)(c.rU,{to:n,children:e.repo_name})}),(0,m.jsx)("td",{children:e.from_user}),(0,m.jsx)("td",{children:e.from_server_url}),(0,m.jsx)("td",{title:S()(e.last_modified).format("llll"),children:S()(e.ctime).fromNow()}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button",className:"action-icon sf2-icon-x3 ".concat(t?"":"invisible"),title:(0,h.ih)("Leave Share"),"aria-label":(0,h.ih)("Leave Share"),onClick:this.leaveShare})})]})}}]),n}(a.Component),ze=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).leaveShare=function(e){var t=e.id,n=e.repo_name;C.I.deleteOCMShareReceived(t).then((function(e){var r=o.state.items.filter((function(e){return e.id!=t}));o.setState({items:r}),W.Z.success((0,h.ih)("Successfully unshared {name}").replace("{name}",n))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={loading:!0,errorMsg:"",items:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.listOCMSharesReceived().then((function(t){e.setState({loading:!1,items:t.data.ocm_share_received_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)(a.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,h.ih)("Shared from other servers")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(Ae,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,leaveShare:this.leaveShare})})]})})})}}]),n}(a.Component),Be=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).getAllReceivedShares=function(){var e=C.I.server+"/ocm-via-webdav/received-shares/";C.I.req.get(e).then((function(e){o.setState({loading:!1,shareID:"",path:"",items:e.data.received_share_list})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.leaveShare=function(e){var t=e.id,n=e.name,r=C.I.server+"/ocm-via-webdav/received-shares/"+t+"/";C.I.req.delete(r).then((function(e){var r=o.state.items.filter((function(e){return e.id!=t}));o.setState({items:r}),W.Z.success((0,h.ih)("Successfully unshared {name}").replace("{name}",n))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.openFolder=function(e){o.setState({loading:!0});var t=C.I.server+"/ocm-via-webdav/received-shares/"+e.id+"/?path="+e.path;C.I.req.get(t).then((function(t){o.setState({loading:!1,shareID:e.id,path:t.data.parent_dir,items:t.data.received_share_list})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onPathClick=function(e){o.setState({loading:!0});var t=C.I.server+"/ocm-via-webdav/received-shares/"+o.state.shareID+"/?path="+e;C.I.req.get(t).then((function(e){o.setState({loading:!1,items:e.data.received_share_list,path:e.data.parent_dir})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={loading:!0,shareID:"",path:"",items:[],errorMsg:""},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.getAllReceivedShares()}},{key:"render",value:function(){return(0,m.jsx)(a.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path align-items-center",children:(0,m.jsx)(Ye,{shareID:this.state.shareID,currentPath:this.state.path,onPathClick:this.onPathClick,getAllReceivedShares:this.getAllReceivedShares})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(Ge,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,path:this.state.path,leaveShare:this.leaveShare,openFolder:this.openFolder})})]})})})}}]),n}(a.Component),Ge=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,r.Z)(this,n),t.call(this,e)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,i=t.path,s=(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No libraries have been shared with you")}),(0,m.jsx)("p",{children:(0,h.ih)("No libraries have been shared with you from other servers.")})]});if(n)return(0,m.jsx)(D.Z,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var a=(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"35%",children:(0,h.ih)("Shared By")}),(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Time")}),(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"5%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(He,{item:t,path:i,leaveShare:e.props.leaveShare,openFolder:e.props.openFolder},n)}))})]});return o.length?a:s}}]),n}(a.Component),He=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleMouseOver=function(){o.setState({isOpIconShown:!0})},o.handleMouseOut=function(){o.setState({isOpIconShown:!1})},o.downloadFile=function(){var e=h.ze+"ocm-via-webdav/download-received-file/?share_id="+o.props.item.id+"&path="+o.props.item.path;window.location.href=e},o.leaveShare=function(e){e.preventDefault(),o.props.leaveShare(o.props.item)},o.openFolder=function(e){e.preventDefault(),o.props.openFolder(o.props.item)},o.state={isOpIconShown:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.item,t=this.state.isOpIconShown;return e.is_dir?e.icon_url=f.c.getFolderIconUrl():e.icon_url=f.c.getFileIconUrl(e.name),(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:e.icon_url,width:"24",alt:""})}),(0,m.jsx)("td",{children:e.is_dir?(0,m.jsx)("a",{href:"#",onClick:this.openFolder,children:e.name}):e.name}),(0,m.jsx)("td",{children:e.shared_by}),(0,m.jsx)("td",{title:S()(e.last_modified).format("llll"),children:S()(e.ctime).fromNow()}),(0,m.jsx)("td",{children:e.is_dir?"":(0,m.jsx)("a",{href:"#",className:"action-icon sf2-icon-download ".concat(t?"":"invisible"),title:(0,h.ih)("Download"),onClick:this.downloadFile})}),(0,m.jsx)("td",{children:this.props.path?"":(0,m.jsx)("a",{href:"#",className:"action-icon sf2-icon-x3 ".concat(t?"":"invisible"),title:(0,h.ih)("Leave Share"),onClick:this.leaveShare})})]})}}]),n}(a.Component),Ye=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onPathClick=function(e){var t=f.c.getEventData(e,"path");o.props.onPathClick(t)},o.turnPathToLink=function(e){var t=(e=e.slice(1,e.length-1)).split("/"),n="";return t.map((function(e,r){return r===t.length-1?(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-file-name",children:e})]},r):(0===r?n="/":n+=e+"/",(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("a",{className:"path-link","data-path":n,onClick:o.onPathClick,children:e})]},r))}))},o.state={},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.turnPathToLink(this.props.currentPath);return(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)("a",{href:"#",onClick:this.props.getAllReceivedShares,children:(0,h.ih)("All")}),e]})}}]),n}(a.Component),Ve=Be,We=n(35662),Ke=n(93190),qe=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)("div",{className:"main-panel-north ".concat(this.props.children?"border-left-show":""),children:[(0,m.jsxs)("div",{className:"cur-view-toolbar",children:[(0,m.jsx)("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:"Side Nav Menu"}),(0,m.jsx)("div",{className:"operation",children:this.props.children})]}),(0,m.jsx)("div",{className:"common-toolbar",children:(0,m.jsx)(Ke.Z,{isAdminPanel:!1})})]})}}]),n}(a.Component),$e=qe,Xe=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onPathClick=function(t){var n=f.c.getEventData(t,"path");e.props.onPathClick(n)},e.turnPathToLink=function(t){var n=(t="/"===t[t.length-1]?t.slice(0,t.length-1):t).split("/"),r="";return n.map((function(t,o){return""===t?null:o===n.length-1?(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-file-name",children:t})]},o):(r+="/"+t,(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("a",{className:"path-link","data-path":r,onClick:e.onPathClick,children:t})]},o))}))},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentPath,r=t.repoName,o=this.turnPathToLink(n);return(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)(c.rU,{to:h.ze+"shared-with-ocm/",className:"normal",onClick:function(t){return e.props.onTabNavClick("shared-with-ocm")},children:(0,h.ih)("All")}),(0,m.jsx)("span",{className:"path-split",children:"/"}),"/"===n||""===n?(0,m.jsx)("span",{className:"path-repo-name",children:r}):(0,m.jsx)("a",{className:"path-link","data-path":"/",onClick:this.onPathClick,children:r}),o]})}}]),n}(a.Component),Je=Xe,Qe=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleMouseOver=function(){o.setState({isOpIconShown:!0})},o.handleMouseOut=function(){o.setState({isOpIconShown:!1})},o.openFolder=function(){o.props.openFolder(o.props.dirent)},o.downloadDirent=function(e){e.preventDefault(),o.props.downloadDirent(o.props.dirent)},o.state={isOpIconShown:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state.isOpIconShown,t=this.props.dirent,n=f.c.getDirentIcon(t);return(0,m.jsx)(a.Fragment,{children:(0,m.jsxs)("tr",{onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:n,width:"24",alt:""})}),(0,m.jsx)("td",{children:t.is_file?t.name:(0,m.jsx)(c.rU,{to:"#",onClick:this.openFolder,children:t.name})}),(0,m.jsx)("td",{children:e&&t.is_file&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font sf3-font-download1",title:(0,h.ih)("Download"),onClick:this.downloadDirent})}),(0,m.jsx)("td",{children:f.c.bytesToSize(t.size)}),(0,m.jsx)("td",{children:S()(t.mtime).fromNow()})]})})}}]),n}(a.Component),et=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,r.Z)(this,n),t.call(this,e)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.direntList;return n?(0,m.jsx)(D.Z,{}):r?(0,m.jsx)("p",{className:"error text-center mt-4",children:r}):(0,m.jsx)(a.Fragment,{children:(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"55%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"10%"}),(0,m.jsx)("th",{width:"15%",children:(0,h.ih)("Size")}),(0,m.jsx)("th",{width:"15%",children:(0,h.ih)("Last Update")})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(Qe,{dirent:t,openFolder:e.props.openFolder,deleteDirent:e.props.deleteDirent,downloadDirent:e.props.downloadDirent},n)}))})]})})}}]),n}(a.Component),tt=function(){function e(t){(0,r.Z)(this,e),this.name=t.name,this.mtime=t.mtime,this.size=t.size,this.is_file="file"===t.type}return(0,o.Z)(e,[{key:"isDir",value:function(){return!this.is_file}}]),e}(),nt=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onPathClick=function(e){o.loadDirentList(e)},o.openFolder=function(e){var t=f.c.joinPath(o.state.path,e.name);e.is_file||o.loadDirentList(t)},o.loadDirentList=function(e){var t=o.props,n=t.providerID,r=t.repoID;C.I.listOCMRepoDir(n,r,e).then((function(t){var i=t.data,s=i.repo_name,a=i.dirent_list,l=i.user_perm,c=[];a.forEach((function(e){var t=new tt(e);c.push(t)})),o.setState({loading:!1,repoName:s,direntList:c,path:e,userPerm:l},(function(){var t="".concat(h.ze,"remote-library/").concat(n,"/").concat(r,"/").concat(s).concat(f.c.encodePath(e));window.history.replaceState({url:t,path:e},e,t)}))})).catch((function(e){o.setState({loading:!1,errorMsg:f.c.getErrorMsg(e,!0)})}))},o.downloadDirent=function(e){var t=f.c.joinPath(o.state.path,e.name);C.I.getOCMRepoDownloadURL(o.props.providerID,o.props.repoID,t).then((function(e){location.href=e.data})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.openFileInput=function(){o.fileInput.current.click()},o.onFileInputChange=function(){if(o.fileInput.current.files.length){var e=o.fileInput.current.files[0],t=o.state.path,n=o.props,r=n.providerID,i=n.repoID;C.I.getOCMRepoUploadURL(r,i,t).then((function(n){var r=new FormData;r.append("parent_dir",t),r.append("file",e),We.Z.post(n.data,r).then((function(e){var t=e.data[0],n=new tt({type:"file",name:t.name,size:t.size,mtime:(new Date).getTime()}),r=o.state.direntList,i=r.filter((function(e){return!e.is_file}));r.splice(i.length,0,n),o.setState({direntList:r})}))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}},o.state={loading:!0,errorMsg:"",repoName:"",path:"",direntList:[],isNewFolderDialogOpen:!1,userPerm:""},o.fileInput=a.createRef(),o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.loadDirentList("/")}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.errorMsg,r=e.repoName,o=e.direntList,i=e.path,s=e.userPerm,l=this.props.repoID;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)($e,{children:(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("input",{className:"d-none",type:"file",onChange:this.onFileInputChange,ref:this.fileInput}),"rw"===s&&(0,m.jsx)(R.Z,{className:"operation-item",onClick:this.openFileInput,children:(0,h.ih)("Upload")})]})}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path align-items-center",children:(0,m.jsx)(Je,{repoID:l,repoName:r,currentPath:i,onPathClick:this.onPathClick,onTabNavClick:this.props.onTabNavClick})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(et,{loading:t,errorMsg:n,direntList:o,openFolder:this.openFolder,deleteDirent:this.deleteDirent,downloadDirent:this.downloadDirent})})]})})]})}}]),n}(a.Component),rt=n(74073),ot=n(54105),it=n(85951),st=n(93869),at=n(32959),lt=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleRepoNameChange=function(e){e.target.value.trim()?o.setState({isSubmitBtnActive:!0}):o.setState({isSubmitBtnActive:!1}),o.setState({repoName:e.target.value})},o.handlePassword1Change=function(e){o.setState({password1:e.target.value})},o.handlePassword2Change=function(e){o.setState({password2:e.target.value})},o.handleSubmit=function(){if(o.validateInputParams()){var e=o.prepareRepoData();if("department"===o.props.libraryType)return void o.props.onCreateRepo(e,"department");o.props.onCreateRepo(e)}},o.handleKeyDown=function(e){"Enter"===e.key&&(o.handleSubmit(),e.preventDefault())},o.toggle=function(){o.props.onCreateToggle()},o.onPermissionChange=function(e){var t=e.target.value;o.setState({permission:t})},o.handleStorageInputChange=function(e){o.setState({storage_id:e.value})},o.handlelibraryTemplatesInputChange=function(e){o.setState({library_template:e.value})},o.onEncrypted=function(e){var t=e.target.checked;o.setState({encrypt:t,disabled:!t})},o.prepareRepoData=function(){var e=o.props.libraryType,t=o.state.repoName.trim(),n=o.state.encrypt?o.state.password1:"",r=o.state.permission,i=null;"mine"!==e&&"public"!==e||(i={name:t,passwd:n}),"group"===e&&(i={repo_name:t,password:n,permission:r}),"department"===e&&(i={repo_name:t,passwd:n});var s=o.state.storage_id;s&&(i.storage_id=s);var a=o.state.library_template;return a&&(i.library_template=a),i},o.state={repoName:"",disabled:!0,encrypt:!1,password1:"",password2:"",errMessage:"",permission:"rw",storage_id:h.al.length?h.al[0].id:"",library_template:h.dj.length?h.dj[0]:"",isSubmitBtnActive:!1},o.templateOptions=[],o.storageOptions=[],Array.isArray(h.dj)&&h.dj.length&&(o.templateOptions=h.dj.map((function(e){return{value:e,label:e}}))),Array.isArray(h.al)&&h.al.length&&(o.storageOptions=h.al.map((function(e){return{value:e.id,label:e.name}}))),o}return(0,o.Z)(n,[{key:"validateInputParams",value:function(){var e="",t=this.state.repoName.trim();if(!t.length)return e=(0,h.ih)("Name is required"),this.setState({errMessage:e}),!1;if(t.indexOf("/")>-1)return e=(0,h.ih)("Name should not include '/'."),this.setState({errMessage:e}),!1;if(this.state.encrypt){var n=this.state.password1.trim(),r=this.state.password2.trim();if(!n.length)return e=(0,h.ih)("Please enter password"),this.setState({errMessage:e}),!1;if(!r.length)return e=(0,h.ih)("Please enter the password again"),this.setState({errMessage:e}),!1;if(n.length<h.gl)return e=(0,h.ih)("Password is too short"),this.setState({errMessage:e}),!1;if(n!==r)return e=(0,h.ih)("Passwords don't match"),this.setState({errMessage:e}),!1}return!0}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.toggle,autoFocus:!1,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:(0,h.ih)("New Library")}),(0,m.jsxs)(M.Z,{children:[(0,m.jsxs)(rt.Z,{children:[(0,m.jsxs)(ot.Z,{children:[(0,m.jsx)(it.Z,{for:"repoName",children:(0,h.ih)("Name")}),(0,m.jsx)(L.Z,{id:"repoName",onKeyDown:this.handleKeyDown,value:this.state.repoName,onChange:this.handleRepoNameChange,autoFocus:!0})]}),h.dj.length>0&&(0,m.jsxs)(ot.Z,{children:[(0,m.jsx)(it.Z,{children:(0,h.ih)("Template")}),(0,m.jsx)(at.ME,{defaultValue:this.templateOptions[0],options:this.templateOptions,onChange:this.handlelibraryTemplatesInputChange,value:this.templateOptions.find((function(t){return t.value===e.state.library_template}))||null})]}),h.al.length>0&&(0,m.jsxs)(ot.Z,{children:[(0,m.jsx)(it.Z,{children:(0,h.ih)("Storage Backend")}),(0,m.jsx)(at.ME,{defaultValue:this.storageOptions[0],options:this.storageOptions,onChange:this.handleStorageInputChange,value:this.storageOptions.find((function(t){return t.value===e.state.storage_id}))||null})]}),"group"===this.props.libraryType&&(0,m.jsxs)(ot.Z,{children:[(0,m.jsx)(it.Z,{for:"exampleSelect",children:(0,h.ih)("Permission")}),(0,m.jsxs)(L.Z,{type:"select",name:"select",id:"exampleSelect",onChange:this.onPermissionChange,value:this.state.permission,children:[(0,m.jsx)("option",{value:"rw",children:(0,h.ih)("Read-Write")}),(0,m.jsx)("option",{value:"r",children:(0,h.ih)("Read-Only")})]})]}),h.l3&&(0,m.jsxs)("div",{children:[(0,m.jsxs)(ot.Z,{check:!0,children:[(0,m.jsx)(L.Z,{type:"checkbox",id:"encrypt",onChange:this.onEncrypted}),(0,m.jsx)(it.Z,{for:"encrypt",children:(0,h.ih)("Encrypt")})]}),!this.state.disabled&&(0,m.jsxs)(ot.Z,{children:[(0,m.jsx)(it.Z,{for:"passwd1",children:(0,h.ih)("Password")}),(0,m.jsxs)("span",{className:"tip",children:[" ",(0,h.ih)("(at least {placeholder} characters)").replace("{placeholder}",h.gl)]}),(0,m.jsx)(L.Z,{id:"passwd1",type:"password",disabled:this.state.disabled,value:this.state.password1,onChange:this.handlePassword1Change,autoComplete:"new-password"})]}),!this.state.disabled&&(0,m.jsxs)(ot.Z,{children:[(0,m.jsx)(it.Z,{for:"passwd2",children:(0,h.ih)("Password again")}),(0,m.jsx)(L.Z,{id:"passwd2",type:"password",disabled:this.state.disabled,value:this.state.password2,onChange:this.handlePassword2Change,autoComplete:"new-password"})]})]})]}),this.state.errMessage&&(0,m.jsx)(st.Z,{color:"danger",children:this.state.errMessage})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggle,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),ct=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onCreateRepo=function(e){o.props.onCreateRepo(e),o.onCreateToggle()},o.onCreateToggle=function(){o.setState({isCreateRepoDialogOpen:!o.state.isCreateRepoDialogOpen})},o.toggleMore=function(){o.setState({isOpen:!o.state.isOpen})},o.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.toggleMore()},o.visitDeletedviaKey=function(e){"Enter"!=e.key&&"Space"!=e.key||(0,c.c4)("".concat(h.ze,"my-libs/deleted/"))},o.state={isCreateRepoDialogOpen:!1,isOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.moreShown,t=void 0!==e&&e;return(0,m.jsxs)(a.Fragment,{children:[f.c.isDesktop()?(0,m.jsxs)("div",{className:"operation",children:[(0,m.jsxs)("button",{className:"btn btn-secondary operation-item",title:(0,h.ih)("New Library"),onClick:this.onCreateToggle,children:[(0,m.jsx)("i",{className:"sf3-font sf3-font-enlarge text-secondary mr-1"}),(0,h.ih)("New Library")]}),t&&(0,m.jsxs)(H.Z,{isOpen:this.state.isOpen,toggle:this.toggleMore,children:[(0,m.jsx)(Y.Z,{className:"btn btn-secondary operation-item",onKeyDown:this.onDropdownToggleKeyDown,children:(0,h.ih)("More")}),(0,m.jsx)(Me.Z,{children:(0,m.jsx)(V.Z,{className:"link-dropdown-container",onKeyDown:this.visitDeletedviaKey,children:(0,m.jsx)(c.rU,{className:"link-dropdown-item",to:h.ze+"my-libs/deleted/",children:(0,h.ih)("Deleted Libraries")})})})]})]}):(0,m.jsx)("span",{className:"sf2-icon-plus mobile-toolbar-icon",title:(0,h.ih)("New Library"),onClick:this.onCreateToggle}),this.state.isCreateRepoDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(lt,{libraryType:"mine",onCreateRepo:this.onCreateRepo,onCreateToggle:this.onCreateToggle})})]})}}]),n}(a.Component),dt=n(56529),ut=n(15890),pt=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).submit=function(){var e=o.state.keepDays;o.state.autoHistory&&(e=o.state.expireDays);var t=o.props.repoID;if(/^-?\d+$/.test(e)){var n=(0,h.ih)("Successfully set library history.");C.I.setRepoHistoryLimit(t,e).then((function(e){W.Z.success(n),o.setState({keepDays:e.data.keep_days}),o.props.toggleDialog()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}else o.setState({errorInfo:(0,h.ih)("Please enter a non-negative integer")})},o.handleKeyDown=function(e){"Enter"===e.key&&(o.submit(),e.preventDefault())},o.onChange=function(e){var t=e.target.value;o.setState({keepDays:t,expireDays:t})},o.setLimitDays=function(e){"allHistory"===e?o.setState({keepDays:-1,disabled:!0}):"noHistory"===e?o.setState({keepDays:0,disabled:!0}):o.setState({disabled:!1}),o.setState({allHistory:"allHistory"===e,noHistory:"noHistory"===e,autoHistory:"autoHistory"===e})},o.state={keepDays:-1,expireDays:30,disabled:!0,allHistory:!0,noHistory:!1,autoHistory:!1,errorInfo:""},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.getRepoHistoryLimit(this.props.repoID).then((function(t){e.setState({keepDays:t.data.keep_days,allHistory:t.data.keep_days<0,noHistory:0===t.data.keep_days,autoHistory:t.data.keep_days>0,disabled:!(t.data.keep_days>0),expireDays:t.data.keep_days>0?t.data.keep_days:30})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}},{key:"render",value:function(){var e=this,t=this.props.itemName,n=(0,h.ih)("{placeholder} History Setting");return n=n.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.c.HTMLescape(t)+"</span>"),(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.Z,{toggle:this.props.toggleDialog,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:n},className:"d-flex mw-100"})}),(0,m.jsx)(M.Z,{children:(0,m.jsxs)(rt.Z,{children:[!h.Qo&&(0,m.jsx)(ot.Z,{children:(0,m.jsx)(it.Z,{className:"error",children:(0,h.ih)("Setting library history is disabled by Admin.")})}),(0,m.jsxs)(ot.Z,{check:!0,children:[(0,m.jsx)(L.Z,{type:"radio",name:"radio1",checked:this.state.allHistory,disabled:!h.Qo,onChange:function(){e.setLimitDays("allHistory")}})," ",(0,m.jsx)(it.Z,{children:(0,h.ih)("Keep full history")})]}),(0,m.jsxs)(ot.Z,{check:!0,children:[(0,m.jsx)(L.Z,{type:"radio",name:"radio1",checked:this.state.noHistory,disabled:!h.Qo,onChange:function(){e.setLimitDays("noHistory")}})," ",(0,m.jsx)(it.Z,{children:(0,h.ih)("Don't keep history")})]}),(0,m.jsxs)(ot.Z,{check:!0,children:[(0,m.jsx)(L.Z,{type:"radio",name:"radio1",checked:this.state.autoHistory,disabled:!h.Qo,onChange:function(){e.setLimitDays("autoHistory")}})," ",(0,m.jsx)(it.Z,{children:(0,h.ih)("Only keep a period of history:")}),(0,m.jsx)(L.Z,{type:"text",className:"expire-input",value:this.state.expireDays,onChange:this.onChange,disabled:this.state.disabled,onKeyDown:this.handleKeyDown})," ",(0,m.jsx)(it.Z,{children:(0,m.jsx)("span",{children:(0,h.ih)("days")})})]}),this.state.errorInfo&&(0,m.jsx)(st.Z,{color:"danger",children:this.state.errorInfo})]})}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.props.toggleDialog,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.submit,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),ht=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleOldPasswordInputChange=function(e){o.setState({oldPassword:e.target.value})},o.handleNewPasswordInputChange=function(e){o.setState({newPassword:e.target.value})},o.handleNewPasswordAgainInputChange=function(e){o.setState({newPasswordAgain:e.target.value})},o.formSubmit=function(e){var t=o.state,n=t.oldPassword,r=t.newPassword,i=t.newPasswordAgain;return n?r?r.length<h.gl?(o.setState({errorMsg:(0,h.ih)("New password is too short")}),!1):i?r!=i?(o.setState({errorMsg:(0,h.ih)("New passwords don't match")}),!1):(o.setState({submitBtnDisabled:!0}),void C.I.changeEncryptedRepoPassword(o.props.repoID,n,r).then((function(){o.props.toggleDialog(),W.Z.success((0,h.ih)("Successfully changed library password."))})).catch((function(e){var t=f.c.getErrorMsg(e);o.setState({errorMsg:t,submitBtnDisabled:!1})}))):(o.setState({errorMsg:(0,h.ih)("Please enter the new password again")}),!1):(o.setState({errorMsg:(0,h.ih)("Please enter a new password")}),!1):(o.setState({errorMsg:(0,h.ih)("Please enter the old password")}),!1)},o.state={oldPassword:"",newPassword:"",newPasswordAgain:"",submitBtnDisabled:!1,errorMsg:""},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.repoName,n=e.toggleDialog,r=(0,h.ih)("Change Password of Library {placeholder}");return r=r.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.c.HTMLescape(t)+"</span>"),(0,m.jsxs)(p.Z,{isOpen:!0,style:{height:"auto"},toggle:n,children:[(0,m.jsx)(I.Z,{toggle:n,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:r},className:"d-flex mw-100"})}),(0,m.jsx)(M.Z,{children:(0,m.jsxs)("form",{id:"repo-change-passwd-form",action:"",method:"post",children:[(0,m.jsx)("label",{htmlFor:"passwd",children:(0,h.ih)("Old Password")}),(0,m.jsx)("br",{}),(0,m.jsx)("input",{type:"password",name:"old_passwd",className:"form-control",id:"passwd",value:this.state.oldPassword,onChange:this.handleOldPasswordInputChange}),(0,m.jsx)("br",{}),(0,m.jsx)("label",{htmlFor:"new-passwd",children:(0,h.ih)("New Password")}),(0,m.jsx)("span",{className:"tip",children:(0,h.ih)("(at least {placeholder} characters)").replace("{placeholder}",h.gl)}),(0,m.jsx)("br",{}),(0,m.jsx)("input",{type:"password",name:"new_passwd",className:"form-control",id:"new-passwd",value:this.state.newPassword,onChange:this.handleNewPasswordInputChange}),(0,m.jsx)("br",{}),(0,m.jsx)("label",{htmlFor:"new-passwd-again",children:(0,h.ih)("New Password Again")}),(0,m.jsx)("br",{}),(0,m.jsx)("input",{type:"password",name:"new_passwd_again",className:"form-control",id:"new-passwd-again",value:this.state.newPasswordAgain,onChange:this.handleNewPasswordAgainInputChange}),(0,m.jsx)("br",{}),this.state.errorMsg&&(0,m.jsx)(st.Z,{color:"danger",children:this.state.errorMsg})]})}),(0,m.jsx)(N.Z,{children:(0,m.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:(0,h.ih)("Submit")})})]})}}]),n}(a.Component),ft=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).state={errMessage:"",showLoading:!0,showSuccess:!1,showError:!1},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.resetAndSendEncryptedRepoPassword(this.props.repoID).then((function(t){e.setState({showLoading:!1}),e.setState({showSuccess:!0})})).catch((function(t){t.response&&(e.setState({errMessage:t.response.data.error_msg}),e.setState({showLoading:!1}),e.setState({showError:!0}))}))}},{key:"render",value:function(){var e="<strong>"+h.Ru+"</strong>",t=(0,h.ih)("New password has been sent to your email {mail}. Please check your mailbox. If you don\u2019t receive the password, please check if your email address is properly configured.").replace("{mail}",e);return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.Z,{toggle:this.props.toggleDialog,children:(0,h.ih)("Reset library password")}),(0,m.jsxs)(M.Z,{children:[this.state.showLoading&&(0,m.jsx)("span",{children:(0,h.ih)("Sending new password...")}),this.state.showSuccess&&(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:t}}),this.state.showError&&(0,m.jsx)("span",{className:"err-message",children:this.state.errMessage})]})]})}}]),n}(a.Component),mt=n(58447),gt=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleInputChange=function(e){o.setState({inputValue:e})},o.formSubmit=function(){var e=o.state.inputValue;if(e&&e.length){o.setState({submitBtnDisabled:!0});var t=o.props,n=t.repoID,r=t.repoName,i=e.map((function(e,t){return e.value})).join(",");C.I.addNewRepoLabels(n,i).then((function(e){var t=(0,h.ih)("Successfully added label(s) for library {placeholder}").replace("{placeholder}",r);W.Z.success(t),o.props.toggleDialog()})).catch((function(e){var t=f.c.getErrorMsg(e);o.setState({formErrorMsg:t,submitBtnDisabled:!1})}))}else o.setState({formErrorMsg:(0,h.ih)("It is required.")})},o.state={isLoading:!0,existingLabels:null,errorMsg:"",submitBtnDisabled:!1},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.getAllRepoSnapshotLabels().then((function(t){e.setState({isLoading:!1,existingLabels:t.data,errorMsg:""})})).catch((function(t){var n=f.c.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})}))}},{key:"render",value:function(){return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.Z,{toggle:this.props.toggleDialog,children:(0,h.ih)("Label Current State")}),(0,m.jsx)(M.Z,{children:(0,m.jsx)(vt,{data:this.state,handleChange:this.handleInputChange})}),this.state.existingLabels&&(0,m.jsxs)(N.Z,{children:[(0,m.jsx)("button",{className:"btn btn-secondary",onClick:this.props.toggleDialog,children:(0,h.ih)("Cancel")}),(0,m.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),vt=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,n=e.errorMsg,r=e.existingLabels,o=e.formErrorMsg;return t?(0,m.jsx)(D.Z,{}):n?(0,m.jsx)("p",{className:"error mt-4 text-center",children:n}):(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(mt.Z,{isMulti:!0,onChange:this.props.handleChange,placeholder:"",options:r.map((function(e,t){return{label:e,value:e}}))}),o&&(0,m.jsx)("p",{className:"error m-0 mt-2",children:o})]})}}]),n}(a.Component),yt=gt,xt=n(97326),wt=n(63035),bt=n(53108),St=n(21179),Ct=n(73722),Dt=n(86500),kt=n(59743),jt=n(76578),It=n(78534),Mt=n(62150),_t=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.setState({isOperationShow:!0})},o.onMouseLeave=function(){o.setState({isOperationShow:!1})},o.deleteUserFolderPermission=function(){var e=o.props.item;o.props.deleteUserFolderPermission(e)},o.onChangeUserFolderPerm=function(e){var t=o.props.item;o.props.onChangeUserFolderPerm(t.repo_id,e,t.folder_path,t.user_email)},o.state={isOperationShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.item,t=e.permission;return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(h.ze,"profile/").concat(encodeURIComponent(e.user_email),"/"),target:"_blank",rel:"noreferrer",children:e.user_name})}),this.props.showPath&&(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(h.ze,"library/").concat(e.repo_id,"/").concat(f.c.encodePath(this.props.repoName+e.folder_path)),children:e.folder_name})}),(0,m.jsx)("td",{children:(0,m.jsx)(ne.Z,{isTextMode:!0,autoFocus:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserFolderPerm})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),onClick:this.deleteUserFolderPermission,onKeyDown:f.c.onKeyDown,title:(0,h.ih)("Delete"),"aria-label":(0,h.ih)("Delete")})})]})}}]),n}(a.Component),Nt=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleUserSelectChange=function(e){o.setState({selectedUsers:e})},o.setPermission=function(e){o.setState({permission:e})},o.addUserFolderPerm=function(){var e=o.state.selectedUsers,t=o.props.folderPath||o.state.folderPath;if(!e||!e.length||!t)return!1;var n=e.map((function(e,t){return e.email}));(o.props.isDepartmentRepo?C.I.addDepartmentRepoUserFolderPerm(o.props.repoID,o.state.permission,t,n):C.I.addUserFolderPerm(o.props.repoID,o.state.permission,t,n)).then((function(e){var t=[];if(e.data.failed.length>0)for(var n=0;n<e.data.failed.length;n++)t[n]=e.data.failed[n];o.setState({errorMsg:t,userFolderPermItems:o.state.userFolderPermItems.concat(e.data.success),selectedUsers:null,permission:"rw",folderPath:""}),o.refs.userSelect.clearSelect()})).catch((function(e){var t="";t=e.response?e.response.data&&e.response.data.error_msg?e.response.data.error_msg:(0,h.ih)("Error"):(0,h.ih)("Please check the network."),o.setState({errorMsg:[t]})}))},o.deleteUserFolderPermItem=function(e){(o.props.isDepartmentRepo?C.I.deleteDepartmentRepoUserFolderPerm(e.repo_id,e.permission,e.folder_path,e.user_email):C.I.deleteUserFolderPerm(e.repo_id,e.permission,e.folder_path,e.user_email)).then((function(t){o.setState({userFolderPermItems:o.state.userFolderPermItems.filter((function(t){return t!=e}))})}))},o.onChangeUserFolderPerm=function(e,t,n,r){(o.props.isDepartmentRepo?C.I.updateDepartmentRepoUserFolderPerm(e,t,n,r):C.I.updateUserFolderPerm(e,t,n,r)).then((function(e){var i=o.state.userFolderPermItems.map((function(e){return e.user_email===r&&e.folder_path===n&&(e.permission=t),e}));o.setState({userFolderPermItems:i})}))},o.onSetSubFolder=function(e){o.setState({folderPath:e.target.value})},o.toggleFileChooser=function(){o.setState({showFileChooser:!o.state.showFileChooser,folderPath:""})},o.toggleSubFolder=function(e,t,n){o.setState({folderPath:t})},o.handleFileChooserSubmit=function(){o.setState({folderPath:o.state.folderPath||"/",showFileChooser:!o.state.showFileChooser})},o.onRepoItemClick=function(){o.setState({folderPath:"/"})},o.state={selectedUsers:null,errorMsg:[],permission:"rw",userFolderPermItems:[],folderPath:"",showFileChooser:!1},h._y?o.permissions=["r","rw","cloud-edit","preview","invisible"]:o.permissions=["r","rw"],o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.repoID,r=t.folderPath;(t.isDepartmentRepo?C.I.listDepartmentRepoUserFolderPerm(n,r):C.I.listUserFolderPerm(n,r)).then((function(t){0!==t.data.length&&e.setState({userFolderPermItems:t.data})}))}},{key:"render",value:function(){var e=this,t=!this.props.folderPath,n=this.state.userFolderPermItems;if(this.state.showFileChooser)return(0,m.jsxs)("div",{children:[(0,m.jsx)(Mt.Z,{repoID:this.props.repoID,mode:"only_current_library",onDirentItemClick:this.toggleSubFolder,onRepoItemClick:this.onRepoItemClick}),(0,m.jsxs)("div",{className:"modal-footer",children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggleFileChooser,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.handleFileChooserSubmit,children:(0,h.ih)("Submit")})]})]});var r=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:t?"32%":"55%",children:(0,h.ih)("User")}),t&&(0,m.jsx)("th",{width:"32%",children:(0,h.ih)("Folder")}),(0,m.jsx)("th",{width:t?"24%":"30%",children:(0,h.ih)("Permission")}),(0,m.jsx)("th",{width:t?"12%":"15%"})]})});return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("table",{className:"w-xs-250",children:[r,(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)(It.Z,{ref:"userSelect",isMulti:!0,className:"reviewer-select",placeholder:(0,h.ih)("Search users"),onSelectChange:this.handleUserSelectChange,value:this.state.selectedUsers})}),t&&(0,m.jsx)("td",{children:(0,m.jsxs)(kt.Z,{children:[(0,m.jsx)(L.Z,{value:this.state.folderPath,onChange:this.onSetSubFolder}),(0,m.jsx)(jt.Z,{addonType:"append",children:(0,m.jsx)(R.Z,{className:"sf2-icon-plus",onClick:this.toggleFileChooser})})]})}),(0,m.jsx)("td",{children:(0,m.jsx)(ne.Z,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)(R.Z,{onClick:this.addUserFolderPerm,children:(0,h.ih)("Submit")})})]}),this.state.errorMsg.length>0&&this.state.errorMsg.map((function(e,t){var n="";return n=e.user_email?e.user_email+": "+e.error_msg:e,(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:3,children:(0,m.jsx)("p",{className:"error",children:n})})},t)}))]})]}),(0,m.jsx)("div",{className:"share-list-container",children:(0,m.jsxs)("table",{className:"table-thead-hidden w-xs-250",children:[r,(0,m.jsx)("tbody",{children:n.map((function(n,r){return(0,m.jsx)(_t,{item:n,permissions:e.permissions,deleteUserFolderPermission:e.deleteUserFolderPermItem,onChangeUserFolderPerm:e.onChangeUserFolderPerm,showPath:t,repoName:e.props.repoName},r)}))})]})})]})}}]),n}(a.Component),Rt=Nt,Tt=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.setState({isOperationShow:!0})},o.onMouseLeave=function(){o.setState({isOperationShow:!1})},o.deleteGroupPermissionItem=function(){var e=o.props.item;o.props.deleteGroupPermissionItem(e)},o.onChangeGroupPermission=function(e){var t=o.props.item;o.props.onChangeGroupPermission(t,e)},o.state={isOperationShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.item;return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(h.ze,"group/").concat(e.group_id,"/"),target:"_blank",rel:"noreferrer",children:e.group_name})}),this.props.showPath&&(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(h.ze,"library/").concat(e.repo_id,"/").concat(f.c.encodePath(this.props.repoName+e.folder_path)),children:e.folder_name})}),(0,m.jsx)("td",{children:(0,m.jsx)(ne.Z,{isTextMode:!0,autoFocus:!0,isEditIconShow:this.state.isOperationShow,currentPermission:e.permission,permissions:this.props.permissions,onPermissionChanged:this.onChangeGroupPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),onClick:this.deleteGroupPermissionItem,onKeyDown:f.c.onKeyDown,title:(0,h.ih)("Delete"),"aria-label":(0,h.ih)("Delete")})})]})}}]),n}(a.Component),Ot=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleSelectChange=function(e){o.setState({selectedOption:e})},o.loadOptions=function(){C.I.shareableGroups().then((function(e){o.options=e.data.map((function(e,t){return{id:e.id,label:e.name,value:e.name}}))}))},o.listGroupPermissionItems=function(){var e=o.props,t=e.isDepartmentRepo,n=e.repoID,r=e.folderPath;(t?C.I.listDepartmentRepoGroupFolderPerm(n,r):C.I.listGroupFolderPerm(n,r)).then((function(e){0!==e.data.length&&o.setState({groupPermissionItems:e.data})}))},o.setPermission=function(e){o.setState({permission:e})},o.addGroupFolderPerm=function(){var e=o.state.selectedOption,t=o.props.folderPath||o.state.folderPath;if(!e||!t)return!1;(o.props.isDepartmentRepo?C.I.addDepartmentRepoGroupFolderPerm(o.props.repoID,o.state.permission,t,e.id):C.I.addGroupFolderPerm(o.props.repoID,o.state.permission,t,e.id)).then((function(e){var t=[];if(e.data.failed.length>0)for(var n=0;n<e.data.failed.length;n++)t[n]=e.data.failed[n];o.setState({errorMsg:t,groupPermissionItems:o.state.groupPermissionItems.concat(e.data.success),selectedOption:null,permission:"rw",folderPath:""})})).catch((function(e){var t="";t=e.response?e.response.data&&e.response.data.error_msg?e.response.data.error_msg:(0,h.ih)("Error"):(0,h.ih)("Please check the network."),o.setState({errorMsg:[t]})}))},o.deleteGroupPermissionItem=function(e){(o.props.isDepartmentRepo?C.I.deleteDepartmentRepoGroupFolderPerm(e.repo_id,e.permission,e.folder_path,e.group_id):C.I.deleteGroupFolderPerm(e.repo_id,e.permission,e.folder_path,e.group_id)).then((function(){o.setState({groupPermissionItems:o.state.groupPermissionItems.filter((function(t){return t!=e}))})}))},o.onChangeGroupPermission=function(e,t){(o.props.isDepartmentRepo?C.I.updateDepartmentRepoGroupFolderPerm(e.repo_id,t,e.folder_path,e.group_id):C.I.updateGroupFolderPerm(e.repo_id,t,e.folder_path,e.group_id)).then((function(){o.updateGroupPermission(e,t)}))},o.updateGroupPermission=function(e,t){var n=e.group_id,r=o.state.groupPermissionItems.map((function(r){var o=r.group_id;return n===o&&e.folder_path===r.folder_path&&(r.permission=t),r}));o.setState({groupPermissionItems:r})},o.onSetSubFolder=function(e){o.setState({folderPath:e.target.value})},o.toggleFileChooser=function(){o.setState({showFileChooser:!o.state.showFileChooser,folderPath:""})},o.toggleSubFolder=function(e,t,n){o.setState({folderPath:t})},o.handleSubmit=function(){o.setState({folderPath:o.state.folderPath||"/",showFileChooser:!o.state.showFileChooser})},o.onRepoItemClick=function(){o.setState({folderPath:"/"})},o.state={selectedOption:null,errorMsg:[],permission:"rw",groupPermissionItems:[],folderPath:"",showFileChooser:!1},o.options=[],h._y?o.permissions=["r","rw","cloud-edit","preview","invisible"]:o.permissions=["r","rw"],o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.loadOptions(),this.listGroupPermissionItems()}},{key:"render",value:function(){var e=this,t=!this.props.folderPath;if(this.state.showFileChooser)return(0,m.jsxs)("div",{children:[(0,m.jsx)(Mt.Z,{repoID:this.props.repoID,mode:"only_current_library",onDirentItemClick:this.toggleSubFolder,onRepoItemClick:this.onRepoItemClick}),(0,m.jsxs)("div",{className:"modal-footer",children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggleFileChooser,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.handleSubmit,children:(0,h.ih)("Submit")})]})]});var n=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:t?"32%":"55%",children:(0,h.ih)("Group")}),t&&(0,m.jsx)("th",{width:"32%",children:(0,h.ih)("Folder")}),(0,m.jsx)("th",{width:t?"24%":"30%",children:(0,h.ih)("Permission")}),(0,m.jsx)("th",{width:t?"12%":"15%"})]})});return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("table",{className:"w-xs-250",children:[n,(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)(at.ME,{onChange:this.handleSelectChange,options:this.options,placeholder:(0,h.ih)("Select a group"),maxMenuHeight:200,value:this.state.selectedOption,components:{NoOptionsMessage:at.in}})}),t&&(0,m.jsx)("td",{children:(0,m.jsxs)(kt.Z,{children:[(0,m.jsx)(L.Z,{value:this.state.folderPath,onChange:this.onSetSubFolder}),(0,m.jsx)(jt.Z,{addonType:"append",children:(0,m.jsx)(R.Z,{className:"sf2-icon-plus",onClick:this.toggleFileChooser})})]})}),(0,m.jsx)("td",{children:(0,m.jsx)(ne.Z,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)(R.Z,{onClick:this.addGroupFolderPerm,children:(0,h.ih)("Submit")})})]}),this.state.errorMsg.length>0&&this.state.errorMsg.map((function(e,t){var n=e.group_id+": "+e.error_msg;return(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:3,children:(0,m.jsx)("p",{className:"error",children:n})})},t)}))]})]}),(0,m.jsx)("div",{className:"share-list-container",children:(0,m.jsxs)("table",{className:"table-thead-hidden w-xs-250",children:[n,(0,m.jsx)("tbody",{children:this.state.groupPermissionItems.map((function(n,r){return(0,m.jsx)(Tt,{item:n,permissions:e.permissions,deleteGroupPermissionItem:e.deleteGroupPermissionItem,onChangeGroupPermission:e.onChangeGroupPermission,showPath:t,repoName:e.props.repoName},r)}))})]})})]})}}]),n}(a.Component),Et=Ot,Pt=(n(62990),function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggle=function(e){o.state.activeTab!==e&&o.setState({activeTab:e})},o.renderContent=function(){var e=o.state.activeTab;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("div",{className:"share-dialog-side",children:(0,m.jsxs)(wt.Z,{pills:!0,children:[(0,m.jsx)(bt.Z,{role:"tab","aria-selected":"userPermission"===e,"aria-controls":"user-perm-panel",children:(0,m.jsx)(St.Z,{className:"userPermission"===e?"active":"",onClick:o.toggle.bind((0,xt.Z)(o),"userPermission"),tabIndex:"0",onKeyDown:f.c.onKeyDown,children:(0,h.ih)("User Permission")})}),(0,m.jsx)(bt.Z,{role:"tab","aria-selected":"groupPermission"===e,"aria-controls":"group-perm-panel",children:(0,m.jsx)(St.Z,{className:"groupPermission"===e?"active":"",onClick:o.toggle.bind((0,xt.Z)(o),"groupPermission"),tabIndex:"0",onKeyDown:f.c.onKeyDown,children:(0,h.ih)("Group Permission")})})]})}),(0,m.jsx)("div",{className:"share-dialog-main",children:(0,m.jsxs)(Ct.Z,{activeTab:o.state.activeTab,children:[(0,m.jsx)(Dt.Z,{tabId:"userPermission",role:"tabpanel",id:"user-perm-panel",children:(0,m.jsx)(Rt,{repoID:o.props.repoID,repoName:o.props.repoName,folderPath:o.props.folderPath,isDepartmentRepo:o.props.isDepartmentRepo})}),(0,m.jsx)(Dt.Z,{tabId:"groupPermission",role:"tabpanel",id:"group-perm-panel",children:(0,m.jsx)(Et,{repoID:o.props.repoID,repoName:o.props.repoName,folderPath:o.props.folderPath,isDepartmentRepo:o.props.isDepartmentRepo})})]})})]})},o.state={activeTab:"userPermission"},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.repoName,n=e.folderName,r=t?(0,h.ih)("{placeholder} Folder Permission"):(0,h.ih)("Set permission of {placeholder}");return r=r.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.c.HTMLescape(t||n)+"</span>"),(0,m.jsx)("div",{children:(0,m.jsxs)(p.Z,{isOpen:!0,style:{maxWidth:"980px"},className:"share-dialog",toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.Z,{toggle:this.props.toggleDialog,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:r},className:"d-flex mw-100"})}),(0,m.jsx)(M.Z,{className:"dialog-list-container share-dialog-content",role:"tablist",children:this.renderContent()})]})})}}]),n}(a.Component)),Zt=n(18718),Ft=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMenuItemClick=function(e){var t=f.c.getEventData(e,"toggle");o.props.onMenuItemClick(t)},o.onMenuItemKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.onMenuItemClick(e)},o.onDropdownToggleClick=function(e){o.toggleOperationMenu(e)},o.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.onDropdownToggleClick(e)},o.toggleOperationMenu=function(e){var t=e.target?e.target.dataset:null;t&&t.toggle&&"Rename"===t.toggle?o.setState({isItemMenuShow:!o.state.isItemMenuShow}):o.setState({isItemMenuShow:!o.state.isItemMenuShow},(function(){o.state.isItemMenuShow?o.props.onFreezedItem():o.props.onUnfreezedItem()}))},o.toggleAdvancedMenuShown=function(e){o.setState({isAdvancedMenuShown:!0})},o.toggleAdvancedMenu=function(e){e.stopPropagation(),o.setState({isAdvancedMenuShown:!o.state.isAdvancedMenuShown},(function(){o.toggleOperationMenu(e)}))},o.onDropDownMouseMove=function(e){o.state.isAdvancedMenuShown&&e.target&&"dropdown-item"===e.target.className&&o.setState({isAdvancedMenuShown:!1})},o.generatorOperations=function(){var e=o.props.repo,t=h._y&&e.encrypted&&h.yV&&h.aZ,n=["Rename","Transfer"];if(h.n_&&n.push("Folder Permission"),n.push("Share Admin","Divider"),e.encrypted&&n.push("Change Password"),t&&n.push("Reset Password"),h._y){var r=e.monitored?"Unwatch File Changes":"Watch File Changes";n.push(r)}n.push("Divider","History Setting","Advanced");for(var i=0;i<n.length;i++)"Divider"===n[i]&&"Divider"===n[i+1]&&(n.splice(i,1),i--);return n},o.getAdvancedOperations=function(){var e=[];return e.push("API Token"),o.props.isPC&&h.cz&&e.push("Label Current State"),h.PZ&&e.push("Old Files Auto Delete"),h.CT&&e.push("SeaTable integration"),e},o.translateOperations=function(e){var t="";switch(e){case"Star":t=(0,h.ih)("Star");break;case"Unstar":t=(0,h.ih)("Unstar");break;case"Share":t=(0,h.ih)("Share");break;case"Delete":t=(0,h.ih)("Delete");break;case"Rename":t=(0,h.ih)("Rename");break;case"Transfer":t=(0,h.ih)("Transfer");break;case"History Setting":t=(0,h.ih)("History Setting");break;case"Change Password":t=(0,h.ih)("Change Password");break;case"Reset Password":t=(0,h.ih)("Reset Password");break;case"Watch File Changes":t=(0,h.ih)("Watch File Changes");break;case"Unwatch File Changes":t=(0,h.ih)("Unwatch File Changes");break;case"Folder Permission":t=(0,h.ih)("Folder Permission");break;case"Label Current State":t=(0,h.ih)("Label Current State");break;case"API Token":t="API Token";break;case"Share Admin":t=(0,h.ih)("Share Admin");break;case"Old Files Auto Delete":t=(0,h.ih)("Auto Deletion Setting");break;case"Advanced":t=(0,h.ih)("Advanced");break;case"SeaTable integration":t=(0,h.ih)("SeaTable integration")}return t},o.state={isItemMenuShow:!1,isAdvancedMenuShown:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.generatorOperations(),n=this.getAdvancedOperations();return this.props.isPC?(0,m.jsxs)(H.Z,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),onClick:this.onDropdownToggleClick,onKeyDown:this.onDropdownToggleKeyDown,"data-toggle":"dropdown"}),(0,m.jsx)(Me.Z,{onMouseMove:this.onDropDownMouseMove,children:t.map((function(t,r){return"Divider"==t?(0,m.jsx)(V.Z,{divider:!0},r):"Advanced"==t?(0,m.jsxs)(H.Z,{direction:"right",className:"w-100",isOpen:e.state.isAdvancedMenuShown,toggle:e.toggleAdvancedMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsxs)(Y.Z,{className:"dropdown-item font-weight-normal rounded-0 d-flex justify-content-between align-items-center pr-2",onMouseEnter:e.toggleAdvancedMenuShown,children:[e.translateOperations(t),(0,m.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,m.jsx)(Me.Z,{children:n.map((function(t,n){return(0,m.jsx)(V.Z,{"data-toggle":t,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:e.translateOperations(t)},n)}))})]},r):(0,m.jsx)(V.Z,{"data-toggle":t,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:e.translateOperations(t)},r)}))})]}):(t.pop(),t.unshift("Delete"),t.unshift("Share"),this.props.isStarred?t.unshift("Unstar"):t.unshift("Star"),(0,m.jsxs)(H.Z,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),(0,m.jsxs)("div",{className:"".concat(this.state.isItemMenuShow?"":"d-none"),onClick:this.toggleOperationMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:t.map((function(t,n){return"Divider"!=t?(0,m.jsx)(V.Z,{className:"mobile-menu-item","data-toggle":t,onClick:e.onMenuItemClick,children:e.translateOperations(t)},n):null}))})]})]}))}}]),n}(a.Component),Lt=Ft,At=n(17787),Ut=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onHideSelect=function(){o.setState({isEditing:!1})},o.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),o.setState({isEditing:!0})},o.onPermissionChanged=function(e){e.value!==o.props.currentPermission&&o.props.onPermissionChanged(e.value),o.setState({isEditing:!1})},o.onSelectHandler=function(e){e.nativeEvent.stopImmediatePropagation()},o.state={isEditing:!1},o.options=[{value:"rw",label:(0,m.jsx)("div",{children:(0,h.ih)("Read-Write")})},{value:"r",label:(0,m.jsx)("div",{children:(0,h.ih)("Read-Only")})}],o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onHideSelect)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onHideSelect)}},{key:"render",value:function(){var e=this.props,t=e.currentPermission,n=e.isTextMode,r="rw"===t?(0,h.ih)("Read-Write"):(0,h.ih)("Read-Only");return(0,m.jsx)("div",{onClick:this.onSelectHandler,children:n&&!this.state.isEditing?(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("span",{children:r}),this.props.isEditIconShow&&(0,m.jsx)(At.Z,{title:(0,h.ih)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",op:this.onEditPermission})]}):(0,m.jsx)(at.ME,{options:this.options,placeholder:r,onChange:this.onPermissionChanged,captureMenuScroll:!1,value:this.options.find((function(e){return e.value===t}))||null})})}}]),n}(a.Component),zt=n(92229),Bt=n.n(zt),Gt=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.setState({isOperationShow:!0})},o.onMouseLeave=function(){o.setState({isOperationShow:!1})},o.onDeleteAPIToken=function(){o.props.deleteAPIToken(o.props.item.app_name)},o.onUpdateAPIToken=function(e){o.props.updateAPIToken(o.props.item.app_name,e)},o.onCopyAPIToken=function(){var e=o.props.item.api_token;Bt()(e),W.Z.success((0,h.ih)("API token is copied to the clipboard."))},o.state={isOperationShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.item;return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,tabIndex:"0",onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"name",children:e.app_name}),(0,m.jsx)("td",{children:(0,m.jsx)(Ut,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:e.permission,onPermissionChanged:this.onUpdateAPIToken})}),(0,m.jsxs)("td",{children:[(0,m.jsx)("span",{children:e.api_token}),this.state.isOperationShow&&(0,m.jsx)(At.Z,{className:"action-icon sf3-font sf3-font-copy1",op:this.onCopyAPIToken,title:(0,h.ih)("Copy")})]}),(0,m.jsx)("td",{children:(0,m.jsx)(At.Z,{className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),op:this.onDeleteAPIToken,title:(0,h.ih)("Delete")})})]})}}]),n}(a.Component),Ht=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).listAPITokens=function(){C.I.listRepoAPITokens(o.repo.repo_id).then((function(e){o.setState({apiTokenList:e.data.repo_api_tokens,loading:!1})})).catch((function(e){403===e.response.status?o.setState({errorMsg:(0,h.ih)("Permission denied")}):o.handleError(e)}))},o.onInputChange=function(e){var t=e.target.value;o.setState({appName:t})},o.onKeyDown=function(e){13===e.keyCode&&(e.preventDefault(),o.addAPIToken())},o.setPermission=function(e){o.setState({permission:e})},o.addAPIToken=function(){if(o.state.appName){o.setState({isSubmitBtnActive:!1});var e=o.state,t=e.appName,n=e.permission,r=e.apiTokenList;C.I.addRepoAPIToken(o.repo.repo_id,t,n).then((function(e){r.push(e.data),o.setState({apiTokenList:r,isSubmitBtnActive:!0})})).catch((function(e){o.handleError(e),o.setState({isSubmitBtnActive:!0})}))}},o.deleteAPIToken=function(e){C.I.deleteRepoAPIToken(o.repo.repo_id,e).then((function(t){var n=o.state.apiTokenList.filter((function(t){return t.app_name!==e}));o.setState({apiTokenList:n})})).catch((function(e){o.handleError(e)}))},o.updateAPIToken=function(e,t){C.I.updateRepoAPIToken(o.repo.repo_id,e,t).then((function(n){var r=o.state.apiTokenList.filter((function(n){return n.app_name===e&&(n.permission=t),n}));o.setState({apiTokenList:r})})).catch((function(e){o.handleError(e)}))},o.handleError=function(e){e.response?W.Z.danger(e.response.data.error_msg||e.response.data.detail||(0,h.ih)("Error"),{duration:3}):W.Z.danger((0,h.ih)("Please check the network."),{duration:3})},o.renderContent=function(){var e=o.state.apiTokenList.map((function(e,t){return(0,m.jsx)(Gt,{item:e,deleteAPIToken:o.deleteAPIToken,updateAPIToken:o.updateAPIToken},t)})),t=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("App Name")}),(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Permission")}),(0,m.jsx)("th",{width:"48%",children:"API Token"}),(0,m.jsx)("th",{width:"12%"})]})});return(0,m.jsxs)(a.Fragment,{children:[o.state.errorMsg&&(0,m.jsx)("p",{className:"error text-center",children:o.state.errorMsg}),!o.state.errorMsg&&(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("table",{className:"w-xs-250",children:[t,(0,m.jsx)("tbody",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)(L.Z,{type:"text",id:"appName",value:o.state.appName,onChange:o.onInputChange,onKeyDown:o.onKeyDown})}),(0,m.jsx)("td",{children:(0,m.jsx)(Ut,{isTextMode:!1,isEditIconShow:!1,currentPermission:o.state.permission,onPermissionChanged:o.setPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{className:"text-secondary",children:"--"})}),(0,m.jsx)("td",{children:(0,m.jsx)(R.Z,{onClick:o.addAPIToken,disabled:!o.state.isSubmitBtnActive,children:(0,h.ih)("Submit")})})]})})]}),(0,m.jsx)("div",{style:{minHeight:"10rem",maxHeight:"18rem"},children:0!==o.state.apiTokenList.length&&(0,m.jsxs)("table",{className:"table-thead-hidden w-xs-250",children:[t,(0,m.jsx)("tbody",{children:e})]})}),o.state.loading&&(0,m.jsx)(D.Z,{})]})]})},o.state={apiTokenList:[],permission:"rw",appName:"",errorMsg:"",loading:!0,isSubmitBtnActive:!0},o.repo=o.props.repo,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.listAPITokens()}},{key:"render",value:function(){var e=this.repo,t='<span class="op-target text-truncate mr-1">'+f.c.HTMLescape(e.repo_name)+"</span>",n=(0,h.ih)("{placeholder} API Token").replace("{placeholder}",t);return(0,m.jsxs)(p.Z,{isOpen:!0,style:{maxWidth:"800px"},toggle:this.props.onRepoAPITokenToggle,children:[(0,m.jsx)(I.Z,{toggle:this.props.onRepoAPITokenToggle,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:n},className:"d-flex mw-100"})}),(0,m.jsx)(M.Z,{children:(0,m.jsx)("div",{className:"o-auto",children:this.renderContent()})})]})}}]),n}(a.Component),Yt=n(74165),Vt=n(15861),Wt=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.accountName,n=e.closeDialog;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:n,children:[(0,m.jsx)(I.Z,{toggle:n,children:(0,h.ih)("Delete SeaTable base")}),(0,m.jsx)(M.Z,{children:(0,m.jsx)("p",{className:"pb-6",children:(0,h.ih)("Are you sure you want to delete SeaTable {accountName}?").replace("{accountName}",t)})}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:n,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.props.onDeleteSeatables,children:(0,h.ih)("Delete")})]})]})}}]),n}(a.Component),Kt=Wt,qt=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).openDialog=function(){o.setState({isShowDialog:!0})},o.closeDialog=function(){o.setState({isShowDialog:!1})},o.onDeleteSeatables=function(){var e=o.props.setting;o.props.deleteStableAccountSetting(e,"seatable_account_manage"),o.closeDialog()},o.state={isShowDialog:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state.isShowDialog,t=this.props,n=t.setting,r=t.t,o=t.index,i=n.base_api_token,s=n.base_name,a=n.seatable_server_url;return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{width:"30%",className:"text-truncate",title:s,"aria-label":s,children:s}),(0,m.jsx)("td",{id:"abc-".concat(o),width:"55%",className:"text-truncate",title:a,"aria-label":a,children:a}),(0,m.jsxs)("td",{width:"15%",children:[(0,m.jsx)("span",{className:"account-operation-btn",onClick:this.props.editSeatableSettingAccount.bind(this,i),title:(0,h.ih)("Edit"),"aria-label":(0,h.ih)("Edit"),children:(0,m.jsx)("i",{className:"sf2-icon-edit",style:{color:"#999"}})}),(0,m.jsx)("span",{className:"account-operation-btn",onClick:this.openDialog,title:(0,h.ih)("Delete"),"aria-label":(0,h.ih)("Delete"),children:(0,m.jsx)("i",{className:"sf3-font-delete1 sf3-font",style:{color:"#999"}})})]}),e&&(0,m.jsx)(Kt,{t:r,accountName:s,onDeleteSeatables:this.onDeleteSeatables,closeDialog:this.closeDialog})]},"account-".concat(i))}}]),n}(a.Component),$t=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).renderContent=function(){var t=e.props.seatableSettings;return Array.isArray(t)&&0!==t.length?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("table",{className:"accounts-list-header",children:(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("SeaTable base name")}),(0,m.jsx)("th",{width:"55%",children:(0,h.ih)("SeaTable server URL")}),(0,m.jsx)("th",{width:"15%",children:" "})]})})}),(0,m.jsx)("div",{className:"accounts-list-body",children:(0,m.jsx)("table",{children:(0,m.jsx)("tbody",{children:t.map((function(t,n){return(0,m.jsx)(qt,{index:n,setting:t,editSeatableSettingAccount:e.props.editSeatableSettingAccount,deleteStableAccountSetting:e.props.deleteStableAccountSetting},t.base_api_token)}))})})})]}):(0,m.jsxs)("div",{className:"no-accounts d-flex flex-column align-items-center justify-content-center",children:[(0,m.jsx)("img",{src:"".concat(h.si,"img/no-items-tip.png"),alt:(0,h.ih)("No SeaTable bases")}),(0,m.jsx)("p",{children:(0,h.ih)("No SeaTable bases")})]})},e}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)("div",{className:"accounts-manage",children:[(0,m.jsxs)("div",{className:"accounts-manage-header d-flex align-items-center justify-content-between",children:[(0,m.jsx)("span",{children:"SeaTable"}),(0,m.jsx)(R.Z,{color:"primary",size:"sm",outline:!0,onClick:this.props.changeStatus,children:(0,h.ih)("Add")})]}),(0,m.jsx)("div",{className:"accounts-list mt-2",children:this.renderContent()})]})}}]),n}(a.Component),Xt=$t,Jt=n(25965),Qt=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).onChangeBaseName=function(e){var t=e.target.value;t!==o.state.base_name&&o.setState({base_name:t,errMessage:""})},o.onChangeSeatableUrl=function(e){var t=e.target.value;t!==o.state.seatable_url&&o.setState({seatable_url:t,successMessage:null,stage:"toCheck",errMessage:""})},o.onChangeSeatableApiToken=function(e){var t=e.target.value;t!==o.state.seatable_api_token&&o.setState({seatable_api_token:t,successMessage:null,stage:"toCheck",errMessage:""})},o.addSeatableAccountSetting=function(){var e=o.state,t=e.base_name,n=e.seatable_url,r=e.seatable_api_token;t=t.trim(),n=n.trim(),r=r.trim();var i="";if(t?n?r||(i=(0,h.ih)("SeaTable API token is required")):i=(0,h.ih)("SeaTable server URL is required"):i=(0,h.ih)("SeaTable base name is required"),o.setState({errMessage:i}),!i){var s={base_name:t,seatable_url:n,seatable_api_token:r};o.props.onSubmit(s,"seatable_account_manage")}},o.testSeatableAPIToken=(0,Vt.Z)((0,Yt.Z)().mark((function e(){var t,n,r,i,s,a,l;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.state,n=t.seatable_url,r=t.seatable_api_token,C.I.req.defaults.headers.Authorization="Token ".concat(r),e.next=4,C.I.req.get("".concat(n,"api/v2.1/dtable/app-access-token/")).then((function(e){return[e,null]})).catch((function(e){return[null,e]}));case 4:i=e.sent,s=(0,ge.Z)(i,2),a=s[0],l=s[1],a&&o.setState({successMessage:a.data,stage:"toSubmit"}),l&&o.setState({errMessage:(0,h.ih)("URL or SeaTable API token is invalid")});case 10:case"end":return e.stop()}}),e)}))),o.togglePasswordShow=function(){"password"===o.state.passwordType?o.setState({passwordType:"text"}):o.setState({passwordType:"password"})};var i=e.currentDtableInfo;return o.state={errMessage:"",base_name:(null===i||void 0===i?void 0:i.base_name)||"",seatable_url:(null===i||void 0===i?void 0:i.seatable_url)||"",seatable_api_token:(null===i||void 0===i?void 0:i.base_api_token)||"",successMessage:null,stage:"toCheck",passwordType:"password"},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state,t=e.errMessage,n=e.stage,r=e.successMessage,o=e.base_name,i=e.seatable_url,s=e.seatable_api_token,a=e.passwordType;return(0,m.jsxs)("div",{className:"add-account",children:[(0,m.jsxs)("div",{className:"add-account-header d-flex align-items-center justify-content-between",children:[(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{className:"back-btn d-inline-flex align-items-center justify-content-center",onClick:this.props.changeStatus,children:(0,m.jsx)("i",{className:"link-icon icon-left sf3-font sf3-font-arrow",style:{transform:"rotate(180deg)",color:"#999"}})}),(0,m.jsx)("span",{className:"add-account-header-text",children:(0,h.ih)("Add SeaTable Integration")})]}),(0,m.jsx)("button",{onClick:"toCheck"===n?this.testSeatableAPIToken:this.addSeatableAccountSetting,type:"button",className:"btn btn-secondary add-account-btn",children:"toCheck"===n?(0,h.ih)("Check"):(0,h.ih)("Submit")})]}),(0,m.jsxs)("div",{className:"base-account",children:[(0,m.jsxs)("div",{className:"account-name-desc",children:[(0,m.jsxs)(ot.Z,{children:[(0,m.jsx)(it.Z,{children:(0,h.ih)("SeaTable base name")}),(0,m.jsx)(L.Z,{value:o,onChange:this.onChangeBaseName})]}),(0,m.jsxs)(ot.Z,{children:[(0,m.jsx)(it.Z,{children:(0,h.ih)("SeaTable server URL")}),(0,m.jsx)(L.Z,{value:i,onChange:this.onChangeSeatableUrl})]}),(0,m.jsxs)(ot.Z,{className:"base-account-password",children:[(0,m.jsx)(it.Z,{children:(0,h.ih)("SeaTable API token")}),(0,m.jsxs)(kt.Z,{children:[(0,m.jsx)(L.Z,{value:s,type:a,onChange:this.onChangeSeatableApiToken}),(0,m.jsx)(Jt.Z,{children:(0,m.jsx)("i",{className:"sf3-font sf3-font-eye".concat("password"===a?"-slash":""," cursor-pointer"),onClick:this.togglePasswordShow})})]})]})]}),t&&(0,m.jsx)(st.Z,{color:"danger",children:t}),r&&(0,m.jsxs)(st.Z,{color:"success",children:[(0,m.jsx)("span",{className:"dtable-font dtable-icon-check-circle mr-2"}),(0,h.ih)("Successfully connected to SeaTable")]})]})]})}}]),n}(a.Component),en="seatable_account_manage",tn="add_seatable_account",nn="update_seatable_account",rn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).getSeatableSettings=function(){var e=(0,Vt.Z)((0,Yt.Z)().mark((function e(t){var n,r,i,s;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.I.req.defaults.headers.Authorization=null,e.next=3,C.I.getFileDownloadLink(o.repo.repo_id,h.oM).then((function(e){return[e,null]})).catch((function(e){return[null,e]}));case 3:if(n=e.sent,r=(0,ge.Z)(n,1),!(i=r[0])||!i.data){e.next=11;break}return e.next=9,C.I.getFileContent(i.data);case 9:null!==(s=e.sent)&&void 0!==s&&s.data&&s.data&&(o.setState({seatableSettings:s.data}),t&&o.setState({status:t}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o.changeTab=function(e){o.state.activeTab!==e&&o.setState({activeTab:e})},o.changeStatus=function(e){o.setState({status:e})},o.getFile=function(e,t){var n=e.base_name,r=e.seatable_url,o=e.seatable_api_token,i=[{base_name:n,seatable_server_url:r,base_api_token:o}];if(t&&0!==t.length){var s=null===t||void 0===t?void 0:t.findIndex((function(e){return e.base_api_token===o}));-1!==s?t[s]=i[0]:t.push(i[0]),i=t}var a=h.oM.split("/")[2],l=JSON.stringify(i);return new File([l],a)},o.editSeatableSettingAccount=function(e){var t=o.state.seatableSettings;o.setState({status:nn,currentDtableInfo:t.find((function(t){return t.base_api_token===e}))})},o.deleteStableAccountSetting=function(){var e=(0,Vt.Z)((0,Yt.Z)().mark((function e(t,n){var r,i,s,a,l,c,d,u,p,f,m;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.base_api_token,C.I.req.defaults.headers.Authorization=null,e.next=4,C.I.getFileDownloadLink(o.repo.repo_id,h.oM).then((function(e){return[e,null]})).catch((function(e){return[null,e]}));case 4:if(i=e.sent,s=(0,ge.Z)(i,1),!(a=s[0])||!a.data){e.next=25;break}return e.next=10,C.I.getFileContent(a.data);case 10:if(null===(l=e.sent)||void 0===l||!l.data){e.next=25;break}if(c=l.data,-1===(d=null===c||void 0===c?void 0:c.findIndex((function(e){return e.base_api_token===r})))){e.next=25;break}return c.splice(d,1),u=JSON.stringify(c),p=h.oM.split("/")[2],f=new File([u],p),e.next=21,C.I.getUpdateLink(o.repo.repo_id,h.oM.slice(0,10));case 21:return m=e.sent,e.next=24,C.I.updateFile(m.data,h.oM,p,f).catch((function(e){W.Z.danger((0,h.ih)(e.message))}));case 24:o.getSeatableSettings(n);case 25:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),o.onSubmit=function(){var e=(0,Vt.Z)((0,Yt.Z)().mark((function e(t,n){var r,i,s,a,l,c,d,u,p,f,m;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.I.req.defaults.headers.Authorization=null,e.next=3,C.I.getFileDownloadLink(o.repo.repo_id,h.oM).then((function(e){return[e,null]})).catch((function(e){return[null,e]}));case 3:if(r=e.sent,i=(0,ge.Z)(r,2),s=i[0],a=i[1],!s||!s.data){e.next=20;break}return e.next=10,C.I.getFileContent(s.data);case 10:if(null===(l=e.sent)||void 0===l||!l.data){e.next=20;break}return c=o.getFile(t,l.data),e.next=15,C.I.getUpdateLink(o.repo.repo_id,h.oM.slice(0,10));case 15:return d=e.sent,u=h.oM.split("/")[2],e.next=19,C.I.updateFile(d.data,h.oM,u,c).catch((function(e){W.Z.danger((0,h.ih)(e.message))}));case 19:o.getSeatableSettings(n);case 20:if(!a){e.next=32;break}return e.next=23,C.I.getFileServerUploadLink(o.repo.repo_id,h.Z6);case 23:return p=e.sent,f=o.getFile(t),(m=new FormData).append("file",f),m.append("relative_path",h.oM.split("/")[1]),m.append("parent_dir",h.Z6),e.next=31,C.I.uploadImage(p.data+"?ret-json=1",m).catch((function(e){W.Z.danger((0,h.ih)(e.message))}));case 31:o.getSeatableSettings(n);case 32:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),o.state={activeTab:"SeaTable",seatableSettings:[],baseApiToken:"",isPasswordVisible:!1,isShowDialog:!1,currentDtableInfo:{},status:en},o.repo=o.props.repo,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.getSeatableSettings()}},{key:"render",value:function(){var e=this,t=this.state,n=t.seatableSettings,r=t.status,o=t.currentDtableInfo,i=this.props.onSeaTableIntegrationToggle,s=this.repo,a='<span class="op-target">'+f.c.HTMLescape(s.repo_name)+"</span>",l=(0,h.ih)("{placeholder} SeaTable integration").replace("{placeholder}",a);return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:i,className:"account-dialog",children:[(0,m.jsx)(I.Z,{toggle:i,children:(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:l},className:"m-0"})}),(0,m.jsx)(M.Z,{className:"account-dialog-content",children:(0,m.jsxs)("div",{className:"account-dialog-main",children:[r===en&&(0,m.jsx)(Xt,{seatableSettings:n,changeStatus:function(){return e.changeStatus(tn)},editSeatableSettingAccount:this.editSeatableSettingAccount,deleteStableAccountSetting:this.deleteStableAccountSetting}),r===tn&&(0,m.jsx)(Qt,{changeStatus:function(){return e.changeStatus(en)},onSubmit:this.onSubmit}),r===nn&&(0,m.jsx)(Qt,{currentDtableInfo:o,changeStatus:function(){return e.changeStatus(en)},onSubmit:this.onSubmit})]})})]})}}]),n}(a.Component),on=rn,sn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.setState({isOperationShow:!0})},o.onMouseLeave=function(){o.setState({isOperationShow:!1})},o.onDeleteLink=function(e){e.preventDefault(),o.props.deleteItem(o.props.item)},o.state={isOperationShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e,t=this.props.item,n="/"===t.path?"/":t.path.slice(0,t.path.length-1);return e=t.is_dir?"".concat(h.ze,"library/").concat(t.repo_id,"/").concat(encodeURIComponent(t.repo_name)).concat(f.c.encodePath(n)):"".concat(h.ze,"lib/").concat(t.repo_id,"/file").concat(f.c.encodePath(t.path)),(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"name",children:t.creator_name}),(0,m.jsx)("td",{children:t.is_dir?(0,m.jsx)(c.rU,{to:e,children:t.obj_name}):(0,m.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",children:t.obj_name})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:t.link,target:"_blank",rel:"noreferrer",children:t.link})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:f.c.onKeyDown,title:(0,h.ih)("Delete"),"aria-label":(0,h.ih)("Delete")})})]})}}]),n}(a.Component),an=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).deleteItem=function(e){C.I.deleteRepoShareLink(o.props.repo.repo_id,e.token).then((function(){var t=o.state.items.filter((function(t){return t.token!==e.token}));o.setState({items:t});var n=(0,h.ih)("Successfully deleted 1 item");W.Z.success(n)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={loading:!0,errorMsg:"",items:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.listRepoShareLinks(this.props.repo.repo_id).then((function(t){e.setState({loading:!1,items:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.errorMsg,o=t.items;return(0,m.jsxs)(a.Fragment,{children:[n&&(0,m.jsx)(D.Z,{}),!n&&r&&(0,m.jsx)("p",{className:"error text-center mt-8",children:r}),!n&&!r&&!o.length&&(0,m.jsx)(j.Z,{forDialog:!0,children:(0,m.jsx)("p",{className:"text-secondary",children:(0,h.ih)("No share links")})}),!n&&!r&&o.length>0&&(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"22%",children:(0,h.ih)("Creator")}),(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"50%",children:(0,h.ih)("Link")}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(sn,{item:t,deleteItem:e.deleteItem},n)}))})]})]})}}]),n}(a.Component),ln=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.setState({isOperationShow:!0})},o.onMouseLeave=function(){o.setState({isOperationShow:!1})},o.onDeleteLink=function(e){e.preventDefault(),o.props.deleteItem(o.props.item)},o.state={isOperationShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.item,t="/"===e.path?"/":e.path.slice(0,e.path.length-1),n="".concat(h.ze,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)).concat(f.c.encodePath(t));return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"name",children:e.creator_name}),(0,m.jsx)("td",{children:(0,m.jsx)(c.rU,{to:n,children:e.obj_name})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:e.link,target:"_blank",rel:"noreferrer",children:e.link})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:f.c.onKeyDown,title:(0,h.ih)("Delete"),"aria-label":(0,h.ih)("Delete")})})]})}}]),n}(a.Component),cn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).deleteItem=function(e){C.I.deleteRepoUploadLink(o.props.repo.repo_id,e.token).then((function(){var t=o.state.items.filter((function(t){return t.token!==e.token}));o.setState({items:t});var n=(0,h.ih)("Successfully deleted 1 item");W.Z.success(n)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={loading:!0,errorMsg:"",items:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.listRepoUploadLinks(this.props.repo.repo_id).then((function(t){e.setState({loading:!1,items:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.errorMsg,o=t.items;return(0,m.jsxs)(a.Fragment,{children:[n&&(0,m.jsx)(D.Z,{}),!n&&r&&(0,m.jsx)("p",{className:"error text-center mt-8",children:r}),!n&&!r&&!o.length&&(0,m.jsx)(j.Z,{forDialog:!0,children:(0,m.jsx)("p",{className:"text-secondary",children:(0,h.ih)("No upload links")})}),!n&&!r&&o.length>0&&(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"22%",children:(0,h.ih)("Creator")}),(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"50%",children:(0,h.ih)("Link")}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(ln,{item:t,deleteItem:e.deleteItem},n)}))})]})]})}}]),n}(a.Component),dn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.setState({isOperationShow:!0})},o.onMouseLeave=function(){o.setState({isOperationShow:!1})},o.onDeleteLink=function(e){e.preventDefault(),o.props.deleteItem(o.props.item)},o.changePerm=function(e){var t=o.props.item;C.I.updateShareToUserItemPermission(t.repo_id,t.path,"user",t.share_to,e).then((function(){o.setState({permission:e})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),o.setState({isShowPermEditor:!0})},o.state={permission:o.props.item.permission,isOperationShow:!1,isShowPermEditor:!1},o.permissions=["rw","r"],h._y&&("/"===o.props.item.path&&o.props.isRepoOwner&&o.permissions.push("admin"),o.permissions.push("cloud-edit","preview")),o}return(0,o.Z)(n,[{key:"render",value:function(){var e,t=this.props.item,n="/"===t.path?"/":t.path.slice(0,t.path.length-1);return e="".concat(h.ze,"library/").concat(t.repo_id,"/").concat(encodeURIComponent(t.repo_name)).concat(f.c.encodePath(n)),(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)(c.rU,{to:e,children:f.c.getFolderName(t.path)})}),(0,m.jsx)("td",{className:"name",children:t.share_to_name}),(0,m.jsxs)("td",{children:[!this.state.isShowPermEditor&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:t.permission_name||f.c.sharePerms(this.state.permission)}),this.state.isOperationShow&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.ih)("Edit"),title:(0,h.ih)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),this.state.isShowPermEditor&&(0,m.jsx)(ne.Z,{repoID:t.repo_id,isTextMode:!0,isEditIconShow:this.state.isOperationShow,isEditing:!0,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:f.c.onKeyDown,title:(0,h.ih)("Delete"),"aria-label":(0,h.ih)("Delete")})})]})}}]),n}(a.Component),un=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).deleteItem=function(e){C.I.deleteShareToUserItem(e.repo_id,e.path,"user",e.share_to).then((function(t){var n=o.state.items.filter((function(t){return t.path+t.share_to!==e.path+e.share_to}));o.setState({items:n});var r=(0,h.ih)("Successfully deleted 1 item");W.Z.success(r)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={loading:!0,errorMsg:"",items:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.getAllRepoFolderShareInfo(this.props.repo.repo_id,"user").then((function(t){e.setState({loading:!1,items:t.data.share_info_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.errorMsg,o=t.items,i=this.props.repo.owner_email===h.b6;return(0,m.jsxs)(a.Fragment,{children:[n&&(0,m.jsx)(D.Z,{}),!n&&r&&(0,m.jsx)("p",{className:"error text-center mt-8",children:r}),!n&&!r&&!o.length&&(0,m.jsx)(j.Z,{forDialog:!0,children:(0,m.jsx)("p",{className:"text-secondary",children:(0,h.ih)("No user shares")})}),!n&&!r&&o.length>0&&(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("User")}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("Permission")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(dn,{item:t,deleteItem:e.deleteItem,isRepoOwner:i},n)}))})]})]})}}]),n}(a.Component),pn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.setState({isOperationShow:!0})},o.onMouseLeave=function(){o.setState({isOperationShow:!1})},o.onDeleteLink=function(e){e.preventDefault(),o.props.deleteItem(o.props.item)},o.changePerm=function(e){var t=o.props.item;C.I.updateShareToGroupItemPermission(t.repo_id,t.path,"group",t.share_to,e).then((function(){o.setState({permission:e})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),o.setState({isShowPermEditor:!0})},o.state={permission:o.props.item.permission,isOperationShow:!1,isShowPermEditor:!1},o.permissions=["rw","r"],h._y&&("/"===o.props.item.path&&o.props.isRepoOwner&&o.permissions.push("admin"),o.permissions.push("cloud-edit","preview")),o}return(0,o.Z)(n,[{key:"render",value:function(){var e,t=this.props.item,n="/"===t.path?"/":t.path.slice(0,t.path.length-1);return e="".concat(h.ze,"library/").concat(t.repo_id,"/").concat(encodeURIComponent(t.repo_name)).concat(f.c.encodePath(n)),(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)(c.rU,{to:e,children:f.c.getFolderName(t.path)})}),(0,m.jsx)("td",{className:"name",children:t.share_to_name}),(0,m.jsxs)("td",{children:[!this.state.isShowPermEditor&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:t.permission_name||f.c.sharePerms(this.state.permission)}),this.state.isOperationShow&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.ih)("Edit"),title:(0,h.ih)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),this.state.isShowPermEditor&&(0,m.jsx)(ne.Z,{repoID:t.repo_id,isTextMode:!0,isEditIconShow:this.state.isOperationShow,isEditing:!0,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:f.c.onKeyDown,title:(0,h.ih)("Delete"),"aria-label":(0,h.ih)("Delete")})})]})}}]),n}(a.Component),hn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).deleteItem=function(e){C.I.deleteShareToGroupItem(e.repo_id,e.path,"group",e.share_to).then((function(t){var n=o.state.items.filter((function(t){return t.path+t.share_to!==e.path+e.share_to}));o.setState({items:n});var r=(0,h.ih)("Successfully deleted 1 item");W.Z.success(r)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={loading:!0,errorMsg:"",items:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.getAllRepoFolderShareInfo(this.props.repo.repo_id,"group").then((function(t){e.setState({loading:!1,items:t.data.share_info_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.errorMsg,o=t.items,i=this.props.repo.owner_email===h.b6;return(0,m.jsxs)(a.Fragment,{children:[n&&(0,m.jsx)(D.Z,{}),!n&&r&&(0,m.jsx)("p",{className:"error text-center mt-8",children:r}),!n&&!r&&!o.length&&(0,m.jsx)(j.Z,{forDialog:!0,children:(0,m.jsx)("p",{className:"text-secondary",children:(0,h.ih)("No group shares")})}),!n&&!r&&o.length>0&&(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("Group")}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("Permission")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(pn,{item:t,deleteItem:e.deleteItem,isRepoOwner:i},n)}))})]})]})}}]),n}(a.Component),fn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).getInitialActiveTab=function(){return o.enableShareLink?"shareLink":o.enableUploadLink?"uploadLink":"shareToUser"},o.toggle=function(e){o.state.activeTab!==e&&o.setState({activeTab:e})},o.onTabKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||e.target.click()},o.enableShareLink=!o.props.repo.encrypted&&h.Fl,o.enableUploadLink=!o.props.repo.encrypted&&h.$g,o.state={activeTab:o.getInitialActiveTab()},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state.activeTab,t=this.props.repo.repo_name,n=(0,h.ih)("{placeholder} Share Admin");return n=n.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.c.HTMLescape(t)+"</span>"),(0,m.jsx)("div",{children:(0,m.jsxs)(p.Z,{isOpen:!0,style:{maxWidth:"760px"},className:"share-dialog",toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.Z,{toggle:this.props.toggleDialog,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:n},className:"d-flex mw-100"})}),(0,m.jsx)(M.Z,{className:"dialog-list-container share-dialog-content",role:"tablist",children:(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("div",{className:"share-dialog-side",children:(0,m.jsxs)(wt.Z,{pills:!0,children:[this.enableShareLink&&(0,m.jsx)(bt.Z,{role:"tab","aria-selected":"shareLink"===e,"aria-controls":"share-link-panel",children:(0,m.jsx)(St.Z,{className:"shareLink"===e?"active":"",onClick:this.toggle.bind(this,"shareLink"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,h.ih)("Share Links")})}),this.enableUploadLink&&(0,m.jsx)(bt.Z,{role:"tab","aria-selected":"uploadLink"===e,"aria-controls":"upload-link-panel",children:(0,m.jsx)(St.Z,{className:"uploadLink"===e?"active":"",onClick:this.toggle.bind(this,"uploadLink"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,h.ih)("Upload Links")})}),(0,m.jsx)(bt.Z,{role:"tab","aria-selected":"shareToUser"===e,"aria-controls":"share-to-user-panel",children:(0,m.jsx)(St.Z,{className:"shareToUser"===e?"active":"",onClick:this.toggle.bind(this,"shareToUser"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,h.ih)("User Shares")})}),(0,m.jsx)(bt.Z,{role:"tab","aria-selected":"shareToGroup"===e,"aria-controls":"share-to-group-panel",children:(0,m.jsx)(St.Z,{className:"shareToGroup"===e?"active":"",onClick:this.toggle.bind(this,"shareToGroup"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,h.ih)("Group Shares")})})]})}),(0,m.jsx)("div",{className:"share-dialog-main",children:(0,m.jsxs)(Ct.Z,{activeTab:this.state.activeTab,children:[this.enableShareLink&&"shareLink"===e&&(0,m.jsx)(Dt.Z,{tabId:"shareLink",role:"tabpanel",id:"share-link-panel",children:(0,m.jsx)(an,{repo:this.props.repo})}),this.enableUploadLink&&"uploadLink"===e&&(0,m.jsx)(Dt.Z,{tabId:"uploadLink",role:"tabpanel",id:"upload-link-panel",children:(0,m.jsx)(cn,{repo:this.props.repo})}),"shareToUser"===e&&(0,m.jsx)(Dt.Z,{tabId:"shareToUser",role:"tabpanel",id:"share-to-user-panel",children:(0,m.jsx)(un,{repo:this.props.repo})}),"shareToGroup"===e&&(0,m.jsx)(Dt.Z,{tabId:"shareToGroup",role:"tabpanel",id:"share-to-group-panel",children:(0,m.jsx)(hn,{repo:this.props.repo})})]})})]})})]})})}}]),n}(a.Component),mn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).submit=function(){var e;if(o.state.isAutoDel){e=o.state.autoDelDays;if(!/^-?\d+$/.test(e)||e<=0)return void o.setState({errorInfo:(0,h.ih)("Please enter a positive integer")})}else e=0;var t=o.props.repoID;C.I.setRepoOldFilesAutoDelDays(t,e).then((function(e){o.props.toggleDialog(),W.Z.success((0,h.ih)("Successfully set it."))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.handleKeyDown=function(e){"Enter"===e.key&&(o.submit(),e.preventDefault())},o.onChange=function(e){var t=e.target.value;o.setState({autoDelDays:t})},o.updateRadioCheck=function(e){"noAutoDel"===e?o.setState({isAutoDel:!1}):"autoDel"===e&&o.setState({isAutoDel:!0})},o.state={autoDelDays:0,isAutoDel:!1,errorInfo:""},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.getRepoOldFilesAutoDelDays(this.props.repoID).then((function(t){e.setState({autoDelDays:t.data.auto_delete_days,isAutoDel:t.data.auto_delete_days>0})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.Z,{toggle:this.props.toggleDialog,children:(0,h.ih)("Auto deletion")}),(0,m.jsx)(M.Z,{children:(0,m.jsxs)(rt.Z,{children:[(0,m.jsxs)(ot.Z,{check:!0,children:[(0,m.jsx)(L.Z,{type:"radio",name:"radio1",checked:!this.state.isAutoDel,onChange:function(){e.updateRadioCheck("noAutoDel")}})," ",(0,m.jsx)(it.Z,{children:(0,h.ih)("Do not automatically delete files")})]}),(0,m.jsxs)(ot.Z,{check:!0,children:[(0,m.jsx)(L.Z,{type:"radio",name:"radio1",checked:this.state.isAutoDel,onChange:function(){e.updateRadioCheck("autoDel")}})," ",(0,m.jsx)(it.Z,{children:(0,h.ih)("Automatically delete files that are not modified within certain days:")}),(0,m.jsx)(L.Z,{type:"text",className:"expire-input",value:this.state.autoDelDays,disabled:!this.state.isAutoDel,onChange:this.onChange,onKeyDown:this.handleKeyDown})," ",(0,m.jsx)(it.Z,{children:(0,m.jsx)("span",{children:(0,h.ih)("days")})})]}),this.state.errorInfo&&(0,m.jsx)(st.Z,{color:"danger",children:this.state.errorInfo})]})}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.props.toggleDialog,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.submit,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),gn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onFocus=function(){o.props.isItemFreezed||o.setState({isOpIconShow:!0})},o.onMouseEnter=function(){o.props.isItemFreezed||o.setState({isOpIconShow:!0,highlight:!0})},o.onMouseLeave=function(){o.props.isItemFreezed||o.setState({isOpIconShow:!1,highlight:!1})},o.onMenuItemClick=function(e){switch(e){case"Star":case"Unstar":o.onToggleStarRepo();break;case"Share":o.onShareToggle();break;case"Delete":o.onDeleteToggle();break;case"Rename":o.onRenameToggle();break;case"Transfer":o.onTransferToggle();break;case"History Setting":o.onHistorySettingToggle();break;case"Change Password":o.onChangePasswordToggle();break;case"Reset Password":o.onResetPasswordToggle();break;case"Watch File Changes":o.watchFileChanges();break;case"Unwatch File Changes":o.unwatchFileChanges();break;case"Folder Permission":o.onFolderPermissionToggle();break;case"Label Current State":o.onLabelToggle();break;case"API Token":o.onAPITokenToggle();break;case"Share Admin":o.toggleRepoShareAdminDialog();break;case"Old Files Auto Delete":o.toggleOldFilesAutoDelDialog();break;case"SeaTable integration":o.onSeaTableIntegrationToggle()}},o.visitRepo=function(){!o.state.isRenaming&&o.props.repo.repo_name&&(0,c.c4)(o.repoURL)},o.onToggleStarRepo=function(e){e.preventDefault();var t=o.props.repo.repo_name;o.state.isStarred?C.I.unstarItem(o.props.repo.repo_id,"/").then((function(){o.setState({isStarred:!o.state.isStarred});var e=(0,h.ih)("Successfully unstarred {library_name_placeholder}.").replace("{library_name_placeholder}",t);W.Z.success(e)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})):C.I.starItem(o.props.repo.repo_id,"/").then((function(){o.setState({isStarred:!o.state.isStarred});var e=(0,h.ih)("Successfully starred {library_name_placeholder}.").replace("{library_name_placeholder}",t);W.Z.success(e)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.watchFileChanges=function(){var e=o.props.repo;C.I.monitorRepo(e.repo_id).then((function(){o.props.onMonitorRepo(e,!0)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.unwatchFileChanges=function(){var e=o.props.repo;C.I.unMonitorRepo(e.repo_id).then((function(){o.props.onMonitorRepo(e,!1)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onShareToggle=function(e){void 0!=e&&e.preventDefault(),o.setState({isShareDialogShow:!o.state.isShareDialogShow})},o.onDeleteToggle=function(e){e.preventDefault(),o.setState({isDeleteDialogShow:!o.state.isDeleteDialogShow})},o.onRenameToggle=function(){o.props.onFreezedItem(),o.setState({isRenaming:!o.state.isRenaming})},o.onTransferToggle=function(){o.setState({isTransferDialogShow:!o.state.isTransferDialogShow})},o.onHistorySettingToggle=function(){o.setState({isHistorySettingDialogShow:!o.state.isHistorySettingDialogShow})},o.onChangePasswordToggle=function(){o.setState({isChangePasswordDialogShow:!o.state.isChangePasswordDialogShow})},o.onResetPasswordToggle=function(){o.setState({isResetPasswordDialogShow:!o.state.isResetPasswordDialogShow})},o.onLabelToggle=function(){o.setState({isLabelRepoStateDialogOpen:!o.state.isLabelRepoStateDialogOpen})},o.onFolderPermissionToggle=function(){o.setState({isFolderPermissionDialogShow:!o.state.isFolderPermissionDialogShow})},o.onAPITokenToggle=function(){o.setState({isAPITokenDialogShow:!o.state.isAPITokenDialogShow})},o.onSeaTableIntegrationToggle=function(){o.setState({isSeaTableIntegrationShow:!o.state.isSeaTableIntegrationShow})},o.toggleRepoShareAdminDialog=function(){o.setState({isRepoShareAdminDialogOpen:!o.state.isRepoShareAdminDialogOpen})},o.toggleOldFilesAutoDelDialog=function(){o.setState({isOldFilesAutoDelDialogOpen:!o.state.isOldFilesAutoDelDialogOpen})},o.onUnfreezedItem=function(){o.setState({highlight:!1,isOpIconShow:!1}),o.props.onUnfreezedItem()},o.onRenameConfirm=function(e){var t=o.props.repo,n=t.repo_id;C.I.renameRepo(n,e).then((function(){o.props.onRenameRepo(t,e),o.onRenameCancel()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onRenameCancel=function(){o.props.onUnfreezedItem(),o.setState({isRenaming:!o.state.isRenaming})},o.onTransferRepo=function(e){var t=o.props.repo.repo_id;C.I.transferRepo(t,e.email).then((function(e){o.props.onTransferRepo(t);var n=(0,h.ih)("Successfully transferred the library.");W.Z.success(n)})).catch((function(e){e.response?W.Z.danger(e.response.data.error_msg||(0,h.ih)("Error"),{duration:3}):W.Z.danger((0,h.ih)("Failed. Please check the network."),{duration:3})})),o.onTransferToggle()},o.onDeleteRepo=function(e){C.I.deleteRepo(e.repo_id).then((function(t){o.setState({isRepoDeleted:!0,isDeleteDialogShow:!1}),o.props.onDeleteRepo(e);var n=e.repo_name,r=(0,h.ih)("Successfully deleted {name}.").replace("{name}",n);W.Z.success(r)})).catch((function(t){var n=f.c.getErrorMsg(t);if(n===(0,h.ih)("Error")){var r=e.repo_name;n=(0,h.ih)("Failed to delete {name}.").replace("{name}",r)}W.Z.danger(n),o.setState({isRepoDeleted:!1})}))},o.renderPCUI=function(){var e=o.state.isStarred,t=o.props,n=t.repo,r=t.currentViewMode,i=void 0===r?"list":r,s="grid"==i,l=f.c.getLibIconUrl(n,s),d=f.c.getLibIconTitle(n),u="".concat(h.ze,"library/").concat(n.repo_id,"/").concat(f.c.encodePath(n.repo_name),"/");return"list"==i?(0,m.jsxs)("tr",{className:o.state.highlight?"tr-highlight":"",onMouseEnter:o.onMouseEnter,onMouseLeave:o.onMouseLeave,onFocus:o.onFocus,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("i",{role:"button",title:o.state.isStarred?(0,h.ih)("Unstar"):(0,h.ih)("Star"),"aria-label":o.state.isStarred?(0,h.ih)("Unstar"):(0,h.ih)("Star"),onClick:o.onToggleStarRepo,className:"op-icon m-0 ".concat(o.state.isStarred?"sf3-font-star":"sf3-font-star-empty"," sf3-font")})}),(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:l,title:d,alt:d,width:"24"})}),(0,m.jsxs)("td",{children:[o.state.isRenaming&&(0,m.jsx)(Zt.Z,{name:n.repo_name,onRenameConfirm:o.onRenameConfirm,onRenameCancel:o.onRenameCancel}),!o.state.isRenaming&&n.repo_name&&(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(c.rU,{to:u,children:n.repo_name}),n.monitored&&(0,m.jsx)(Pe,{repoID:n.repo_id,className:"ml-1 op-icon"})]}),!o.state.isRenaming&&!n.repo_name&&(0,h.ih)("Broken (please contact your administrator to fix this library)")]}),(0,m.jsx)("td",{children:n.repo_name&&o.state.isOpIconShow&&(0,m.jsxs)("div",{children:[(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-share sf3-font",title:(0,h.ih)("Share"),role:"button","aria-label":(0,h.ih)("Share"),onClick:o.onShareToggle}),(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-delete1 sf3-font",title:(0,h.ih)("Delete"),role:"button","aria-label":(0,h.ih)("Delete"),onClick:o.onDeleteToggle}),(0,m.jsx)(Lt,{isPC:!0,repo:o.props.repo,onMenuItemClick:o.onMenuItemClick,onFreezedItem:o.props.onFreezedItem,onUnfreezedItem:o.onUnfreezedItem})]})}),(0,m.jsx)("td",{children:n.size}),h.al.length>0&&(0,m.jsx)("td",{children:n.storage_name}),(0,m.jsx)("td",{title:S()(n.last_modified).format("llll"),children:S()(n.last_modified).fromNow()})]}):(0,m.jsxs)("div",{className:"library-grid-item px-3 d-flex justify-content-between align-items-center",onMouseEnter:o.onMouseEnter,onMouseLeave:o.onMouseLeave,onFocus:o.onFocus,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center text-truncate",children:[(0,m.jsx)("img",{src:l,title:d,alt:d,width:"36",className:"mr-2"}),o.state.isRenaming&&(0,m.jsx)(Zt.Z,{name:n.repo_name,onRenameConfirm:o.onRenameConfirm,onRenameCancel:o.onRenameCancel}),!o.state.isRenaming&&n.repo_name&&(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(c.rU,{to:u,className:"library-name text-truncate",title:n.repo_name,children:n.repo_name}),e&&(0,m.jsx)("i",{role:"button",title:(0,h.ih)("Unstar"),"aria-label":(0,h.ih)("Unstar"),className:"op-icon library-grid-item-icon sf3-font-star sf3-font",onClick:o.onToggleStarRepo}),n.monitored&&(0,m.jsx)(Pe,{repoID:n.repo_id,className:"op-icon library-grid-item-icon"})]}),!o.state.isRenaming&&!n.repo_name&&(0,m.jsx)("span",{children:(0,h.ih)("Broken (please contact your administrator to fix this library)")})]}),n.repo_name&&o.state.isOpIconShow&&(0,m.jsxs)("div",{className:"flex-shrink-0",children:[(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-share sf3-font",title:(0,h.ih)("Share"),role:"button","aria-label":(0,h.ih)("Share"),onClick:o.onShareToggle}),(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-delete1 sf3-font",title:(0,h.ih)("Delete"),role:"button","aria-label":(0,h.ih)("Delete"),onClick:o.onDeleteToggle}),(0,m.jsx)(Lt,{isPC:!0,repo:o.props.repo,onMenuItemClick:o.onMenuItemClick,onFreezedItem:o.props.onFreezedItem,onUnfreezedItem:o.onUnfreezedItem})]})]})},o.renderMobileUI=function(){var e=o.props.repo,t=f.c.getLibIconUrl(e),n=f.c.getLibIconTitle(e),r=o.repoURL="".concat(h.ze,"library/").concat(e.repo_id,"/").concat(f.c.encodePath(e.repo_name),"/");return(0,m.jsxs)("tr",{className:o.state.highlight?"tr-highlight":"",onMouseEnter:o.onMouseEnter,onMouseLeave:o.onMouseLeave,children:[(0,m.jsx)("td",{onClick:o.visitRepo,children:(0,m.jsx)("img",{src:t,title:n,alt:n,width:"24"})}),(0,m.jsxs)("td",{onClick:o.visitRepo,children:[o.state.isRenaming&&(0,m.jsx)(Zt.Z,{name:e.repo_name,onRenameConfirm:o.onRenameConfirm,onRenameCancel:o.onRenameCancel}),!o.state.isRenaming&&e.repo_name&&(0,m.jsxs)("div",{children:[(0,m.jsx)(c.rU,{to:r,children:e.repo_name}),e.monitored&&(0,m.jsx)(Pe,{repoID:e.repo_id,className:"ml-1 op-icon"})]}),!o.state.isRenaming&&!e.repo_name&&(0,m.jsx)("div",{children:"(gettext('Broken (please contact your administrator to fix this library)'))"}),(0,m.jsx)("span",{className:"item-meta-info",children:e.size}),(0,m.jsx)("span",{className:"item-meta-info",title:S()(e.last_modified).format("llll"),children:S()(e.last_modified).fromNow()})]}),(0,m.jsx)("td",{children:e.repo_name&&(0,m.jsx)(Lt,{repo:o.props.repo,isStarred:o.state.isStarred,onMenuItemClick:o.onMenuItemClick,onFreezedItem:o.props.onFreezedItem,onUnfreezedItem:o.onUnfreezedItem})})]})},o.state={isOpIconShow:!1,isStarred:o.props.repo.starred,isRenaming:!1,isShareDialogShow:!1,isDeleteDialogShow:!1,isTransferDialogShow:!1,isHistorySettingDialogShow:!1,isChangePasswordDialogShow:!1,isResetPasswordDialogShow:!1,isLabelRepoStateDialogOpen:!1,isFolderPermissionDialogShow:!1,isAPITokenDialogShow:!1,isSeaTableIntegrationShow:!1,isRepoShareAdminDialogOpen:!1,isRepoDeleted:!1,isOldFilesAutoDelDialogOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.repo;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(u(),{query:"(min-width: 768px)",children:this.renderPCUI()}),(0,m.jsx)(u(),{query:"(max-width: 767.8px)",children:this.renderMobileUI()}),this.state.isShareDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Te.Z,{itemType:"library",itemName:e.repo_name,itemPath:"/",repoID:e.repo_id,repoEncrypted:e.encrypted,enableDirPrivateShare:!0,userPerm:e.permission,toggleDialog:this.onShareToggle})}),this.state.isDeleteDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(dt.Z,{repo:e,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.onDeleteRepo,toggle:this.onDeleteToggle})}),this.state.isTransferDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(ut.Z,{itemName:e.repo_name,submit:this.onTransferRepo,toggleDialog:this.onTransferToggle})}),this.state.isHistorySettingDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(pt,{repoID:e.repo_id,itemName:e.repo_name,toggleDialog:this.onHistorySettingToggle})}),this.state.isChangePasswordDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(ht,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onChangePasswordToggle})}),this.state.isResetPasswordDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(ft,{repoID:e.repo_id,toggleDialog:this.onResetPasswordToggle})}),this.state.isLabelRepoStateDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(yt,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onLabelToggle})}),this.state.isFolderPermissionDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Pt,{toggleDialog:this.onFolderPermissionToggle,repoID:e.repo_id,repoName:e.repo_name})}),this.state.isAPITokenDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Ht,{repo:e,onRepoAPITokenToggle:this.onAPITokenToggle})}),this.state.isSeaTableIntegrationShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(on,{repo:e,onSeaTableIntegrationToggle:this.onSeaTableIntegrationToggle})}),this.state.isRepoShareAdminDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(fn,{repo:e,toggleDialog:this.toggleRepoShareAdminDialog})}),this.state.isOldFilesAutoDelDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(mn,{repoID:e.repo_id,toggleDialog:this.toggleOldFilesAutoDelDialog})})]})}}]),n}(a.Component),vn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onFreezedItem=function(){o.setState({isItemFreezed:!0})},o.onUnfreezedItem=function(){o.setState({isItemFreezed:!1})},o.sortByName=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortRepoList("name",t)},o.sortByTime=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortRepoList("time",t)},o.sortBySize=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortRepoList("size",t)},o.renderRepoListView=function(){return(0,m.jsx)(a.Fragment,{children:o.props.repoList.map((function(e){return(0,m.jsx)(gn,{repo:e,isItemFreezed:o.state.isItemFreezed,onFreezedItem:o.onFreezedItem,onUnfreezedItem:o.onUnfreezedItem,onRenameRepo:o.props.onRenameRepo,onDeleteRepo:o.props.onDeleteRepo,onTransferRepo:o.props.onTransferRepo,onMonitorRepo:o.props.onMonitorRepo,currentViewMode:o.props.currentViewMode},e.repo_id)}))})},o.renderPCUI=function(){var e=o.props,t=e.inAllLibs,n=e.currentViewMode,r=void 0===n?"list":n,i=!t&&h.al.length>0,s="asc"===o.props.sortOrder?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"});return"list"==r?(0,m.jsxs)("table",{className:t?"table-thead-hidden":"",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.ih)("Library Type")})}),(0,m.jsx)("th",{width:i?"36%":"35%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:o.sortByName,children:[(0,h.ih)("Name")," ","name"===o.props.sortBy&&s]})}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.ih)("Actions")})}),(0,m.jsx)("th",{width:i?"15%":"14%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:o.sortBySize,children:[(0,h.ih)("Size")," ","size"===o.props.sortBy&&s]})}),i?(0,m.jsx)("th",{width:"17%",children:(0,h.ih)("Storage Backend")}):null,(0,m.jsx)("th",{width:i?"15%":"34%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:o.sortByTime,children:[(0,h.ih)("Last Update")," ","time"===o.props.sortBy&&s]})})]})}),(0,m.jsx)("tbody",{children:o.renderRepoListView()})]}):(0,m.jsx)("div",{className:"d-flex justify-content-between flex-wrap",children:o.renderRepoListView()})},o.renderMobileUI=function(){return(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)(Re,{}),(0,m.jsx)("tbody",{children:o.renderRepoListView()})]})},o.state={isItemFreezed:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(u(),{query:"(min-width: 768px)",children:this.renderPCUI()}),(0,m.jsx)(u(),{query:"(max-width: 767.8px)",children:this.renderMobileUI()})]})}}]),n}(a.Component),yn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleSortOptionsDialog=function(){o.setState({isSortOptionsDialogOpen:!o.state.isSortOptionsDialogOpen})},o.onCreateRepo=function(e){C.I.createMineRepo(e).then((function(e){var t=new Ne({repo_id:e.data.repo_id,repo_name:e.data.repo_name,size:e.data.repo_size,mtime:e.data.mtime,owner_email:e.data.email,encrypted:e.data.encrypted,permission:e.data.permission,storage_name:e.data.storage_name});o.state.repoList.unshift(t),o.setState({repoList:o.state.repoList})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.sortRepoList=function(e,t){_e.ZP.save("seafile-repo-dir-sort-by",e),_e.ZP.save("seafile-repo-dir-sort-order",t),o.setState({sortBy:e,sortOrder:t,repoList:f.c.sortRepos(o.state.repoList,e,t)})},o.onTransferRepo=function(e){var t=o.state.repoList.filter((function(t){return t.repo_id!==e}));o.setState({repoList:t})},o.onRenameRepo=function(e,t){var n=o.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n}));o.setState({repoList:n})},o.onMonitorRepo=function(e,t){var n=o.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));o.setState({repoList:n})},o.onDeleteRepo=function(e){var t=o.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));o.setState({repoList:t})},o.state={errorMsg:"",isLoading:!0,repoList:[],isSortOptionsDialogOpen:!1,sortBy:_e.ZP.load("seafile-repo-dir-sort-by")||"name",sortOrder:_e.ZP.load("seafile-repo-dir-sort-order")||"asc"},o.emptyTip=(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No libraries")}),(0,m.jsx)("p",{children:(0,h.ih)('You have not created any libraries yet. A library is a container to organize your files and folders. A library can also be shared with others and synced to your connected devices. You can create a library by clicking the "New Library" button in the menu bar.')})]}),o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.listRepos({type:"mine"}).then((function(t){var n=t.data.repos.map((function(e){return new Ne(e)}));e.setState({isLoading:!1,repoList:f.c.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({isLoading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(xe.Z,{onShowSidePanel:this.props.onShowSidePanel,onSearchedClick:this.props.onSearchedClick,children:(0,m.jsx)(ct,{onCreateRepo:this.onCreateRepo,moreShown:!0})}),(0,m.jsxs)("div",{className:"main-panel-center flex-row",children:[(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,h.ih)("My Libraries")}),!f.c.isDesktop()&&this.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})]}),(0,m.jsxs)("div",{className:"cur-view-content",children:[this.state.isLoading&&(0,m.jsx)(D.Z,{}),!this.state.isLoading&&this.state.errorMsg&&(0,m.jsx)("p",{className:"error text-center mt-8",children:this.state.errorMsg}),!this.state.isLoading&&!this.state.errorMsg&&0===this.state.repoList.length&&this.emptyTip,!this.state.isLoading&&!this.state.errorMsg&&this.state.repoList.length>0&&(0,m.jsx)(vn,{sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,repoList:this.state.repoList,onRenameRepo:this.onRenameRepo,onDeleteRepo:this.onDeleteRepo,onTransferRepo:this.onTransferRepo,onMonitorRepo:this.onMonitorRepo,sortRepoList:this.sortRepoList})]})]}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(ve,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortRepoList})]})]})}}]),n}(a.Component),xn=n(1781);S().locale(h.KQ);var wn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).refreshDeletedRepoList=function(e){var t=o.state.deletedRepoList.filter((function(t){return t.repo_id!==e}));o.setState({deletedRepoList:t})},o.state={deletedRepoList:[],isLoading:!0},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.listDeletedRepo().then((function(t){e.setState({deletedRepoList:t.data,isLoading:!1})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}},{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-north",children:(0,m.jsx)(xn.Z,{onSearchedClick:this.props.onSearchedClick})}),(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)(c.rU,{to:h.ze+"my-libs/",children:(0,h.ih)("My Libraries")}),(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{children:(0,h.ih)("Deleted Libraries")})]})}),(0,m.jsxs)("div",{className:"cur-view-content",children:[this.state.isLoading&&(0,m.jsx)(D.Z,{}),!this.state.isLoading&&0===this.state.deletedRepoList.length&&(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No deleted libraries")}),(0,m.jsx)("p",{children:(0,h.ih)("You have not deleted any libraries in the last {placeholder} days. A deleted library will be cleaned automatically after this period.").replace("{placeholder}",h.UR)})]}),0!==this.state.deletedRepoList.length&&(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"tip mt-2",children:(0,h.ih)("Tip: libraries deleted {placeholder} days ago will be cleaned automatically.").replace("{placeholder}",h.UR)}),(0,m.jsx)(bn,{deletedRepoList:this.state.deletedRepoList,refreshDeletedRepoList:this.refreshDeletedRepoList})]})]})]})})]})}}]),n}(a.Component),bn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props.deletedRepoList;return(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{style:{width:"4%"}}),(0,m.jsx)("th",{style:{width:"52%"},children:(0,h.ih)("Name")}),(0,m.jsx)("th",{style:{width:"30%"},children:(0,h.ih)("Deleted Time")}),(0,m.jsx)("th",{style:{width:"14%"}})]})}),(0,m.jsx)("tbody",{children:t&&t.map((function(t){return(0,m.jsx)(Sn,{repo:t,refreshDeletedRepoList:e.props.refreshDeletedRepoList},t.repo_id)}))})]})}}]),n}(a.Component),Sn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.setState({hideRestoreMenu:!1,highlight:!0})},o.onMouseLeave=function(){o.setState({hideRestoreMenu:!0,highlight:!1})},o.restoreDeletedRepo=function(e){e.preventDefault();var t=o.props.repo.repo_id,n=o.props.repo.repo_name;C.I.restoreDeletedRepo(t).then((function(e){var r=(0,h.ih)("Successfully restored the library.")+"  "+n;W.Z.success(r),o.props.refreshDeletedRepoList(t)})).catch((function(e){var t=f.c.getErrorMsg(e);t===(0,h.ih)("Error")&&(t=(0,h.ih)("Failed. Please check the network.")),W.Z.danger(t)}))},o.state={hideRestoreMenu:!0,highlight:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=S().utc(this.props.repo.del_time).toDate();e=S()(e).fromNow();var t=f.c.getLibIconUrl(this.props.repo);return(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,tabIndex:"0",onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:t,alt:"",width:"24"})}),(0,m.jsx)("td",{className:"name",children:this.props.repo.repo_name}),(0,m.jsx)("td",{className:"update",children:e}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",onClick:this.restoreDeletedRepo,title:(0,h.ih)("Restore"),role:"button","aria-label":(0,h.ih)("Restore"),className:"sf2-icon-reply action-icon ".concat(this.state.highlight?"":"vh")})})]})}}]),n}(a.Component),Cn=wn,Dn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.props.isItemFreezed||o.setState({highlight:!0,isOperationShow:!0})},o.onMouseOver=function(){o.props.isItemFreezed||o.setState({highlight:!0,isOperationShow:!0})},o.onMouseLeave=function(){o.props.isItemFreezed||o.setState({highlight:!1,isOperationShow:!1})},o.clickOperationMenuToggle=function(e){o.toggleOperationMenu(e)},o.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.clickOperationMenuToggle(e)},o.toggleOperationMenu=function(e){var t=e.target?e.target.dataset:null;t&&t.toggle&&"Rename"===t.toggle?o.setState({isItemMenuShow:!o.state.isItemMenuShow}):o.setState({isItemMenuShow:!o.state.isItemMenuShow},(function(){o.state.isItemMenuShow?o.props.onFreezedItem():(o.props.onUnfreezedItem(),o.setState({highlight:!1,isOperationShow:!1}))}))},o.toggleAdvancedMenuShown=function(e){o.setState({isAdvancedMenuShown:!0})},o.toggleAdvancedMenu=function(e){e.stopPropagation(),o.setState({isAdvancedMenuShown:!o.state.isAdvancedMenuShown},(function(){o.toggleOperationMenu(e)}))},o.onDropDownMouseMove=function(e){o.state.isAdvancedMenuShown&&e.target&&"dropdown-item"===e.target.className&&o.setState({isAdvancedMenuShown:!1})},o.getRepoComputeParams=function(){var e=o.props,t=e.repo,n="grid"==e.currentViewMode;return{iconUrl:f.c.getLibIconUrl(t,n),iconTitle:f.c.getLibIconTitle(t),libPath:"".concat(h.ze,"library/").concat(t.repo_id,"/").concat(f.c.encodePath(t.repo_name),"/")}},o.onMenuItemKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.onMenuItemClick(e)},o.onMenuItemClick=function(e){switch(e.target.dataset.toggle){case"Rename":o.onItemRenameToggle();break;case"Folder Permission":o.onItemFolderPermissionToggle();break;case"Share":o.onItemShare();break;case"Unshare":o.onItemUnshare();break;case"History Setting":o.onHistorySettingToggle();break;case"API Token":o.onAPITokenToggle();break;case"Share Admin":o.toggleRepoShareAdminDialog();break;case"Change Password":o.onChangePasswordToggle();break;case"Reset Password":o.onResetPasswordToggle();break;case"Watch File Changes":o.watchFileChanges();break;case"Unwatch File Changes":o.unwatchFileChanges();break;case"Old Files Auto Delete":o.toggleOldFilesAutoDelDialog();break;case"SeaTable integration":o.onSeaTableIntegrationToggle()}},o.watchFileChanges=function(){var e=o.props.repo;C.I.monitorRepo(e.repo_id).then((function(){o.props.onMonitorRepo(e,!0)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.unwatchFileChanges=function(){var e=o.props.repo;C.I.unMonitorRepo(e.repo_id).then((function(){o.props.onMonitorRepo(e,!1)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onItemRenameToggle=function(){o.props.onFreezedItem(),o.setState({isRenaming:!o.state.isRenaming,isOperationShow:!o.state.isOperationShow})},o.onRenameConfirm=function(e){o.props.onItemRename(o.props.repo,e),o.onRenameCancel()},o.onRenameCancel=function(){o.props.onUnfreezedItem(),o.setState({isRenaming:!o.state.isRenaming})},o.onItemFolderPermissionToggle=function(){o.setState({isFolderPermissionDialogOpen:!o.state.isFolderPermissionDialogOpen})},o.onHistorySettingToggle=function(){o.setState({isHistorySettingDialogShow:!o.state.isHistorySettingDialogShow})},o.onItemShare=function(e){e.preventDefault(),o.setState({isShowSharedDialog:!0})},o.onItemUnshare=function(e){e.preventDefault(),o.props.onItemUnshare(o.props.repo)},o.onItemDeleteToggle=function(e){e.preventDefault(),o.setState({isDeleteDialogShow:!o.state.isDeleteDialogShow})},o.onItemDelete=function(){var e=o.props,t=e.currentGroup,n=e.repo;if(t){var r=t.id;C.I.deleteGroupOwnedLibrary(r,n.repo_id).then((function(){o.setState({isRepoDeleted:!0,isDeleteDialogShow:!1}),o.props.onItemDelete(n);var e=n.repo_name,t=(0,h.ih)("Successfully deleted {name}.").replace("{name}",e);W.Z.success(t)})).catch((function(e){var t=f.c.getErrorMsg(e);if(t===(0,h.ih)("Error")){var r=n.repo_name;t=(0,h.ih)("Failed to delete {name}.").replace("{name}",r)}W.Z.danger(t),o.setState({isRepoDeleted:!1})}))}},o.toggleShareDialog=function(){o.setState({isShowSharedDialog:!1})},o.toggleRepoShareAdminDialog=function(){o.setState({isRepoShareAdminDialogOpen:!o.state.isRepoShareAdminDialogOpen})},o.toggleOldFilesAutoDelDialog=function(){o.setState({isOldFilesAutoDelDialogOpen:!o.state.isOldFilesAutoDelDialogOpen})},o.onSeaTableIntegrationToggle=function(){o.setState({isSeaTableIntegrationShow:!o.state.isSeaTableIntegrationShow})},o.onAPITokenToggle=function(){o.setState({isAPITokenDialogShow:!o.state.isAPITokenDialogShow})},o.onChangePasswordToggle=function(){o.setState({isChangePasswordDialogShow:!o.state.isChangePasswordDialogShow})},o.onResetPasswordToggle=function(){o.setState({isResetPasswordDialogShow:!o.state.isResetPasswordDialogShow})},o.translateMenuItem=function(e){var t="";switch(e){case"Rename":t=(0,h.ih)("Rename");break;case"Folder Permission":t=(0,h.ih)("Folder Permission");break;case"Unshare":t=(0,h.ih)("Unshare");break;case"Share":t=(0,h.ih)("Share");break;case"History Setting":t=(0,h.ih)("History Setting");break;case"Share Admin":t=(0,h.ih)("Share Admin");break;case"Change Password":t=(0,h.ih)("Change Password");break;case"Reset Password":t=(0,h.ih)("Reset Password");break;case"Watch File Changes":t=(0,h.ih)("Watch File Changes");break;case"Unwatch File Changes":t=(0,h.ih)("Unwatch File Changes");break;case"Old Files Auto Delete":t=(0,h.ih)("Auto Deletion Setting");break;case"API Token":t="API Token";break;case"Advanced":t=(0,h.ih)("Advanced");break;case"SeaTable integration":t=(0,h.ih)("SeaTable integration")}return t},o.getAdvancedOperations=function(){var e=[];return e.push("API Token"),h.PZ&&e.push("Old Files Auto Delete"),h.CT&&e.push("SeaTable integration"),e},o.generatorOperations=function(){var e=o.props,t=e.repo,n=e.currentGroup,r=n&&n.admins&&n.admins.indexOf(h.b6)>-1,i=t.owner_email===h.b6,s=t.is_admin,a=[];if(h._y){if(-1!=t.owner_email.indexOf("@seafile_group")){if(r){if(t.owner_email==n.id+"@seafile_group"){if(o.isDeparementOnwerGroupMember=!0,a=["Rename"],h.n_&&a.push("Folder Permission"),a.push("Share Admin","Divider"),t.encrypted&&a.push("Change Password"),t.encrypted&&h.yV&&h.aZ&&a.push("Reset Password"),"r"==t.permission||"rw"==t.permission){var l=t.monitored?"Unwatch File Changes":"Watch File Changes";a.push(l)}return a.push("Divider","History Setting"),f.c.isDesktop()&&a.push("Advanced"),a}a.push("Unshare")}}else(i||s)&&a.push("Share"),(r||i||s)&&a.push("Unshare");if("r"==t.permission||"rw"==t.permission){var c=t.monitored?"Unwatch File Changes":"Watch File Changes";a.push(c)}}else i&&a.push("Share"),(r||i)&&a.push("Unshare");return a},o.generatorMobileMenu=function(){var e=[];if(o.props.libraryType&&"public"===o.props.libraryType){var t=o.props.repo.owner_email===h.b6;(h.AU||t)&&e.push("Unshare")}else e=o.generatorOperations(),o.isDeparementOnwerGroupMember&&(e.unshift("Unshare"),e.unshift("Share"));return e.length?(0,m.jsxs)(H.Z,{isOpen:o.state.isItemMenuShow,toggle:o.toggleOperationMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":o.state.isItemMenuShow,onClick:o.clickOperationMenuToggle}),(0,m.jsxs)("div",{className:"".concat(o.state.isItemMenuShow?"":"d-none"),onClick:o.toggleOperationMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:e.map((function(e,t){return(0,m.jsx)(V.Z,{"data-toggle":e,onClick:o.onMenuItemClick,children:o.translateMenuItem(e)},t)}))})]})]}):null},o.generatorPCMenu=function(){var e=[];if(o.props.libraryType&&"public"===o.props.libraryType){var t=o.props.repo.owner_email===h.b6;(h.AU||t)&&e.push("Unshare")}else e=o.generatorOperations();var n=(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-share sf3-font",title:(0,h.ih)("Share"),role:"button","aria-label":(0,h.ih)("Share"),onClick:o.onItemShare}),r=(0,m.jsx)("a",{href:"#",className:"op-icon sf2-icon-x3",title:(0,h.ih)("Unshare"),role:"button","aria-label":(0,h.ih)("Unshare"),onClick:o.onItemUnshare}),i=(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-delete1 sf3-font",title:(0,h.ih)("Delete"),role:"button","aria-label":(0,h.ih)("Delete"),onClick:o.onItemDeleteToggle});if(o.isDeparementOnwerGroupMember){var s=o.getAdvancedOperations();return(0,m.jsxs)(a.Fragment,{children:[n,i,(0,m.jsxs)(H.Z,{isOpen:o.state.isItemMenuShow,toggle:o.toggleOperationMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":o.state.isItemMenuShow,"aria-haspopup":!0,style:{minWidth:"0"},onClick:o.clickOperationMenuToggle,onKeyDown:o.onDropdownToggleKeyDown}),(0,m.jsx)(Me.Z,{onMouseMove:o.onDropDownMouseMove,children:e.map((function(e,t){return"Divider"==e?(0,m.jsx)(V.Z,{divider:!0},t):"Advanced"==e?(0,m.jsxs)(H.Z,{direction:"right",className:"w-100",isOpen:o.state.isAdvancedMenuShown,toggle:o.toggleAdvancedMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsxs)(Y.Z,{className:"dropdown-item font-weight-normal rounded-0 d-flex justify-content-between align-items-center pr-2",onMouseEnter:o.toggleAdvancedMenuShown,children:[o.translateMenuItem(e),(0,m.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,m.jsx)(Me.Z,{children:s.map((function(e,t){return(0,m.jsx)(V.Z,{"data-toggle":e,onClick:o.onMenuItemClick,onKeyDown:o.onMenuItemKeyDown,children:o.translateMenuItem(e)},t)}))})]},t):(0,m.jsx)(V.Z,{"data-toggle":e,onClick:o.onMenuItemClick,onKeyDown:o.onMenuItemKeyDown,children:o.translateMenuItem(e)},t)}))})]})]})}return(0,m.jsx)(a.Fragment,{children:e.map((function(e){switch(e){case"Share":return(0,m.jsx)(a.Fragment,{children:n},e);case"Unshare":return(0,m.jsx)(a.Fragment,{children:r},e);case"Watch File Changes":case"Unwatch File Changes":return(0,m.jsxs)(H.Z,{isOpen:o.state.isItemMenuShow,toggle:o.toggleOperationMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":o.state.isItemMenuShow,"aria-haspopup":!0,style:{minWidth:"0"},onClick:o.clickOperationMenuToggle,onKeyDown:o.onDropdownToggleKeyDown}),(0,m.jsx)(Me.Z,{children:[e].map((function(e,t){return(0,m.jsx)(V.Z,{"data-toggle":e,onClick:o.onMenuItemClick,onKeyDown:o.onMenuItemKeyDown,children:o.translateMenuItem(e)},t)}))})]},e);default:return null}}))})},o.onToggleStarRepo=function(e){e.preventDefault();var t=o.props.repo.repo_name;o.state.isStarred?C.I.unstarItem(o.props.repo.repo_id,"/").then((function(){o.setState({isStarred:!o.state.isStarred});var e=(0,h.ih)("Successfully unstarred {library_name_placeholder}.").replace("{library_name_placeholder}",t);W.Z.success(e)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})):C.I.starItem(o.props.repo.repo_id,"/").then((function(){o.setState({isStarred:!o.state.isStarred});var e=(0,h.ih)("Successfully starred {library_name_placeholder}.").replace("{library_name_placeholder}",t);W.Z.success(e)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.renderPCUI=function(){var e=o.state.isStarred,t=o.getRepoComputeParams(),n=t.iconUrl,r=t.iconTitle,i=t.libPath,s=o.props,l=s.repo;return"list"==s.currentViewMode?(0,m.jsxs)("tr",{className:o.state.highlight?"tr-highlight":"",onMouseEnter:o.onMouseEnter,onMouseOver:o.onMouseOver,onMouseLeave:o.onMouseLeave,onFocus:o.onMouseEnter,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("i",{role:"button",title:o.state.isStarred?(0,h.ih)("Unstar"):(0,h.ih)("Star"),"aria-label":o.state.isStarred?(0,h.ih)("Unstar"):(0,h.ih)("Star"),onClick:o.onToggleStarRepo,className:"op-icon m-0 ".concat(o.state.isStarred?"sf3-font-star":"sf3-font-star-empty"," sf3-font")})}),(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:n,title:r,alt:r,width:"24"})}),(0,m.jsx)("td",{children:o.state.isRenaming?(0,m.jsx)(Zt.Z,{name:l.repo_name,onRenameConfirm:o.onRenameConfirm,onRenameCancel:o.onRenameCancel}):(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(c.rU,{to:i,children:l.repo_name}),l.monitored&&(0,m.jsx)(Pe,{repoID:l.repo_id,className:"ml-1 op-icon"})]})}),(0,m.jsx)("td",{children:o.state.isOperationShow&&o.generatorPCMenu()}),(0,m.jsx)("td",{children:l.size}),(0,m.jsx)("td",{title:S()(l.last_modified).format("llll"),children:S()(l.last_modified).fromNow()}),(0,m.jsx)("td",{title:l.owner_contact_email,children:l.owner_name})]}):(0,m.jsxs)("div",{className:"library-grid-item px-3 d-flex justify-content-between align-items-center",onMouseEnter:o.onMouseEnter,onMouseLeave:o.onMouseLeave,onFocus:o.onMouseEnter,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center text-truncate",children:[(0,m.jsx)("img",{src:n,title:r,alt:r,width:"36",className:"mr-2"}),o.state.isRenaming?(0,m.jsx)(Zt.Z,{name:l.repo_name,onRenameConfirm:o.onRenameConfirm,onRenameCancel:o.onRenameCancel}):(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(c.rU,{to:i,className:"library-name text-truncate",title:l.repo_name,children:l.repo_name}),e&&(0,m.jsx)("i",{role:"button",title:(0,h.ih)("Unstar"),"aria-label":(0,h.ih)("Unstar"),onClick:o.onToggleStarRepo,className:"op-icon library-grid-item-icon sf3-font-star sf3-font"}),l.monitored&&(0,m.jsx)(Pe,{repoID:l.repo_id,className:"op-icon library-grid-item-icon"})]})]}),(0,m.jsx)("div",{className:"flex-shrink-0",children:o.state.isOperationShow&&o.generatorPCMenu()})]})},o.visitRepo=function(){o.state.isRenaming||(0,c.c4)(o.repoURL)},o.renderMobileUI=function(){var e=o.getRepoComputeParams(),t=e.iconUrl,n=e.iconTitle,r=e.libPath,i=o.props.repo;return o.repoURL=r,(0,m.jsx)(a.Fragment,{children:(0,m.jsxs)("tr",{className:o.state.highlight?"tr-highlight":"",onMouseEnter:o.onMouseEnter,onMouseOver:o.onMouseOver,onMouseLeave:o.onMouseLeave,children:[(0,m.jsx)("td",{onClick:o.visitRepo,children:(0,m.jsx)("img",{src:t,title:n,width:"24",alt:n})}),(0,m.jsxs)("td",{onClick:o.visitRepo,children:[o.state.isRenaming?(0,m.jsx)(Zt.Z,{name:i.repo_name,onRenameConfirm:o.onRenameConfirm,onRenameCancel:o.onRenameCancel}):(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(c.rU,{to:r,children:i.repo_name}),i.monitored&&(0,m.jsx)(Pe,{repoID:i.repo_id,className:"ml-1 op-icon"})]}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",title:i.owner_contact_email,children:i.owner_name}),(0,m.jsx)("span",{className:"item-meta-info",children:i.size}),(0,m.jsx)("span",{className:"item-meta-info",title:S()(i.last_modified).format("llll"),children:S()(i.last_modified).fromNow()})]}),(0,m.jsx)("td",{children:o.generatorMobileMenu()})]})})},o.state={highlight:!1,isOperationShow:!1,isItemMenuShow:!1,isAdvancedMenuShown:!1,isShowSharedDialog:!1,isRenaming:!1,isStarred:o.props.repo.starred,isFolderPermissionDialogOpen:!1,isHistorySettingDialogShow:!1,isDeleteDialogShow:!1,isAPITokenDialogShow:!1,isRepoShareAdminDialogOpen:!1,isRepoDeleted:!1,isChangePasswordDialogShow:!1,isResetPasswordDialogShow:!1,isOldFilesAutoDelDialogOpen:!1,isSeaTableIntegrationShow:!1},o.isDeparementOnwerGroupMember=!1,o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.repo,t=e.owner_email.indexOf("@seafile_group")>-1;return(0,m.jsxs)(a.Fragment,{children:[f.c.isDesktop()?this.renderPCUI():this.renderMobileUI(),this.state.isShowSharedDialog&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Te.Z,{itemType:"library",itemName:e.repo_name,itemPath:"/",repoID:e.repo_id,repoEncrypted:e.encrypted,enableDirPrivateShare:!0,userPerm:e.permission,isAdmin:e.is_admin,isGroupOwnedRepo:t,toggleDialog:this.toggleShareDialog})}),this.state.isFolderPermissionDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Pt,{toggleDialog:this.onItemFolderPermissionToggle,repoID:e.repo_id,repoName:e.repo_name,isDepartmentRepo:!0})}),this.state.isDeleteDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(dt.Z,{repo:this.props.repo,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.onItemDelete,toggle:this.onItemDeleteToggle})}),this.state.isHistorySettingDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(pt,{repoID:e.repo_id,itemName:e.repo_name,toggleDialog:this.onHistorySettingToggle})}),this.state.isAPITokenDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Ht,{repo:e,onRepoAPITokenToggle:this.onAPITokenToggle})}),this.state.isRepoShareAdminDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(fn,{repo:e,toggleDialog:this.toggleRepoShareAdminDialog})}),this.state.isChangePasswordDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(ht,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onChangePasswordToggle})}),this.state.isResetPasswordDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(ft,{repoID:e.repo_id,toggleDialog:this.onResetPasswordToggle})}),this.state.isOldFilesAutoDelDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(mn,{repoID:e.repo_id,toggleDialog:this.toggleOldFilesAutoDelDialog})}),this.state.isSeaTableIntegrationShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(on,{repo:e,onSeaTableIntegrationToggle:this.onSeaTableIntegrationToggle})})]})}}]),n}(a.Component),kn=Dn,jn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).sortByName=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortItems("name",t)},o.sortByTime=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortItems("time",t)},o.sortBySize=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortItems("size",t)},o.getSortMetaData=function(){return{sortByName:"name"==o.props.sortBy,sortByTime:"time"==o.props.sortBy,sortBySize:"size"==o.props.sortBy,sortIcon:"asc"==o.props.sortOrder?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"})}},o.onFreezedItem=function(){o.setState({isItemFreezed:!0})},o.onUnfreezedItem=function(){o.setState({isItemFreezed:!1})},o.onItemRename=function(e,t){if(o.props.repoList.some((function(e){return e.name===t}))){var n=(0,h.ih)('The name "{name}" is already taken. Please choose a different name.');return n=n.replace("{name}",f.c.HTMLescape(t)),W.Z.danger(n),!1}o.props.onItemRename(e,t)},o.renderRepoListView=function(){var e=o.props.currentViewMode,t=void 0===e?"list":e;return(0,m.jsx)(a.Fragment,{children:o.props.repoList.map((function(e){return(0,m.jsx)(kn,{repo:e,libraryType:o.props.libraryType,currentGroup:o.props.currentGroup,isItemFreezed:o.state.isItemFreezed,onFreezedItem:o.onFreezedItem,onUnfreezedItem:o.onUnfreezedItem,onItemUnshare:o.props.onItemUnshare,onItemDelete:o.props.onItemDelete,onItemRename:o.props.onItemRename,onMonitorRepo:o.props.onMonitorRepo,currentViewMode:t},e.repo_id)}))})},o.renderPCUI=function(){var e=o.props,t=e.theadHidden,n=void 0!==t&&t,r=e.currentViewMode,i=void 0===r?"list":r,s=o.getSortMetaData(),a=s.sortByName,l=s.sortByTime,c=s.sortBySize,d=s.sortIcon;return"list"==i?(0,m.jsxs)("table",{className:n?"table-thead-hidden":"",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.ih)("Library Type")})}),(0,m.jsx)("th",{width:"35%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:o.sortByName,children:[(0,h.ih)("Name")," ",a&&d]})}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.ih)("Actions")})}),(0,m.jsx)("th",{width:"14%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:o.sortBySize,children:[(0,h.ih)("Size")," ",c&&d]})}),(0,m.jsx)("th",{width:"17%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:o.sortByTime,children:[(0,h.ih)("Last Update")," ",l&&d]})}),(0,m.jsx)("th",{width:"17%",children:(0,h.ih)("Owner")})]})}),(0,m.jsx)("tbody",{children:o.renderRepoListView()})]}):(0,m.jsx)("div",{className:"d-flex justify-content-between flex-wrap",children:o.renderRepoListView()})},o.renderMobileUI=function(){return(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)(Re,{}),(0,m.jsx)("tbody",{children:o.renderRepoListView()})]})},o.state={isItemFreezed:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=f.c.isDesktop()?this.renderPCUI():this.renderMobileUI();return this.props.hasNextPage?(0,m.jsxs)(a.Fragment,{children:[e,(0,m.jsx)(D.Z,{})]}):e}}]),n}(a.Component),In=jn,Mn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onRepoSelect=function(t){var n=t.target.checked;e.props.onRepoSelect(e.props.repo,n)},e.onPermissionChange=function(t){var n=t.target.value,r=e.props.repo;e.props.onPermissionChange(r,n)},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.repo,t=f.c.getLibIconUrl(e);return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("input",{type:"checkbox",className:"vam",name:"repo",onChange:this.onRepoSelect})}),(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:t,width:"24",alt:(0,h.ih)("icon")})}),(0,m.jsx)("td",{className:"name",children:e.repo_name}),(0,m.jsx)("td",{children:S()(e.last_modified).fromNow()}),(0,m.jsx)("td",{children:(0,m.jsxs)(L.Z,{style:{height:"1.5rem",padding:0},type:"select",name:"select",onChange:this.onPermissionChange,value:e.sharePermission,children:[(0,m.jsx)("option",{value:"rw",children:(0,h.ih)("Read-Write")}),(0,m.jsx)("option",{value:"r",children:(0,h.ih)("Read-Only")})]})})]})}}]),n}(a.Component),_n=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onRepoSelect=function(e,t){var n=[];t?(o.state.selectedRepoList.push(e),n=o.state.selectedRepoList):n=o.state.selectedRepoList.filter((function(t){return t.repo_id!==e.repo_id})),o.setState({selectedRepoList:n})},o.onPermissionChange=function(e,t){var n=o.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.sharePermission=t),n}));o.setState({repoList:n})},o.handleSubmit=function(){if(0!==o.state.selectedRepoList.length)o.props.onRepoSelectedHandler(o.state.selectedRepoList),o.onCloseDialog();else{var e=(0,h.ih)("Please select a library to share.");o.setState({errMessage:e})}},o.onCloseDialog=function(){o.props.onShareRepoDialogClose()},o.state={repoList:[],currentRepo:null,permission:"rw",selectedRepoList:[],errMessage:""},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.listRepos({type:"mine"}).then((function(t){var n=t.data.repos.map((function(e){var t=new Ne(e);return t.sharePermission="rw",t}));e.setState({repoList:n})}))}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:(0,h.ih)("Select libraries to share")}),(0,m.jsx)(M.Z,{className:"dialog-list-container",children:(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"6%"}),(0,m.jsx)("th",{width:"35%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"25%",children:(0,h.ih)("Last Update")}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("Permission")})]})}),(0,m.jsx)("tbody",{children:this.state.repoList.map((function(t,n){return(0,m.jsx)(Mn,{repo:t,onRepoSelect:e.onRepoSelect,onPermissionChange:e.onPermissionChange},n)}))})]})}),this.state.errMessage&&(0,m.jsx)(st.Z,{color:"danger",className:"mt-2",children:this.state.errMessage}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.onCloseDialog,children:(0,h.ih)("Close")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.handleSubmit,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),Nn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onCreateRepo=function(e){C.I.createPublicRepo(e).then((function(e){var t={repo_id:e.data.id,repo_name:e.data.name,permission:e.data.permission,size:e.data.size,owner_name:e.data.owner_name,owner_email:e.data.owner,mtime:e.data.mtime,encrypted:e.data.encrypted},n=new Ne(t);o.props.addRepoItem(n),o.onCreateRepoToggle()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onRepoSelectedHandler=function(e){e.forEach((function(e){C.I.selectOwnedRepoToPublic(e.repo_id,{share_type:"public",permission:e.sharePermission}).then((function(){o.props.addRepoItem(e)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}))},o.onAddRepoToggle=function(){o.setState({isCreateMenuShow:!o.state.isCreateMenuShow})},o.onCreateRepoToggle=function(){o.setState({isCreateRepoDialogShow:!o.state.isCreateRepoDialogShow})},o.onSelectRepoToggle=function(){o.setState({isSelectRepoDialpgShow:!o.state.isSelectRepoDialpgShow})},o.state={libraryType:"public",isCreateMenuShow:!1,isCreateRepoDialogShow:!1,isSelectRepoDialpgShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{className:"cur-view-toolbar",children:[(0,m.jsx)("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:"Side Nav Menu",onClick:this.props.onShowSidePanel}),(0,m.jsx)("div",{className:"operation",children:(0,m.jsxs)(H.Z,{isOpen:this.state.isCreateMenuShow,toggle:this.onAddRepoToggle,children:[(0,m.jsx)(u(),{query:"(min-width: 768px)",children:(0,m.jsxs)(Y.Z,{className:"btn btn-secondary operation-item",children:[(0,m.jsx)("i",{className:"sf3-font sf3-font-enlarge text-secondary mr-1"}),(0,h.ih)("Add Library")]})}),(0,m.jsx)(u(),{query:"(max-width: 767.8px)",children:(0,m.jsx)(Y.Z,{tag:"span",className:"sf2-icon-plus mobile-toolbar-icon",title:(0,h.ih)("Add Library")})}),(0,m.jsxs)(Me.Z,{children:[(0,m.jsx)(V.Z,{onClick:this.onSelectRepoToggle,children:(0,h.ih)("Share existing libraries")}),(0,m.jsx)(V.Z,{onClick:this.onCreateRepoToggle,children:(0,h.ih)("New Library")})]})]})})]}),this.state.isCreateRepoDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(lt,{libraryType:this.state.libraryType,onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo})}),this.state.isSelectRepoDialpgShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(_n,{onRepoSelectedHandler:this.onRepoSelectedHandler,onShareRepoDialogClose:this.onSelectRepoToggle})})]})}}]),n}(a.Component),Rn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onItemUnshare=function(e){C.I.unshareRepo(e.repo_id,{share_type:"public"}).then((function(){var t=o.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));o.setState({repoList:t});var n=(0,h.ih)("Successfully unshared {name}").replace("{name}",e.repo_name);W.Z.success(n)})).catch((function(t){var n=f.c.getErrorMsg(t);n===(0,h.ih)("Error")&&(n=(0,h.ih)("Failed to unshare {name}").replace("{name}",e.repo_name)),(0,W.Z)(n)}))},o.onItemDelete=function(){},o.addRepoItem=function(e){for(var t=!1,n=0,r=o.state.repoList,i=0;i<r.length;i++)if(e.repo_id===r[i].repo_id){t=!0,n=i;break}t&&o.state.repoList.splice(n,1);var s=o.state.repoList.map((function(e){return e}));s.unshift(e),o.setState({repoList:s})},o.sortItems=function(e,t){_e.ZP.save("seafile-repo-dir-sort-by",e),_e.ZP.save("seafile-repo-dir-sort-order",t),o.setState({sortBy:e,sortOrder:t,repoList:f.c.sortRepos(o.state.repoList,e,t)})},o.toggleSortOptionsDialog=function(){o.setState({isSortOptionsDialogOpen:!o.state.isSortOptionsDialogOpen})},o.renderContent=function(){var e=o.props,t=e.inAllLibs,n=void 0!==t&&t,r=e.currentViewMode,i=void 0===r?"list":r,s=o.state.errMessage,a=n?(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(i,"-mode"),children:(0,h.ih)("No public libraries")}):(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No public libraries")}),(0,m.jsx)("p",{children:(0,h.ih)('No public libraries have been created yet. A public library is accessible by all users. You can create a public library by clicking the "Add Library" button in the menu bar.')})]});return(0,m.jsxs)(m.Fragment,{children:[o.state.isLoading&&(0,m.jsx)(D.Z,{}),!o.state.isLoading&&s&&s,!o.state.isLoading&&0===o.state.repoList.length&&a,!o.state.isLoading&&o.state.repoList.length>0&&(0,m.jsx)(In,{libraryType:o.state.libraryType,repoList:o.state.repoList,sortBy:o.state.sortBy,sortOrder:o.state.sortOrder,sortItems:o.sortItems,onItemUnshare:o.onItemUnshare,onItemDelete:o.onItemDelete,theadHidden:n,currentViewMode:i})]})},o.renderSortIconInMobile=function(){return(0,m.jsx)(m.Fragment,{children:!f.c.isDesktop()&&o.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:o.toggleSortOptionsDialog})})},o.state={isLoading:!0,errMessage:"",repoList:[],sortBy:_e.ZP.load("seafile-repo-dir-sort-by")||"name",sortOrder:_e.ZP.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1,libraryType:"public"},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.repoList?this.setState({isLoading:!1,repoList:f.c.sortRepos(this.props.repoList,this.state.sortBy,this.state.sortOrder)}):C.I.listRepos({type:"public"}).then((function(t){var n=t.data.repos.map((function(e){return new Ne(e)}));e.setState({isLoading:!1,repoList:f.c.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({isLoading:!1,errMessage:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.props,t=e.inAllLibs,n=void 0!==t&&t,r=e.currentViewMode,o=void 0===r?"list":r;return n?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat("list"==o?"sf-border-bottom":""),children:[(0,m.jsxs)("h4",{className:"sf-heading m-0",children:[(0,m.jsx)("span",{className:"sf3-font-share-with-all sf3-font nav-icon","aria-hidden":"true"}),(0,h.ih)("Shared with all")]}),this.renderSortIconInMobile()]}),this.renderContent()]}):(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{className:"main-panel-north border-left-show",children:[h.un&&(0,m.jsx)(Nn,{onShowSidePanel:this.props.onShowSidePanel,addRepoItem:this.addRepoItem}),(0,m.jsx)(xn.Z,{onSearchedClick:this.props.onSearchedClick})]}),(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,h.ih)("Shared with all")}),this.renderSortIconInMobile()]}),(0,m.jsx)("div",{className:"cur-view-content",children:this.renderContent()})]})}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(ve,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})]})}}]),n}(a.Component),Tn=Rn,On=n(30207),En=n.n(On),Pn=""!==h.NZ?En()(h.NZ):void 0,Zn=new(function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,[{key:"watchRepo",value:function(e,t){Pn&&(Pn.emit("repo_update",{request:"watch_update",repo_id:e,user:{name:h.u2,username:h.b6,contact_email:h.Ru}}),Pn.on("repo_update",t))}},{key:"unwatchRepo",value:function(e,t){Pn&&(Pn.emit("repo_update",{request:"unwatch_update",repo_id:e,user:{name:h.u2,username:h.b6,contact_email:h.Ru}}),Pn.off("repo_update",t))}}]),e}()),Fn=n(55668),Ln=n(19725),An=n(69443),Un=n(61166),zn=n(70609),Bn=n(47809),Gn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleSubmit=function(e){var t=o.props.repoID,n=o.state.password;C.I.setRepoDecryptPassword(t,n).then((function(e){o.props.onLibDecryptDialog()})).catch((function(e){o.setState({showError:!0})})),e.preventDefault()},o.handleKeyDown=function(e){"Enter"==e.key&&o.handleSubmit(e)},o.handleChange=function(e){o.setState({password:e.target.value,showError:!1})},o.toggle=function(){window.location.href=h.ze},o.state={password:"",showError:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsx)(p.Z,{isOpen:!0,toggle:this.toggle,children:(0,m.jsxs)(M.Z,{children:[(0,m.jsx)("button",{type:"button",className:"close",onClick:this.toggle,children:(0,m.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),(0,m.jsxs)(rt.Z,{className:"lib-decrypt-form text-center",children:[(0,m.jsx)("img",{src:"".concat(h.si,"img/lock.png"),alt:"","aria-hidden":"true"}),(0,m.jsx)("p",{className:"intro",children:(0,h.ih)("This library is password protected")}),this.state.showError&&(0,m.jsx)("p",{className:"error",children:(0,h.ih)("Wrong password")}),(0,m.jsx)("input",{type:"password",name:"password",className:"form-control password-input",autoComplete:"off",onKeyDown:this.handleKeyDown,placeholder:(0,h.ih)("Password"),onChange:this.handleChange}),(0,m.jsx)("button",{type:"submit",className:"btn btn-primary submit",onClick:this.handleSubmit,children:(0,h.ih)("Submit")}),(0,m.jsxs)("p",{className:"tip",children:["* ",(0,h.ih)("The password will be kept in the server for only 1 hour.")]})]})]})})}}]),n}(a.Component),Hn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("div",{className:"cur-view-toolbar",children:(0,m.jsx)("span",{className:"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle",title:(0,h.ih)("Side Nav Menu"),onClick:this.props.onSideNavMenuClick})}),(0,m.jsx)(xn.Z,{isLibView:!0,path:this.props.path,isViewFile:this.props.isViewFile,repoID:this.props.repoID,repoName:this.props.repoName,currentRepoInfo:this.props.currentRepoInfo,onSearchedClick:this.props.onSearchedClick,searchPlaceholder:(0,h.ih)("Search files")})]})}}]),n}(a.Component),Yn=Hn,Vn=n(44028),Wn=n(30166),Kn=n(1631),qn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleDesktopOpMenu=function(){o.setState({isDesktopMenuOpen:!o.state.isDesktopMenuOpen})},o.toggleMobileOpMenu=function(){o.setState({isMobileOpMenuOpen:!o.state.isMobileOpMenuOpen})},o.onUploadFile=function(e){o.props.onUploadFile(e)},o.onUploadFolder=function(e){o.props.onUploadFolder(e)},o.onShareClick=function(){o.setState({isShareDialogShow:!o.state.isShareDialogShow})},o.onCreateFolderToggle=function(){o.setState({isCreateFolderDialogShow:!o.state.isCreateFolderDialogShow})},o.onCreateFileToggle=function(){o.setState({isCreateFileDialogShow:!o.state.isCreateFileDialogShow,fileType:""})},o.onCreateMarkdownToggle=function(){o.setState({isCreateFileDialogShow:!o.state.isCreateFileDialogShow,fileType:".md"})},o.onCreateExcelToggle=function(){o.setState({isCreateFileDialogShow:!o.state.isCreateFileDialogShow,fileType:".xlsx"})},o.onCreatePPTToggle=function(){o.setState({isCreateFileDialogShow:!o.state.isCreateFileDialogShow,fileType:".pptx"})},o.onCreateWordToggle=function(){o.setState({isCreateFileDialogShow:!o.state.isCreateFileDialogShow,fileType:".docx"})},o.onCreateSeaDocToggle=function(){o.setState({isCreateFileDialogShow:!o.state.isCreateFileDialogShow,fileType:".sdoc"})},o.onAddFolder=function(e){o.setState({isCreateFolderDialogShow:!1}),o.props.onAddFolder(e)},o.checkDuplicatedName=function(e){return o.props.direntList.some((function(t){return t.name===e}))},o.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.toggleDesktopOpMenu()},o.onDropDownMouseMove=function(e){o.state.isSubMenuShown&&e.target&&"dropdown-item"===e.target.className&&o.setState({isSubMenuShown:!1})},o.toggleSubMenu=function(e){e.stopPropagation(),o.setState({isSubMenuShown:!o.state.isSubMenuShown})},o.toggleSubMenuShown=function(e){o.setState({isSubMenuShown:!0,currentItem:e.text})},o.onMenuItemKeyDown=function(e,t){"Enter"!=t.key&&"Space"!=t.key||e.onClick()},o.state={fileType:".md",isCreateFileDialogShow:!1,isCreateFolderDialogShow:!1,isShareDialogShow:!1,operationMenuStyle:"",isDesktopMenuOpen:!1,isSubMenuShown:!1,isMobileOpMenuOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.path,r=t.repoName,o=t.userPerm,i="/"===n?"library":"dir",s="/"==n?r:f.c.getFolderName(n),l=f.c.getUserPermission(o),c=l.isCustomPermission,d=l.customPermission,u=!0,p=!0;if(c){var g=d.permission;u=g.upload,p=g.create}var v=null;if(f.c.isDesktop()){var y=this.props,x=y.showShareBtn,w=y.repoEncrypted,b=[];if(u&&(f.c.isSupportUploadFolder()?b.push({icon:"upload-files",text:(0,h.ih)("Upload"),subOpList:[{text:(0,h.ih)("Upload Files"),onClick:this.onUploadFile},{text:(0,h.ih)("Upload Folder"),onClick:this.onUploadFolder}]}):b.push({icon:"upload-files",text:(0,h.ih)("Upload"),onClick:this.onUploadFile})),p){var S=[{text:(0,h.ih)("New Folder"),onClick:this.onCreateFolderToggle},{text:(0,h.ih)("New File"),onClick:this.onCreateFileToggle},"Divider",{text:(0,h.ih)("New Markdown File"),onClick:this.onCreateMarkdownToggle},{text:(0,h.ih)("New Excel File"),onClick:this.onCreateExcelToggle},{text:(0,h.ih)("New PowerPoint File"),onClick:this.onCreatePPTToggle},{text:(0,h.ih)("New Word File"),onClick:this.onCreateWordToggle}];h.np&&!w&&S.push({text:(0,h.ih)("New SeaDoc File"),onClick:this.onCreateSeaDocToggle}),b.push({icon:"new",text:(0,h.ih)("New"),subOpList:S})}x&&b.push({icon:"share",text:(0,h.ih)("Share"),onClick:this.onShareClick}),v=(0,m.jsx)(a.Fragment,{children:(0,m.jsxs)(H.Z,{isOpen:this.state.isDesktopMenuOpen,toggle:this.toggleDesktopOpMenu,children:[(0,m.jsxs)(Y.Z,{tag:"div",role:"button",className:"path-item",onClick:this.toggleDesktopOpMenu,onKeyDown:this.onDropdownToggleKeyDown,"data-toggle":"dropdown",children:[this.props.children,(0,m.jsx)("i",{className:"sf3-font-down sf3-font ml-1 path-item-dropdown-toggle"})]}),(0,m.jsx)(Me.Z,{onMouseMove:this.onDropDownMouseMove,children:b.map((function(t,n){return"Divider"==t?(0,m.jsx)(V.Z,{divider:!0},n):t.subOpList?(0,m.jsxs)(H.Z,{direction:"right",className:"w-100",isOpen:e.state.isSubMenuShown&&e.state.currentItem==t.text,toggle:e.toggleSubMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsxs)(Y.Z,{tag:"div",className:"dropdown-item font-weight-normal rounded-0 d-flex align-items-center",onMouseEnter:e.toggleSubMenuShown.bind(e,t),children:[(0,m.jsx)("i",{className:"sf3-font-".concat(t.icon," sf3-font mr-2 dropdown-item-icon")}),(0,m.jsx)("span",{className:"mr-auto",children:t.text}),(0,m.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,m.jsx)(Me.Z,{children:t.subOpList.map((function(t,n){return"Divider"==t?(0,m.jsx)(V.Z,{divider:!0},n):(0,m.jsx)(V.Z,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:t.text},n)}))})]},n):(0,m.jsxs)(V.Z,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:[(0,m.jsx)("i",{className:"sf3-font-".concat(t.icon," sf3-font mr-2 dropdown-item-icon")}),t.text]},n)}))})]})})}else v=(0,m.jsxs)(H.Z,{isOpen:this.state.isMobileOpMenuOpen,toggle:this.toggleMobileOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"span",className:"sf2-icon-plus mobile-toolbar-icon"}),(0,m.jsxs)(Me.Z,{children:[u&&(0,m.jsx)(V.Z,{onClick:this.onUploadFile,children:(0,h.ih)("Upload")}),p&&(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(V.Z,{onClick:this.onCreateFolderToggle,children:(0,h.ih)("New Folder")}),(0,m.jsx)(V.Z,{onClick:this.onCreateFileToggle,children:(0,h.ih)("New File")})]})]})]});return(0,m.jsxs)(a.Fragment,{children:[("rw"===o||"admin"===o||"cloud-edit"===o||c)&&(0,m.jsx)("div",{className:"dir-operation",children:v}),this.state.isCreateFileDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Kn.Z,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onCreateFileToggle})}),this.state.isCreateFolderDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Wn.Z,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})}),this.state.isShareDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Te.Z,{itemType:i,itemName:s,itemPath:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.onShareClick})})]})}}]),n}(a.Component),$n=qn,Xn=n(78655),Jn=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).inputNewName=function(e){o.setState({tagName:e.target.value}),o.state.errorMsg&&o.setState({errorMsg:""})},o.selectTagcolor=function(e){o.setState({tagColor:e.target.value})},o.createTag=function(){var e=o.state.tagName,t=o.state.tagColor,n=o.props.repoID;C.I.createRepoTag(n,e,t).then((function(e){var t=e.data.repo_tag.repo_tag_id;o.props.onRepoTagCreated&&o.props.onRepoTagCreated(t),o.props.toggleCancel()})).catch((function(t){var n;500===t.response.status?n=(0,h.ih)("Internal Server Error"):400===t.response.status&&(n=(n=(0,h.ih)('Tag "{name}" already exists.')).replace("{name}",f.c.HTMLescape(e))),o.setState({errorMsg:n})}))},o.handleKeyDown=function(e){"Enter"===e.key&&o.createTag()},o.state={tagName:"",tagColor:Xn.QQ[0],newTag:{},errorMsg:""},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=!!this.state.tagName.trim();return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)(I.Z,{toggle:this.props.onClose,children:[(0,m.jsx)("span",{className:"tag-dialog-back sf3-font sf3-font-arrow rotate-180 d-inline-block",onClick:this.props.toggleCancel,"aria-label":(0,h.ih)("Back")}),(0,h.ih)("New Tag")]}),(0,m.jsx)(M.Z,{children:(0,m.jsxs)("div",{role:"form",className:"tag-create",children:[(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{className:"form-label",children:(0,h.ih)("Name")}),(0,m.jsx)(L.Z,{onKeyDown:this.handleKeyDown,autoFocus:!0,value:this.state.tagName,onChange:this.inputNewName}),(0,m.jsx)("div",{className:"mt-2",children:(0,m.jsx)("span",{className:"error",children:this.state.errorMsg})})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{className:"form-label",children:(0,h.ih)("Select a color")}),(0,m.jsx)("div",{className:"d-flex justify-content-between",children:Xn.QQ.map((function(t,n){return(0,m.jsx)("div",{className:"tag-color-option",onChange:e.selectTagcolor,children:(0,m.jsxs)("label",{className:"colorinput",children:[0===n?(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:!0,onClick:e.selectTagcolor}):(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",onClick:e.selectTagcolor}),(0,m.jsx)("span",{className:"colorinput-color rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:t},children:(0,m.jsx)("i",{className:"sf2-icon-tick color-selected"})})]})},n)}))})]})]})}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.props.toggleCancel,children:(0,h.ih)("Cancel")}),t?(0,m.jsx)(R.Z,{color:"primary",onClick:this.createTag,children:(0,h.ih)("Save")}):(0,m.jsx)(R.Z,{color:"primary",disabled:!0,children:(0,h.ih)("Save")})]})]})}}]),n}(a.Component);n(6251);var Qn,er=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.setState({isTagHighlighted:!0})},o.onMouseLeave=function(){o.setState({isTagHighlighted:!1})},o.getRepoTagIdList=function(){return(o.props.fileTagList||[]).map((function(e){return e.repo_tag_id}))},o.onEditFileTag=function(){var e=o.props,t=e.repoID,n=e.repoTag,r=e.filePath,i=o.getRepoTagIdList();if(-1===i.indexOf(n.id)){var s=n.id;C.I.addFileTag(t,r,s).then((function(){i=o.getRepoTagIdList(),o.props.onFileTagChanged()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}else{for(var a=null,l=o.props.fileTagList,c=0;c<l.length;c++)if(l[c].repo_tag_id===n.id){a=l[c];break}C.I.deleteFileTag(t,a.id).then((function(){i=o.getRepoTagIdList(),o.props.onFileTagChanged()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}},o.state={isTagHighlighted:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state.isTagHighlighted,t=this.props.repoTag,n=-1!=this.getRepoTagIdList().indexOf(t.id);return(0,m.jsxs)("li",{className:"tag-list-item cursor-pointer px-4 d-flex justify-content-between align-items-center ".concat(e?"hl":""),onClick:this.onEditFileTag,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"tag-color w-4 h-4 rounded-circle",style:{backgroundColor:t.color}}),(0,m.jsx)("span",{className:"tag-name mx-2",children:t.name})]}),n&&(0,m.jsx)("i",{className:"sf2-icon-tick tag-selected-icon"})]})}}]),n}(a.Component),tr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props.repoTags;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(I.Z,{toggle:this.props.toggleCancel,children:(0,h.ih)("Select Tags")}),(0,m.jsxs)(M.Z,{className:"px-0",children:[(0,m.jsx)("ul",{className:"tag-list tag-list-container",children:t.map((function(t){return(0,m.jsx)(er,{repoTag:t,repoID:e.props.repoID,filePath:e.props.filePath,fileTagList:e.props.fileTagList,onFileTagChanged:e.props.onFileTagChanged},t.id)}))}),(0,m.jsxs)("a",{href:"#",className:"add-tag-link px-4 py-2 d-flex align-items-center",onClick:this.props.createNewTag,children:[(0,m.jsx)("span",{className:"sf2-icon-plus mr-2"}),(0,h.ih)("Create a new tag")]})]}),(0,m.jsx)(N.Z,{children:(0,m.jsx)(R.Z,{onClick:this.props.toggleCancel,children:(0,h.ih)("Close")})})]})}}]),n}(a.Component),nr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).createNewTag=function(){o.setState({isCreateRepoTagShow:!o.state.isCreateRepoTagShow,isListRepoTagShow:!o.state.isListRepoTagShow})},o.onRepoTagCreated=function(e){var t=o.props,n=t.repoID,r=t.filePath;C.I.addFileTag(n,r,e).then((function(){o.props.onFileTagChanged()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={isCreateRepoTagShow:!1,isListRepoTagShow:!0},o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.props.toggleCancel,autoFocus:!1,children:[this.state.isListRepoTagShow&&(0,m.jsx)(tr,{repoID:this.props.repoID,repoTags:this.props.repoTags,filePath:this.props.filePath,fileTagList:this.props.fileTagList,onFileTagChanged:this.props.onFileTagChanged,toggleCancel:this.props.toggleCancel,createNewTag:this.createNewTag}),this.state.isCreateRepoTagShow&&(0,m.jsx)(Jn,{repoID:this.props.repoID,onClose:this.props.toggleCancel,toggleCancel:this.createNewTag,onRepoTagCreated:this.onRepoTagCreated})]})}}]),n}(a.Component),rr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleDropdownMenu=function(){o.setState({isDropdownMenuOpen:!o.state.isDropdownMenuOpen})},o.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.toggleDropdownMenu()},o.onDropDownMouseMove=function(e){o.state.isSubMenuShown&&e.target&&"dropdown-item"===e.target.className&&o.setState({isSubMenuShown:!1})},o.toggleSubMenu=function(e){e.stopPropagation(),o.setState({isSubMenuShown:!o.state.isSubMenuShown},(function(){o.toggleDropdownMenu()}))},o.toggleSubMenuShown=function(e){o.setState({isSubMenuShown:!0,currentItem:e.text})},o.onMenuItemKeyDown=function(e,t){"Enter"!=t.key&&"Space"!=t.key||e.onClick()},o.onEditClick=function(e){e.preventDefault();var t=o.props,n=t.path,r=t.repoID,i=h.ze+"lib/"+r+"/file"+f.c.encodePath(n)+"?mode=edit";window.open(i)},o.toggleMore=function(){o.setState({isMoreMenuShow:!o.state.isMoreMenuShow})},o.onShareToggle=function(){o.setState({isShareDialogShow:!o.state.isShareDialogShow})},o.onEditFileTagToggle=function(){o.setState({isEditTagDialogShow:!o.state.isEditTagDialogShow})},o.onHistoryClick=function(){var e=h.ze+"repo/file_revisions/"+o.props.repoID+"/?p="+f.c.encodePath(o.props.path);location.href=e},o.state={isDropdownMenuOpen:!1,isMoreMenuShow:!1,isShareDialogShow:!1,isEditTagDialogShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.filePermission,r=t.showShareBtn,o=[];return"rw"!==n&&"cloud-edit"!==n||o.push({icon:"rename",text:(0,h.ih)("Edit"),onClick:this.onEditClick}),"rw"===n&&(r&&o.push({icon:"share",text:(0,h.ih)("Share"),onClick:this.onShareToggle}),o.push({icon:"tag",text:(0,h.ih)("Tags"),onClick:this.onEditFileTagToggle},{icon:"history",text:(0,h.ih)("History"),onClick:this.onHistoryClick})),(0,m.jsxs)(a.Fragment,{children:[o.length>0&&(0,m.jsxs)(H.Z,{isOpen:this.state.isDropdownMenuOpen,toggle:this.toggleDropdownMenu,children:[(0,m.jsxs)(Y.Z,{tag:"div",role:"button",className:"path-item",onClick:this.toggleDropdownMenu,onKeyDown:this.onDropdownToggleKeyDown,"data-toggle":"dropdown",children:[this.props.children,(0,m.jsx)("i",{className:"sf3-font-down sf3-font ml-1 path-item-dropdown-toggle"})]}),(0,m.jsx)(Me.Z,{onMouseMove:this.onDropDownMouseMove,children:o.map((function(t,n){return"Divider"==t?(0,m.jsx)(V.Z,{divider:!0},n):t.subOpList?(0,m.jsxs)(H.Z,{direction:"right",className:"w-100",isOpen:e.state.isSubMenuShown&&e.state.currentItem==t.text,toggle:e.toggleSubMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsxs)(Y.Z,{className:"dropdown-item font-weight-normal rounded-0 d-flex align-items-center",onMouseEnter:e.toggleSubMenuShown.bind(e,t),children:[(0,m.jsx)("i",{className:"sf3-font-".concat(t.icon," sf3-font mr-2 dropdown-item-icon")}),(0,m.jsx)("span",{className:"mr-auto",children:t.text}),(0,m.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,m.jsx)(Me.Z,{children:t.subOpList.map((function(t,n){return"Divider"==t?(0,m.jsx)(V.Z,{divider:!0},n):(0,m.jsx)(V.Z,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:t.text},n)}))})]},n):(0,m.jsxs)(V.Z,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:[(0,m.jsx)("i",{className:"sf3-font-".concat(t.icon," sf3-font mr-2 dropdown-item-icon")}),t.text]},n)}))})]}),this.state.isShareDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Te.Z,{itemType:"file",itemName:f.c.getFileName(this.props.path),itemPath:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.onShareToggle})}),this.state.isEditTagDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(nr,{filePath:this.props.path,repoID:this.props.repoID,repoTags:this.props.repoTags,fileTagList:this.props.fileTags,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.props.onFileTagChanged})})]})}}]),n}(a.Component),or=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onPathClick=function(t){var n=f.c.getEventData(t,"path");e.props.onPathClick(n)},e.onTabNavClick=function(t,n,r){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress){if(!window.confirm((0,h.ih)("A file is being uploaded. Are you sure you want to leave this page?")))return t.preventDefault(),!1;window.uploader.isUploadProgressDialogShow=!1}e.props.onTabNavClick(n,r)},e.turnPathToLink=function(t){var n=(t="/"===t[t.length-1]?t.slice(0,t.length-1):t).split("/"),r="";return n.map((function(t,o){return""===t?null:o===n.length-1?t===Xn.$s.FILE_EXTENDED_PROPERTIES?(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-item",children:(0,h.ih)("File extended properties")})]},o):(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),e.props.isViewFile?(0,m.jsx)(rr,{path:e.props.currentPath,repoID:e.props.repoID,userPerm:e.props.userPerm,repoEncrypted:e.props.repoEncrypted,enableDirPrivateShare:e.props.enableDirPrivateShare,isGroupOwnedRepo:e.props.isGroupOwnedRepo,filePermission:e.props.filePermission,fileTags:e.props.fileTags,onFileTagChanged:e.props.onFileTagChanged,showShareBtn:e.props.showShareBtn,repoTags:e.props.repoTags,children:(0,m.jsx)("span",{className:"path-file-name",children:t})}):(0,m.jsx)($n,{path:e.props.currentPath,repoID:e.props.repoID,repoName:e.props.repoName,repoEncrypted:e.props.repoEncrypted,direntList:e.props.direntList,showShareBtn:e.props.showShareBtn,enableDirPrivateShare:e.props.enableDirPrivateShare,userPerm:e.props.userPerm,isGroupOwnedRepo:e.props.isGroupOwnedRepo,onAddFile:e.props.onAddFile,onAddFolder:e.props.onAddFolder,onUploadFile:e.props.onUploadFile,onUploadFolder:e.props.onUploadFolder,children:(0,m.jsx)("span",{className:"path-file-name",children:t})})]},o):(r+="/"+t,(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-item","data-path":r,onClick:e.onPathClick,role:"button",children:t})]},o))}))},e.isViewMetadata=function(){var t=e.props.currentPath,n=("/"===t[t.length-1]?t.slice(0,t.length-1):t).split("/");return n[n.length-1]===Xn.$s.FILE_EXTENDED_PROPERTIES},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentPath,r=t.repoName,o=t.fileTags,i=this.turnPathToLink(n),s="";return o.length>0&&o.forEach((function(e){s+=e.name+" "})),(0,m.jsxs)("div",{className:"path-container dir-view-path",children:[(0,m.jsx)("span",{className:"cur-view-path-btn mr-1",onClick:this.props.toggleTreePanel,children:(0,m.jsx)("span",{className:"sf3-font-side-bar sf3-font"})}),this.props.pathPrefix&&this.props.pathPrefix.map((function(t,n){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(c.rU,{to:t.url,className:"path-item normal",onClick:function(n){return e.onTabNavClick(n,t.name,t.id)},children:(0,h.ih)(t.showName)}),(0,m.jsx)("span",{className:"path-split",children:"/"})]},n)})),this.props.pathPrefix&&0===this.props.pathPrefix.length&&(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(c.rU,{to:h.ze+"libraries/",className:"path-item normal",onClick:function(t){return e.onTabNavClick(t,"libraries")},children:(0,h.ih)("Files")}),(0,m.jsx)("span",{className:"path-split",children:"/"})]}),!this.props.pathPrefix&&(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(c.rU,{to:h.ze+"libraries/",className:"path-item normal",onClick:function(t){return e.onTabNavClick(t,"libraries")},children:(0,h.ih)("Files")}),(0,m.jsx)("span",{className:"path-split",children:"/"})]}),"/"===n||""===n?(0,m.jsx)($n,{path:this.props.currentPath,repoID:this.props.repoID,repoName:this.props.repoName,repoEncrypted:this.props.repoEncrypted,direntList:this.props.direntList,showShareBtn:this.props.showShareBtn,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,onAddFile:this.props.onAddFile,onAddFolder:this.props.onAddFolder,onUploadFile:this.props.onUploadFile,onUploadFolder:this.props.onUploadFolder,children:(0,m.jsx)("span",{className:"path-repo-name",children:r})}):(0,m.jsx)("span",{className:"path-item","data-path":"/",onClick:this.onPathClick,role:"button",children:r}),i,this.props.isViewFile&&!this.isViewMetadata()&&(0,m.jsx)(Vn.O,{repoID:this.props.repoID,path:this.props.currentPath}),this.props.isViewFile&&0!==o.length&&(0,m.jsxs)("span",{id:"column-mode-file-tags",className:"tag-list tag-list-stacked align-middle ml-1 d-flex align-items-center",children:[o.map((function(e,t){return(0,m.jsx)("span",{className:"file-tag",style:{zIndex:t,backgroundColor:e.color}},e.id)})),(0,m.jsx)(Oe.Z,{target:"column-mode-file-tags",placement:"bottom",children:s})]})]})}}]),n}(a.Component),ir=or,sr=n(1413),ar=n(39131),lr=n(30560),cr={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},dr=new Uint8Array(16);function ur(){if(!Qn&&!(Qn="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Qn(dr)}for(var pr=[],hr=0;hr<256;++hr)pr.push((hr+256).toString(16).slice(1));function fr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return pr[e[t+0]]+pr[e[t+1]]+pr[e[t+2]]+pr[e[t+3]]+"-"+pr[e[t+4]]+pr[e[t+5]]+"-"+pr[e[t+6]]+pr[e[t+7]]+"-"+pr[e[t+8]]+pr[e[t+9]]+"-"+pr[e[t+10]]+pr[e[t+11]]+pr[e[t+12]]+pr[e[t+13]]+pr[e[t+14]]+pr[e[t+15]]}var mr=function(e,t,n){if(cr.randomUUID&&!t&&!e)return cr.randomUUID();var r=(e=e||{}).random||(e.rng||ur)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return fr(r)},gr=n(29389),vr=n(27205),yr=(n(6251),function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).togglePopover=function(){o.setState({isPopoverOpen:!o.state.isPopoverOpen})},o.selectTagColor=function(e){var t=e.target.value,n=o.props,r=n.repoID,i=n.tag,s=i.id,a=i.name;C.I.updateRepoTag(r,s,a,t).then((function(){o.setState({tagColor:t,isPopoverOpen:!o.state.isPopoverOpen})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={tagColor:o.props.tag.color,isPopoverOpen:!1},o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.color!==this.props.tag.color&&this.setState({tagColor:e.tag.color})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isPopoverOpen,r=t.tagColor,o=this.props.tag,i=o.id,s=o.color,a=(0,w.Z)(Xn.QQ);return-1==a.indexOf(s)&&a.unshift(s),(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{id:"tag-".concat(i,"-color"),className:"tag-color cursor-pointer rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:r},onClick:this.togglePopover,children:(0,m.jsx)("i",{className:"sf3-font sf3-font-down text-white"})}),(0,m.jsx)(gr.Z,{target:"tag-".concat(i,"-color"),isOpen:n,placement:"bottom",toggle:this.togglePopover,className:"tag-color-popover mw-100",children:(0,m.jsx)(vr.Z,{className:"p-2",children:(0,m.jsx)("div",{className:"d-flex justify-content-between",children:a.map((function(t,n){return(0,m.jsx)("div",{className:"tag-color-option mx-1",children:(0,m.jsxs)("label",{className:"colorinput",children:[(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:t==r,onClick:e.selectTagColor}),(0,m.jsx)("span",{className:"colorinput-color rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:t},children:(0,m.jsx)("i",{className:"sf2-icon-tick color-selected"})})]})},n)}))})})})]})}}]),n}(a.Component)),xr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleMode=function(){o.setState({isEditing:!o.state.isEditing},(function(){o.state.isEditing&&o.input.current.focus()}))},o.updateTagName=function(e){var t=e.target.value,n=o.props,r=n.repoID,i=n.tag,s=i.id,a=i.color;C.I.updateRepoTag(r,s,t,a).then((function(){o.setState({tagName:t})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onInputKeyDown=function(e){"Enter"==e.key?(o.toggleMode(),o.updateTagName(e)):"Escape"==e.key&&(e.nativeEvent.stopImmediatePropagation(),o.toggleMode())},o.onInputBlur=function(e){o.toggleMode(),o.updateTagName(e)},o.state={tagName:o.props.tag.name,isEditing:!1},o.input=a.createRef(),o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.name!==this.props.tag.name&&this.setState({tagName:e.tag.name})}},{key:"render",value:function(){var e=this.state,t=e.isEditing,n=e.tagName;return(0,m.jsx)("div",{className:"mx-2 flex-fill d-flex",children:t?(0,m.jsx)("input",{type:"text",ref:this.input,defaultValue:n,onBlur:this.onInputBlur,onKeyDown:this.onInputKeyDown,className:"flex-fill form-control-sm form-control"}):(0,m.jsx)("span",{onClick:this.toggleMode,className:"cursor-pointer flex-fill",children:n})})}}]),n}(a.Component),wr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseOver=function(){o.setState({isTagHighlighted:!0})},o.onMouseOut=function(){o.setState({isTagHighlighted:!1})},o.deleteTag=function(){o.props.onDeleteTag(o.props.item)},o.state={isTagHighlighted:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state.isTagHighlighted,t=this.props,n=t.item,r=t.repoID;return(0,m.jsxs)("li",{className:"tag-list-item px-4 d-flex justify-content-between align-items-center ".concat(e?"hl":""),onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,children:[(0,m.jsx)(yr,{repoID:r,tag:n}),(0,m.jsx)(xr,{repoID:r,tag:n}),(0,m.jsx)("button",{className:"tag-delete-icon sf3-font-delete1 sf3-font border-0 px-0 bg-transparent cursor-pointer ".concat(e?"":"invisible"),onClick:this.deleteTag,"aria-label":(0,h.ih)("Delete"),title:(0,h.ih)("Delete")})]})}}]),n}(a.Component),br=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).togglePopover=function(){o.setState({isPopoverOpen:!o.state.isPopoverOpen})},o.selectTagColor=function(e){var t=e.target.value;o.props.updateVirtualTag(o.props.tag,{color:t}),o.setState({tagColor:t,isPopoverOpen:!o.state.isPopoverOpen})},o.state={tagColor:o.props.tag.color,isPopoverOpen:!1},o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.color!==this.props.tag.color&&this.setState({tagColor:e.tag.color})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isPopoverOpen,r=t.tagColor,o=this.props.tag,i=o.id,s=o.color,a=(0,w.Z)(Xn.QQ);return-1==a.indexOf(s)&&a.unshift(s),(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{id:"tag-".concat(i,"-color"),className:"tag-color cursor-pointer rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:r},onClick:this.togglePopover,children:(0,m.jsx)("i",{className:"sf3-font sf3-font-down text-white"})}),(0,m.jsx)(gr.Z,{target:"tag-".concat(i,"-color"),isOpen:n,placement:"bottom",toggle:this.togglePopover,className:"tag-color-popover mw-100",children:(0,m.jsx)(vr.Z,{className:"p-2",children:(0,m.jsx)("div",{className:"d-flex justify-content-between",children:a.map((function(t,n){return(0,m.jsx)("div",{className:"tag-color-option mx-1",children:(0,m.jsxs)("label",{className:"colorinput",children:[(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:t==r,onClick:e.selectTagColor}),(0,m.jsx)("span",{className:"colorinput-color rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:t},children:(0,m.jsx)("i",{className:"sf2-icon-tick color-selected"})})]})},n)}))})})})]})}}]),n}(a.Component),Sr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleMode=function(){o.setState({isEditing:!o.state.isEditing})},o.updateTagName=function(e){var t=e.target.value;o.props.updateVirtualTag(o.props.tag,{name:t}),o.setState({tagName:t})},o.onInputKeyDown=function(e){"Enter"==e.key?(o.toggleMode(),o.updateTagName(e)):"Escape"==e.key&&(e.nativeEvent.stopImmediatePropagation(),o.toggleMode())},o.onInputBlur=function(e){o.toggleMode(),o.updateTagName(e)},o.state={tagName:o.props.tag.name,isEditing:!0},o.input=a.createRef(),o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.name!==this.props.tag.name&&this.setState({tagName:e.tag.name})}},{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.input.current.focus()}),1)}},{key:"render",value:function(){var e=this.state,t=e.isEditing,n=e.tagName;return(0,m.jsx)("div",{className:"mx-2 flex-fill d-flex",children:t?(0,m.jsx)("input",{type:"text",ref:this.input,defaultValue:n,onBlur:this.onInputBlur,onKeyDown:this.onInputKeyDown,className:"flex-fill form-control-sm form-control"}):(0,m.jsx)("span",{onClick:this.toggleMode,className:"cursor-pointer flex-fill",style:{width:100,height:20},children:n})})}}]),n}(a.Component),Cr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseOver=function(){o.setState({isTagHighlighted:!0})},o.onMouseOut=function(){o.setState({isTagHighlighted:!1})},o.deleteVirtualTag=function(){o.props.deleteVirtualTag(o.props.item)},o.state={isTagHighlighted:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state.isTagHighlighted,t=this.props,n=t.item,r=t.repoID;return(0,m.jsxs)("li",{className:"tag-list-item px-4 d-flex justify-content-between align-items-center ".concat(e?"hl":""),onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,children:[(0,m.jsx)(br,{repoID:r,tag:n,updateVirtualTag:this.props.updateVirtualTag}),(0,m.jsx)(Sr,{repoID:r,tag:n,updateVirtualTag:this.props.updateVirtualTag}),(0,m.jsx)("button",{className:"tag-delete-icon sf3-font-delete1 sf3-font border-0 px-0 bg-transparent cursor-pointer ".concat(e?"":"invisible"),onClick:this.deleteVirtualTag,"aria-label":(0,h.ih)("Delete"),title:(0,h.ih)("Delete")})]})}}]),n}(a.Component),Dr=n(39857),kr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleTooltip=function(){o.setState({showTooltip:!o.state.showTooltip})},o.onClickImport=function(){o.importOptionsInput.click()},o.importTagsInputChange=function(){if(o.importOptionsInput.files&&o.importOptionsInput.files.length){var e=new FileReader;e.onload=o.onImportTags.bind((0,xt.Z)(o)),e.onerror=o.onImportTagsError.bind((0,xt.Z)(o)),e.readAsText(o.importOptionsInput.files[0])}else W.Z.warning((0,h.ih)("Please select a file"))},o.getValidTags=function(e){var t=[],n={};o.props.repotagList.forEach((function(e){return n[e.name]=!0}));for(var r=0;r<e.length;r++)e[r]&&"object"===typeof e[r]&&e[r].name&&e[r].color&&(n[e[r].name]||(t.push({name:e[r].name,color:e[r].color}),n[e[r].name]=!0));return t},o.onImportTags=function(e){var t=[];try{t=JSON.parse(e.target.result)}catch(r){return void W.Z.danger((0,h.ih)("The imported tags are invalid"))}if(Array.isArray(t)&&0!==t.length){var n=o.getValidTags(t);0!==n.length?(C.I.createRepoTags(o.props.repoID,n).then((function(e){W.Z.success((0,h.ih)("Tags imported"));var t=[];e.data.repo_tags.forEach((function(e){var n=new An.Z(e);t.push(n)})),o.props.updateTags(t)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})),o.importOptionsInput.value=null):W.Z.warning((0,h.ih)("The imported tag already exists"))}else W.Z.danger((0,h.ih)("The imported tags are invalid"))},o.onImportTagsError=function(){W.Z.success((0,h.ih)("Failed to import tags. Please reupload."))},o.getDownloadUrl=function(){var e=o.props.repotagList.map((function(e){return{name:e.name,color:e.color}}));return"data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(e)))},o.state={showTooltip:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this;return(0,m.jsxs)("div",{className:"tag-list-footer",children:[(0,m.jsx)("span",{className:"sf3-font sf3-font-tips mr-2",style:{color:"#999"},id:"import-export-tags-tip"}),(0,m.jsx)(Dr.Z,{toggle:this.toggleTooltip,delay:{show:0,hide:0},target:"import-export-tags-tip",placement:"bottom",isOpen:this.state.showTooltip,children:(0,h.ih)("Use the import/export function to transfer tags quickly to another library. (The export is in JSON format.)")}),(0,m.jsx)("input",{type:"file",ref:function(t){return e.importOptionsInput=t},accept:".json",className:"d-none",onChange:this.importTagsInputChange}),(0,m.jsx)("span",{className:"item-text",onClick:this.onClickImport,children:(0,h.ih)("Import tags")}),(0,m.jsx)("span",{className:"mx-2",children:"|"}),(0,m.jsx)("a",{href:this.getDownloadUrl(),download:"tags.json",onClick:this.props.toggle,children:(0,m.jsx)("span",{className:"item-text",children:(0,h.ih)("Export tags")})})]})}}]),n}(a.Component),jr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).loadTags=function(){C.I.listRepoTags(o.props.repoID).then((function(e){var t=[];e.data.repo_tags.forEach((function(e){var n=new An.Z(e);t.push(n)})),o.setState({repotagList:t})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.updateTags=function(e){o.setState({repotagList:[].concat((0,w.Z)(o.state.repotagList),(0,w.Z)(e))})},o.onDeleteTag=function(e){var t=o.props.repoID,n=e.id;C.I.deleteRepoTag(t,n).then((function(e){o.setState({repotagList:o.state.repotagList.filter((function(e){return e.id!=n}))})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.createVirtualTag=function(e){e.preventDefault();var t=o.state.repotagList,n={name:"",color:Xn.QQ[Math.floor(Math.random()*Xn.QQ.length)],id:"virtual-tag-".concat(mr()),is_virtual:!0};t.push(n),o.setState({repotagList:t})},o.deleteVirtualTag=function(e){var t=o.state.repotagList,n=t.findIndex((function(t){return t.id===e.id}));t.splice(n,1),o.setState({repotagList:t})},o.updateVirtualTag=function(e,t){var n=o.props.repoID,r=o.state.repotagList,i=r.findIndex((function(t){return t.id===e.id}));if(i<0)return null;if(t.color)return e.color=t.color,r[i]=e,void o.setState({repotagList:r});if(t.name&&t.name.length>0){var s=e.color,a=t.name;C.I.createRepoTag(n,a,s).then((function(e){r[i]=new An.Z(e.data.repo_tag),o.setState({repotagList:r})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}},o.state={repotagList:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.loadTags()}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("ul",{className:"tag-list tag-list-container my-2",children:this.state.repotagList.map((function(t,n){return t.is_virtual?(0,m.jsx)(Cr,{item:t,repoID:e.props.repoID,deleteVirtualTag:e.deleteVirtualTag,updateVirtualTag:e.updateVirtualTag},n):(0,m.jsx)(wr,{item:t,repoID:e.props.repoID,onDeleteTag:e.onDeleteTag},n)}))}),(0,m.jsxs)("div",{className:"add-tag-link px-4 py-2 d-flex align-items-center",onClick:this.createVirtualTag,children:[(0,m.jsx)("span",{className:"sf2-icon-plus mr-2"}),(0,h.ih)("Create a new tag")]}),(0,m.jsx)(kr,{toggle:this.props.onListTagCancel,repotagList:this.state.repotagList,updateTags:this.updateTags,repoID:this.props.repoID})]})}}]),n}(a.Component),Ir=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleDropdownMenu=function(){o.setState({isDropdownMenuOpen:!o.state.isDropdownMenuOpen})},o.state={isDropdownMenuOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.state.isDropdownMenuOpen,n=this.props.currentViewMode,r=[{icon:"list-view",text:(0,h.ih)("List view"),value:"list"},{icon:"grid-view",text:(0,h.ih)("Grid view"),value:"grid"}];return(0,m.jsxs)(H.Z,{isOpen:t,toggle:this.toggleDropdownMenu,id:"cur-view-change-mode-dropdown",children:[(0,m.jsx)(Y.Z,{tag:"div","data-toggle":"dropdown",title:(0,h.ih)("Switch view mode"),"aria-label":(0,h.ih)("Switch view mode"),"aria-expanded":t,children:(0,m.jsxs)("span",{className:"cur-view-path-btn px-1",children:[(0,m.jsx)("span",{className:"sf3-font sf3-font-".concat(n,"-view")}),(0,m.jsx)("span",{className:"sf3-font sf3-font-down"})]})}),(0,m.jsx)(Me.Z,{right:!0,className:"mt-1",children:r.map((function(t,r){return(0,m.jsx)(V.Z,{onClick:e.props.switchViewMode.bind(e,t.value),children:(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,m.jsxs)("span",{className:"mr-8 d-flex justify-content-between align-items-center",children:[(0,m.jsx)("span",{className:"sf3-font-".concat(t.icon," sf3-font mr-2")}),(0,m.jsx)("span",{children:t.text})]}),(0,m.jsx)("span",{children:n===t.value&&(0,m.jsx)("i",{className:"sf2-icon-tick"})})]})},r)}))})]})}}]),n}(a.Component),Mr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleDropdownMenu=function(){o.setState({isDropdownMenuOpen:!o.state.isDropdownMenuOpen})},o.hidePopover=function(e){if(e)for(var t=e.target;t;){if("string"===typeof t.className&&t.className.includes("tag-color-popover"))return;t=t.parentNode}o.setState({isRepoTagDialogOpen:!1})},o.toggleCancel=function(){o.setState({isRepoTagDialogOpen:!1})},o.getMenu=function(){var e=[],t=o.props,n=t.repoID,r=t.userPerm,i=t.currentPath,s=ar.Z.TAGS,a=ar.Z.TRASH,l=ar.Z.HISTORY;if("rw"!==r)return e;if(o.isMarkdownFile(i))return e;if(e.push(s),f.c.getFileName(i)){var c=h.ze+"repo/"+n+"/trash/?path="+encodeURIComponent(i);e.push((0,sr.Z)((0,sr.Z)({},a),{},{href:c}))}else{var d=h.ze+"repo/"+n+"/trash/";e.push((0,sr.Z)((0,sr.Z)({},a),{},{href:d}));var u=h.ze+"repo/history/"+n+"/";e.push((0,sr.Z)((0,sr.Z)({},l),{},{href:u}))}return e},o.onMenuItemClick=function(e){var t=e.key,n=e.href;switch(t){case"Tags":o.setState({isRepoTagDialogOpen:!o.state.isRepoTagDialogOpen});break;case"Trash":case"History":location.href=n}},o.onMenuItemKeyDown=function(e,t){"Enter"!=e.key&&"Space"!=e.key||o.onMenuItemClick(t)},o.state={isRepoTagDialogOpen:!1,isDropdownMenuOpen:!1},o}return(0,o.Z)(n,[{key:"isMarkdownFile",value:function(e){return f.c.getFileName(e).includes(".md")}},{key:"render",value:function(){var e=this,t=this.getMenu(),n=this.state.isDropdownMenuOpen,r=this.props,o=r.repoID,i=r.currentMode,s=ar.Z.PROPERTIES.value;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{className:"d-flex",children:[(0,m.jsx)(Ir,{currentViewMode:i,switchViewMode:this.props.switchViewMode}),!this.props.isCustomPermission&&(0,m.jsx)("span",{className:"cur-view-path-btn ml-2",onClick:function(){return e.props.switchViewMode("detail")},children:(0,m.jsx)("span",{className:"sf3-font sf3-font-info","aria-label":s,title:s})}),t.length>0&&(0,m.jsxs)(H.Z,{isOpen:n,toggle:this.toggleDropdownMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",id:"cur-folder-more-op-toggle",className:"cur-view-path-btn sf3-font-more sf3-font ml-2","data-toggle":"dropdown",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"aria-expanded":n}),(0,m.jsx)(Me.Z,{right:!0,children:t.map((function(t,n){return"Divider"===t?(0,m.jsx)(V.Z,{divider:!0},n):(0,m.jsx)(V.Z,{onClick:e.onMenuItemClick.bind(e,t),onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:t.value},n)}))})]})]}),this.state.isRepoTagDialogOpen&&(0,m.jsx)(lr.Z,{popoverClassName:"list-tag-popover",target:"cur-folder-more-op-toggle",hideSeahubPopover:this.hidePopover,hideSeahubPopoverWithEsc:this.hidePopover,canHideSeahubPopover:!0,boundariesElement:document.body,placement:"bottom-end",children:(0,m.jsx)(jr,{repoID:o,onListTagCancel:this.toggleCancel})})]})}}]),n}(a.Component),_r=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleSortOptionsDialog=function(){o.setState({isSortOptionsDialogOpen:!o.state.isSortOptionsDialogOpen})},o.state={isSortOptionsDialogOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=f.c.isDesktop();return(0,m.jsxs)("div",{className:"cur-dir-path d-flex justify-content-between align-items-center",children:[(0,m.jsx)(ir,{repoID:this.props.repoID,repoName:this.props.repoName,repoEncrypted:this.props.repoEncrypted,isGroupOwnedRepo:this.props.isGroupOwnedRepo,pathPrefix:this.props.pathPrefix,currentPath:this.props.currentPath,userPerm:this.props.userPerm,onPathClick:this.props.onPathClick,onTabNavClick:this.props.onTabNavClick,isViewFile:this.props.isViewFile,fileTags:this.props.fileTags,toggleTreePanel:this.props.toggleTreePanel,enableDirPrivateShare:this.props.enableDirPrivateShare,showShareBtn:this.props.showShareBtn,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onUploadFile:this.props.onUploadFile,onUploadFolder:this.props.onUploadFolder,direntList:this.props.fullDirentList,filePermission:this.props.filePermission,onFileTagChanged:this.props.onFileTagChanged,repoTags:this.props.repoTags}),e&&(0,m.jsx)(Mr,{repoID:this.props.repoID,repoName:this.props.repoName,userPerm:this.props.userPerm,currentPath:this.props.currentPath,updateUsedRepoTags:this.props.updateUsedRepoTags,onDeleteRepoTag:this.props.onDeleteRepoTag,currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode,isCustomPermission:this.props.isCustomPermission}),!e&&this.props.direntList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(ve,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems})]})}}]),n}(a.Component),Nr=n(15108),Rr=n(57357),Tr=n(46408),Or=n(37387),Er=n(71500),Pr=n(20587);var Zr=function(e){var t=e.column.name;return(0,m.jsx)(Pr.Z,{md:3,className:"d-flex column-name",children:(0,m.jsx)("div",{className:"w-100 text-truncate",children:t||""})})},Fr=n(4942),Lr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).blurInput=function(){setTimeout((function(){o.inputRef.current&&o.inputRef.current.blur()}),1)},o.onBlur=function(){var e=o.props,t=e.column,n=e.onCommit,r={};r[t.key]=o.state.value.trim(),n(r,t)},o.onChange=function(e){var t=e.target.value;t!==o.state.value&&o.setState({value:t})},o.onCut=function(e){e.stopPropagation()},o.onPaste=function(e){e.stopPropagation()},o.onKeyDown=function(e){if(e.keyCode===Xn.mW.Esc)return e.stopPropagation(),void o.blurInput();var t=e.currentTarget,n=t.selectionStart,r=t.selectionEnd,i=t.value;(e.keyCode===Xn.mW.ChineseInputMethod||e.keyCode===Xn.mW.LeftArrow&&0===n||e.keyCode===Xn.mW.RightArrow&&r===i.length)&&e.stopPropagation()},o.state={value:e.row[e.column.key]||""},o.inputRef=a.createRef(),o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.row[e.column.key];t!==this.state.value&&this.setState({value:t})}},{key:"render",value:function(){var e=this.props.column,t=this.state.value;return(0,m.jsx)("input",{type:"text",onBlur:this.onBlur,onCut:this.onCut,onPaste:this.onPaste,onChange:this.onChange,className:"form-control",value:t||"",onKeyDown:this.onKeyDown,disabled:!e.editable,ref:this.inputRef})}}]),n}(a.Component),Ar=Lr;var Ur=function(e){var t=e.column,n=e.row[t.key],r=t.data||{},o=r.result_type,i=r.format;return o===Xn.HC.DATE?(0,m.jsx)("div",{className:"form-control disabled",children:(0,Er.n4)(n,i)}):o===Xn.HC.STRING?n:"object"===typeof n?null:(0,m.jsx)(m.Fragment,{})},zr=n(46123),Br=n.n(zr),Gr=n(72669),Hr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onCompositionStart=function(){o.isInputtingChinese=!0},o.onChange=function(e){o.timer&&clearTimeout(o.timer);var t=o.props,n=t.onChange,r=t.wait,i=e.target.value;o.setState({searchValue:i||""},(function(){o.isInputtingChinese||(o.timer=setTimeout((function(){n&&n(o.state.searchValue.trim())}),r))}))},o.onCompositionEnd=function(e){o.isInputtingChinese=!1,o.onChange(e)},o.setFocus=function(e){if(o.inputRef!==document.activeElement&&(o.inputRef.focus(),e)){var t=o.state.searchValue.length;o.inputRef.setSelectionRange(0,t)}},o.state={searchValue:e.value},o.isInputtingChinese=!1,o.timer=null,o.inputRef=null,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.autoFocus&&this.inputRef&&this.inputRef!==document.activeElement&&setTimeout((function(){e.inputRef.focus()}),0)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({searchValue:e.value})}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null,this.inputRef=null}},{key:"render",value:function(){var e=this,t=this.props,n=t.placeholder,r=t.autoFocus,o=t.className,i=t.onKeyDown,s=t.disabled,a=t.style,l=this.state.searchValue;return(0,m.jsx)("input",{type:"text",value:l,className:Br()("form-control",o),onChange:this.onChange,autoFocus:r,placeholder:n,onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,onKeyDown:i,disabled:s,style:a,ref:function(t){return e.inputRef=t}})}}]),n}(a.Component);Hr.defaultProps={wait:100,disabled:!1,value:""};var Yr,Vr=Hr,Wr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).getCascadeColumnValue=function(e){var t=e.column,n=e.row,r=e.columns,o=(t.data||{}).cascade_column_key;return o&&r.find((function(e){return e.key===o}))?n[o]:""},o.getSelectColumnOptions=function(e){var t=e.column,n=e.row,r=e.columns,o=(0,Er.T8)(t),i=t.data||{},s=i.cascade_column_key,a=i.cascade_settings;if(s&&r.find((function(e){return e.key===s}))){var l=n[s];if(!l)return[];var c=a[l];return c&&Array.isArray(c)&&0!==c.length?o.filter((function(e){return c.includes(e.id)})):[]}return o},o.toggle=function(){o.ref.toggle(),o.props.onUpdateState()},o.onChangeSearch=function(e){if(o.state.searchVal!==e){var t=e.toLowerCase(),n=t?o.options.filter((function(e){return e.name&&e.name.toLowerCase().indexOf(t)>-1})):o.options;o.setState({searchVal:e,filteredOptions:n})}},o.onSelectOption=function(e){var t=o.props.column;o.setState({value:e},(function(){o.props.onCommit((0,Fr.default)({},t.key,e),t),o.toggle()}))};var i=o.getSelectColumnOptions(e);return o.state={value:e.row[e.column.key],searchVal:"",highlightIndex:-1,maxItemNum:0,itemHeight:0,filteredOptions:i},o.options=i,o.timer=null,o.editorKey="single-select-editor-".concat(e.column.key),o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.getCascadeColumnValue(this.props)!==this.getCascadeColumnValue(e)&&(this.options=this.getSelectColumnOptions(e),this.setState({filteredOptions:this.options}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.value,r=t.filteredOptions,o=this.props.column;return(0,m.jsx)(Gr.Z,{target:this.editorKey,className:"single-select-editor-popover",trigger:"legacy",placement:"bottom-start",hideArrow:!0,toggle:this.toggle,ref:function(t){return e.ref=t},children:(0,m.jsxs)("div",{className:"single-select-editor-container",children:[(0,m.jsx)("div",{className:"search-single-selects",children:(0,m.jsx)(Vr,{placeholder:(0,h.ih)("Find an option"),onKeyDown:this.onKeyDown,onChange:this.onChangeSearch,autoFocus:!0})}),(0,m.jsx)("div",{className:"single-select-editor-content",children:r.map((function(t){var r=n===t.id,i={backgroundColor:t.color,color:t.textColor||null,maxWidth:Math.max(138,o.width?o.width-62:0)};return(0,m.jsxs)("div",{className:"single-select-option-container",onClick:e.onSelectOption.bind(e,r?null:t.id),children:[(0,m.jsx)("div",{className:"single-select-option",style:i,children:t.name}),(0,m.jsx)("div",{className:"single-select-option-selected",children:r&&(0,m.jsx)("i",{})})]},t.id)}))})]})})}}]),n}(a.Component),Kr=Wr,qr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).updateState=function(){o.setState({isShowSingleSelect:!o.state.isShowSingleSelect})},o.onCommit=function(e,t){o.props.onCommit(e,t)};var i=e.column;return o.options=(0,Er.T8)(i),o.state={isShowSingleSelect:!1},o.editorKey="single-select-editor-".concat(i.key),o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state.isShowSingleSelect,t=this.props,n=t.column,r=t.row[n.key],o=this.options.find((function(e){return e.id===r})),i=o?{backgroundColor:o.color,color:o.textColor||null}:{backgroundColor:Xn.yR},s=o?o.name:(0,h.ih)(Xn.sL);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{id:this.editorKey,className:Br()("selected-single-select-container",{disable:!n.editable,focus:e}),children:(0,m.jsxs)("div",{className:"single-select-inner w-100 h-100 d-flex align-items-center justify-content-between",children:[(0,m.jsx)("div",{children:r&&(0,m.jsx)("div",{className:"single-select-option",style:i,title:s,children:s})}),n.editable&&(0,m.jsx)("i",{className:"sf3-font sf3-font-down"})]})}),n.editable&&(0,m.jsx)(Kr,{column:n,row:this.props.row,columns:this.props.columns,onCommit:this.onCommit,onUpdateState:this.updateState})]})}}]),n}(a.Component),$r=qr,Xr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).onChange=function(e){var t=o.props.column.data,n=t&&t.format?t.format:Xn.Ul,r=null;t&&"custom_currency"===t.format&&(r=t.currency_symbol);var i=e.target.value.trim();if((0,Er.V5)()||!(i.indexOf(".\u3002")>-1)){var s=(0,Er.MS)(i,n,r);s!==o.state.value&&o.setState({value:s})}},o.onKeyDown=function(e){var t=e.currentTarget,n=t.selectionStart,r=t.selectionEnd,i=t.value;e.keyCode===Xn.mW.Enter||e.keyCode===Xn.mW.Esc?(e.preventDefault(),o.input.blur()):(e.keyCode===Xn.mW.LeftArrow&&0===n||e.keyCode===Xn.mW.RightArrow&&r===i.length)&&e.stopPropagation()},o.onBlur=function(){var e=o.state.value,t=o.props.column;o.props.onCommit((0,Fr.default)({},t.key,(0,Er.ap)(e,t.data)),t)},o.setInputRef=function(e){return o.input=e,o.input},o.onPaste=function(e){e.stopPropagation()},o.onCut=function(e){e.stopPropagation()};var i=e.row,s=e.column,a=i[s.key];return o.state={value:(0,Er.d8)(a,s.data)},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.column;return(0,m.jsx)("input",{ref:this.setInputRef,type:"text",className:"form-control",value:this.state.value,onBlur:this.onBlur,onPaste:this.onPaste,onCut:this.onCut,onKeyDown:this.onKeyDown,onChange:this.onChange,disabled:!e.editable})}}]),n}(a.Component),Jr=Xr,Qr=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.column,n=e.row,r=t.data,o=t.key,i=(0,Er.n4)(n[o],r?r.format:"");return(0,m.jsx)("input",{type:"text",className:"form-control",value:i,disabled:!0})}}]),n}(a.Component),eo=Qr,to=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.column,n=e.row,r=t.key,o=(0,Er.n4)(n[r],"YYYY-MM-DD HH:mm:ss")||"";return(0,m.jsx)("div",{className:"form-control",style:{width:320},children:o})}}]),n}(a.Component),no=to,ro=(Yr={},(0,Fr.default)(Yr,Xn.EM.TEXT,Ar),(0,Fr.default)(Yr,Xn.EM.FORMULA,Ur),(0,Fr.default)(Yr,Xn.EM.SINGLE_SELECT,$r),(0,Fr.default)(Yr,Xn.EM.NUMBER,Jr),(0,Fr.default)(Yr,Xn.EM.DATE,eo),(0,Fr.default)(Yr,Xn.EM.CTIME,no),(0,Fr.default)(Yr,Xn.EM.MTIME,no),Yr),oo=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.column,n=e.row,r=e.columns,o=ro[t.type]||ro.text;return(0,m.jsxs)("div",{className:"pb-4 row column-item",children:[(0,m.jsx)(Zr,{column:t}),(0,m.jsx)(Pr.Z,{md:9,className:"d-flex align-items-center extra-attribute-item-info",children:(0,m.jsx)(o,{column:t,row:n,columns:r,onCommit:this.props.onCommit})})]})}}]),n}(a.Component),io=oo,so=function(){function e(){var t=this;(0,r.Z)(this,e),this.getCollaborators=function(e){var n=t.server+"/api/v2.1/repos/"+e+"/related-users/";return t.req.get(n)},this.updateMetadataRecord=function(e,n,r,o){var i=t.server+"/api/v2.1/repos/"+e+"/metadata/records/"+n+"/",s={column_name:r,value:o};return t.req.put(i,s)},this.listUserInfo=function(e){var n=t.server+"/api/v2.1/user-list/",r={user_id_list:e};return t._sendPostRequest(n,r,{headers:{"Content-type":"application/json"}})}}return(0,o.Z)(e,[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,o=e.token;return this.server=t,this.username=n,this.password=r,this.token=o,this.token&&this.server&&(this.req=We.Z.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=We.Z.create({headers:{"X-CSRFToken":n}}),this}},{key:"_sendPostRequest",value:function(e,t){return t.getHeaders?this.req.post(e,t,{headers:t.getHeaders()}):this.req.post(e,t)}},{key:"getMetadataStatus",value:function(e){var t=this.server+"/api/v2.1/repos/"+e+"/metadata/";return this.req.get(t)}},{key:"createMetadata",value:function(e){var t=this.server+"/api/v2.1/repos/"+e+"/metadata/";return this.req.put(t)}},{key:"deleteMetadata",value:function(e){var t=this.server+"/api/v2.1/repos/"+e+"/metadata/";return this.req.delete(t)}},{key:"getMetadata",value:function(e,t){var n=this.server+"/api/v2.1/repos/"+e+"/metadata/records/";return this.req.get(n,{params:t})}},{key:"addMetadataRecords",value:function(e,t,n){var r=this.server+"/api/v2.1/repos/"+e+"/metadata/records/",o={parent_dir:t,name:n};return this.req.post(r,o)}},{key:"addMetadataColumn",value:function(e,t){var n=this.server+"/api/v2.1/repos/"+e+"/metadata/columns/",r={column_name:t};return this.req.post(n,r)}},{key:"getMetadataRecordInfo",value:function(e,t,n){var r=this.server+"/api/v2.1/repos/"+e+"/metadata/record/",o={};return t&&(o.parent_dir=t),n&&(o.name=n),this.req.get(r,{params:o})}}]),e}(),ao=new so,lo=_e.ZP.load("sfcsrftoken");ao.initForSeahubUsage({siteRoot:h.ze,xcsrfHeaders:lo});var co=ao,uo=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).startAnimation=function(e){!0===o.state.animationEnd&&e&&e(),setTimeout((function(){var t=o.modalRef.current.firstChild,n=o.getDialogStyle(),r=n.width,i=n.maxWidth,s=n.marginLeft,a=n.height;t.style.width="".concat(r,"px"),t.style.maxWidth="".concat(i,"px"),t.style.marginLeft="".concat(s,"px"),t.style.height="".concat(a,"px"),t.style.marginRight="unset",t.style.marginTop="28px",setTimeout((function(){o.setState({animationEnd:!0},(function(){t.style.transition="none",e&&e()}))}),280)}),1)},o.getData=function(){var e=o.props,t=e.repoID,n=e.filePath,r=e.direntType,i=f.c.getDirName(n),s=f.c.getFileName(n),a="file"===r?i:i.slice(0,i.length-s.length-1);a.startsWith("/")||(a="/"+a),co.getMetadataRecordInfo(t,a,s).then((function(e){var t=e.data,n=t.row,r=t.metadata,i=t.editable_columns;o.isExist=Boolean(n._id),o.setState({row:n,columns:(0,Er.s2)(r,i,o.isEmptyFile),isLoading:!1,errorMsg:""})})).catch((function(e){var t=f.c.getErrorMsg(e);o.setState({isLoading:!1,errorMsg:t})}))},o.updateData=function(e,t){var n=(0,sr.Z)((0,sr.Z)({},o.state.row),e);o.setState({row:n},(function(){var n=o.props,r=n.repoID,i=(n.filePath,e[t.key]),s=o.state.row._id;o.isExist&&co.updateMetadataRecord(r,s,t.name,i).then((function(e){o.setState({update:{},row:e.data.row})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger((0,h.ih)(t))}))}))},o.onHotKey=function(e){(0,Or.default)("esc",e)&&o.onToggle()},o.onToggle=function(){o.props.onToggle()},o.getDialogStyle=function(){return{width:800,maxWidth:800,marginLeft:(window.innerWidth-800)/2,height:Xn.KF}},o.getInitStyle=function(){var e=window.innerWidth;return{width:"".concat(e-80,"px"),maxWidth:"".concat(e-80,"px"),marginLeft:"".concat(80,"px"),height:"".concat(100,"px"),marginRight:"".concat(80,"px"),marginTop:"30%",transition:"all .3s"}},o.renderColumns=function(){var e=o.state,t=e.isLoading,n=e.errorMsg,r=e.columns,i=e.row,s=e.update;if(t)return(0,m.jsx)("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center",children:(0,m.jsx)(D.Z,{})});if(n)return(0,m.jsx)("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center error-message",children:(0,h.ih)(n)});var a=(0,sr.Z)((0,sr.Z)({},i),s);return(0,m.jsx)(m.Fragment,{children:r.map((function(e){return(0,m.jsx)(io,{column:e,row:a,columns:r,onCommit:o.updateData},e.key)}))})},o.renderContent=function(){return o.state.animationEnd?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(I.Z,{toggle:o.onToggle,children:(0,h.ih)("Edit extra properties")}),(0,m.jsx)(M.Z,{children:o.renderColumns()})]}):null};var i=e.direntDetail,s=e.direntType;if(o.state={animationEnd:!1,isLoading:!0,update:{},row:{},columns:[],errorMsg:""},"dir"===s)o.isEmptyFile=!1;else{var l=(null===i||void 0===i?void 0:i.id)||"";o.isEmptyFile=l==="0".repeat(l.length)}return o.isExist=!1,o.modalRef=a.createRef(),o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.startAnimation(this.getData),window.addEventListener("keydown",this.onHotKey)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.onHotKey)}},{key:"render",value:function(){var e=this.state.animationEnd;return(0,m.jsx)(p.Z,{isOpen:!0,className:"extra-attributes-dialog",style:e?this.getDialogStyle():this.getInitStyle(),zIndex:Xn.Ue.f,contentClassName:"extra-attributes-content-container",modalClassName:"extra-attributes-modal",wrapClassName:"extra-attributes",fade:!1,innerRef:this.modalRef,toggle:this.onToggle,children:this.renderContent()})}}]),n}(a.Component),po=uo,ho=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).getDirentPosition=function(){var e=o.props.repoInfo,t=o.getDirentPath(),n=e.repo_name;if("/"!==t){var r=t.lastIndexOf("/");n+=t.slice(0,r)}return n},o.onEditFileTagToggle=function(){o.setState({isEditFileTagShow:!o.state.isEditFileTagShow})},o.onFileTagChanged=function(){var e=o.getDirentPath();o.props.onFileTagChanged(o.props.dirent,e)},o.getDirentPath=function(){if(f.c.isMarkdownFile(o.props.path))return o.props.path;var e=o.props,t=e.dirent,n=e.path;return f.c.joinPath(n,t.name)},o.toggleExtraMetadataPropertiesDialog=function(){o.setState({isShowMetadataExtraProperties:!o.state.isShowMetadataExtraProperties})},o.renderTags=function(){var e=o.props,t=e.direntType,n=e.direntDetail,r=o.getDirentPosition();return"dir"===t?(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"35%"}),(0,m.jsx)("th",{width:"65%"})]})}),(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:(0,h.ih)("Location")}),(0,m.jsx)("td",{children:r})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:(0,h.ih)("Last Update")}),(0,m.jsx)("td",{children:S()(n.mtime).format("YYYY-MM-DD")})]}),"rw"===n.permission&&window.app.pageOptions.enableMetadataManagement&&(0,m.jsx)(a.Fragment,{children:(0,m.jsx)("tr",{className:"file-extra-attributes",children:(0,m.jsx)("th",{colSpan:2,children:(0,m.jsx)("div",{className:"edit-file-extra-attributes-btn",onClick:o.toggleExtraMetadataPropertiesDialog,children:(0,h.ih)("Edit metadata properties")})})})})]})]}):(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"35%"}),(0,m.jsx)("th",{width:"65%"})]})}),(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:(0,h.ih)("Size")}),(0,m.jsx)("td",{children:f.c.bytesToSize(n.size)})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:(0,h.ih)("Location")}),(0,m.jsx)("td",{children:r})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:(0,h.ih)("Last Update")}),(0,m.jsx)("td",{children:S()(n.last_modified).fromNow()})]}),(0,m.jsxs)("tr",{className:"file-tag-container",children:[(0,m.jsx)("th",{children:(0,h.ih)("Tags")}),(0,m.jsxs)("td",{children:[(0,m.jsx)(Tr.Z,{fileTagList:o.props.fileTagList}),(0,m.jsx)("span",{onClick:o.onEditFileTagToggle,id:o.tagListTitleID,children:(0,m.jsx)(Nr.Z,{symbol:"tag"})})]})]}),"rw"===n.permission&&window.app.pageOptions.enableMetadataManagement&&(0,m.jsx)("tr",{className:"file-extra-attributes",children:(0,m.jsx)("th",{colSpan:2,children:(0,m.jsx)("div",{className:"edit-file-extra-attributes-btn",onClick:o.toggleExtraMetadataPropertiesDialog,children:(0,h.ih)("Edit metadata properties")})})})]})]})},o.state={isEditFileTagShow:!1,isShowMetadataExtraProperties:!1},o.tagListTitleID="detail-list-view-tags-".concat(mr()),o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.direntType,n=e.direntDetail,r=e.fileTagList,o=this.getDirentPath();return(0,m.jsxs)(a.Fragment,{children:[this.renderTags(),this.state.isEditFileTagShow&&(0,m.jsx)(Rr.Z,{repoID:this.props.repoID,repoTags:this.props.repoTags,filePath:o,fileTagList:r,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged,target:this.tagListTitleID,isEditFileTagShow:this.state.isEditFileTagShow}),this.state.isShowMetadataExtraProperties&&(0,m.jsx)(po,{repoID:this.props.repoID,filePath:o,direntType:t,direntDetail:n,onToggle:this.toggleExtraMetadataPropertiesDialog})]})}}]),n}(a.Component);ho.defaultProps={fileTagList:[]};var fo=ho,mo=(n(25984),function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).loadDirentInfo=function(e,t,n){if(e){var r=f.c.joinPath(t,e.name);o.updateDetailView(e,r)}else{var i=f.c.getDirName(t);C.I.listDir(n,i).then((function(e){for(var n=e.data.dirent_list,r=null,i=0;i<n.length;i++){var s=n[i];if(s.parent_dir+s.name===t){r=new Fn.Z(s);break}}o.setState({folderDirent:r}),o.updateDetailView(r,t)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}},o.updateDetailView=function(e,t){var n=o.props.repoID;"file"===e.type?C.I.getFileInfo(n,t).then((function(e){o.setState({direntType:"file",direntDetail:e.data})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})):C.I.getDirInfo(n,t).then((function(e){o.setState({direntType:"dir",direntDetail:e.data})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.renderHeader=function(e,t){return(0,m.jsxs)("div",{className:"detail-header",children:[(0,m.jsx)("div",{className:"detail-control sf2-icon-x1",onClick:o.props.onItemDetailsClose}),(0,m.jsxs)("div",{className:"detail-title dirent-title",children:[(0,m.jsx)("img",{src:e,width:"24",height:"24",alt:""})," ",(0,m.jsx)("span",{className:"name ellipsis",title:t,children:t})]})]})},o.renderDetailBody=function(e,t){var n=o.props,r=n.dirent,i=n.fileTags;return(0,m.jsxs)("div",{className:"detail-body dirent-info",children:[(0,m.jsx)("div",{className:"img",children:(0,m.jsx)("img",{src:e,className:"thumbnail",alt:""})}),o.state.direntDetail&&(0,m.jsx)("div",{className:"dirent-table-container",children:(0,m.jsx)(fo,{repoInfo:o.props.currentRepoInfo,path:o.props.path,repoID:o.props.repoID,dirent:o.props.dirent||t,direntType:o.state.direntType,direntDetail:o.state.direntDetail,repoTags:o.props.repoTags,fileTagList:r?r.file_tags:i,onFileTagChanged:o.props.onFileTagChanged})})]})},o.state={direntType:"",direntDetail:"",folderDirent:null},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dirent,n=e.path,r=e.repoID;this.loadDirentInfo(t,n,r)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.dirent,n=e.path,r=e.repoID;this.props.dirent!==e.dirent&&this.loadDirentInfo(t,n,r)}},{key:"render",value:function(){var e=this.props,t=e.dirent,n=e.repoID,r=e.path,o=this.state.folderDirent;if(!t&&!o)return"";var i=t?f.c.getDirentIcon(t):f.c.getDirentIcon(o),s=t?f.c.getDirentIcon(t,!0):f.c.getDirentIcon(o,!0),a=t?f.c.imageCheck(t.name):f.c.imageCheck(o.name),l=t?f.c.videoCheck(t.name):f.c.videoCheck(o.name);(a||h.eA&&l)&&(s="".concat(h.ze,"thumbnail/").concat(n,"/1024")+f.c.encodePath("".concat("/"===r?"":r,"/").concat(t.name)));var c=t?t.name:o.name;return(0,m.jsxs)("div",{className:"detail-container",children:[this.renderHeader(i,c),this.renderDetailBody(s,o)]})}}]),n}(a.Component)),go=mo,vo=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).getFileCounts=function(e){C.I.getRepoInfo(e.repo_id).then((function(e){o.setState({fileCount:e.data.file_count})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.state={fileCount:0},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this.props.currentRepo;this.getFileCounts(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.currentRepo.repo_id!==this.props.currentRepo.repo_id&&this.getFileCounts(e.currentRepo)}},{key:"render",value:function(){var e=this.props.currentRepo,t=f.c.getLibIconUrl(e),n=f.c.getLibIconUrl(e,!0);return(0,m.jsxs)("div",{className:"detail-container",children:[(0,m.jsxs)("div",{className:"detail-header",children:[(0,m.jsx)("div",{className:"detail-control sf2-icon-x1",onClick:this.props.closeDetails}),(0,m.jsxs)("div",{className:"detail-title dirent-title",children:[(0,m.jsx)("img",{src:t,width:"24",height:"24",alt:""}),"  ",(0,m.jsx)("span",{className:"name ellipsis",title:e.repo_name,children:e.repo_name})]})]}),(0,m.jsxs)("div",{className:"detail-body dirent-info",children:[(0,m.jsx)("div",{className:"img",children:(0,m.jsx)("img",{src:n,height:"96",alt:""})}),(0,m.jsx)("div",{className:"dirent-table-container",children:(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"35%"}),(0,m.jsx)("th",{width:"65%"})]})}),(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:(0,h.ih)("Files")}),(0,m.jsx)("td",{children:this.state.fileCount})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:(0,h.ih)("Size")}),(0,m.jsx)("td",{children:e.size})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:(0,h.ih)("Last Update")}),(0,m.jsx)("td",{children:S()(e.last_modified).fromNow()})]})]})]})})]})]})}}]),n}(a.Component),yo=n(20512),xo=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleChange=function(e){e.target.value.trim()?o.setState({isSubmitBtnActive:!0}):o.setState({isSubmitBtnActive:!1}),o.setState({newName:e.target.value})},o.handleSubmit=function(){var e=o.validateInput(),t=e.isValid,n=e.errMessage;if(t)if(o.checkDuplicatedName()){var r=(0,h.ih)('The name "{name}" is already taken. Please choose a different name.');r=r.replace("{name}",f.c.HTMLescape(o.state.newName)),o.setState({errMessage:r})}else o.props.onRename(o.state.newName);else o.setState({errMessage:n})},o.handleKeyDown=function(e){"Enter"===e.key&&o.handleSubmit()},o.toggle=function(){o.props.toggleCancel()},o.changeState=function(e){var t=e.object.name;o.setState({newName:t})},o.validateInput=function(){var e=o.state.newName.trim(),t=!0,n="";return e?e.indexOf("/")>-1?{isValid:t=!1,errMessage:n=(0,h.ih)("Name should not include '/'.")}:{isValid:t,errMessage:n}:{isValid:t=!1,errMessage:n=(0,h.ih)("Name is required.")}},o.checkDuplicatedName=function(){return o.props.checkDuplicatedName(o.state.newName)},o.onAfterModelOpened=function(){if(o.newInput.current){var e=o.props.currentNode,t=e.object.type;if(o.newInput.current.focus(),"file"===t){var n=e.object.name.lastIndexOf(".md");o.newInput.current.setSelectionRange(0,n,"forward")}else o.newInput.current.setSelectionRange(0,-1)}},o.state={newName:"",errMessage:"",isSubmitBtnActive:!1},o.newInput=a.createRef(),o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({newName:this.props.currentNode.object.name})}},{key:"componentDidMount",value:function(){var e=this.props.currentNode;this.changeState(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.changeState(e.currentNode)}},{key:"render",value:function(){var e=this.props.currentNode.object.type;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.toggle,onOpened:this.onAfterModelOpened,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:"file"===e?(0,h.ih)("Rename File"):(0,h.ih)("Rename Folder")}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)("p",{children:"file"===e?(0,h.ih)("New file name"):(0,h.ih)("New folder name")}),(0,m.jsx)(L.Z,{onKeyDown:this.handleKeyDown,innerRef:this.newInput,placeholder:"newName",value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&(0,m.jsx)(st.Z,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggle,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),wo=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleSubmit=function(){o.props.isMutipleOperation?o.copyItems():o.copyItem()},o.copyItems=function(){var e=o.state,t=e.repo,n=e.selectedPath,r=(0,h.ih)("Invalid destination path");if(t&&""!==n){var i=o.props.selectedDirentList,s=[];if(i.forEach((function(e){var t=f.c.joinPath(o.props.path,e.name);s.push(t)})),s.some((function(e){return e===n})))o.setState({errMessage:r});else{var a="";if(s.some((function(e){var t=n.length>e.length&&n.indexOf(e)>-1;return t&&(a=e),t})))return r=(r=(r=(0,h.ih)("Can not move directory %(src)s to its subdirectory %(des)s")).replace("%(src)s",a)).replace("%(des)s",n),void o.setState({errMessage:r});o.props.onItemsCopy(t,n),o.toggle()}}else o.setState({errMessage:r})},o.copyItem=function(){var e=o.state,t=e.repo,n=e.repoID,r=e.selectedPath,i=f.c.joinPath(o.props.path,o.props.dirent.name),s=(0,h.ih)("Invalid destination path");if(!t||t.repo_id===n&&""===r)o.setState({errMessage:s});else if(r&&i===r)o.setState({errMessage:s});else{if(r&&r.length>i.length&&r.indexOf(i)>-1)return s=(s=(s=(0,h.ih)("Can not copy directory %(src)s to its subdirectory %(des)s")).replace("%(src)s",i)).replace("%(des)s",r),void o.setState({errMessage:s});o.props.onItemCopy(t,o.props.dirent,r,o.props.path),o.toggle()}},o.toggle=function(){o.props.onCancelCopy()},o.onDirentItemClick=function(e,t){o.setState({repo:e,selectedPath:t,errMessage:""})},o.onRepoItemClick=function(e){o.setState({repo:e,selectedPath:"/",errMessage:""})},o.state={repo:{repo_id:o.props.repoID},selectedPath:o.props.path,errMessage:""},o}return(0,o.Z)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.errMessage!==t.errMessage}},{key:"render",value:function(){var e=(0,h.ih)("Copy {placeholder} to");e=this.props.isMutipleOperation?(0,h.ih)("Copy selected item(s) to:"):e.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.c.HTMLescape(this.props.dirent.name)+"</span>");var t=this.props.isMutipleOperation;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:t?e:(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:e},className:"d-flex mw-100"})}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)(Mt.Z,{repoID:this.props.repoID,currentPath:this.props.path,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:"current_repo_and_other_repos"}),this.state.errMessage&&(0,m.jsx)(st.Z,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggle,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.handleSubmit,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),bo=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleSubmit=function(){o.props.isMutipleOperation?o.moveItems():o.moveItem()},o.moveItems=function(){var e=o.props.repoID,t=o.state,n=t.repo,r=t.selectedPath,i=(0,h.ih)("Invalid destination path");if(n&&""!==r){var s=o.props.selectedDirentList,a=[];if(s.forEach((function(e){var t=f.c.joinPath(o.props.path,e.name);a.push(t)})),a.some((function(e){return e===r})))o.setState({errMessage:i});else if(r&&r===o.props.path&&n.repo_id===e)o.setState({errMessage:i});else{var l="";if(a.some((function(e){var t=r.length>e.length&&r.indexOf(e)>-1;return t&&(l=e),t})))return i=(i=(i=(0,h.ih)("Can not move directory %(src)s to its subdirectory %(des)s")).replace("%(src)s",l)).replace("%(des)s",r),void o.setState({errMessage:i});o.props.onItemsMove(n,r),o.toggle()}}else o.setState({errMessage:i})},o.moveItem=function(){var e=o.props.repoID,t=o.state,n=t.repo,r=t.selectedPath,i=f.c.joinPath(o.props.path,o.props.dirent.name),s=(0,h.ih)("Invalid destination path");if(!n||n.repo_id===e&&""===r)o.setState({errMessage:s});else if(r&&i===r)o.setState({errMessage:s});else if(r&&o.props.path===r&&n.repo_id===e)o.setState({errMessage:s});else{if(r&&r.length>i.length&&r.indexOf(i)>-1)return s=(s=(s=(0,h.ih)("Can not move directory %(src)s to its subdirectory %(des)s")).replace("%(src)s",i)).replace("%(des)s",r),void o.setState({errMessage:s});o.props.onItemMove(n,o.props.dirent,r,o.props.path),o.toggle()}},o.toggle=function(){o.props.onCancelMove()},o.onDirentItemClick=function(e,t){o.setState({repo:e,selectedPath:t,errMessage:""})},o.onRepoItemClick=function(e){o.setState({repo:e,selectedPath:"/",errMessage:""})},o.state={repo:{repo_id:o.props.repoID},selectedPath:o.props.path,errMessage:""},o}return(0,o.Z)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.errMessage!==t.errMessage}},{key:"render",value:function(){var e=(0,h.ih)("Move {placeholder} to");e=this.props.isMutipleOperation?(0,h.ih)("Move selected item(s) to:"):e.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.c.HTMLescape(this.props.dirent.name)+"</span>");var t="current_repo_and_other_repos",n=this.props,r=n.dirent,o=n.selectedDirentList,i=n.isMutipleOperation,s=(r||o[0]).permission;return f.c.getUserPermission(s).isCustomPermission&&(t="only_current_library"),(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:i?e:(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:e},className:"d-flex mw-100"})}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)(Mt.Z,{repoID:this.props.repoID,currentPath:this.props.path,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:t}),this.state.errMessage&&(0,m.jsx)(st.Z,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggle,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.handleSubmit,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),So=n(40207),Co=n(90299),Do=function(e){var t=e.title,n=e.children,r=e.moreKey,o=e.moreOperations,i=e.moreOperationClick,s=(0,a.useState)(!0),l=(0,ge.Z)(s,2),c=l[0],d=l[1],u=(0,a.useState)(!1),p=(0,ge.Z)(u,2),h=p[0],f=p[1],g=(0,a.useState)(!1),v=(0,ge.Z)(g,2),y=v[0],x=v[1],w=(0,a.useMemo)((function(){return Array.isArray(o)&&0!==o.length?o.filter((function(e){return e.key&&e.value})):[]}),[o]),b=(0,a.useCallback)((function(){d(!c)}),[c]),S=(0,a.useCallback)((function(){y||f(!0)}),[y]),C=(0,a.useCallback)((function(){y||f(!0)}),[y]),D=(0,a.useCallback)((function(){y||f(!1)}),[y]),k=(0,a.useCallback)((function(){x(!0)}),[]),j=(0,a.useCallback)((function(){x(!1),f(!1)}),[]);return(0,m.jsxs)("div",{className:"tree-section",children:[(0,m.jsxs)("div",{className:"tree-section-header".concat(h?" tree-section-header-hover":""),onMouseEnter:S,onMouseOver:C,onMouseLeave:D,children:[(0,m.jsx)("div",{className:"tree-section-header-title",children:t}),(0,m.jsxs)("div",{className:"tree-section-header-operations",children:[w.length>0&&(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:"tree-section-header-operation tree-section-more-operation",children:(0,m.jsx)(Co.Z,{item:r,toggleClass:"sf3-font sf3-font-more",freezeItem:k,unfreezeItem:j,getMenuList:function(){return w},onMenuItemClick:i})})}),(0,m.jsx)("div",{className:"tree-section-header-operation",onClick:b,children:(0,m.jsx)("i",{className:"sf3-font sf3-font-down ".concat(c?"":"rotate-90")})})]})]}),c&&(0,m.jsx)("div",{className:"tree-section-body",children:n})]})};var ko,jo,Io,Mo,_o,No,Ro,To,Oo,Eo,Po=n(45987),Zo=(0,o.Z)((function e(t){var n=this,o=t.api,i=t.mediaUrl,s=void 0===i?"":i;(0,r.Z)(this,e),this.queryUser=function(e,t){e&&(n.waitingExecCallbacks.push(t),n.emailUserMap[e]||n.waitingQueryEmails.includes(e)||(n.waitingQueryEmails.push(e),n.startQueryUsers()))},this.queryUsers=function(e,t){var r;if(Array.isArray(e)&&0!==e.length){var o=[];e.forEach((function(e){n.waitingExecCallbacks.push(t),n.emailUserMap[e]||n.waitingQueryEmails.includes(e)||o.push(e)})),0!==o.length&&((r=n.waitingQueryEmails).push.apply(r,o),n.startQueryUsers())}},this.startQueryUsers=function(){n.pendingTimer||0===n.waitingQueryEmails.length||(n.pendingTimer=setTimeout((function(){n.api(n.waitingQueryEmails).then((function(e){e.data.user_list.forEach((function(e){n.emailUserMap[e.email]=e})),n.queryUserCallback()})).catch((function(){n.waitingQueryEmails.forEach((function(e){n.emailUserMap[e]={email:e,name:e,avatar_url:n.defaultAvatarUrl}})),n.queryUserCallback()})),clearTimeout(n.pendingTimer),n.pendingTimer=null}),1e3))},this.queryUserCallback=function(){n.waitingExecCallbacks.forEach((function(e){e(n.emailUserMap)})),n.waitingQueryEmails=[],n.waitingExecCallbacks=[]},this.api=o,this.defaultAvatarUrl="".concat(s,"/avatars/default.png"),this.waitingQueryEmails=[],this.waitingExecCallbacks=[],this.emailUserMap={}})),Fo=Zo,Lo=n(21128),Ao=n.n(Lo),Uo={DEFAULT:"default",TEXT:"text",CREATOR:"creator",CTIME:"ctime",LAST_MODIFIER:"last-modifier",MTIME:"mtime",FILE_NAME:"file-name",CHECKBOX:"checkbox"},zo=(ko={},(0,Fr.default)(ko,Uo.CREATOR,"creator"),(0,Fr.default)(ko,Uo.LAST_MODIFIER,"creator"),(0,Fr.default)(ko,Uo.CTIME,"creation-time"),(0,Fr.default)(ko,Uo.MTIME,"creation-time"),(0,Fr.default)(ko,Uo.DEFAULT,"text"),(0,Fr.default)(ko,Uo.TEXT,"text"),(0,Fr.default)(ko,Uo.FILE_NAME,"text"),(0,Fr.default)(ko,Uo.CHECKBOX,"checkbox"),ko),Bo=(jo={},(0,Fr.default)(jo,Uo.CREATOR,"Creator"),(0,Fr.default)(jo,Uo.LAST_MODIFIER,"Last modifier"),(0,Fr.default)(jo,Uo.CTIME,"CTime"),(0,Fr.default)(jo,Uo.MTIME,"Last modified time"),(0,Fr.default)(jo,Uo.DEFAULT,"Text"),(0,Fr.default)(jo,Uo.TEXT,"Text"),(0,Fr.default)(jo,Uo.FILE_NAME,"File name"),(0,Fr.default)(jo,Uo.CHECKBOX,"Checkbox"),jo),Go=[Uo.CTIME,Uo.MTIME],Ho=[Uo.CREATOR,Uo.LAST_MODIFIER],Yo="YYYY-MM-DD",Vo="YYYY-MM-DDTHH:mm:ss.SSSZ",Wo="year",Ko="month",qo="day",$o="hours",Xo="minutes",Jo="YYYY-MM-DD HH:mm:ss",Qo=(Uo.CTIME,Uo.MTIME,Uo.CREATOR,Uo.LAST_MODIFIER,Io={},(0,Fr.default)(Io,Uo.CTIME,!0),(0,Fr.default)(Io,Uo.MTIME,!0),(0,Fr.default)(Io,Uo.CREATOR,!0),(0,Fr.default)(Io,Uo.LAST_MODIFIER,!0),Io),ei={},ti=(Mo={},(0,Fr.default)(Mo,Uo.TEXT,!0),(0,Fr.default)(Mo,Uo.CTIME,!0),(0,Fr.default)(Mo,Uo.MTIME,!0),(0,Fr.default)(Mo,Uo.CREATOR,!0),(0,Fr.default)(Mo,Uo.LAST_MODIFIER,!0),Mo),ni="_id",ri="_ctime",oi="_mtime",ii="_creator",si="_last_modifier",ai="_is_dir",li="_parent_dir",ci="_file_ctime",di="_file_mtime",ui="_file_creator",pi="_file_modifier",hi="_name",fi=[ni,ri,oi,ii,si],mi=[ai],gi="today",vi="tomorrow",yi="yesterday",xi="one_week_ago",wi="one_week_from_now",bi="one_month_ago",Si="one_month_from_now",Ci="number_of_days_ago",Di="number_of_days_from_now",ki="exact_date",ji="the_past_week",Ii="the_past_month",Mi="the_past_year",_i="the_next_week",Ni="the_next_month",Ri="the_next_year",Ti="the_next_numbers_of_days",Oi="the_past_numbers_of_days",Ei="this_week",Pi="this_month",Zi="this_year",Fi=(_o={},(0,Fr.default)(_o,gi,(0,h.ih)("Today")),(0,Fr.default)(_o,vi,(0,h.ih)("Tomorrow")),(0,Fr.default)(_o,yi,(0,h.ih)("Yesterday")),(0,Fr.default)(_o,xi,(0,h.ih)("One week ago")),(0,Fr.default)(_o,wi,(0,h.ih)("One week from now")),(0,Fr.default)(_o,bi,(0,h.ih)("One month ago")),(0,Fr.default)(_o,Si,(0,h.ih)("One month from now")),(0,Fr.default)(_o,Ci,(0,h.ih)("Number of days ago")),(0,Fr.default)(_o,Di,(0,h.ih)("Number of days from now")),(0,Fr.default)(_o,ki,(0,h.ih)("Exact date")),(0,Fr.default)(_o,ji,(0,h.ih)("The past week")),(0,Fr.default)(_o,Ii,(0,h.ih)("The past month")),(0,Fr.default)(_o,Mi,(0,h.ih)("The past year")),(0,Fr.default)(_o,_i,(0,h.ih)("The next week")),(0,Fr.default)(_o,Ni,(0,h.ih)("The next month")),(0,Fr.default)(_o,Ri,(0,h.ih)("The next year")),(0,Fr.default)(_o,Ti,(0,h.ih)("The next numbers of days")),(0,Fr.default)(_o,Oi,(0,h.ih)("The past numbers of days")),(0,Fr.default)(_o,Ei,(0,h.ih)("This week")),(0,Fr.default)(_o,Pi,(0,h.ih)("This month")),(0,Fr.default)(_o,Zi,(0,h.ih)("This year")),_o),Li={CONTAINS:"contains",NOT_CONTAIN:"does_not_contain",IS:"is",IS_NOT:"is_not",EQUAL:"equal",NOT_EQUAL:"not_equal",LESS:"less",GREATER:"greater",LESS_OR_EQUAL:"less_or_equal",GREATER_OR_EQUAL:"greater_or_equal",EMPTY:"is_empty",NOT_EMPTY:"is_not_empty",IS_WITHIN:"is_within",IS_BEFORE:"is_before",IS_AFTER:"is_after",IS_ON_OR_BEFORE:"is_on_or_before",IS_ON_OR_AFTER:"is_on_or_after",HAS_ANY_OF:"has_any_of",HAS_ALL_OF:"has_all_of",HAS_NONE_OF:"has_none_of",IS_EXACTLY:"is_exactly",INCLUDE_ME:"include_me",IS_CURRENT_USER_ID:"is_current_user_ID",IS_ANY_OF:"is_any_of",IS_NONE_OF:"is_none_of"},Ai=(No={},(0,Fr.default)(No,Li.CONTAINS,(0,h.ih)("contains")),(0,Fr.default)(No,Li.NOT_CONTAIN,(0,h.ih)("does not contain")),(0,Fr.default)(No,Li.IS,(0,h.ih)("is")),(0,Fr.default)(No,Li.IS_NOT,(0,h.ih)("is not")),(0,Fr.default)(No,Li.EQUAL,"="),(0,Fr.default)(No,Li.NOT_EQUAL,"\u2260"),(0,Fr.default)(No,Li.LESS,"<"),(0,Fr.default)(No,Li.GREATER,">"),(0,Fr.default)(No,Li.LESS_OR_EQUAL,"\u2264"),(0,Fr.default)(No,Li.GREATER_OR_EQUAL,"\u2265"),(0,Fr.default)(No,Li.EMPTY,(0,h.ih)("is empty")),(0,Fr.default)(No,Li.NOT_EMPTY,(0,h.ih)("is not empty")),(0,Fr.default)(No,Li.IS_WITHIN,(0,h.ih)("is within...")),(0,Fr.default)(No,Li.IS_BEFORE,(0,h.ih)("is before...")),(0,Fr.default)(No,Li.IS_AFTER,(0,h.ih)("is after...")),(0,Fr.default)(No,Li.IS_ON_OR_BEFORE,(0,h.ih)("is on or before...")),(0,Fr.default)(No,Li.IS_ON_OR_AFTER,(0,h.ih)("is on or after...")),(0,Fr.default)(No,Li.HAS_ANY_OF,(0,h.ih)("has any of...")),(0,Fr.default)(No,Li.HAS_ALL_OF,(0,h.ih)("has all of...")),(0,Fr.default)(No,Li.HAS_NONE_OF,(0,h.ih)("has none of...")),(0,Fr.default)(No,Li.IS_EXACTLY,(0,h.ih)("is exactly...")),(0,Fr.default)(No,Li.IS_CURRENT_USER_ID,(0,h.ih)("is current user's ID")),(0,Fr.default)(No,Li.INCLUDE_ME,(0,h.ih)("include the current user")),No),Ui=[Li.CONTAINS,Li.NOT_CONTAIN,Li.IS,Li.IS_NOT,Li.EMPTY,Li.NOT_EMPTY,Li.IS_CURRENT_USER_ID],zi=[Li.IS,Li.IS_WITHIN,Li.IS_BEFORE,Li.IS_AFTER,Li.IS_ON_OR_BEFORE,Li.IS_ON_OR_AFTER,Li.IS_NOT,Li.EMPTY,Li.NOT_EMPTY],Bi=[gi,vi,yi,xi,wi,bi,Si,Ci,Di,ki],Gi=(Ro={},(0,Fr.default)(Ro,Uo.TEXT,{filterPredicateList:Ui}),(0,Fr.default)(Ro,Uo.FILE_NAME,{filterPredicateList:Ui}),(0,Fr.default)(Ro,Uo.CTIME,{filterPredicateList:zi,filterTermModifierList:Bi}),(0,Fr.default)(Ro,Uo.MTIME,{filterPredicateList:zi,filterTermModifierList:Bi}),(0,Fr.default)(Ro,Uo.CREATOR,{filterPredicateList:[Li.CONTAINS,Li.NOT_CONTAIN,Li.INCLUDE_ME,Li.IS,Li.IS_NOT]}),(0,Fr.default)(Ro,Uo.LAST_MODIFIER,{filterPredicateList:[Li.CONTAINS,Li.NOT_CONTAIN,Li.INCLUDE_ME,Li.IS,Li.IS_NOT]}),(0,Fr.default)(Ro,Uo.CHECKBOX,{filterPredicateList:[Li.IS]}),(0,Fr.default)(Ro,Uo.URL,{filterPredicateList:[Li.CONTAINS,Li.NOT_CONTAIN,Li.IS,Li.IS_NOT,Li.EMPTY,Li.NOT_EMPTY]}),Ro),Hi=[ki,gi,vi,yi,xi,wi,bi,Si,Ci,Di],Yi=[ji,Ii,Mi,Ei,Pi,Zi,_i,Ni,Ri,Ti,Oi],Vi="And",Wi="Or",Ki="incomplete filter",qi="the column to filter does not exist",$i="the column to filter is not supported",Xi="unmatched filter predicate",Ji="unmatched filter modifier",Qi="invalid filter term",es="day",ts="week",ns="month",rs="quartar",os="year",is=(To={},(0,Fr.default)(To,es,"By_day"),(0,Fr.default)(To,ts,"By_week"),(0,Fr.default)(To,ns,"By_month"),(0,Fr.default)(To,rs,"By_quarter"),(0,Fr.default)(To,os,"By_year"),"province"),ss="city",as="district",ls=(Oo={},(0,Fr.default)(Oo,is,"By_province"),(0,Fr.default)(Oo,ss,"By_city"),(0,Fr.default)(Oo,as,"By_district"),[Uo.TEXT,Uo.CTIME,Uo.MTIME,Uo.CREATOR,Uo.LAST_MODIFIER]),cs="default",ds="double",us="up",ps="down",hs=[Uo.FILE_NAME,Uo.CTIME,Uo.MTIME,Uo.TEXT],fs=[Uo.TEXT],ms=((0,Or.default)("mod+s"),(0,Or.default)("mod+z"),(0,Or.default)("mod+l"),(0,Or.default)("mod+f")),gs=((0,Or.default)("mod+p"),(0,Or.default)("mod+g"),(0,Or.default)("mod+."),(0,Or.default)("mod+,"),(0,Or.default)("mod+/"),(0,Or.default)("mod+'"),(0,Or.default)("mod+;"),(0,Or.default)("mod+up"),(0,Or.default)("mod+down"),(0,Or.default)("mod+left"),(0,Or.default)("mod+right"),(0,Or.default)("mod+shift+z"),(0,Or.default)("mod+shift+g"),(0,Or.default)("mod+shift+."),(0,Or.default)("mod+shift+,"),(0,Or.default)("shift+enter"),(0,Or.default)("shift+mod+enter"),(0,Or.default)("opt+pageup"),(0,Or.default)("opt+pagedown"),(0,Or.default)("space")),vs=(0,Or.default)("enter"),ys=function(){function e(t){(0,r.Z)(this,e),this.baseName=t||"sf-metadata"}return(0,o.Z)(e,[{key:"getStorage",value:function(){try{return JSON.parse(window.localStorage.getItem(this.baseName)||"{}")}catch(e){return""}}},{key:"setItem",value:function(e,t){var n=this.getStorage(),r=(0,sr.Z)((0,sr.Z)({},n),{},(0,Fr.default)({},e,t));return window.localStorage.setItem(this.baseName,JSON.stringify(r))}},{key:"getItem",value:function(e){return this.getStorage()[e]}}]),e}(),xs=function(e,t){return Array.isArray(e)&&t?e.find((function(e){return e.key===t})):null},ws=function(e){return Go.includes(function(e){return e.type}(e))},bs="number",Ss="string",Cs="boolean",Ds="array",ks=[Uo.TEXT,Uo.FILE_NAME],js=[Li.EMPTY,Li.NOT_EMPTY],Is=[Ci,Di,Ti,Oi,ki],Ms=[Ci,Di,Ti,Oi],_s=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,null,[{key:"validate",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.column_key,o=e.filter_predicate,i=e.filter_term_modifier,s=e.filter_term,a=this.validateColumn(r,t).error_message;if(a)return{error_message:a};var l=t.find((function(e){return e.key===r})),c=this.validatePredicate(o,l).error_message;if(c)return{error_message:c};if(this.isFilterOnlyWithPredicate(o,l))return{error_message:null};var d=this.validateModifier(i,o,l).error_message;if(d)return{error_message:d};if(this.isFilterOnlyWithModifier(i,l))return{error_message:null};if(n){var u=this.validateTerm(s,o,i,l).error_message;if(u)return{error_message:u}}return{error_message:null}}},{key:"validateColumn",value:function(e,t){if(!e)return{error_message:Ki};var n=t.find((function(t){return t.key===e}));return n?this.isValidColumnType(n)?{error_message:null}:{error_message:$i}:{error_message:qi}}},{key:"validatePredicate",value:function(e,t){if(!e)return{error_message:Ki};var n=t.type;return Gi[n].filterPredicateList.includes(e)?{error_message:null}:{error_message:Xi}}},{key:"validatePredicateWithArrayType",value:function(e,t){var n=t.data.array_type;return n===Uo.CHECKBOX||n===Uo.BOOL?this.validatePredicate(e,{type:Uo.CHECKBOX}):!!js.includes(e)||(n===Uo.SINGLE_SELECT||n===Uo.DEPARTMENT_SINGLE_SELECT?this.validatePredicate(e,{type:Uo.MULTIPLE_SELECT}):Ho.includes(n)?this.validatePredicate(e,{type:Uo.COLLABORATOR}):this.validatePredicate(e,{type:n}))}},{key:"isFilterOnlyWithPredicate",value:function(e,t){if(js.includes(e))return!0;var n=t.type,r=Li.IS_CURRENT_USER_ID,o=Li.INCLUDE_ME;return!(e!==r||!ks.includes(n))||!(e!==o||!Ho.includes(n))}},{key:"validateModifier",value:function(e,t,n){if(!ws(n))return{error_message:null};if(!e)return{error_message:Ki};if(t===Li.IS_WITHIN){if(Yi.includes(e))return{error_message:null}}else if(Hi.includes(e))return{error_message:null};return{error_message:Ji}}},{key:"isFilterOnlyWithModifier",value:function(e,t){return!!ws(t)&&!Is.includes(e)}},{key:"validateTerm",value:function(e,t,n,r){return this.isTermMissing(e)?{error_message:Ki}:this.isValidTerm(e,t,n,r)?{error_message:null}:{error_message:Qi}}},{key:"isTermMissing",value:function(e){return!e&&0!==e&&!1!==e||Array.isArray(e)&&0===e.length}},{key:"isValidTerm",value:function(e,t,n,r){switch(r.type){case Uo.TEXT:case Uo.FILE_NAME:return this.isValidTermType(e,Ss);case Uo.CHECKBOX:case Uo.BOOL:return this.isValidTermType(e,Cs);case Uo.COLLABORATOR:case Uo.CREATOR:case Uo.LAST_MODIFIER:return this.isValidTermType(e,Ds);case Uo.DATE:case Uo.CTIME:case Uo.MTIME:return Ms.includes(n)?this.isValidTermType(e,bs):this.isValidTermType(e,Ss);default:return!1}}},{key:"isValidTermType",value:function(e,t){return t===Ds?Array.isArray(e)&&e.length>0:t===Uo.NUMBER?typeof e===t||!isNaN(Number(e)):typeof e===t}},{key:"isValidTermWithArrayType",value:function(e,t,n,r){var o=r.data,i=o.array_type,s=o.array_data;return i===Uo.SINGLE_SELECT?this.isValidTerm(e,t,n,{type:Uo.MULTIPLE_SELECT,data:s}):i===Uo.DEPARTMENT_SINGLE_SELECT?this.isValidTermType(e,Ds):Ho.includes(i)?this.isValidTerm(e,t,n,{type:Uo.COLLABORATOR}):this.isValidTerm(e,t,n,{type:i,data:s})}},{key:"isValidColumnType",value:function(e){var t=e.type;return Gi.hasOwnProperty(t)}},{key:"isValidSelectedOptions",value:function(e,t){var n=t.filter((function(t){return e.includes(t.id)}));return e.length===n.length}}]),e}(),Ns=[1,1,1,2,2,2,3,3,3,4,4,4],Rs=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,Ts=/\d\d?/,Os=/\d\d/,Es={mm:[Ts,Xo],HH:[Ts,$o],D:[Ts,qo],DD:[Os,qo],M:[Ts,Ko],MM:[Os,Ko],YYYY:[/\d{4}/,Wo]},Ps=["YYYY","MM","M","DD","D"],Zs=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,null,[{key:"format",value:function(e,t){var n=this.getValidDate(e);if(!n)return"";var r=t&&t.toUpperCase(),o=n.getFullYear(),i=n.getMonth()+1,s=n.getDate(),a=i<10?"0".concat(i):i,l=s<10?"0".concat(s):s;switch(r){case"YYYY-MM-DD HH:MM:SS":var c=n.getHours(),d=n.getMinutes(),u=n.getSeconds(),p=c<10?"0".concat(c):c,h=d<10?"0".concat(d):d,f=u<10?"0".concat(u):u;return"".concat(o,"-").concat(a,"-").concat(l," ").concat(p,":").concat(h,":").concat(f);case"YYYY-MM-DD HH:MM":var m=n.getHours(),g=n.getMinutes(),v=m<10?"0".concat(m):m,y=g<10?"0".concat(g):g;return"".concat(o,"-").concat(a,"-").concat(l," ").concat(v,":").concat(y);default:return"".concat(o,"-").concat(a,"-").concat(l)}}},{key:"getDateByGranularity",value:function(e,t){var n=this.getValidDate(e);if(!n)return"";var r=t&&t.toUpperCase(),o=n.getFullYear();switch(r){case"YEAR":return"".concat(o);case"QUARTAR":var i=n.getMonth(),s=Ns[i];return"".concat(o,"-Q").concat(s);case"MONTH":var a=n.getMonth()+1,l=a<10?"0".concat(a):a;return"".concat(o,"-").concat(l);case"WEEK":var c=n.getDay(),d=n.getDate()+(0===c?-6:1-c),u=new Date(o,n.getMonth(),d),p=u.getMonth()+1,h=u.getDate(),f=p<10?"0".concat(p):p,m=h<10?"0".concat(h):h;return"".concat(u.getFullYear(),"-").concat(f,"-").concat(m);case"DAY":var g=n.getMonth()+1,v=n.getDate(),y=g<10?"0".concat(g):g,x=v<10?"0".concat(v):v;return"".concat(o,"-").concat(y,"-").concat(x);default:return""}}},{key:"isValidDateObject",value:function(e){return e instanceof Date&&!isNaN(e.getTime())}},{key:"getValidDate",value:function(e){if(!e)return null;var t="string"===typeof e,n=e,r=e;return t&&(n.split(" ").length>1||n.includes("T")?r=new Date(e):(n="".concat(e," 00:00:00"),r=new Date(n))),this.isValidDateObject(r)?r:t?(r=new Date(n.replace(/-/g,"/")),this.isValidDateObject(r)?r:null):null}},{key:"parseDateWithFormat",value:function(e,t){if(e.includes("T")){var n=new Date(e);return this.isValidDateObject(n)?n:this.getValidDate(e)}try{var r=this.makeParser(t)(e),o=r.year,i=r.month,s=r.day,a=r.hours,l=r.minutes;if(!o)o=(new Date).getFullYear();var c=new Date("".concat(o,"-").concat(i,"-").concat(s," ").concat(a||"00",":").concat(l||"00"));return this.isValidDateObject(c)?c:this.getValidDate(e)}catch(d){return this.getValidDate(e)}}},{key:"makeParser",value:function(e){var t=(e||Yo).match(Rs),n=t.length;return function(e){for(var r=e.split(" "),o=r[0]||"",i=r[1]||"",s={},a=0;a<n;a++){var l=t[a],c=Es[l];if(c){var d=c[0],u=c[1];if(u){var p=Ps.includes(l),h=p?d.exec(o):d.exec(i);if(h){var f=h[0];s[u]=f,p?o=o.replace(f,""):i=i.replace(f,"")}}}}return s}}}]),e}(),Fs=[gi,vi,yi,xi,wi,bi,Si,Ci,Di,ki],Ls=function(e,t){return Array.isArray(e)&&Array.isArray(t)?e.filter((function(e){var n=_s.validate(e,t).error_message;return!n||n!==Ki})):[]},As=function(e,t){var n=function(e,t){var n=new Date,r=n.getFullYear(),o=n.getMonth(),i=n.getDate(),s=[31,28,31,30,31,30,31,31,30,31,30,31];switch(s[1]=r%4!==0||r%100===0&&r%400!==0?28:29,e){case gi:return new Date(r,o,i,0,0,0);case vi:return new Date(r,o,i+1);case yi:return new Date(r,o,i-1);case xi:return new Date(r,o,i-7);case wi:return new Date(r,o,i+7);case bi:var a=o-1,l=0===o?11:a,c=i>s[l]?s[l]:i;return new Date(r,a,c);case Si:var d=o+1,u=11===o?0:d,p=i>s[u]?s[u]:i;return new Date(r,d,p);case Ci:return new Date(r,o,i-Number(t));case Di:return new Date(r,o,i+Number(t));case ki:return new Date(t);case ji:var h=0!==n.getDay()?n.getDay():7;return{startDate:new Date(r,o,i-h-6),endDate:new Date(r,o,i-h)};case Ei:var f=0!==n.getDay()?n.getDay():7;return{startDate:new Date(r,o,i-f+1),endDate:new Date(r,o,i-f+7)};case _i:var m=0!==n.getDay()?n.getDay():7;return{startDate:new Date(r,o,i-m+8),endDate:new Date(r,o,i-m+14)};case Ii:var g=o-1;return{startDate:new Date(r,g,1),endDate:new Date(r,g,s[0===o?11:g])};case Pi:return{startDate:new Date(r,o,1),endDate:new Date(r,o,s[o])};case Ni:var v=o+1;return{startDate:new Date(r,v,1),endDate:new Date(r,v,11===o?s[0]:s[v])};case Mi:var y=r-1;return{startDate:new Date(y,0,1),endDate:new Date(y,11,31)};case Zi:return{startDate:new Date(r,0,1),endDate:new Date(r,11,31)};case Ri:var x=r+1;return{startDate:new Date(x,0,1),endDate:new Date(x,11,31)};case Ti:return{startDate:new Date(r,o,i+1,0,0,0),endDate:new Date(r,o,i+Number(t))};case Oi:return{startDate:new Date(r,o,i-Number(t)),endDate:new Date(r,o,i,0,0,0)};default:return{}}}(e,t);if(Fs.includes(e))return Zs.format(n);var r=n.startDate,o=n.endDate;return{startDate:r?Zs.format(r):"",endDate:o?Zs.format(o):""}},Us=function(e){return e.map((function(e){return function(e,t){var n=e.filter_term,r=e.filter_term_modifier,o=e;switch(t.type){case Uo.CTIME:case Uo.MTIME:o.other_date=As(r,n)}return o}(e,e.column)}))},zs=function(e,t,n){var r=n.username,o=n.userId,i=t.column_key,s=t.column,a=e[i];switch(s.type){case Uo.CTIME:case Uo.MTIME:return function(e,t){var n=t.filter_predicate,r=t.filter_term_modifier,o=t.filter_term,i=t.other_date;switch(n){case Li.IS:return r===ki&&!o||Zs.format(e)===i;case Li.IS_WITHIN:if(r===ki&&!o)return!0;if(!e)return!1;var s=i.startDate,a=i.endDate,l=Zs.format(e);return l>=s&&l<=a;case Li.IS_BEFORE:return r===ki&&!o||!(!e||!Zs.getValidDate(e))&&Zs.format(e)<i;case Li.IS_AFTER:return r===ki&&!o||!(!e||!Zs.getValidDate(e))&&Zs.format(e)>i;case Li.IS_ON_OR_BEFORE:return r===ki&&!o||!(!e||!Zs.getValidDate(e))&&Zs.format(e)<=i;case Li.IS_ON_OR_AFTER:return r===ki&&!o||!(!e||!Zs.getValidDate(e))&&Zs.format(e)>=i;case Li.IS_NOT:return r===ki&&!o||!(!e||!Zs.getValidDate(e))&&Zs.format(e)!==i;case Li.EMPTY:return!(e&&Zs.getValidDate(e));case Li.NOT_EMPTY:return!(!e||!Zs.getValidDate(e));default:return!1}}(a=Zs.format(a,Jo),t);case Uo.FILE_NAME:case Uo.TEXT:return function(e,t,n){var r=t.filter_predicate,o=t.filter_term;switch(r){case Li.CONTAINS:return!o||!!e&&e.toString().toLowerCase().indexOf(o.toLowerCase())>-1;case Li.NOT_CONTAIN:return!o||!e||e.toString().toLowerCase().indexOf(o.toLowerCase())<0;case Li.IS:return!o||e===o;case Li.IS_NOT:return!o||e!==o;case Li.EMPTY:return!e;case Li.NOT_EMPTY:return!!e;case Li.IS_CURRENT_USER_ID:return!!n&&e===n;default:return!1}}(a,t,o);case Uo.LAST_MODIFIER:case Uo.CREATOR:return function(e,t,n){var r=t.filter_predicate,o=t.filter_term;switch(r){case Li.CONTAINS:return!Array.isArray(o)||!!e&&o.findIndex((function(t){return t===e}))>-1;case Li.NOT_CONTAIN:return!Array.isArray(o)||!e||o.findIndex((function(t){return t===e}))<0;case Li.INCLUDE_ME:return e===n;case Li.IS:return!o||(Array.isArray(o)?e===o[0]:e===o);case Li.IS_NOT:return!o||(Array.isArray(o)?e!==o[0]:e!==o);default:return!1}}(a,t,r);case Uo.CHECKBOX:return function(e,t){var n=t.filter_term||!1;return("string"===typeof e?"TRUE"===e.toLocaleUpperCase():e||!1)===n}(a,t);default:return!1}},Bs=function(e,t,n,r){var o=r.username,i=r.userId,s=[],a=Us(t);return n.forEach((function(t){var n=t._id;(function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=r.username,i=void 0===o?"":o,s=r.userId;return t===Vi?n.every((function(t){return zs(e,t,{username:i,userId:s})})):t===Wi&&n.some((function(t){return zs(e,t,{username:i,userId:s})}))})(t,e,a,{username:o,userId:i})&&s.push(n)})),s},Gs=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=o.username,s=void 0===i?null:i,a=o.userId,l=void 0===a?null:a,c=e.columns,d=[];try{d=function(e,t){if(!Array.isArray(e)||0===e.length)return[];var n=[];return e.forEach((function(e){var r=e.column_key,o=_s.validate(e,t).error_message;if(o){if(o!==Ki)throw new Error(o)}else{var i=t.find((function(e){return e.key===r})),s=(0,sr.Z)((0,sr.Z)({},e),{},{column:i});n.push(s)}})),n}(r,c)}catch(u){return{row_ids:[],error_message:u.message}}return{row_ids:0===d.length?t.map((function(e){return e._id})):Bs(n,d,t,{username:s,userId:l}),error_message:null}},Hs=function(e,t){return Array.isArray(e)&&Array.isArray(t)?e.filter((function(e){return function(e,t){if(!e||!Array.isArray(t))return!1;var n=e.column_key,r=t.find((function(e){return e.key===n}));return!!r&&ls.includes(r.type)}(e,t)})):[]},Ys=function(e,t,n){var r=!e,o=!t;return r&&o?0:r?1:o?-1:e>t?n===us?1:-1:e<t?n===us?-1:1:0},Vs=/\d+|\D+/g,Ws=/\d/,Ks=function(e,t){if(!e&&!t)return 0;if(!e)return-1;if(!t)return 1;if("string"!==typeof e||"string"!==typeof t)return 0;for(var n,r,o=e.match(Vs),i=t.match(Vs),s=Math.min(o.length,i.length),a=0;a<s;a++){if(n=o[a],r=i[a],Ws.test(n)&&Ws.test(r)){if((n=parseInt(n))>(r=parseInt(r)))return 1;if(n<r)return-1}if(n!==r)return e.localeCompare(t)}return e.localeCompare(t)},qs=function(e,t,n){var r=!e,o=!t;return r&&o?0:r?1:o?-1:t===e?0:n===us?Ks(e,t):-1*Ks(e,t)},$s=function(e,t){return e[t.column_key]},Xs=function(e,t){var n=t.column,r=t.count_type;switch(n.type){case Uo.TEXT:case Uo.LAST_MODIFIER:case Uo.CREATOR:return e||null;case Uo.CTIME:case Uo.MTIME:return Zs.getDateByGranularity(e,r)||null;default:return null}},Js=function(e,t){var n=null;return ti[t]?n="string"===typeof e?e:String(e):ei[t]&&(n=(0,w.Z)(e).sort().toString()),n},Qs=function(e,t,n){var r=t[e];return r&&r.index>-1?r.index:(t[e]={},t[e].subgroups={},t[e].index=n,-1)},ea=function e(t,n,r){var o=n[r],i=o.column,s=o.sort_type,a=i.type,l=s||us;if(t.sort((function(e,t){var n,r=e.cell_value,o=t.cell_value;return hs.includes(a)?(fs.includes(a)?n=qs(r,o,l):Go.includes(a)&&(n=Ys(r,o,l)),n):""===r?1:""===o?-1:0})),Array.isArray(t[0].subgroups)&&t[0].subgroups.length>0){var c=r+1;t=t.map((function(t){var r=e(t.subgroups,n,c);return(0,sr.Z)((0,sr.Z)({},t),{},{subgroups:r})}))}return t},ta=function(e,t){if(0===e.length)return[];if(e.length>1)return function(e,t,n){var r=e.length>3?e.slice(0,3):(0,w.Z)(e),o=[],i={};return t.forEach((function(e){for(var t,n,s=e._id,a=0;a<r.length;a++){var l=r[a],c=l.column,d=l.column_key,u=c.type,p=$s(e,l),h=Xs(p,l),f=Js(h,u),m={cell_value:h,original_cell_value:p,row_ids:null,column_key:d,subgroups:[],summaries:{}};if(0===a){var g=Qs(f,i,o.length);n=i[f].subgroups,g<0?(o.push(m),t=o[o.length-1]):t=o[g]}else{var v=Qs(f,n,t.subgroups.length);n=n[f].subgroups,v<0?(t.subgroups.push(m),t=t.subgroups[t.subgroups.length-1]):t=t.subgroups[v],a===r.length-1&&(t.row_ids?t.row_ids.push(s):t.row_ids=[s])}}})),o=ea(o,r,n)}(e,t);var n=e[0],r=n.column_key,o=n.column.type,i=[],s={};return t.forEach((function(e){var t=$s(e,n),a=Xs(t,n),l=function(e,t,n){var r=t[e];return r>-1?r:(t[e]=n,-1)}(Js(a,o),s,i.length);l>-1?i[l].row_ids.push(e._id):i.push({cell_value:a,original_cell_value:t,column_key:r,row_ids:[e._id],subgroups:null,summaries:{}})})),i=ea(i,e,0)},na=function(e,t,n){if(0===t.length)return[];if(0===n.length)return t;var r=[];try{r=function(e,t){var n=Hs(e,t),r=[];return n.forEach((function(e){var n=e.column_key,o=e.count_type,i=t.find((function(e){return n===e.key})),s=i.type,a=(0,sr.Z)((0,sr.Z)({},e),{},{column:i});switch(s){case Uo.CTIME:case Uo.MTIME:a.count_type=o||ns}r.push(a)})),r}(n,e.columns)}catch(o){r=[]}return ta(r,t)},ra=function(e){return Array.isArray(e)&&"object"===typeof e[0]},oa=function(e,t){var n=e&&t.find((function(t){return t.key===e.column_key}));return!!n&&hs.includes(n.type)},ia=function(e,t){return Array.isArray(e)&&Array.isArray(t)?e.filter((function(e){return oa(e,t)})):[]},sa=function(e,t,n){var r=e.columns;if(!Array.isArray(t)||0===t.length)return[];var o=t.slice(0),i=function(e,t){var n=ia(e,t),r=[];return n.forEach((function(e){var n=e.column_key,o=t.find((function(e){return e.key===n})),i=(0,sr.Z)((0,sr.Z)({},e),{},{column:o});r.push(i)})),r}(n,r);return function(e,t){e.sort((function(e,n){var r=0;return t.forEach((function(t){var o=t.column_key,i=t.sort_type,s=t.column.type,a=e[o],l=n[o];r=Go.includes(s)?r||Ys(a,l,i):r||qs(a,l,i)})),r}))}(o,i),o.map((function(e){return e._id}))},aa=function(e,t){return e&&e.id_row_map&&t?e.id_row_map[t]:null},la=function(e,t){return e&&e.id_row_map&&Array.isArray(t)?t.map((function(t){return e.id_row_map[t]})).filter(Boolean):[]},ca=function(e,t){return Ls(e.filters,t).length>0},da=function(e,t){return Hs(e.groupbys,t).length>0},ua=function(e,t){return ia(e.sorts,t).length>0},pa=function(e){return e&&"[object Function]"==={}.toString.call(e)},ha=function(e){var t;for(t in e)return!1;return!0},fa=function(){function e(){(0,r.Z)(this,e),this.subscribers={}}return(0,o.Z)(e,[{key:"subscribe",value:function(e,t){this.subscribers[e]||(this.subscribers[e]=[]);var n=this.subscribers[e];return n.push(t),function(){var e=n.indexOf(t);e>-1&&n.splice(e,1)}}},{key:"dispatch",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=this.subscribers[e];Array.isArray(o)&&o.forEach((function(e){return e.apply(void 0,n)}))}}]),e}(),ma=fa,ga=function(){function e(){var t=this;(0,r.Z)(this,e),this.destroy=function(){t.settings={},t.metadataAPI=null,t.localStorage=null,t.userService=null,t.eventBus=null,t.hasInit=!1},this.getSetting=function(e){return!1===t.settings[e]?t.settings[e]:t.settings[e]||""},this.setSetting=function(e,n){t.settings[e]=n},this.getUsername=function(){return h.b6},this.getCollaborators=function(){var e=t.settings.repoID;return t.metadataAPI.getCollaborators(e)},this.getMetadata=function(e){var n=t.settings.repoID;return t.metadataAPI.getMetadata(n,e)},this.canModifyCell=function(e){return!1},this.canModifyRow=function(e){return!0},this.getPermission=function(){return"rw"},this.getCollaboratorsFromCache=function(){},this.restoreRows=function(){},this.updateRows=function(){},this.lockRowViaButton=function(){},this.updateRowViaButton=function(){},this.getRowsByIds=function(){},this.settings={},this.metadataAPI=null,this.localStorage=null,this.userService=null,this.eventBus=null,this.hasInit=!1}return(0,o.Z)(e,[{key:"init",value:function(){var e=(0,Vt.Z)((0,Yt.Z)().mark((function e(t){var n,r,o,i;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.otherSettings,!this.hasInit){e.next=3;break}return e.abrupt("return");case 3:this.settings=n||{},r=this.settings.mediaUrl,this.metadataAPI=co,o=this.settings.repoID,this.localStorage=new ys("sf-metadata-".concat(o)),this.userService=new Fo({mediaUrl:r,api:this.metadataAPI.listUserInfo}),i=new ma,this.eventBus=i,this.hasInit=!0;case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),va=ga,ya=n(32773),xa=n.n(ya),wa=n(10658),ba=n.n(wa),Sa=n(91635),Ca=n.n(Sa),Da={MODIFY_RECORD:"modify_record",MODIFY_RECORDS:"modify_records",RESTORE_RECORDS:"restore_records",RELOAD_RECORDS:"reload_records",MODIFY_FILTERS:"modify_filters",MODIFY_SORTS:"modify_sorts",MODIFY_GROUPBYS:"modify_groupbys",MODIFY_HIDDEN_COLUMNS:"modify_hidden_columns",LOCK_RECORD_VIA_BUTTON:"lock_record_via_button",MODIFY_RECORD_VIA_BUTTON:"modify_record_via_button"},ka=(Eo={},(0,Fr.default)(Eo,Da.MODIFY_RECORD,["repo_id","row_id","updates","old_row_data","original_updates","original_old_row_data"]),(0,Fr.default)(Eo,Da.MODIFY_RECORDS,["repo_id","row_ids","id_row_updates","id_original_row_updates","id_old_row_data","id_original_old_row_data","is_copy_paste"]),(0,Fr.default)(Eo,Da.RESTORE_RECORDS,["repo_id","rows_data","original_rows","link_infos","upper_row_ids"]),(0,Fr.default)(Eo,Da.RELOAD_RECORDS,["repo_id","row_ids"]),(0,Fr.default)(Eo,Da.MODIFY_FILTERS,["filter_conjunction","filters"]),(0,Fr.default)(Eo,Da.MODIFY_SORTS,["sorts"]),(0,Fr.default)(Eo,Da.MODIFY_GROUPBYS,["groupbys"]),(0,Fr.default)(Eo,Da.MODIFY_HIDDEN_COLUMNS,["shown_column_keys"]),(0,Fr.default)(Eo,Da.LOCK_RECORD_VIA_BUTTON,["repo_id","row_id","button_column_key"]),(0,Fr.default)(Eo,Da.MODIFY_RECORD_VIA_BUTTON,["repo_id","row_id","updates","old_row_data","original_updates","original_old_row_data","button_column_key"]),Eo),ja=[Da.MODIFY_RECORD,Da.MODIFY_RECORDS,Da.RESTORE_RECORDS],Ia=[Da.MODIFY_FILTERS,Da.MODIFY_SORTS,Da.MODIFY_GROUPBYS,Da.MODIFY_HIDDEN_COLUMNS],Ma=[Da.INSERT_RECORD,Da.INSERT_RECORDS];ba().extend(Ca());var _a=function(){function e(t){var n=this;(0,r.Z)(this,e);var o=xa()(t),i=o.type||o.op_type,s=ka[i];this.op_type=i,s.forEach((function(e){n[e]=o[e]})),this.success_callback=o.success_callback,this.fail_callback=o.fail_callback}return(0,o.Z)(e,[{key:"clone",value:function(){return new e(this)}},{key:"apply",value:function(e){return function(e,t){switch(t.op_type){case Da.MODIFY_RECORD:var n=t.row_id,r=t.original_updates,o=e.rows,i=o.findIndex((function(e){return n===e._id}));if(i<0)return e;var s=ba()().utc().format(Vo),a=window.sfMetadataContext.getUsername(),l=Object.assign({},o[i],r,{_mtime:s,_last_modifier:a});return e.rows[i]=l,e.id_row_map[n]=l,e;case Da.MODIFY_RECORDS:var c=t.id_original_row_updates,d=e.rows,u=ba()().utc().format(Vo),p=window.sfMetadataContext.getUsername(),h=(0,w.Z)(d);return d.forEach((function(t,n){var r=t._id,o=c[r];if(o){var i=Object.assign({},t,o,{_mtime:u,_last_modifier:p});h[n]=i,e.id_row_map[r]=i}})),e.rows=h,e;case Da.RESTORE_RECORDS:var f=t.original_rows,m=ba()().utc().format(Vo),g=window.sfMetadataContext.getUsername(),v=[];return f.forEach((function(t){var n=(0,sr.Z)((0,sr.Z)({},t),{},{_ctime:m,_mtime:m,_creator:g,_last_modifier:g});v.push(n),e.id_row_map[t._id]=n})),e.rows.push(v),e;case Da.LOCK_RECORD_VIA_BUTTON:var y=t.row_id,x=e.rows,b=x.findIndex((function(e){return y===e._id}));if(b<0)return e;var S=(0,sr.Z)((0,sr.Z)({},x[b]),{},{_locked:!0});return e.rows[b]=S,e.id_row_map[y]=S,e;case Da.MODIFY_RECORD_VIA_BUTTON:var C=t.row_id,D=t.original_updates,k=e.rows,j=k.findIndex((function(e){return C===e._id}));if(j<0)return e;var I=ba()().utc().format(Vo),M=window.sfMetadataContext.getUsername(),_=Object.assign({},k[j],D,{_mtime:I,_last_modifier:M});return e.rows[j]=_,e.id_row_map[C]=_,e;case Da.MODIFY_FILTERS:var N=t.filter_conjunction,R=t.filters;return e.view.filter_conjunction=N,e.view.filters=R,e;case Da.MODIFY_SORTS:var T=t.sorts;return e.view.sorts=T,e;case Da.MODIFY_GROUPBYS:var O=t.groupbys;return e.view.groupbys=O,e;case Da.MODIFY_HIDDEN_COLUMNS:var E=t.shown_column_keys;return e.view.shown_column_keys=E,e;default:return e}}(e,this)}},{key:"invert",value:function(){return function(e){switch(e.clone().op_type){case Da.MODIFY_RECORD:var t=e.page_id,n=e.row_id,r=e.updates,o=e.old_row_data,i=e.original_updates,s=e.original_old_row_data;return Na({type:Da.MODIFY_RECORD,page_id:t,row_id:n,updates:xa()(o),old_row_data:xa()(r),original_updates:xa()(s),original_old_row_data:xa()(i)});case Da.MODIFY_RECORDS:var a=e.page_id,l=e.is_copy_paste,c=e.row_ids,d=e.id_row_updates,u=e.id_original_row_updates,p=e.id_old_row_data,h=e.id_original_old_row_data;return Na({type:Da.MODIFY_RECORDS,page_id:a,is_copy_paste:l,row_ids:xa()(c),id_row_updates:xa()(p),id_original_row_updates:xa()(h),id_old_row_data:xa()(d),id_original_old_row_data:xa()(u)});case Da.RESTORE_RECORDS:var f=e.page_id,m=e.rows_data,g=e.original_rows,v=e.link_infos,y=e.upper_row_ids,x=m.map((function(e){return e._id}));return Na({type:Da.DELETE_RECORDS,page_id:f,row_ids:x,deleted_rows:xa()(m),original_deleted_rows:xa()(g),deleted_link_infos:xa()(v),upper_row_ids:xa()(y)})}}(this)}},{key:"set",value:function(e,t){this[e]=t}}]),e}();function Na(e){return new _a(e)}var Ra,Ta,Oa,Ea={QUERY_COLLABORATORS:"query-collaborators",QUERY_COLLABORATOR:"query-collaborator",UPDATE_TABLE_ROWS:"update-table-rows",LOCAL_TABLE_CHANGED:"local-table-changed",SERVER_TABLE_CHANGED:"server-table-changed",TABLE_ERROR:"table-error",OPEN_EDITOR:"open-editor",CLOSE_EDITOR:"close-editor",SELECT_CELL:"select_cell",SELECT_START:"select_start",SELECT_UPDATE:"select_update",SELECT_END:"select_end",SELECT_END_WITH_SHIFT:"select_end_with_shift",SELECT_NONE:"select_none",COPY_CELLS:"copy_cells",PASTE_CELLS:"paste_cells",SEARCH_CELLS:"search-cells",CLOSE_SEARCH_CELLS:"close-search-cells",OPEN_SELECT:"open-select",UPDATE_LINKED_RECORDS:"update_linked_records",SELECT_COLUMN:"select_column",DRAG_ENTER:"drag_enter",COLLAPSE_ALL_GROUPS:"collapse_all_groups",EXPAND_ALL_GROUPS:"expand_all_groups"},Pa={FRAGMENT:"application/x-sf-metadata-fragment",HTML:"text/html",TEXT:"text/plain",FILES:"files",DTABLE_FRAGMENT:"sf-metadata-fragment"},Za=80,Fa=16,La=48,Aa=(Ra={},(0,Fr.default)(Ra,Uo.CREATOR,!0),(0,Fr.default)(Ra,Uo.LAST_MODIFIER,!0),(0,Fr.default)(Ra,Uo.CTIME,!0),(0,Fr.default)(Ra,Uo.MTIME,!0),Ta={},(0,Fr.default)(Ta,Uo.TEXT,!0),(0,Fr.default)(Ta,Uo.FILE_NAME,!0),Ta),Ua=(0,Fr.default)({},Uo.TEXT,!0),za="group_container",Ba="row",Ga="btn_insert_row",Ha=[],Ya=[],Va="deleted_option",Wa=[],Ka=(Uo.TEXT,Uo.TEXT,Uo.CTIME,Uo.MTIME,Uo.CREATOR,Uo.LAST_MODIFIER,Uo.TEXT,1e3),qa=1e4,$a=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,null,[{key:"getFilteredRows",value:function(e,t,n,r){var o=ra(t)?t:la(e,t);return Gs(e,o,n,r,{username:h.b6}).row_ids}},{key:"getSortedRows",value:function(e,t,n){var r=ra(t)?t:la(e,t);return sa(e,r,n)}},{key:"getGroupedRows",value:function(e,t,n){var r=ra(t)?t:la(e,t);return na(e,r,n)}},{key:"updateSummaries",value:function(e,t){}},{key:"hasRelatedGroupby",value:function(e,t){return e.some((function(e){return t[e.column_key]}))}},{key:"deleteGroupRows",value:function(e,t){var n=this;e.forEach((function(e){var r=e.subgroups,o=e.row_ids;Array.isArray(r)&&r.length>0?n.deleteGroupRows(r,t):o&&(e.row_ids=o.filter((function(e){return!t[e]})))}))}},{key:"run",value:function(e){var t=e.rows,n=e.view,r=n.filters,o=n.filter_conjunction,i=n.sorts,s=n.groupbys,a=e.view.available_columns||e.columns,l=ca({filters:r},a),c=ua({sorts:i},a),d=da({groupbys:s},a);if(l||c||d){var u=t;l&&(u=this.getFilteredRows(e,u,o,r)),c&&(u=this.getSortedRows(e,u,i));var p=d?this.getGroupedRows(e,u,s):[],h=ra(u)?u.map((function(e){return e._id})):u;e.view.rows=h,e.view.groups=p}else e.view.rows=e.rows.map((function(e){return e._id}))}},{key:"updateDataWithModifyRecords",value:function(e,t){}},{key:"handleReloadedRecords",value:function(e,t,n){var r=t.reduce((function(e,t){return e[t._id]=t,e}),{});e.rows.forEach((function(t,n){var o=t._id,i=r[o],s=Object.assign({},e.rows[n],i);i&&(e.rows[n]=s,e.id_row_map[o]=s)})),this.updateDataWithModifyRecords(),this.updateSummaries()}},{key:"handleNotExistRecords",value:function(e,t){var n=[],r=[];e.rows.forEach((function(o){var i=o._id;t[i]?(n.push(o),delete e.id_row_map[i]):r.push(o)})),e.rows=e.rows.filter((function(e){return!t[e._id]})),e.view.rows=e.rows.filter((function(e){return!t[e]})),this.updateSummaries()}},{key:"updatePageDataWithCommonOperations",value:function(e,t){}},{key:"syncOperationOnData",value:function(e,t){switch(t.op_type){case Da.MODIFY_RECORD:case Da.MODIFY_RECORDS:var n=e.view.available_columns,r=t.id_original_row_updates,o=t.row_ids,i={},s=[];o.forEach((function(e){var t=r[e];t&&s.push.apply(s,(0,w.Z)(Object.keys(t)))})),s.forEach((function(e){i[e]||xs(n,e)&&(i[e]=!0)})),this.updateDataWithModifyRecords(),this.updateSummaries();break;case Da.MODIFY_RECORD_VIA_BUTTON:var a=e.view.available_columns,l=t.original_updates,c={};for(var d in l){xs(a,d)&&(c[d]=!0)}this.updateDataWithModifyRecords(),this.updateSummaries();break;case Da.RESTORE_RECORDS:var u=t.rows_data,p=t.upper_row_ids,h=e.view.rows,f=u.map((function(e){return e._id})),m=(0,w.Z)(h);Array.isArray(p)&&0!==p.length?p.forEach((function(e,t){var n=f[t],r=m.indexOf(e);r<0?m.push(n):m.splice(r+1,0,n)})):m.push.apply(m,(0,w.Z)(f)),e.view.rows=m,this.updatePageDataWithCommonOperations(),this.updateSummaries();break;case Da.MODIFY_HIDDEN_COLUMNS:case Da.MODIFY_FILTERS:this.run(e);break;case Da.MODIFY_SORTS:var g=e.view,v=g.sorts,y=g.rows,x=e.view.available_columns||e.columns;if(!ua({sorts:v},x)){this.run(e);break}e.view.rows=this.getSortedRows(e,y,v),this.updatePageDataWithCommonOperations();break;case Da.MODIFY_GROUPBYS:var b=e.view,S=b.available_columns,C=b.groupbys,D=b.rows;if(!da({groupbys:C},S)){e.view.groups=[];break}e.view.groups=this.getGroupedRows(e,D,C)}}}]),e}();Oa=$a,$a.deleteEmptyGroups=function(e){return e.filter((function(e){var t=e.subgroups,n=e.row_ids;return t&&t.length>0?0!==Oa.deleteEmptyGroups(t).length:!(!n||0===n.length)}))};var Xa=$a,Ja=function(){function e(){(0,r.Z)(this,e),this.checkReloadRecordsOperation=function(e){return e.op_type===Da.RELOAD_RECORDS}}return(0,o.Z)(e,[{key:"applyOperation",value:function(e,t){switch(e.op_type){case Da.MODIFY_RECORD:var n=e.repo_id,r=[{row_id:e.row_id,row:e.updates}];window.sfMetadataContext.updateRows(n,r).then((function(n){t({operation:e})})).catch((function(e){t({error:"Failed_to_modify_record"})}));break;case Da.MODIFY_RECORDS:var o=e.repo_id,i=e.row_ids,s=e.id_row_updates,a=e.is_copy_paste,l=i.map((function(e){return{row_id:e,row:s[e]}}));window.sfMetadataContext.updateRows(o,l,a).then((function(n){t({operation:e})})).catch((function(e){t({error:"Failed_to_modify_record"})}));break;case Da.RESTORE_RECORDS:var c=e.repo_id,d=e.rows_data;if(!Array.isArray(d)||0===d.length){t({error:"Failed_to_insert_records"});break}window.sfMetadataContext.restoreRows(c,d).then((function(n){t({operation:e})})).catch((function(e){t({error:"Failed_to_insert_records"})}));break;case Da.RELOAD_RECORDS:t({operation:e});break;case Da.LOCK_RECORD_VIA_BUTTON:var u=e.repo_id,p=e.row_id,h=e.button_column_key;window.sfMetadataContext.lockRowViaButton(u,p,h).then((function(n){t({operation:e})})).catch((function(e){t({error:"Failed_to_lock_row_via_button"})}));break;case Da.MODIFY_RECORD_VIA_BUTTON:var f=e.repo_id,m=e.row_id,g=e.button_column_key,v=e.updates;window.sfMetadataContext.updateRowViaButton(f,m,g,v).then((function(n){t({operation:e})})).catch((function(e){t({error:"Failed_to_modify_row_via_button"})}))}}},{key:"handleReloadRecords",value:function(e,t){var n=e.repo_id,r=this.getOperationRelatedColumns(e).relatedColumnKeyMap;if(this.checkReloadRecordsOperation(e)){var o=this.getOperatedRowsIds(e);this.asyncReloadRecords(o,n,r,t)}}},{key:"asyncReloadRecords",value:function(e,t,n,r){var o=this;if(Array.isArray(e)&&0!==e.length){var i=(0,w.Z)(e),s=i.splice(0,100);window.sfMetadataContext.getRowsByIds(t,s).then((function(e){if(e&&e.data&&e.data.results){var a=e.data.results,l=[],c={},d={};a.length>0&&a.forEach((function(e){l.push(e),c[e._id]=!0})),s.forEach((function(e){c[e]||(d[e]=!0)})),r({reloadedRecords:l,idRecordNotExistMap:d,relatedColumnKeyMap:n}),o.asyncReloadRecords(i,t,n,r)}else o.asyncReloadRecords(i,t,n,r)})).catch((function(e){console.log(e),o.asyncReloadRecords(i,t,n,r)}))}}},{key:"getOperationRelatedColumns",value:function(e,t){var n;switch(t.op_type){case Da.MODIFY_RECORDS:var r=t.id_original_row_updates;n=this.getRelatedColumnKeysFromRecordUpdates(r);break;case Da.RELOAD_RECORDS:var o=e.view.available_columns,i={};return o.forEach((function(e){var t=e.key;i[t]=!0})),{relatedColumnKeyMap:i,relatedColumns:o};case Da.MODIFY_RECORD_VIA_BUTTON:var s=t.row_id,a=t.original_updates;n=this.getRelatedColumnKeysFromRecordUpdates((0,Fr.default)({},s,a));break;default:n=[]}return this.getRelatedColumns(n,e)}},{key:"getOperatedRowsIds",value:function(e){switch(e.op_type){case Da.MODIFY_RECORDS:case Da.RELOAD_RECORDS:var t=e.row_ids;return Array.isArray(t)?(0,w.Z)(t):[];case Da.MODIFY_RECORD_VIA_BUTTON:var n=e.row_id;return n?[n]:[];default:return[]}}},{key:"getRelatedColumns",value:function(e,t){if(!e||0===e.length)return{relatedColumnKeyMap:{},relatedColumns:[]};var n={},r=[],o=t.view.available_columns;return e.forEach((function(e){if(!n[e]){var t=xs(o,e);t&&(n[e]=!0,r.push(t))}})),{relatedColumnKeyMap:n,relatedColumns:r}}},{key:"getRelatedColumnKeysFromRecordUpdates",value:function(e){return e?Object.keys(e).reduce((function(t,n){var r=e[n];return r&&t.push.apply(t,(0,w.Z)(Object.keys(r))),t}),[]):[]}}]),e}(),Qa=Ja,el=["type","key","name"];function tl(e,t){return Array.isArray(t)?t[e]:"undefined"!==typeof Immutable?t.get(e):null}var nl=function(e){return"0000"===e.key},rl=function(e){return!!e&&!0===e.frozen};function ol(e,t){return t[e.idx].type===Uo.FILE_NAME}function il(e,t){var n=t[e.idx];return[Uo.CHECKBOX].includes(null===n||void 0===n?void 0:n.type)}var sl=function(e,t){var n=e,r=t,o=window.sfMetadataContext.localStorage.getItem("columns_width")||{},i=n.reduce((function(e,t){return e+=o[t.key]||t.width}),0),s=Za,a=n.filter((function(e){return rl(e)})),l=a.reduce((function(e,t){return e+(o[t.key]||t.width)}),0),c=l>0?a[a.length-1].key:null,d=n.map((function(e,t){var n=o[e.key]||e.width;return e.idx=t,e.left=s,e.width=n,s+=n,e}));return{totalWidth:i,lastFrozenColumnKey:c,frozenColumnsWidth:l,columns:d,allColumns:r}},al=function(e,t){switch(e){case ri:case ci:return(0,h.ih)("Created time");case oi:case di:return(0,h.ih)("Last modified time");case ii:case ui:return(0,h.ih)("Creator");case si:case pi:return(0,h.ih)("Last modifier");case ai:return(0,h.ih)("Is folder");case li:return(0,h.ih)("Parent folder");case hi:return(0,h.ih)("File name");default:return t}},ll=function(e,t){switch(e){case ri:case ci:return Uo.CTIME;case oi:case di:return Uo.MTIME;case ii:case ui:return Uo.CREATOR;case si:case pi:return Uo.LAST_MODIFIER;case hi:return Uo.FILE_NAME;case ai:return Uo.CHECKBOX;default:return t}},cl=function(e){if(!Array.isArray(e)||0===e.length)return[];var t=window.sfMetadataContext.localStorage.getItem("columns_width")||{},n=e.map((function(e){var n=e.type,r=e.key,o=e.name,i=(0,Po.Z)(e,el);return(0,sr.Z)((0,sr.Z)({key:r,type:ll(r,n),name:al(r,o)},i),{},{width:t[r]||200})})).filter((function(e){return!fi.includes(e.key)})),r=[];return n.forEach((function(e){if("_name"===e.key)r.unshift(e);else if(e.key===li){var t=r.findIndex((function(e){return e.key===li}));-1===t?r.unshift(e):r.splice(t,0,e)}else r.push(e)})),r},dl=(0,o.Z)((function e(t,n){(0,r.Z)(this,e),this.filters=t.filters||[],this.filter_conjunction=t.filter_conjunction||"Or",this.sorts=t.sorts||[],this.groupbys=t.groupbys||[],this.groups=t.groups,this.rows=t.rows||[],this.available_columns=n||[],this.columns=this.available_columns.filter((function(e){return!mi.includes(e.key)}))})),ul=dl,pl=(0,o.Z)((function e(t){var n=this;(0,r.Z)(this,e),this.columns=t.columns||[],this.rows=t.rows||[],this.id_row_map={},this.row_ids=[],this.rows.forEach((function(e){n.row_ids.push(e._id),n.id_row_map[e._id]=e})),this.hasMore=!0,this.recordsCount=this.row_ids.length,this.view=new ul(t.view||{},this.columns)})),hl=pl,fl=(0,o.Z)((function e(t){(0,r.Z)(this,e),this.avatar_url=t.avatar_url||"",this.contact_email=t.contact_email||"",this.email=t.email||"",this.name=t.name||"",this.name_pinyin=t.name_pinyin||"",this.id=t.id_in_org||""})),ml=function(){function e(t){var n=this;(0,r.Z)(this,e),this.initStartIndex=function(){n.startIndex=0},this.saveView=function(){var e=n.data.view,t={filters:e.filters,sorts:e.sorts,gropbys:e.gropbys,filter_conjunction:e.filter_conjunction};n.context.localStorage.setItem("view",t)},this.sendOperationCallback=function(e,t){var r=t.operation,o=t.error;if(o)return r.fail_callback&&r.fail_callback(),n.context.eventBus.dispatch(Ea.TABLE_ERROR,{error:o}),void n.sendNextOperation(e);Ma.includes(r.op_type)&&(n.handleUndoRedos(e,r),n.data=r.apply(n.data),n.syncOperationOnData(r)),r.success_callback&&r.success_callback(),n.context.eventBus.dispatch(Ea.SERVER_TABLE_CHANGED),n.serverOperator.handleReloadRecords(r,(function(e){var t=e.reloadedRecords,r=e.idRecordNotExistMap,o=e.relatedColumnKeyMap;t.length>0&&Xa.handleReloadedRecords(n.data,t,o),Object.keys(r).length>0&&Xa.handleNotExistRecords(n.data,r),n.context.eventBus.dispatch(Ea.SERVER_TABLE_CHANGED)})),n.sendNextOperation(e)},this.repoId=t.repoId,this.data=null,this.context=t.context,this.startIndex=0,this.redos=[],this.undos=[],this.pendingOperations=[],this.isSendingOperation=!1,this.isTableReadonly=!1,this.serverOperator=new Qa,this.collaborators=[]}return(0,o.Z)(e,[{key:"loadData",value:function(){var e=(0,Vt.Z)((0,Yt.Z)().mark((function e(){var t,n,r,o,i,s,a,l,c,d,u,p=arguments;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=p.length>0&&void 0!==p[0]?p[0]:Ka,e.next=3,this.context.getMetadata({start:this.startIndex,limit:o});case 3:return i=e.sent,s=this.context.localStorage.getItem("view"),a=(null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.results)||[],l=cl(null===i||void 0===i||null===(n=i.data)||void 0===n?void 0:n.metadata),(c=new hl({rows:a,columns:l,view:s})).view.rows=c.row_ids,d=a.length,c.hasMore=d===o,this.data=c,this.startIndex+=d,e.next=15,this.context.getCollaborators();case 15:u=e.sent,this.collaborators=Array.isArray(null===u||void 0===u||null===(r=u.data)||void 0===r?void 0:r.user_list)?u.data.user_list.map((function(e){return new fl(e)})):[],Xa.run(this.data);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadMore",value:function(){var e=(0,Vt.Z)((0,Yt.Z)().mark((function e(t){var n,r,o,i,s,a=this;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.data){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.context.getMetadata({start:this.startIndex,limit:t});case 4:if(o=e.sent,i=(null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.results)||[],Array.isArray(i)&&0!==i.length){e.next=9;break}return this.hasMore=!1,e.abrupt("return");case 9:(r=this.data.rows).push.apply(r,(0,w.Z)(i)),i.forEach((function(e){a.data.row_ids.push(e._id),a.data.id_row_map[e._id]=e})),s=i.length,this.data.hasMore=s===t,this.data.recordsCount=this.data.row_ids.length,this.startIndex=this.startIndex+s,Xa.run(this.data),this.context.eventBus.dispatch(Ea.LOCAL_TABLE_CHANGED);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateRowData",value:function(){var e=(0,Vt.Z)((0,Yt.Z)().mark((function e(t){var n,r,o;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.context.getRowsByIds(this.repoId,[t]);case 2:if((n=e.sent)&&n.data){e.next=5;break}return e.abrupt("return");case 5:r=n.data.results[0],o=this.data.rows.findIndex((function(e){return e._id===t})),this.data.id_row_map[t]=r,this.data.rows[o]=r,Xa.run(this.data);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createOperation",value:function(e){return new _a(e)}},{key:"applyOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{handleUndo:!0},n=e.op_type;Ma.includes(n)||(this.handleUndoRedos(t,e),this.data=xa()(e.apply(this.data)),this.syncOperationOnData(e),this.context.eventBus.dispatch(Ea.LOCAL_TABLE_CHANGED)),Ia.includes(n)||this.addPendingOperations(e,t)}},{key:"addPendingOperations",value:function(e,t){this.pendingOperations.push(e),this.startSendOperation(t)}},{key:"startSendOperation",value:function(e){this.isSendingOperation||0===this.pendingOperations.length||(this.isSendingOperation=!0,this.context.eventBus.dispatch(Ea.SAVING_APP_DATA),this.sendNextOperation(e))}},{key:"sendNextOperation",value:function(e){if(0===this.pendingOperations.length)return this.isSendingOperation=!1,void this.context.eventBus.dispatch(Ea.SAVED_APP_DATA);var t=this.pendingOperations.shift();this.serverOperator.applyOperation(t,this.sendOperationCallback.bind(this,e))}},{key:"handleUndoRedos",value:function(e,t){var n=e.handleUndo,r=e.asyncUndoRedo;n&&(this.redos.length>0&&(this.redos=[]),this.undos.length>10&&(this.undos=this.undos.slice(-10)),ja.includes(t.op_type)&&this.undos.push(t)),r&&r(t)}},{key:"undoOperation",value:function(){var e=this;if(!this.isTableReadonly&&0!==this.undos.length){var t=this.undos.pop(),n=t.invert();Ma.includes(n.op_type)?this.applyOperation(n,{handleUndo:!1,asyncUndoRedo:function(n){n.op_type===Da.INSERT_RECORD&&(t.row_id=n.row_data._id),e.redos.push(t)}}):(this.redos.push(t),this.applyOperation(n,{handleUndo:!1}))}}},{key:"redoOperation",value:function(){var e=this;if(!this.isTableReadonly&&0!==this.redos.length){var t=this.redos.pop();Ma.includes(t.op_type)?this.applyOperation(t,{handleUndo:!1,asyncUndoRedo:function(n){n.op_type===Da.INSERT_RECORD&&(t=n),e.undos.push(t)}}):(this.undos.push(t),this.applyOperation(t,{handleUndo:!1}))}}},{key:"syncOperationOnData",value:function(e){Xa.syncOperationOnData(this.data,e)}},{key:"modifyRecord",value:function(e,t,n,r,o){var i=aa(this.data,e);if(i&&this.context.eventBus.canModifyRow(i)){var s=Da.MODIFY_RECORD,a=this.createOperation({type:s,repo_id:this.repoId,row_id:e,updates:t,old_row_data:n,original_updates:r,original_old_row_data:o});this.applyOperation(a)}}},{key:"modifyRecords",value:function(e,t,n,r,o,i){var s=this,a=la(this.data,e),l=[],c={},d={},u={},p={};a.forEach((function(e){if(e&&s.context.canModifyRow(e)){var i=e._id;l.push(i),c[i]=t[i],d[i]=n[i],u[i]=r[i],p[i]=o[i]}}));var h=Da.MODIFY_RECORDS,f=this.createOperation({type:h,repo_id:this.repoId,row_ids:l,id_row_updates:c,id_original_row_updates:d,id_old_row_data:u,id_original_old_row_data:p,is_copy_paste:i});this.applyOperation(f)}},{key:"reloadRecords",value:function(e){var t=Da.RELOAD_RECORDS,n=this.createOperation({type:t,repo_id:this.repoId,row_ids:e});this.applyOperation(n)}},{key:"lockRecordViaButton",value:function(e,t,n){var r=n.success_callback,o=n.fail_callback,i=Da.LOCK_RECORD_VIA_BUTTON,s=this.createOperation({type:i,repo_id:this.repoId,row_id:e,button_column_key:t,success_callback:r,fail_callback:o});this.applyOperation(s)}},{key:"modifyRecordViaButton",value:function(e,t,n,r,o,i,s){var a=s.success_callback,l=s.fail_callback;if(aa(this.data,e)){var c=Da.MODIFY_RECORD_VIA_BUTTON,d=this.createOperation({type:c,repo_id:this.repoId,row_id:e,updates:t,old_row_data:n,original_updates:r,original_old_row_data:o,button_column_key:i,success_callback:a,fail_callback:l});this.applyOperation(d)}}},{key:"modifyFilters",value:function(e,t){var n=Da.MODIFY_FILTERS,r=this.createOperation({type:n,filter_conjunction:e,filters:t});this.applyOperation(r)}},{key:"modifySorts",value:function(e){var t=Da.MODIFY_SORTS,n=this.createOperation({type:t,sorts:e});this.applyOperation(n)}},{key:"modifyGroupbys",value:function(e){var t=Da.MODIFY_GROUPBYS,n=this.createOperation({type:t,groupbys:e});this.applyOperation(n)}},{key:"modifyHiddenColumns",value:function(e){var t=Da.MODIFY_HIDDEN_COLUMNS,n=this.createOperation({type:t,shown_column_keys:e});this.applyOperation(n)}}]),e}(),gl=ml,vl=["children"],yl=a.createContext(null),xl=function(e){var t=e.children,n=(0,Po.Z)(e,vl),r=(0,a.useState)(!0),o=(0,ge.Z)(r,2),i=o[0],s=o[1],l=(0,a.useState)({rows:[],columns:[]}),c=(0,ge.Z)(l,2),d=c[0],u=c[1],p=(0,a.useRef)(null),h=(0,a.useCallback)((function(){u(p.current.data)}),[]),g=(0,a.useCallback)((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}),[]),v=(0,a.useCallback)((function(e){u(e)}),[]);return(0,a.useEffect)((function(){var e=new va;window.sfMetadataContext=e,window.sfMetadataContext.init({otherSettings:n});var t=window.sfMetadataContext.getSetting("repoID");p.current=new gl({context:window.sfMetadataContext,repoId:t}),p.current.initStartIndex(),p.current.loadData(Ka).then((function(){u(p.current.data),s(!1)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}));var r=window.sfMetadataContext.eventBus.subscribe(Ea.SERVER_TABLE_CHANGED,h),o=window.sfMetadataContext.eventBus.subscribe(Ea.LOCAL_TABLE_CHANGED,h),i=window.sfMetadataContext.eventBus.subscribe(Ea.TABLE_ERROR,g),a=window.sfMetadataContext.eventBus.subscribe(Ea.UPDATE_TABLE_ROWS,v);return function(){window.sfMetadataContext.destroy(),r(),o(),i(),a()}}),[]),(0,m.jsx)(yl.Provider,{value:{isLoading:i,metadata:d,store:p.current},children:t})},wl=function(){var e=(0,a.useContext)(yl);if(!e)throw new Error("'MetadataContext' is null");return{isLoading:e.isLoading,metadata:e.metadata,store:e.store}},bl=a.createContext(null),Sl=function(e){var t=e.children,n=(0,a.useRef)({}),r=(0,a.useState)({}),o=(0,ge.Z)(r,2),i=o[0],s=o[1],l=(0,a.useState)([]),c=(0,ge.Z)(l,2),d=c[0],u=c[1],p=wl().store;(0,a.useEffect)((function(){u((null===p||void 0===p?void 0:p.collaborators)||[])}),[null===p||void 0===p?void 0:p.collaborators]);var h=(0,a.useCallback)((function(e){var t=(0,sr.Z)((0,sr.Z)({},n.current),{},(0,Fr.default)({},e.email,e));n.current=t,s(t)}),[]);return(0,m.jsx)(bl.Provider,{value:{collaborators:d,collaboratorsCache:i,updateCollaboratorsCache:h},children:t})},Cl=function(){var e=(0,a.useContext)(bl);if(!e)throw new Error("'CollaboratorsContext' is null");return{collaborators:e.collaborators,collaboratorsCache:e.collaboratorsCache,updateCollaboratorsCache:e.updateCollaboratorsCache}},Dl=a.createContext(null),kl=function(e){var t=e.children,n=(0,a.useState)(!1),r=(0,ge.Z)(n,2),o=r[0],i=r[1],s=(0,a.useState)({}),l=(0,ge.Z)(s,2),c=l[0],d=l[1],u=(0,a.useCallback)((function(e){d(e),i(!0)}),[]),p=(0,a.useCallback)((function(){d({}),i(!1)}),[]);return(0,m.jsx)(Dl.Provider,{value:{isShowRecordDetails:o,recordDetails:c,openRecordDetails:u,closeRecordDetails:p},children:t})},jl=function(){var e=(0,a.useContext)(Dl);if(!e)throw new Error("'RecordDetailsContext' is null");return{isShowRecordDetails:e.isShowRecordDetails,recordDetails:e.recordDetails,openRecordDetails:e.openRecordDetails,closeRecordDetails:e.closeRecordDetails}},Il=Pa.FRAGMENT,Ml=Pa.HTML,_l=Pa.TEXT;function Nl(e,t){return e.types&&e.types.length?e.getData(t):t===_l&&e.getData("Text")||null}function Rl(e){var t=(e?e.replace(/\r/g,""):"").split("\n"),n=t[0].split("\t").map((function(e,t){return{key:"col".concat(t),type:"text"}})),r=[];return t.forEach((function(e){var t={};e&&(e=e.split("\t")).forEach((function(e,n){t["col".concat(n)]=e})),r.push(t)})),{copiedRecords:r,copiedColumns:n}}var Tl,Ol,El,Pl,Zl,Fl=function(e){var t,n,r,o=e.dataTransfer||e.clipboardData,i=Nl(o,Il),s=Nl(o,Ml),a=Nl(o,_l),l=function(e){var t;try{e.items&&e.items.length?t=Array.from(e.items).map((function(e){return"file"===e.kind?e.getAsFile():null})).filter((function(e){return e})):e.files&&e.files.length&&(t=Array.from(e.files))}catch(n){e.files&&e.files.length&&(t=Array.from(e.files))}return t}(o);if(i)return t={},(0,Fr.default)(t,Pa.DTABLE_FRAGMENT,JSON.parse(i)),(0,Fr.default)(t,"type",Pa.DTABLE_FRAGMENT),t;if(s){var c,d,u=(new DOMParser).parseFromString(s,Ml).querySelector("table");return u?(d={},(0,Fr.default)(d,Pa.DTABLE_FRAGMENT,function(e){var t=e.querySelectorAll("tr"),n=t[0].querySelectorAll("td"),r=[],o=[];return n.forEach((function(e,t){r.push({key:"col".concat(t),type:"text"})})),t.forEach((function(e){var t={};e.querySelectorAll("td").forEach((function(e,n){t["col".concat(n)]=e.innerText})),o.push(t)})),{copiedRecords:o,copiedColumns:r}}(u)),(0,Fr.default)(d,"html",s),(0,Fr.default)(d,"text",a),(0,Fr.default)(d,"type","html"),d):(c={},(0,Fr.default)(c,Pa.DTABLE_FRAGMENT,Rl(a)),(0,Fr.default)(c,"html",s),(0,Fr.default)(c,"text",a),(0,Fr.default)(c,"type","html"),c)}return l&&l.length?(n={},(0,Fr.default)(n,Pa.DTABLE_FRAGMENT,Rl(a)),(0,Fr.default)(n,"files",l),(0,Fr.default)(n,"type","files"),n):a?(r={},(0,Fr.default)(r,Pa.DTABLE_FRAGMENT,Rl(a)),(0,Fr.default)(r,"text",a),(0,Fr.default)(r,"type","text"),r):void 0},Ll=function(e){return e&&e.target&&e.target.getAttribute("class")||""},Al="undefined"!==typeof window&&(window.innerWidth<768||null!=navigator.userAgent.toLowerCase().match(/(ipod|ipad|iphone|android|coolpad|mmp|smartphone|midp|wap|xoom|symbian|j2me|blackberry|wince)/i)),Ul=function(e,t){return e.split(" ").indexOf(t)>-1?e:e+" "+t},zl=function(e,t){var n=e.split(" "),r=n.indexOf(t);return r<0?e:(n.splice(r,1),n.join(" "))},Bl=n(43950),Gl=function(){var e=jl(),t=e.isShowRecordDetails,n=e.recordDetails,r=e.closeRecordDetails,o=Cl(),i=o.collaborators,s=o.collaboratorsCache,a=o.updateCollaboratorsCache,l=wl().metadata;if(!t)return null;var c={collaborators:i,collaboratorsCache:s,updateCollaboratorsCache:a,queryUserAPI:window.sfMetadataContext.userService.queryUser,record:n,fields:l.view.columns,fieldIconConfig:zo,onToggle:r};return(0,m.jsx)(Bl.QS,(0,sr.Z)({},c))},Hl=(Tl={},(0,Fr.default)(Tl,Uo.TEXT,!0),(0,Fr.default)(Tl,Uo.URL,!0),Ol={},(0,Fr.default)(Ol,ki,!0),(0,Fr.default)(Ol,Ci,!0),(0,Fr.default)(Ol,Di,!0),(0,Fr.default)(Ol,Ti,!0),(0,Fr.default)(Ol,Oi,!0),El={},(0,Fr.default)(El,Li.IS_ANY_OF,!0),(0,Fr.default)(El,Li.IS_NONE_OF,!0),(0,Fr.default)(El,Li.HAS_ANY_OF,!0),(0,Fr.default)(El,Li.HAS_ALL_OF,!0),(0,Fr.default)(El,Li.HAS_NONE_OF,!0),(0,Fr.default)(El,Li.IS_EXACTLY,!0),El),Yl=(Pl={},(0,Fr.default)(Pl,Li.IS,!0),(0,Fr.default)(Pl,Li.IS_NOT,!0),Pl),Vl=(Zl={},(0,Fr.default)(Zl,Li.EMPTY,!0),(0,Fr.default)(Zl,Li.NOT_EMPTY,!0),Zl),Wl=[Uo.CREATOR,Uo.LAST_MODIFIER],Kl=function(e,t){var n=e.type;return!!Wl.includes(n)},ql=function(e,t){var n=[Li.CONTAINS,Li.NOT_CONTAIN],r=e.filter_predicate,o=e.filter_term;if(n.includes(r)){o=o?e.filter_term.slice(0):[];var i=t.email,s=o.indexOf(i);s>-1?o.splice(s,1):o.push(i)}else{if(o[0]===t.email)return;o=[t.email]}return Object.assign({},e,{filter_term:o})},$l=function(e,t){var n;if(Hl[e.filter_predicate]){var r=(n=Array.isArray(e.filter_term)?(0,w.Z)(e.filter_term):[]).indexOf(t.id);-1===r?n.push(t.id):n.splice(r,1)}else n=t.id;return Object.assign({},e,{filter_term:n})},Xl=function(e,t){var n=e.filter_term?e.filter_term:[],r=n.indexOf(t.id);return r>-1?n.splice(r,1):n.push(t.id),Object.assign({},e,{filter_term:n})},Jl=function(e,t){var n=e.filter_term?e.filter_term.slice(0):[],r=t.email,o=n.indexOf(r);return o>-1?n.splice(o,1):n.push(r),Object.assign({},e,{filter_term:n})},Ql=function(e){var t=e.type;return Gi[t]||{}},ec=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ql(e).filterPredicateList;if(n){var r=n[0],o=Object.assign({},t,{column_key:e.key,filter_predicate:r});if(o.filter_term="",Kl(e))return o.filter_term=[],o;if(ws(e)){var i=r===Li.IS_WITHIN?Yi[0]:Hi[0];return o.filter_term_modifier=i,o.filter_term="",o}return o}},tc=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,null,[{key:"generatorColumnOption",value:function(e){if(!e)return null;var t=e.type,n=e.name;return{value:{column:e},label:(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("span",{className:"filter-header-icon",children:(0,m.jsx)(Bl.JO,{iconName:zo[t]})}),(0,m.jsx)("span",{className:"select-option-name",children:n})]})}}},{key:"generatorPredicateOption",value:function(e){return{value:{filterPredicate:e},label:(0,m.jsx)("span",{className:"select-option-name",children:Ai[e]})}}},{key:"generatorTermModifierOption",value:function(e){return{value:{filterTermModifier:e},label:(0,m.jsx)("span",{className:"select-option-name",children:Fi[e]})}}},{key:"generatorSingleSelectOption",value:function(e,t){return{value:{columnOption:e},label:(0,m.jsxs)("div",{className:"select-option-name single-option-name",children:[(0,m.jsx)("div",{className:"single-select-option",style:{background:e.color,color:e.textColor||null},title:e.name,"aria-label":e.name,children:e.name}),(0,m.jsx)("div",{className:"single-check-icon",children:(null===t||void 0===t?void 0:t.id)===e.id&&(0,m.jsx)("i",{className:"option-edit sf-metadata-font sf-metadata-icon-check-mark"})})]})}}},{key:"generatorMultipleSelectOption",value:function(e,t){return{value:{columnOption:e},label:(0,m.jsxs)("div",{className:"select-option-name multiple-option-name",children:[(0,m.jsx)("div",{className:"multiple-select-option",style:{background:e.color,color:e.textColor},title:e.name,"aria-label":e.name,children:e.name}),(0,m.jsx)("div",{className:"multiple-check-icon",children:t.indexOf(e.id)>-1&&(0,m.jsx)("i",{className:"option-edit sf-metadata-font sf-metadata-icon-check-mark"})})]})}}},{key:"generatorConjunctionOptions",value:function(){return[{value:{filterConjunction:"And"},label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.ih)("And")})},{value:{filterConjunction:"Or"},label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.ih)("Or")})}]}},{key:"getActiveConjunctionOption",value:function(e){return"And"===e?{value:{filterConjunction:"And"},label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.ih)("And")})}:{value:{filterConjunction:"Or"},label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.ih)("Or")})}}}]),e}(),nc=tc,rc=function(e){var t=e.isLocked,n=e.filterIndex,r=e.filterTerm,o=e.collaborators,i=e.placeholder,s=e.filter_predicate,l=e.onSelectCollaborator,c=(0,a.useMemo)((function(){return[Li.HAS_ANY_OF,Li.HAS_ALL_OF,Li.HAS_NONE_OF,Li.IS_EXACTLY]}),[]),d=(0,a.useMemo)((function(){return c.indexOf(s)>-1}),[c,s]),u=(0,a.useMemo)((function(){return Array.isArray(r)?o.map((function(e){var t=r.findIndex((function(t){return t===e.email}))>-1;return{value:{filterIndex:n,columnOption:e},label:(0,m.jsx)(a.Fragment,{children:(0,m.jsxs)("div",{className:"select-option-name option-collaborator",children:[(0,m.jsx)("div",{className:"collaborator-container",children:(0,m.jsxs)("div",{className:"collaborator",children:[(0,m.jsx)("span",{className:"collaborator-avatar-container",children:(0,m.jsx)("img",{className:"collaborator-avatar",alt:e.name,src:e.avatar_url})}),(0,m.jsx)("span",{className:"collaborator-name text-truncate",style:{maxWidth:"200px"},title:e.name,"aria-label":e.name,children:e.name})]})}),(0,m.jsx)("div",{className:"collaborator-check-icon",children:t&&(0,m.jsx)(Bl.JO,{iconName:"check-mark"})})]})})}})):[]}),[n,o,r]),p=(0,a.useMemo)((function(){return Array.isArray(r)&&r.length>0&&r.map((function(e){var t=o.find((function(t){return t.email===e}));return t?(0,m.jsxs)("div",{className:"collaborator",children:[(0,m.jsx)("span",{className:"collaborator-avatar-container",children:(0,m.jsx)("img",{className:"collaborator-avatar",alt:t.name,src:t.avatar_url})}),(0,m.jsx)("span",{className:"collaborator-name text-truncate",title:t.name,"aria-label":t.name,children:t.name})]},e):null}))}),[r,o]);return(0,m.jsx)(Bl.fg,{className:"selector-collaborator",value:p?{label:p}:{},onSelectOption:l,options:u,placeholder:i,isLocked:t,supportMultipleSelect:d,searchable:!0,searchPlaceholder:(0,h.ih)("Search collaborator"),isShowSelected:!1,noOptionsPlaceholder:(0,h.ih)("No collaborators")})},oc=function(e){var t=e.value,n=e.filterColumn,r=e.isReadOnly,o=e.onChange,i=function(e){return e&&e.data&&e.data.format?e.data.format:Yo}(n).trim(),s=window.sfMetadataContext.getSetting("lang");return(0,m.jsx)(Bl.f,{isReadOnly:r,format:i,lang:s,value:t,onChange:o})},ic=[Li.EMPTY,Li.NOT_EMPTY],sc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).initSelectOptions=function(e){var t=e.filter,n=e.filterColumn,r=(e.value,Ql(n)),i=r.filterPredicateList,s=r.filterTermModifierList;o.filterPredicateOptions=i?i.map((function(e){return nc.generatorPredicateOption(e)})).filter((function(e){return e})):[];var a=t.filter_predicate;ws(n)&&(a===Li.IS_WITHIN&&(s=Yi),o.filterTermModifierOptions=s.map((function(e){return nc.generatorTermModifierOption(e)})))},o.onDeleteFilter=function(e){e.nativeEvent.stopImmediatePropagation();var t=o.props.index;o.props.deleteFilter(t)},o.resetState=function(e){o.setState({filterTerm:e.filter_term})},o.onSelectConjunction=function(e){o.props.filterConjunction!==e.filterConjunction&&o.props.updateConjunction(e.filterConjunction)},o.onSelectColumn=function(e){var t=o.props,n=t.index,r=t.filter,i=e.column;if(i.key!==r.column_key){var s=ec(i,r);s&&(o.resetState(s),o.props.updateFilter(n,s))}},o.onSelectPredicate=function(e){var t=o.props,n=t.index,r=t.filter,i=t.filterColumn,s=e.filterPredicate;if(r.filter_predicate!==s){var a=function(e,t,n){var r=Object.assign({},e,{filter_predicate:n}),o=t.type;if([Uo.CREATOR,Uo.LAST_MODIFIER].includes(o)&&(Yl[e.filter_predicate]===Yl[n]&&n!==Li.INCLUDE_ME||(r.filter_term=[])),Kl(t))return(Vl[n]||n===Li.INCLUDE_ME)&&(r.filter_term=[]),r;if(ws(t)){var i=n===Li.IS_WITHIN?Yi[0]:Hi[0];return r.filter_term_modifier=i,r}return r}(r,i,s);o.resetState(a),o.props.updateFilter(n,a)}},o.onSelectTermModifier=function(e){var t=o.props,n=t.index,r=t.filter,i=e.filterTermModifier,s=[ki,Ci,Di,Ti,Oi];if(r.filter_term_modifier!==i){var a=r.filter_term;s.indexOf(r.filter_term_modifier)>-1&&(a="");var l=Object.assign({},r,{filter_term_modifier:i,filter_term:a});o.resetState(l),o.props.updateFilter(n,l)}},o.onSelectSingle=function(e){var t=o.props,n=t.index,r=t.filter,i=e.columnOption;if(r.filter_term!==i.id){var s=$l(r,i);o.resetState(s),o.props.updateFilter(n,s)}},o.onSelectMultiple=function(e){var t=o.props,n=t.index,r=t.filter,i=e.columnOption,s=Xl(r,i);o.resetState(s),o.props.updateFilter(n,s)},o.onSelectCollaborator=function(e){var t=o.props,n=t.index,r=t.filter,i=e.columnOption,s=Jl(r,i);o.resetState(s),o.props.updateFilter(n,s)},o.onSelectCreator=function(e){var t=o.props,n=t.index,r=t.filter,i=e.columnOption,s=ql(r,i);s&&(o.resetState(s),o.props.updateFilter(n,s))},o.onFilterTermCheckboxChanged=function(e){o.onFilterTermChanged(e.target.checked)},o.onFilterTermTextChanged=function(e){o.onFilterTermChanged(e)},o.onFilterTermNumberChanged=function(){var e=o.numberEditor.getValue();o.onFilterTermChanged(Object.values(e)[0])},o.onFilterTermChanged=function(e){var t=o.props,n=t.index,r=t.filter;if(e!==o.state.filterTerm){o.setState({filterTerm:e});var i=Object.assign({},r,{filter_term:e});o.props.updateFilter(n,i)}},o.onMouseEnterRateItem=function(e){o.setState({enterRateItemIndex:e})},o.onMouseLeaveRateItem=function(){o.setState({enterRateItemIndex:0})},o.onChangeRateNumber=function(e){o.onFilterTermChanged(e)},o.getInputComponent=function(e){var t=o.state.filterTerm;return"text"===e?(0,m.jsx)(Bl.Mj,{value:t,onChange:o.onFilterTermTextChanged,autoFocus:!1,className:Br()("text-truncate")}):"checkbox"===e?(0,m.jsx)("input",{type:"checkbox",checked:t,onChange:o.onFilterTermCheckboxChanged}):void 0},o.renderConjunction=function(){var e=o.props,t=e.index,n=e.filterConjunction,r=e.conjunctionOptions;switch(t){case 0:return null;case 1:var i=nc.getActiveConjunctionOption(n);return(0,m.jsx)(Bl.fg,{value:i,options:r,onSelectOption:o.onSelectConjunction});default:return(0,m.jsx)("span",{className:"selected-conjunction-show",children:(0,h.ih)(n)})}},o.renderMultipleSelectOption=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=o.props.filter.filter_predicate,r=!1;[Li.IS_ANY_OF,Li.IS_NONE_OF,Li.HAS_ANY_OF,Li.HAS_ALL_OF,Li.HAS_NONE_OF,Li.IS_EXACTLY].includes(n)&&(r=!0);var i=[];Array.isArray(e)&&Array.isArray(t)&&t.forEach((function(t){var n=e.find((function(e){return e.id===t})),r={margin:"0 10px 0 0"},o=null;n?(o=n.name,r.background=n.color,r.color=n.textColor||null):(r.background="#eaeaea",o=(0,h.ih)(Va)),i.push((0,m.jsx)("span",{className:"select-option-name multiple-select-option",style:r,title:o,"aria-label":o,children:o},"option_"+t))}));var s=i.length>0?{label:(0,m.jsx)(a.Fragment,{children:i})}:{},l=e.map((function(e){return nc.generatorMultipleSelectOption(e,t)}));return(0,m.jsx)(Bl.fg,{className:"selector-multiple-select",value:s,options:l,onSelectOption:o.onSelectMultiple,placeholder:(0,h.ih)("Select option(s)"),searchable:!0,searchPlaceholder:(0,h.ih)("Search option"),noOptionsPlaceholder:(0,h.ih)("No options available"),supportMultipleSelect:r})},o.renderFilterTerm=function(e){var t=o.props,n=t.index,r=t.filter,i=t.collaborators,s=e.type,a=r.filter_term,l=r.filter_predicate,c=r.filter_term_modifier;if(ic.includes(l))return null;if(ws(e))return[ki,Ci,Di,Ti,Oi].indexOf(c)>-1?"exact_date"===c?(0,m.jsx)(oc,{onChange:o.onFilterTermTextChanged,value:o.state.filterTerm,filterColumn:e}):o.getInputComponent("text"):null;switch(s){case Uo.FILE_NAME:case Uo.TEXT:case Uo.URL:return l===Li.IS_CURRENT_USER_ID?null:o.getInputComponent("text");case Uo.CREATOR:case Uo.LAST_MODIFIER:if(l===Li.INCLUDE_ME)return null;var d=i;return(0,m.jsx)(rc,{filterIndex:n,filterTerm:a||[],collaborators:d,onSelectCollaborator:o.onSelectCreator});case Uo.CHECKBOX:return o.getInputComponent("checkbox");default:return null}},o.isRenderErrorTips=function(){var e=o.props.errMsg;return e&&e!==Ki},o.renderErrorMessage=function(){return o.isRenderErrorTips()?(0,m.jsxs)("div",{className:"ml-2",children:[(0,m.jsx)(Bl.a5,{ref:o.invalidFilterTip,iconName:"exclamation-triangle"}),(0,m.jsx)(Oe.Z,{target:o.invalidFilterTip,placement:"bottom",fade:!1,children:(0,h.ih)("Invalid filter")})]}):null},o.state={filterTerm:e.filter.filter_term,enterRateItemIndex:0},o.filterPredicateOptions=null,o.filterTermModifierOptions=null,o.filterToolTip=a.createRef(),o.invalidFilterTip=a.createRef(),o.initSelectOptions(e),o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.filter;e.filter!==t&&(this.initSelectOptions(e),this.setState({filterTerm:e.filter.filter_term}))}},{key:"shouldComponentUpdate",value:function(e){var t=this.props;return e.index!==t.index||e.filter!==t.filter||e.filterColumn!==t.filterColumn||e.filterConjunction!==t.filterConjunction||e.conjunctionOptions!==t.conjunctionOptions||e.filterColumnOptions!==t.filterColumnOptions}},{key:"render",value:function(){var e=this.filterPredicateOptions,t=this.filterTermModifierOptions,n=this.props,r=n.filter,o=n.filterColumn,i=n.filterColumnOptions,s=r.filter_predicate,a=r.filter_term_modifier,l=nc.generatorColumnOption(o),c=nc.generatorPredicateOption(s),d=null,u=!1;ws(o)?d=nc.generatorTermModifierOption(a):function(e){return e.type===Uo.CHECKBOX}(o)&&(u=!0);var p=[Li.CONTAINS,Li.NOT_CONTAIN].includes(s),f=this.isRenderErrorTips(),g=p&&!f,v=!ic.includes(s);return(0,m.jsxs)("div",{className:"filter-item",children:[(0,m.jsx)("div",{className:"delete-filter",onClick:this.onDeleteFilter,children:(0,m.jsx)(Bl.JO,{iconName:"fork-number"})}),(0,m.jsxs)("div",{className:"condition",children:[(0,m.jsx)("div",{className:"filter-conjunction",children:this.renderConjunction()}),(0,m.jsxs)("div",{className:"filter-container",children:[(0,m.jsx)("div",{className:"filter-column",children:(0,m.jsx)(Bl.fg,{value:l,options:i,onSelectOption:this.onSelectColumn,searchable:!0,searchPlaceholder:(0,h.ih)("Search column"),noOptionsPlaceholder:(0,h.ih)("No results")})}),(0,m.jsx)("div",{className:"filter-predicate ml-2 ".concat(u?"filter-checkbox-predicate":""),children:(0,m.jsx)(Bl.fg,{value:c,options:e,onSelectOption:this.onSelectPredicate})}),ws(o)&&v&&(0,m.jsx)("div",{className:"filter-term-modifier ml-2",children:(0,m.jsx)(Bl.fg,{value:d,options:t,onSelectOption:this.onSelectTermModifier})}),(0,m.jsx)("div",{className:"filter-term ml-2",children:this.renderFilterTerm(o)}),g&&(0,m.jsxs)("div",{className:"ml-2",children:[(0,m.jsx)("span",{ref:this.filterToolTip,id:"filter_tool_tip","aria-hidden":"true",className:"sf-metadata-font sf-metadata-icon-exclamation-triangle",style:{color:"#FFC92C"}}),(0,m.jsx)(Oe.Z,{placement:"bottom",target:this.filterToolTip,children:(0,h.ih)("Filter tip message")})]}),this.renderErrorMessage()]})]})]})}}]),n}(a.Component),ac=sc,lc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).updateFilter=function(e,t){t&&o.props.updateFilter(e,t)},o.deleteFilter=function(e){var t=o.props.scheduleUpdate;o.props.deleteFilter(e,t)},o.updateConjunction=function(e){o.props.updateFilterConjunction(e)},o.getConjunctionOptions=function(){return o.conjunctionOptions||(o.conjunctionOptions=nc.generatorConjunctionOptions()),o.conjunctionOptions},o.getFilterColumns=function(){return o.props.columns.filter((function(e){var t=e.type;return Object.prototype.hasOwnProperty.call(Gi,t)}))},o.getColumnOptions=function(){if(!o.columnOptions){var e=o.getFilterColumns();o.columnOptions=e.map((function(e){return nc.generatorColumnOption(e)}))}return o.columnOptions},o.renderFilterItem=function(e,t,n,r){var i=o.props,s=i.filterConjunction,a=i.value,l=o.getConjunctionOptions(),c=o.getColumnOptions();return(0,m.jsx)(ac,{isLocked:o.props.isLocked,index:t,filter:e,errMsg:n,filterColumn:r,filterConjunction:s,conjunctionOptions:l,filterColumnOptions:c,value:a,deleteFilter:o.deleteFilter,updateFilter:o.updateFilter,updateConjunction:o.updateConjunction,collaborators:o.props.collaborators,isPre:o.props.isPre},t)},o.conjunctionOptions=null,o.columnOptions=null,o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.columns!==this.props.columns&&(this.columnOptions=null)}},{key:"render",value:function(){var e=this,t=this.props,n=t.filters,r=t.className,o=t.emptyPlaceholder,i=t.columns,s=0===n.length;return(0,m.jsxs)("div",{className:Br()("filters-list",{"empty-filters-container":s},(0,Fr.default)({},r,r)),children:[s&&(0,m.jsx)("div",{className:"empty-filters-list",children:o}),!s&&n.map((function(t,n){var r=t.column_key,o=_s.validate(t,i).error_message,s=xs(i,r)||{};return e.renderFilterItem(t,n,o,s)}))]})}}]),n}(a.Component),cc=lc,dc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onHotKey=function(e){(0,Or.default)("esc",e)&&!o.isSelectOpen&&(e.preventDefault(),o.props.hidePopover())},o.setSelectStatus=function(e){o.isSelectOpen=e},o.hideDTablePopover=function(e){if(o.dtablePopoverRef&&!Ll(e).includes("popover")&&!o.dtablePopoverRef.contains(e.target))return o.props.hidePopover(e),e.preventDefault(),e.stopPropagation(),!1},o.isNeedSubmit=function(){return o.props.isNeedSubmit},o.update=function(e){if(o.isNeedSubmit()){o.setState({filters:e,isSubmitDisabled:!1})}else o.setState({filters:e},(function(){var t={filters:e,filter_conjunction:o.state.filterConjunction};o.props.update(t)}))},o.deleteFilter=function(e,t){var n=o.state.filters.slice(0);n.splice(e,1),0===n.length&&t(),o.update(n)},o.updateFilter=function(e,t){var n=o.state.filters.slice(0);n[e]=t,o.update(n)},o.updateFilterConjunction=function(e){if(o.isNeedSubmit()){o.setState({filterConjunction:e,isSubmitDisabled:!1})}else o.setState({filterConjunction:e},(function(){var t={filters:o.state.filters,filter_conjunction:e};o.props.update(t)}))},o.addFilter=function(e){var t=o.props.columns,n=t[0];if(Gi[n.type]||(n=t.find((function(e){return Gi[e.type]}))),n){var r=ec(n),i=o.state.filters.slice(0);0===i.length&&e(),i.push(r),o.update(i)}},o.onClosePopover=function(){o.props.hidePopover()},o.onSubmitFilters=function(){var e=o.state,t={filters:e.filters,filter_conjunction:e.filterConjunction};o.props.update(t),o.props.hidePopover()},o.onPopoverInsideClick=function(e){e.stopPropagation()},o.state={filters:Ls(e.filters,e.columns),filterConjunction:e.filterConjunction||"And"},o.isSelectOpen=!1,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.hideDTablePopover,!0),document.addEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect=window.sfMetadataContext.eventBus.subscribe(Ea.OPEN_SELECT,this.setSelectStatus)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.hideDTablePopover,!0),document.removeEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect()}},{key:"render",value:function(){var e=this,t=this.props,n=t.target,r=t.columns,o=t.placement,i=this.state,s=i.filters,a=i.filterConjunction,l=r.length>0;return(0,m.jsx)(Gr.Z,{placement:o,isOpen:!0,target:n,fade:!1,hideArrow:!0,className:"filter-popover",boundariesElement:document.body,children:function(t){var n=t.scheduleUpdate;return(0,m.jsxs)("div",{ref:function(t){return e.dtablePopoverRef=t},onClick:e.onPopoverInsideClick,className:e.props.filtersClassName,children:[(0,m.jsx)(cc,{filterConjunction:a,filters:s,columns:r,emptyPlaceholder:(0,h.ih)("No filters"),updateFilter:e.updateFilter,deleteFilter:e.deleteFilter,updateFilterConjunction:e.updateFilterConjunction,collaborators:e.props.collaborators,readOnly:!1,scheduleUpdate:n,isPre:e.props.isPre}),(0,m.jsx)(Bl.$R,{className:"popover-add-tool ".concat(l?"":"disabled"),callBack:l?function(){return e.addFilter(n)}:function(){},footerName:(0,h.ih)("Add filter"),addIconClassName:"popover-add-icon"}),e.isNeedSubmit()&&(0,m.jsxs)("div",{className:"filter-popover-footer",children:[(0,m.jsx)(R.Z,{className:"mr-2",onClick:e.onClosePopover,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",disabled:e.state.isSubmitDisabled,onClick:e.onSubmitFilters,children:(0,h.ih)("Submit")})]})]})}})}}]),n}(a.Component);dc.defaultProps={filtersClassName:"",placement:"auto-start"};var uc=dc,pc="add_sort",hc="delete_sort",fc="modify_sort_column",mc="modify_sort_type",gc=function(e,t){var n=t.sorts;switch(e){case pc:var r={column_key:null,sort_type:us};return n.push(r),n;case hc:var o=t.index;return n.splice(o,1),n;case fc:var i=t.index,s={column_key:t.column_key,sort_type:us};return n[i]=s,n;case mc:var a=t.index,l=t.sort_type,c={column_key:n[a].column_key,sort_type:l};return n[a]=c,n;default:return n}},vc=[us,ps],yc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).hideDTablePopover=function(e){if(o.sortPopoverRef&&!Ll(e).includes("popover")&&!o.sortPopoverRef.contains(e.target))return o.props.onSortComponentToggle(e),e.preventDefault(),e.stopPropagation(),!1},o.isNeedSubmit=function(){return o.props.isNeedSubmit},o.onHotKey=function(e){(0,Or.default)("esc",e)&&!o.isSelectOpen&&(e.preventDefault(),o.props.onSortComponentToggle())},o.setSelectStatus=function(e){o.isSelectOpen=e},o.addSort=function(){var e=o.state.sorts,t=gc(pc,{sorts:e});o.updateSorts(t)},o.deleteSort=function(e,t){e.nativeEvent.stopImmediatePropagation();var n=o.state.sorts.slice(0),r=gc(hc,{sorts:n,index:t});o.updateSorts(r)},o.onSelectColumn=function(e,t){var n=o.state.sorts.slice(0),r=e.column.key;if(r!==n[t].column_key){var i=gc(fc,{sorts:n,index:t,column_key:r});o.updateSorts(i)}},o.onSelectSortType=function(e,t){var n=o.state.sorts.slice(0),r=e.sortType;if(r!==n[t].sort_type){var i=gc(mc,{sorts:n,index:t,sort_type:r});o.updateSorts(i)}},o.updateSorts=function(e){if(o.isNeedSubmit()){o.setState({sorts:e,isSubmitDisabled:!1})}else o.setState({sorts:e},(function(){o.handleSortAnimation()}))},o.handleSortAnimation=function(){var e={sorts:o.state.sorts};o.props.update(e)},o.onClosePopover=function(){o.props.onSortComponentToggle()},o.onSubmitSorts=function(){var e={sorts:o.state.sorts};o.props.update(e),o.props.onSortComponentToggle()},o.createColumnsOptions=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(e){return hs.includes(e.type)}));return e.map((function(e){var t=e.type,n=e.name;return{value:{column:e},label:(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("span",{className:"filter-header-icon",children:(0,m.jsx)(Bl.JO,{iconName:zo[t]})}),(0,m.jsx)("span",{className:"select-option-name",children:n})]})}}))},o.createSortTypeOptions=function(){return vc.map((function(e){return{value:{sortType:e},label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.ih)(e)})}}))},o.renderSortsList=function(){var e=o.props.columns;return o.state.sorts.map((function(t,n){var r=xs(e,t.column_key)||{};return o.renderSortItem(r,t,n)}))},o.renderSortItem=function(e,t,n){var r=e.name,i=e.type,s=o.props.readonly,l={label:(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("span",{className:"filter-header-icon",children:(0,m.jsx)(Bl.JO,{iconName:zo[i]})}),(0,m.jsx)("span",{className:"select-option-name",title:r,"aria-label":r,children:r})]})},c=t.sort_type,d=c&&{label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.ih)(c)})};return(0,m.jsxs)("div",{className:"sort-item",children:[!s&&(0,m.jsx)("div",{className:"delete-sort",onClick:function(e){return o.deleteSort(e,n)},children:(0,m.jsx)(Bl.JO,{iconName:"fork-number"})}),(0,m.jsxs)("div",{className:"condition",children:[(0,m.jsx)("div",{className:"sort-column",children:(0,m.jsx)(Bl.fg,{isLocked:s,value:l,onSelectOption:function(e){return o.onSelectColumn(e,n)},options:o.columnsOptions,searchable:!0,searchPlaceholder:(0,h.ih)("Search column"),noOptionsPlaceholder:(0,h.ih)("No results")})}),(0,m.jsx)("div",{className:"sort-predicate ml-2",children:(0,m.jsx)(Bl.fg,{isLocked:s,value:d,onSelectOption:function(e){return o.onSelectSortType(e,n)},options:o.sortTypeOptions})})]})]},"sort-item-"+n)},o.onPopoverInsideClick=function(e){e.stopPropagation()};var i,s,l=o.props,c=l.sorts,d=l.columns;return o.sortTypeOptions=o.createSortTypeOptions(),o.columnsOptions=o.createColumnsOptions(d),o.state={sorts:(i=c,s=d,Array.isArray(i)&&Array.isArray(s)?i.filter((function(e){return!e.column_key||oa(e,s)})):[])},o.isSelectOpen=!1,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.hideDTablePopover,!0),document.addEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect=window.sfMetadataContext.eventBus.subscribe(Ea.OPEN_SELECT,this.setSelectStatus)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hideDTablePopover,!0),document.removeEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.columns;t!==this.props.columns&&(this.columnsOptions=this.createColumnsOptions(t))}},{key:"render",value:function(){var e=this,t=this.props,n=t.target,r=t.readonly,o=function(e){return!e||0===e.length}(this.state.sorts);return(0,m.jsx)(Gr.Z,{placement:"auto-start",isOpen:!0,target:n,fade:!1,hideArrow:!0,className:"sort-popover",boundariesElement:document.body,children:(0,m.jsxs)("div",{ref:function(t){return e.sortPopoverRef=t},onClick:this.onPopoverInsideClick,children:[(0,m.jsx)("div",{className:"sorts-list ".concat(o?"empty-sorts-container":""),children:o?(0,m.jsx)("div",{className:"empty-sorts-list",children:(0,h.ih)("No sorts")}):this.renderSortsList()}),!r&&(0,m.jsx)(Bl.$R,{callBack:this.addSort,footerName:(0,h.ih)("Add sort"),className:"popover-add-tool",addIconClassName:"popover-add-icon"}),this.isNeedSubmit()&&!r&&(0,m.jsxs)("div",{className:"sort-popover-footer",children:[(0,m.jsx)(R.Z,{className:"mr-2",onClick:this.onClosePopover,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",disabled:this.state.isSubmitDisabled,onClick:this.onSubmitSorts,children:(0,h.ih)("Submit")})]})]})})}}]),n}(a.Component);yc.defaultProps={readonly:!1};var xc=yc,wc=function(e){var t=e.columns,n=e.wrapperClass,r=e.filters,o=e.isNeedSubmit,i=e.isPre,s=e.collaborators,l=e.filtersClassName,c=e.target,d=e.filterConjunction,u=e.modifyFilters,p=(0,a.useState)(!1),f=(0,ge.Z)(p,2),g=f[0],v=f[1],y=(0,a.useMemo)((function(){return xa()(Ls(r||[],t))}),[r,t]),x=(0,a.useMemo)((function(){var e=y.length;return 1===e?o?(0,h.ih)("1 preset filter"):(0,h.ih)("1 filter"):e>1?e+" "+(o?(0,h.ih)("Preset filters"):(0,h.ih)("Filters")):o?(0,h.ih)("Preset filter"):(0,h.ih)("Filter")}),[o,y]),w=(0,a.useCallback)((function(){v(!g)}),[g]),b=(0,a.useCallback)((function(e){e.stopPropagation(),(vs(e)||gs(e))&&w()}),[w]),S=(0,a.useCallback)((function(e){var n=e||{},r=n.filters,o=n.filter_conjunction,i=Ls(r,t);u(i,o)}),[t,u]);if(!t)return null;var C=Br()(n,{active:y.length>0});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:Br()("setting-item",{"mr-2":C,"mb-1":!C}),children:(0,m.jsxs)("div",{className:Br()("setting-item-btn filters-setting-btn",C),onClick:w,role:"button",onKeyDown:b,title:x,"aria-label":x,tabIndex:0,id:c,children:[(0,m.jsx)(Bl.JO,{iconName:"filter"}),(0,m.jsx)("span",{children:x})]})}),g&&(0,m.jsx)(uc,{filtersClassName:l,target:c,isNeedSubmit:o,columns:t,collaborators:s,filterConjunction:d,filters:y,hidePopover:w,update:S,isPre:i})]})};wc.defaultProps={target:"sf-metadata-filter-popover",isNeedSubmit:!1};var bc=wc,Sc=function(e){var t=e.target,n=e.sorts,r=e.columns,o=e.isNeedSubmit,i=e.wrapperClass,s=e.modifySorts,l=(0,a.useState)(!1),c=(0,ge.Z)(l,2),d=c[0],u=c[1],p=(0,a.useMemo)((function(){return ia(n||[],r)}),[n,r]),f=(0,a.useMemo)((function(){var e=p.length;return 1===e?o?(0,h.ih)("1 preset sort"):(0,h.ih)("1 sort"):e>1?e+" "+(o?(0,h.ih)("preset sorts"):(0,h.ih)("sorts")):o?(0,h.ih)("Preset sort"):(0,h.ih)("Sort")}),[o,p]),g=(0,a.useCallback)((function(){u(!d)}),[d]),v=(0,a.useCallback)((function(e){e.stopPropagation(),(vs(e)||gs(e))&&g()}),[g]),y=(0,a.useCallback)((function(e){var t=(e||{}).sorts;s(t)}),[s]);if(!r)return null;var x=Br()(i,{active:p.length>0});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:Br()("setting-item",{"mb-1":!x}),children:(0,m.jsxs)("div",{className:Br()("mr-2 setting-item-btn filters-setting-btn",x),onClick:g,role:"button",onKeyDown:v,title:f,"aria-label":f,tabIndex:0,id:t,children:[(0,m.jsx)(Bl.JO,{iconName:"sort"}),(0,m.jsx)("span",{children:f})]})}),d&&(0,m.jsx)(xc,{isNeedSubmit:o,target:t,columns:r,sorts:p,onSortComponentToggle:g,update:y})]})};Sc.defaultProps={target:"sf-metadata-sort-popover",isNeedSubmit:!1};var Cc=Sc,Dc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onKeyDown=function(e){(vs(e)||gs(e))&&o.onGroupbySetterToggle()},o.onGroupbySetterToggle=function(){o.setState({isShowGroupbySetter:!o.state.isShowGroupbySetter})},o.state={isShowGroupbySetter:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.columns,n=e.groupbys,r=e.wrapperClass;if(!t)return null;var o=n?n.length:0,i=o>0,s=(0,h.ih)("Group_by");1===o?s=(0,h.ih)("Grouped by 1 column"):o>1&&(s=(0,h.ih)("Grouped by xxx columns").replace("xxx",o));var a=r||"";return a=a&&i?a+" active":a,(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:Br()("setting-item mr-2",{"mb-1":!a}),children:(0,m.jsxs)("div",{className:Br()("mr-2 setting-item-btn groupbys-setting-btn",a),onClick:this.onGroupbySetterToggle,role:"button",onKeyDown:this.onKeyDown,title:s,"aria-label":s,tabIndex:0,id:this.props.target,children:[(0,m.jsx)(Bl.JO,{iconName:"group"}),(0,m.jsx)("span",{children:s})]})})})}}]),n}(a.Component);Dc.defaultProps={target:"sf-metadata-groupby-popover",isNeedSubmit:!1};var kc=Dc,jc=(a.Component,function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onKeyDown=function(e){(vs(e)||gs(e))&&o.onHideColumnToggle()},o.onHideColumnToggle=function(){o.setState({isHideColumnSetterShow:!o.state.isHideColumnSetterShow})},o.state={isHideColumnSetterShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.columns,n=e.wrapperClass,r=e.target,o=e.localShownColumnKeys;if(!t)return null;var i=(0,h.ih)("Hide columns"),s=t.filter((function(e){return!o.includes(e.key)})),a=s.length;1===a?i=(0,h.ih)("1 hidden column"):a>1&&(i=(0,h.ih)("xxx hidden columns").replace("xxx",a));var l=n||"";return l=l&&a>0?l+" active":l,(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:"setting-item ".concat(l?"":"mb-1"),children:(0,m.jsxs)("div",{className:"mr-2 setting-item-btn filters-setting-btn ".concat(l),onClick:this.onHideColumnToggle,role:"button",onKeyDown:this.onKeyDown,title:i,"aria-label":i,tabIndex:0,id:r,children:[(0,m.jsx)(Bl.JO,{iconName:"hide"}),(0,m.jsx)("span",{children:i})]})})})}}]),n}(a.Component)),Ic=jc,Mc=function(e){var t=e.searcherActive,n=e.view,r=e.modifyFilters,o=e.modifySorts,i=e.modifyGroupbys,s=e.modifyHiddenColumns,l=(0,a.useMemo)((function(){return n.available_columns}),[n]),c=Cl().collaborators,d=(0,a.useCallback)((function(){window.sfMetadataContext.eventBus.dispatch(Ea.SELECT_NONE)}),[]);return(0,m.jsxs)("div",{className:Br()("sf-metadata-tool",{"searcher-active":t}),style:{zIndex:7,transform:"translateZ(1000px)"},onClick:d,children:[(0,m.jsxs)("div",{className:"sf-metadata-tool-left-operations",children:[(0,m.jsx)(bc,{wrapperClass:"custom-tool-label custom-filter-label",filtersClassName:"sf-metadata-filters",target:"sf-metadata-filter-popover",filterConjunction:n.filter_conjunction,filters:n.filters,columns:l,modifyFilters:r,collaborators:c}),(0,m.jsx)(Cc,{wrapperClass:"custom-tool-label custom-sort-label",target:"sf-metadata-sort-popover",sorts:n.sorts,columns:l,modifySorts:o}),(0,m.jsx)(kc,{wrapperClass:"custom-tool-label custom-groupby-label",target:"sf-metadata-groupby-popover",columns:[],groupbys:[],modifyGroupbys:i}),(0,m.jsx)(Ic,{wrapperClass:"custom-tool-label custom-hide-column-label",target:"sf-metadata-hide-column-popover",columns:[],modifyHiddenColumns:s})]}),(0,m.jsx)("div",{className:"sf-metadata-tool-right-operations"})]})},_c=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).cleanUp=function(){window.removeEventListener("mouseup",e.onMouseUp),window.removeEventListener("mousemove",e.onMouseMove),window.removeEventListener("touchend",e.onMouseUp),window.removeEventListener("touchmove",e.onMouseMove)},e.onMouseDown=function(t){t.preventDefault&&t.preventDefault(),window.addEventListener("mouseup",e.onMouseUp),window.addEventListener("mousemove",e.onMouseMove),window.addEventListener("touchend",e.onMouseUp),window.addEventListener("touchmove",e.onMouseMove)},e.onMouseUp=function(t){e.cleanUp()},e.onMouseMove=function(t){t.preventDefault&&t.preventDefault(),function(e,t){var n=null}(e.props.onDrag(t))},e}return(0,o.Z)(n,[{key:"componentWillUnmount",value:function(){this.cleanUp()}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"record-HeaderCell__draggable",onDrag:this.props.onDrag,onMouseDown:this.onMouseDown,onTouchStart:this.onMouseDown})}}]),n}(a.Component),Nc=_c,Rc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggle=function(e){e&&e.preventDefault(),e&&e.stopPropagation();var t=o.props,n=t.column,r=t.height,i=t.isMenuShow,s=r-5,a=-(n.width-30);o.setState({top:s,left:a});var l=e.target;i&&"string"===typeof l.className&&l.className.includes("disabled")||o.props.toggleHeaderDropDownMenu()},o.hideSubMenu=function(){},o.onDownloadAllFiles=function(){var e=o.props.column;o.props.downloadColumnAllFiles(e)},o.getMenuStyle=function(){if(rl(o.props.column))return{transform:"none"};var e=o.state;return{top:e.top,left:e.left,transform:"none"}},o.renderUpperMenu=function(){return[]},o.renderDropdownMenu=function(){var e=o.getMenuStyle();return(0,m.jsx)(Me.Z,{style:e,ref:o.headerDropDownMenuRef,className:"header-drop-down-menu",children:(0,m.jsx)("div",{ref:function(e){return o.dropdownDom=e},children:o.renderUpperMenu().map((function(e,t){return(0,m.jsx)(a.Fragment,{children:e},t)}))})})},o.state={top:0,left:0},o.headerDropDownMenuRef=(0,a.createRef)(),o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.isMenuShow;return(0,m.jsxs)(H.Z,{className:"sf-metadata-dropdown-menu",isOpen:e,toggle:this.toggle,children:[(0,m.jsx)(Y.Z,{tag:"span",role:"button","data-toggle":"dropdown","aria-expanded":e,title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),tabIndex:0,children:(0,m.jsx)("i",{className:"toggle-icon small sf-metadata-font sf-metadata-icon-drop-down"})}),e&&!Al&&(0,m.jsx)(Bl.Hv,{children:(0,m.jsx)("div",{className:"sf-metadata-dropdown-menu large",children:this.renderDropdownMenu()})})]})}}]),n}(a.Component),Tc=Rc,Oc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).headerCellRef=function(e){return o.headerCell=e},o.getWidthFromMouseEvent=function(e){var t=e.pageX||e.touches&&e.touches[0]&&e.touches[0].pageX||e.changedTouches&&e.changedTouches[e.changedTouches.length-1].pageX;return 0===e.pageX&&(t=0),t-l.findDOMNode(o.headerCell).getBoundingClientRect().left},o.onDrag=function(e){var t=o.getWidthFromMouseEvent(e);t>0&&o.props.resizeColumnWidth(o.props.column,t)},o.onIconTooltipToggle=function(){o.setState({tooltipOpen:!o.state.tooltipOpen})},o.handleHeaderCellClick=function(e){o.eventBus.dispatch(Ea.SELECT_COLUMN,e)},o.checkDropdownAvailable=function(){var e=o.props,t=e.isHideTriangle,n=e.column;return!t&&!!Wa.includes(n.type)},o.toggleHeaderDropDownMenu=function(){o.setState({isMenuShow:!o.state.isMenuShow})},o.descriptionRef=(0,a.createRef)(),o.uneditableTip=(0,a.createRef)(),o.eventBus=window.sfMetadataContext.eventBus,o.state={tooltipOpen:!1,isMenuShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.frozen,r=t.groupOffsetLeft,o=t.column,i=t.isLastFrozenCell,s=t.height,a=o.left,l=o.width,c=o.description,d=o.key,u=o.name,p=o.type,f=window.sfMetadataContext.canModifyCell(o),g=Object.assign({width:l,maxWidth:l,minWidth:l,height:s},this.props.style);n||(g.left=a+r);var v=Bo[p];return(0,m.jsx)("div",{className:"record-header-cell",children:(0,m.jsxs)("div",{className:Br()("sf-metadata-result-table-cell column",{"table-last--frozen":i}),ref:this.headerCellRef,style:g,onClick:function(){return e.handleHeaderCellClick(o,n)},children:[(0,m.jsxs)("div",{className:"sf-metadata-result-column-content record-header-cell-left d-flex align-items-center text-truncate",children:[(0,m.jsx)("span",{className:"mr-2",id:"header-icon-".concat(d),children:(0,m.jsx)(Bl.JO,{iconName:zo[p]})}),(0,m.jsx)(Dr.Z,{placement:"bottom",isOpen:this.state.tooltipOpen,toggle:this.onIconTooltipToggle,target:"header-icon-".concat(d),fade:!1,children:(0,h.ih)(v)}),(0,m.jsx)("div",{className:"header-name d-flex",children:(0,m.jsx)("span",{title:u,className:"header-name-text ".concat(56===s&&"double"),children:u})})]}),Aa[p]&&!f&&(0,m.jsx)("span",{className:"sf-metadata-font sf-metadata-icon-unlock column-uneditable-tip",ref:this.uneditableTip,id:"uneditable-column-".concat(d),children:(0,m.jsx)(Oe.Z,{target:this.uneditableTip,placement:"bottom",fade:!1,children:(0,h.ih)("No editing permission")})}),c&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{className:"ml-2 sf-metadata-font sf-metadata-icon-description column-uneditable-tip",ref:this.descriptionRef,id:"column-description-".concat(d),onMouseEnter:this.onToggleDescriptionTip,onMouseLeave:this.onToggleDescriptionTip}),(0,m.jsx)(Oe.Z,{innerClassName:"column-description-tip",target:this.descriptionRef,placement:"bottom",fade:!1,children:c})]}),this.checkDropdownAvailable()&&(0,m.jsx)(Tc,{isMenuShow:this.state.isMenuShow,column:o,toggleHeaderDropDownMenu:this.toggleHeaderDropDownMenu,downloadColumnAllFiles:this.props.downloadColumnAllFiles}),(0,m.jsx)(Nc,{onDrag:this.onDrag})]})},d)}}]),n}(a.Component);Oc.defaultProps={style:null};var Ec=Oc,Pc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onToggleSelectAll=function(e){var t=o.props,n=t.isMobile,r=t.hasSelectedRecord,i=o.state.isSelectedAll;if(n&&e.preventDefault(),r||i)return o.setState({isSelectedAll:!1}),void o.props.selectNoneRecords();o.setState({isSelectedAll:!0}),o.props.selectAllRecords()},o.state={isSelectedAll:e.isSelectedAll},o}return(0,o.Z)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props.isSelectedAll;t!==e.isSelectedAll&&this.setState({isSelectedAll:t})}},{key:"render",value:function(){var e=this.props,t=e.isMobile,n=e.hasSelectedRecord,r=this.state.isSelectedAll,o=n&&!r;return(0,m.jsxs)("div",{className:"select-all-checkbox-container",onClick:this.onToggleSelectAll,children:[t?(0,m.jsx)("label",{className:"mobile-select-all-container",children:o?(0,m.jsx)("i",{"aria-hidden":"true",className:"sf-metadata-font sf-metadata-icon-partially-selected"}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("input",{className:"mobile-select-all-checkbox",name:"mobile-select-all-checkbox",type:"checkbox",checked:r,readOnly:!0}),(0,m.jsx)("div",{className:"select-all-checkbox-show"})]})}):(0,m.jsx)(m.Fragment,{children:o?(0,m.jsx)("i",{"aria-hidden":"true",className:"sf-metadata-font sf-metadata-icon-partially-selected"}):(0,m.jsx)("input",{className:"select-all-checkbox",type:"checkbox",name:(0,h.ih)("Select all"),title:(0,h.ih)("Select all"),"aria-label":(0,h.ih)("Select all"),checked:r,readOnly:!0})}),(0,m.jsx)("label",{htmlFor:"select-all-checkbox",name:(0,h.ih)("Select all"),title:(0,h.ih)("Select all"),"aria-label":(0,h.ih)("Select all")})]})}}]),n}(a.Component),Zc=Pc,Fc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.isMobile,n=e.hasSelectedRecord,r=e.isSelectedAll,o=e.isLastFrozenCell,i=e.groupOffsetLeft,s={height:e.height,width:Za+i,minWidth:Za+i};return(0,m.jsxs)("div",{className:Br()("sf-metadata-result-table-cell column",{"table-last--frozen":o}),style:(0,sr.Z)((0,sr.Z)({},s),{},{backgroundColor:"#f9f9f9"}),children:[(0,m.jsx)(Zc,{isMobile:t,hasSelectedRecord:n,isSelectedAll:r,selectNoneRecords:this.props.selectNoneRecords,selectAllRecords:this.props.selectAllRecords}),(0,m.jsx)("div",{className:"header-action-cell-placeholder"})]})}}]),n}(a.Component),Lc=Fc,Ac=function(e){return e.filter((function(e){return e.frozen}))},Uc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).getFrozenCells=function(t,n){var r=e.props,o=r.columns,i=r.lastFrozenColumnKey;return Ac(o).map((function(r){var o=r.key,s=o===i;return(0,m.jsx)(Ec,{frozen:!0,height:t,column:r,style:{backgroundColor:"#f9f9f9"},isLastFrozenCell:s,isHideTriangle:n,resizeColumnWidth:e.props.resizeColumnWidth,downloadColumnAllFiles:e.props.downloadColumnAllFiles},o)}))},e.getHeaderCells=function(t,n){var r=e.props,o=r.columns,i=r.groupOffsetLeft,s=r.colOverScanStartIdx,a=r.colOverScanEndIdx;return o.slice(s,a).map((function(r){return(0,m.jsx)(Ec,{isHideTriangle:n,groupOffsetLeft:i,height:t,column:r,resizeColumnWidth:e.props.resizeColumnWidth,downloadColumnAllFiles:e.props.downloadColumnAllFiles},r.key)}))},e.getFrozenWrapperStyle=function(t){var n=e.props,r=n.isGroupView,o=n.columns,i={position:Al?"absolute":"fixed",marginLeft:"0px",height:t,zIndex:1};return(r&&!rl(o[0])||Al)&&(i.position="absolute"),i},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.containerWidth,r=t.hasSelectedRecord,o=t.isSelectedAll,i=t.lastFrozenColumnKey,s=t.groupOffsetLeft,a=t.table.header_settings||{},l=ha(a)?cs:a.header_height,c=a&&a.is_hide_triangle,d=l===ds?56:32,u=d+1,p=this.getFrozenCells(d,c),h=this.getHeaderCells(d,c),f={width:n,minWidth:"100%",zIndex:4,height:d};return(0,m.jsx)("div",{className:"static-sf-metadata-result-content grid-header",style:{height:u},children:(0,m.jsxs)("div",{className:"sf-metadata-result-table-row",style:f,children:[(0,m.jsxs)("div",{className:"frozen-columns d-flex",style:this.getFrozenWrapperStyle(d),ref:function(t){!Al&&e.props.onRef(t)},children:[(0,m.jsx)(Lc,{isMobile:Al,height:d,hasSelectedRecord:r,isSelectedAll:o,isLastFrozenCell:!i,groupOffsetLeft:s,selectNoneRecords:this.props.selectNoneRecords,selectAllRecords:this.props.selectAllRecords}),p]}),h]})})}}]),n}(a.Component),zc=Uc,Bc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).isSelfScroll=!0,e.setScrollTop=function(t){e.isSelfScroll=!1,e.rightScrollContainer.scrollTop=t},e.onScroll=function(t){if(t.stopPropagation(),e.isSelfScroll){var n=t.target.scrollTop;e.props.onScrollbarScroll(n)}else e.isSelfScroll=!0},e.onMouseUp=function(t){e.props.onScrollbarMouseUp&&e.props.onScrollbarMouseUp(t)},e.getScrollbarStyle=function(){var e=window.sfMetadataBody;return e&&e.resultRef?{height:e.resultRef.scrollHeight}:{}},e.getContainerStyle=function(){var e={},t=window.sfMetadataBody;return t&&t.resultContentRef&&(e.height=t.resultContentRef.clientHeight,e.zIndex=2),e.bottom=30,e.right="10px",e},e.setScrollbarRef=function(t){e.scrollbar=t},e.setContainerRef=function(t){e.rightScrollContainer=t},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.getContainerStyle(),t=this.getScrollbarStyle();return(0,m.jsx)("div",{className:"right-scrollbar-container",style:e,ref:this.setContainerRef,onScroll:this.onScroll,onMouseUp:this.onMouseUp,children:(0,m.jsx)("div",{ref:this.setScrollbarRef,className:"right-scrollbar-inner",style:t})})}}]),n}(a.Component),Gc=Bc,Hc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).isSelfScroll=!0,e.setScrollLeft=function(t){e.isSelfScroll=!1,e.container.scrollLeft=t},e.onScroll=function(t){if(t.stopPropagation(),e.isSelfScroll){var n=t.target.scrollLeft;e.props.onScrollbarScroll(n)}else e.isSelfScroll=!0},e.getScrollbarStyle=function(){return{width:e.props.innerWidth}},e.getContainerStyle=function(){return{zIndex:2}},e.setScrollbarRef=function(t){e.scrollbar=t},e.setContainerRef=function(t){e.container=t},e}return(0,o.Z)(n,[{key:"render",value:function(){if(!this.props.innerWidth)return null;var e=this.getContainerStyle(),t=this.getScrollbarStyle();return(0,m.jsx)("div",{className:"horizontal-scrollbar-container",ref:this.setContainerRef,style:e,onScroll:this.onScroll,onMouseUp:this.props.onScrollbarMouseUp,children:(0,m.jsx)("div",{className:"horizontal-scrollbar-inner",ref:this.setScrollbarRef,style:t})})}}]),n}(a.Component),Yc=Hc,Vc=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,null,[{key:"getDataType",value:function(e){var t=typeof e;return"object"!==t?t:Object.prototype.toString.call(e).replace(/^\[object (\S+)\]$/,"$1")}},{key:"iterable",value:function(e){return["Object","Array"].includes(this.getDataType(e))}},{key:"isObjectChanged",value:function(e,t){var n=this;if(!this.iterable(e))throw new Error("source should be a Object or Array , but got ".concat(this.getDataType(e)));if(this.getDataType(e)!==this.getDataType(t))return!0;var r=Object.keys(e),o=Object.keys((0,sr.Z)((0,sr.Z)({},e),t));return r.length!==o.length||o.some((function(r){return n.iterable(e[r])?n.isObjectChanged(e[r],t[r]):e[r]!==t[r]}))}},{key:"isSameObject",value:function(e,t){return!(!e||!t)&&!this.isObjectChanged(e,t)}}]),e}(),Wc=["readonly","value","field"],Kc=function(e){var t=e.readonly,n=e.value,r=e.field,o=(0,Po.Z)(e,Wc),i=Cl(),s=i.collaborators,a=i.collaboratorsCache,l=i.updateCollaboratorsCache;return(0,m.jsx)(Bl.Mb,(0,sr.Z)({readonly:t,value:n,field:r,collaborators:s,collaboratorsCache:a,updateCollaboratorsCache:l,queryUserAPI:window.sfMetadataContext.userService.queryUser},o))},qc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={},e.getCellClass=function(t){var n,r=e.props,o=r.column,i=r.highlightClassName,s=r.isLastCell,a=r.isLastFrozenCell,l=r.isCellSelected,c=e.state.isFileTipShow,d=o.type,u=window.sfMetadataContext.canModifyCell(o);return Br()("sf-metadata-result-table-cell","sf-metadata-result-table-".concat(d,"-cell"),(n={"table-cell-uneditable":!u&&Aa[d]},(0,Fr.default)(n,i,i),(0,Fr.default)(n,"last-cell",s),(0,Fr.default)(n,"table-last--frozen",a),(0,Fr.default)(n,"cell-selected",l),(0,Fr.default)(n,"draging-file-to-cell",c),(0,Fr.default)(n,"row-comment-cell",t),n))},e.onCellClick=function(t){var n=e.props,r=n.column,o=n.groupRecordIndex,i=n.recordIndex,s=n.cellMetaData,a={idx:r.idx,groupRecordIndex:o,rowIdx:i};pa(s.onCellClick)&&s.onCellClick(a,t)},e.onCellDoubleClick=function(t){var n=e.props,r=n.column,o=n.groupRecordIndex,i=n.recordIndex,s=n.cellMetaData,a={idx:r.idx,groupRecordIndex:o,rowIdx:i};pa(s.onCellDoubleClick)&&s.onCellDoubleClick(a,t)},e.onCellMouseDown=function(t){if(2!==t.button){var n=e.props,r=n.column,o=n.groupRecordIndex,i=n.recordIndex,s=n.cellMetaData,a={idx:r.idx,groupRecordIndex:o,rowIdx:i};pa(s.onCellMouseDown)&&s.onCellMouseDown(a,t)}},e.onCellMouseEnter=function(t){var n=e.props,r=n.column,o=n.groupRecordIndex,i=n.recordIndex,s=n.cellMetaData,a={idx:r.idx,groupRecordIndex:o,rowIdx:i};if(pa(s.onCellMouseEnter)){var l={x:t.clientX,y:t.clientY};s.onCellMouseEnter((0,sr.Z)((0,sr.Z)({},a),{},{mousePosition:l}),t)}},e.onCellMouseMove=function(t){var n=e.props,r=n.column,o=n.groupRecordIndex,i=n.recordIndex,s=n.cellMetaData,a={idx:r.idx,groupRecordIndex:o,rowIdx:i};if(pa(s.onCellMouseMove)){var l={x:t.clientX,y:t.clientY};s.onCellMouseMove((0,sr.Z)((0,sr.Z)({},a),{},{mousePosition:l}),t)}},e.onCellMouseLeave=function(){},e.getEvents=function(){return{onClick:e.onCellClick,onDoubleClick:e.onCellDoubleClick,onMouseDown:e.onCellMouseDown,onMouseEnter:e.onCellMouseEnter,onMouseMove:e.onCellMouseMove,onMouseLeave:e.onCellMouseLeave,onDragOver:e.onDragOver}},e.onDragOver=function(e){e.stopPropagation(),e.preventDefault()},e.updateParentTips=function(t){e.setState({isFileTipShow:t})},e.onCellTipShow=function(e){W.Z.warning(e)},e.isDir=function(){var t=e.props.record[ai];return"string"===typeof t?"TRUE"===t.toUpperCase():t},e.render=function(){var t=e.props,n=t.frozen,r=t.record,o=t.column,i=t.needBindEvents,s=t.height,a=t.bgColor,l=o.key,c=o.left,d=o.width,u=!!(nl(o)&&e.getCommentCount()),p=e.getCellClass(u),h={width:d,height:s};n||(h.left=c),a&&(h.backgroundColor=a);var f=r[l],g=i&&e.getEvents(),v=(0,sr.Z)({className:p,style:h},g),y=(0,m.jsx)(Kc,{readonly:!0,value:f,field:o,isDir:e.isDir()});return(0,m.jsx)("div",(0,sr.Z)((0,sr.Z)({},v),{},{children:y}),"".concat(r._id,"-").concat(l))},e}return(0,o.Z)(n,[{key:"shouldComponentUpdate",value:function(e,t){var n,r,o,i=this.props,s=i.record,a=i.column,l=i.isCellSelected,c=i.isLastCell,d=i.highlightClassName,u=i.height,p=i.bgColor,h=e.record,f=e.highlightClassName,m=e.height,g=e.column,v=e.bgColor,y=s[a.name]||s[a.key],x=h[a.name]||h[a.key];return n=y,r=x,o=a.type,n!==r&&(void 0===n||null===n?(o!==Uo.GEOLOCATION||!ha(r))&&(o!==Uo.DATE&&o!==Uo.NUMBER&&o!==Uo.AUTO_NUMBER||null!==r)&&(Array.isArray(r)?0!==r.length:!1!==r&&""!==r):Array.isArray(n)&&Array.isArray(r)?JSON.stringify(n)!==JSON.stringify(r):"object"===typeof n&&"object"===typeof r&&null!==r?!Vc.isSameObject(n,r):n!==r)||s._last_modifier!==h._last_modifier||l!==e.isCellSelected||c!==e.isLastCell||d!==f||u!==m||a.left!==g.left||a.width!==g.width||p!==v}}]),n}(a.Component);qc.defaultProps={needBindEvents:!0};var $c=qc,Xc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onCellMouseEnter=function(){o.props.isLocked&&!Al&&(o.timer=setTimeout((function(){o.setState({isLockedRowTooltipShow:!0})}),500))},o.onCellMouseLeave=function(){o.props.isLocked&&!Al&&(o.timer&&(clearTimeout(o.timer),o.timer=null),o.setState({isLockedRowTooltipShow:!1}))},o.getLockedRowTooltip=function(){var e=o.props.recordId;return(0,m.jsx)(Dr.Z,{target:"action-cell-".concat(e),placement:"bottom",isOpen:o.state.isLockedRowTooltipShow,fade:!1,hideArrow:!0,className:"readonly-cell-tooltip",children:(0,h.ih)("The row is locked and cannot be modified")})},o.state={isLockedRowTooltipShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.isSelected,n=e.isLastFrozenCell,r=e.index,o=e.height,i=e.recordId,s={height:o,width:Za,minWidth:Za};return(0,m.jsxs)("div",{className:Br()("sf-metadata-result-table-cell column actions-cell",{"table-last--frozen":n}),id:"action-cell-".concat(i),style:(0,sr.Z)({},s),onMouseEnter:this.onCellMouseEnter,onMouseLeave:this.onCellMouseLeave,children:[!t&&(0,m.jsx)("div",{className:"sf-metadata-result-column-content row-index text-truncate",children:r+1}),(0,m.jsx)("div",{className:"sf-metadata-result-column-content actions-checkbox",children:(0,m.jsxs)("div",{className:"select-cell-checkbox-container",onClick:this.props.onSelectRecord,children:[(0,m.jsx)("input",{className:"select-cell-checkbox",type:"checkbox",name:"row-selection",checked:t||!1,readOnly:!0}),(0,m.jsx)("label",{htmlFor:"select-cell-checkbox",name:(0,h.ih)("Select"),title:(0,h.ih)("Select"),"aria-label":(0,h.ih)("Select")})]})}),(0,m.jsx)("span",{className:"rdg-row-expand-icon",onClick:this.props.onRowExpand,children:(0,m.jsx)(Bl.JO,{iconName:"open"})})]})}}]),n}(a.Component),Jc=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).checkScroll=function(){e.cancelFixFrozenDOMs(e.props.scrollLeft)},e.cancelFixFrozenDOMs=function(t){var n=e.props.isGroupView,r=e.frozenColumns.childElementCount;!e.frozenColumns||r<1||n&&r<2||(e.frozenColumns.style.position="absolute",e.frozenColumns.style.marginLeft=t+"px",e.frozenColumns.style.marginTop="0px")},e.onSelectRecord=function(t){var n=e.props,r=n.groupRecordIndex,o=n.index;e.props.selectNoneCells(),e.props.onSelectRecord({groupRecordIndex:r,recordIndex:o},t)},e.onRowExpand=function(){var t=e.props.record;e.props.onRowExpand(t)},e.isCellSelected=function(t){var n=e.props,r=n.hasSelectedCell,o=n.selectedPosition;return!!o&&(r&&o.idx===t)},e.reloadCurrentRecord=function(){e.props.reloadRecords([e.props.record._id])},e.getFrozenCells=function(){var t=e.props,n=t.columns,r=t.lastFrozenColumnKey,o=t.groupRecordIndex,i=t.index,s=t.record,a=t.cellMetaData,l=t.isGroupView,c=t.height,d=t.columnColor,u=Ac(n);if(0===u.length)return null;var p=s._id;return u.map((function(t,u){var h=t.key,f=e.isCellHighlight(h,p),g=e.isCurrentCellHighlight(h,p)?"cell-current-highlight":f?"cell-highlight":null,v=e.isCellSelected(u),y=e.isLastCell(n,h),x=h===r,w=d&&d[h];return(0,m.jsx)($c,{frozen:!0,record:s,groupRecordIndex:o,recordIndex:i,isCellSelected:v,isLastCell:y,isLastFrozenCell:x,height:l?c:c-1,column:t,cellMetaData:a,modifyRecord:e.props.modifyRecord,lockRecordViaButton:e.props.lockRecordViaButton,modifyRecordViaButton:e.props.modifyRecordViaButton,reloadCurrentRecord:e.reloadCurrentRecord,highlightClassName:g,bgColor:w},t.key)}))},e.isCellHighlight=function(t,n){var r=e.props.searchResult;if(r){var o=r.matchedRows[n];if(o&&o.includes(t))return!0}return!1},e.isCurrentCellHighlight=function(t,n){var r=e.props.searchResult;if(r){var o=r.currentSelectIndex;if("number"!==typeof o)return!1;var i=r.matchedCells[o];if(!i)return!1;if(i.row===n&&i.column===t)return!0}return!1},e.getColumnCells=function(){var t=e.props,n=t.columns,r=t.colOverScanStartIdx,o=t.colOverScanEndIdx,i=t.groupRecordIndex,s=t.index,a=t.record,l=t.cellMetaData,c=t.isGroupView,d=t.height,u=t.columnColor,p=a._id;return n.slice(r,o).map((function(t){var r=t.key,o=!t.frozen,h=e.isCellSelected(n.findIndex((function(e){return e.key===t.key}))),f=e.isCellHighlight(r,p),g=e.isCurrentCellHighlight(r,p)?"cell-current-highlight":f?"cell-highlight":null,v=e.isLastCell(n,r),y=u&&u[r];return(0,m.jsx)($c,{record:a,groupRecordIndex:i,recordIndex:s,isCellSelected:h,isLastCell:v,height:c?d:d-1,column:t,needBindEvents:o,cellMetaData:l,modifyRecord:e.props.modifyRecord,lockRecordViaButton:e.props.lockRecordViaButton,modifyRecordViaButton:e.props.modifyRecordViaButton,reloadCurrentRecord:e.reloadCurrentRecord,highlightClassName:g,bgColor:y},t.key)}))},e.getRecordStyle=function(){var t=e.props,n=t.isGroupView,r={height:t.height+"px"};if(n){var o=e.props,i=o.top,s=o.left;r.top=i+"px",r.left=s+"px"}return r},e.getFrozenColumnsStyle=function(){var t=e.props,n=t.isGroupView,r=t.lastFrozenColumnKey,o=t.height,i={zIndex:1,height:o-1};return n&&(i.height=o,i.zIndex=2,r||(i.marginLeft="0px")),i},e.handleDragEnter=function(t){t.preventDefault();var n=e.props,r=n.index,o=n.groupRecordIndex;(0,n.cellMetaData.onDragEnter)({overRecordIdx:r,overGroupRecordIndex:o})},e.handleDragOver=function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},e.handleDrop=function(e){e.preventDefault()},e}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.checkScroll()}},{key:"shouldComponentUpdate",value:function(e){return e.isGroupView!==this.props.isGroupView||e.hasSelectedCell!==this.props.hasSelectedCell||e.hasSelectedCell&&this.props.selectedPosition.idx!==e.selectedPosition.idx||e.isSelected!==this.props.isSelected||e.groupRecordIndex!==this.props.groupRecordIndex||e.index!==this.props.index||e.isLastRecord!==this.props.isLastRecord||e.lastFrozenColumnKey!==this.props.lastFrozenColumnKey||e.columns!==this.props.columns||e.colOverScanStartIdx!==this.props.colOverScanStartIdx||e.colOverScanEndIdx!==this.props.colOverScanEndIdx||e.record!==this.props.record||e.top!==this.props.top||e.left!==this.props.left||e.height!==this.props.height||e.searchResult!==this.props.searchResult||e.columnColor!==this.props.columnColor}},{key:"isLastCell",value:function(e,t){return e[e.length-1].key===t}},{key:"render",value:function(){var e=this,t=this.props,n=t.isSelected,r=t.isGroupView,o=t.index,i=t.isLastRecord,s=t.lastFrozenColumnKey,a=t.height,l=t.record,c=!!l._locked,d=r?a:a-1,u=this.getFrozenCells(),p=this.getColumnCells();return(0,m.jsxs)("div",{className:Br()("sf-metadata-result-table-row",{"sf-metadata-last-table-row":i,"row-selected":n,"row-locked":c}),style:this.getRecordStyle(),onDragEnter:this.handleDragEnter,onDragOver:this.handleDragOver,onDrop:this.handleDrop,children:[(0,m.jsxs)("div",{className:"frozen-columns d-flex",style:this.getFrozenColumnsStyle(),ref:function(t){return e.frozenColumns=t},children:[(0,m.jsx)(Xc,{isLocked:c,isSelected:n,recordId:l._id,index:o,onSelectRecord:this.onSelectRecord,onRowExpand:this.onRowExpand,isLastFrozenCell:!s,height:d}),u]}),p]})}}]),n}(a.Component),Qc=Jc,ed=function(e,t,n,r,o,i){var s={};t.forEach((function(e){var t=e.column_key,n=xs(r,t);s[t]=n}));var a=t.length,l=td(e,s,n,i,o,a,{parentGroupPath:[],currentLevel:a,isParentGroupVisible:!0}),c=nd(l,a),d=c.computedGroupRows,u=c.groupRowsHeight;return{groupRows:d,idGroupRowMap:c.idGroupRowMap,groupRowsHeight:u,maxLevel:a}},td=function e(t,n,r,o,i,s,a){var l=a.parentGroupPath,c=a.parentGroupKey,d=a.currentLevel,u=a.isParentGroupVisible,p=[];return t.forEach((function(t,a){var h=[];l.length>0&&h.push.apply(h,(0,w.Z)(l)),h.push(a);var f=t.cell_value,m=t.subgroups,g=t.row_ids,v=t.column_key,y=t.summaries,x=t.original_cell_value,b=h.join("-"),S=rd(b,r),C=(s-d+1)*Fa,D="".concat(c||v,"_").concat(f),k={type:za,level:d,left:C,key:D,cell_value:f,column_key:v,isExpanded:S,summaries:y,groupPath:h,groupPathString:b,column:n[v],visible:u,original_cell_value:x};if(Array.isArray(m)&&m.length>0){var j,I=e(m,n,r,o,i,s,{parentGroupPath:h,parentGroupKey:D,currentLevel:d-1,isParentGroupVisible:u&&S}),M=0,_=0;I.forEach((function(e){e.type===za&&e.level+1===d&&(M+=e.count||0,_+=(e.height||0)+Fa,j||(j=e.first_row_id))})),k.first_row_id=j,k.count=M,k.height=(S?_:0)+La,p.push(k),p.push.apply(p,(0,w.Z)(I))}else if(Array.isArray(g)&&g.length>0){var N=g.length,R=N-1,T=u&&S,O=T&&o,E=T?N*i:0,P=O?32:0,Z=g.map((function(e,t){return{type:Ba,key:"row-".concat(e),rowIdx:t,isLastRow:t===R,visible:T,height:i,level:d,rowsLength:N,left:C,rowId:e,groupPath:h,groupPathString:b}}));Z.push({type:Ga,key:"btn-insert-row_".concat(D),visible:O,height:32,level:d,lastRowIndex:R,left:C,groupPath:h,groupPathString:b}),k.first_row_id=Z[0].rowId,k.count=N,k.height=E+P+La,p.push(k),p.push.apply(p,(0,w.Z)(Z))}})),p},nd=function(e,t){var n,r=0,o=Fa,i={};return{computedGroupRows:e.map((function(s,a){var l=s.type,c=s.level,d=s.height,u=s.visible,p=(0,sr.Z)((0,sr.Z)({},s),{},{top:o,groupRowIndex:a});if(l===za)u&&(c===t&&(r+=d+Fa),o+=La,n=c);else if(l===Ba){var h=s.rowId;i[h]=p,u&&(o+=d)}else l===Ga&&u&&(o+=d);var f=e[a+1];if(f&&f.visible&&f.type===za){var m=f.groupPath,g=f.level;m[m.length-1]>0&&(o+=Fa),g>n&&(o+=(g-n)*Fa)}return p})),groupRowsHeight:r,idGroupRowMap:i}},rd=function(e,t){return!t||!t[e]},od=function(e,t){var n=e.groupPath,r=e.groupPathString,o=e.level,i=e.type,s=t.groupPath,a=t.groupPathString,l=t.level;return r===a&&i!==za||o<l&&n[0]===s[0]},id=function(e,t){return(t.groupRows||[])[e]||{}},sd="upwards",ad="downwards",ld=function(e){var t=e.selectedPosition,n=e.isGroupView;return(0,e.recordGetterByIndex)({isGroupView:n,groupRecordIndex:t.groupRecordIndex,recordIndex:t.rowIdx})},cd=function(e){var t=e.selectedPosition,n=e.columns;return tl(t.idx,n)},dd=function(e,t,n,r){var o=e.idx,i=e.groupRecordIndex,s=e.rowIdx,a=t[o];return!!a&&(!!Ya.includes(a.type)||!!r({isGroupView:n,groupRecordIndex:i,recordIndex:s}))};var ud=function(e){var t=e.selectedRange,n=e.columns,r=e.rowHeight,o=e.isGroupView,i=e.groups,s=e.groupMetrics,a=e.groupOffsetLeft,l=e.getRecordTopFromRecordsBody,c=t.topLeft,d=t.bottomRight,u=t.startCell,p=t.cursorCell;if(c.idx<0)return{width:0,left:0,top:0,height:r,zIndex:1};var h,f,m=function(e,t,n){for(var r=0,o=!1,i=e;i<=t;i++){var s=n[i];s&&(r+=s.width,o=o||s.frozen)}return{totalWidth:r,anyColFrozen:o,left:n[e].left}}(c.idx,d.idx,n),g=m.totalWidth,v=m.anyColFrozen,y=m.left;if(o){var x,w,b=u.groupRecordIndex,S=p.groupRecordIndex,C=id(b,s),D=id(S,s),k=C.groupPathString,j=D.groupPathString;if(b<S?(x=b,w=ad):(x=S,w=sd),k===j)h=(Math.abs(S-b)+1)*r;else if(w===ad){var I=function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return null;var n=e[0];if(n<0||n>=t.length)return null;for(var r=1,o=t[n];r<e.length&&o;){var i=o.subgroups,s=e[r];if(!Array.isArray(i)||s<0||s>=i.length)break;o=i[s],r+=1}return o}(C.groupPath,i);h=((I.row_ids||[]).length-C.rowIdx||0)*r}else if(w===sd){var M=C.rowIdx||0;x=b-M,h=(M+1)*r}h+=1,y+=a,f=l(x)}else h=(d.rowIdx-c.rowIdx+1)*r,f=l(c.rowIdx);return{width:g,left:y,top:f,height:h,zIndex:v?3:1}},pd=function(e){for(var t=e.selectedRange,n=e.isGroupView,r=e.recordGetterByIndex,o=t.topLeft,i=t.bottomRight,s=o.rowIdx,a=o.groupRecordIndex,l=[],c=s,d=i.rowIdx+1;c<d;c++){var u=r({isGroupView:n,groupRecordIndex:a,recordIndex:c});n&&a++,u&&l.push(u)}return l};function hd(e){return e&&e.shiftKey}var fd=["width","height","top","left","zIndex","children","innerRef"],md=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).getMaskStyle=function(){var t=e.props,n=t.width,r=t.height,o=t.top,i=t.left;return{height:r-1,width:n,zIndex:t.zIndex,position:"absolute",pointerEvents:"none",transform:"translate(".concat(i,"px, ").concat(o,"px)"),outline:0}},e}return(0,o.Z)(n,[{key:"componentDidUpdate",value:function(){var e=l.findDOMNode(this);"fixed"===e.style.position&&(e.style.transform="none")}},{key:"render",value:function(){var e=this.props,t=(e.width,e.height,e.top,e.left,e.zIndex,e.children),n=e.innerRef,r=(0,Po.Z)(e,fd),o=this.getMaskStyle();return(0,m.jsx)("div",(0,sr.Z)((0,sr.Z)({style:o,"data-test":"cell-mask",ref:n},r),{},{children:t}))}}]),n}(a.PureComponent),gd=md;var vd=function(e){var t=e.selectedRange,n=e.innerRef,r=e.getSelectedRangeDimensions,o=e.children,i=r(t);return(0,m.jsx)(gd,(0,sr.Z)((0,sr.Z)({},i),{},{className:"rdg-selected-range",innerRef:n,children:o}))};var yd=function(e){var t=e.innerRef,n=e.selectedPosition,r=e.getSelectedDimensions,o=e.children,i=r(n);return(0,m.jsx)(gd,(0,sr.Z)((0,sr.Z)({className:"rdg-selected",tabIndex:"0",innerRef:t},i),{},{children:o}))},xd=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=(r.data,r.collaborators,e[n]);return t===Uo.CTIME||t===Uo.MTIME?function(e){if(!e)return null;var t=ba()(e);return t.isValid()?t.format("YYYY-MM-DD HH:mm:ss"):e}(o):e[n]},wd=function(e,t){var n={};return e.forEach((function(e){n[e.key]=e})),bd(t,n)};function bd(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e||!t)return{};var r={};return Object.keys(e).forEach((function(o){var i=t[o];if(i){var s=i.name,a=i.type;if(!n||!n.includes(a)){var l=e[o];if(r[s]=l,a===Uo.TEXT)r[s]="string"===typeof l?l.trim():""}}})),r}function Sd(e,t){Cd(e,t)||(t.idSelectedRecordMap[e]=!0)}function Cd(e,t){return t.idSelectedRecordMap[e]}function Dd(e){return Object.keys(e.idSelectedRecordMap)}var kd={selectRecord:Sd,selectRecordsById:function(e,t){e.forEach((function(e){Sd(e,t)}))},deselectRecord:function(e,t){Cd(e,t)&&delete t.idSelectedRecordMap[e]},deselectAllRecords:function(e){e.idSelectedRecordMap={}},isRecordSelected:Cd,getSelectedIds:Dd,hasSelectedRecords:function(e){return Dd(e).length>0},isSelectedAll:function(e,t){return 0!==Dd(t).length&&e.every((function(e){return Cd(e,t)}))}};var jd=Pa.TEXT,Id=Pa.FRAGMENT;function Md(e,t){var n=window.sfMetadataContext.getCollaboratorsFromCache(),r=e.length-1,o=t.length-1,i="";return e.forEach((function(e,s){t.forEach((function(t,r){var s=t||{},a=s.key,l=s.type,c=s.data;if(l===Uo.LONG_TEXT){var d=e[a];i+=d||""}else i+=e&&xd(e,l,a,{data:c,collaborators:n})||"";r<o&&(i+="\t")})),s<r&&(i+="\n")})),i}function _d(e,t){var n,r,o,i;try{if(n=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],r=0;r<e.rangeCount;r++)n.push(e.getRangeAt(r));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}(),r=document.createRange(),o=document.getSelection(),(i=document.createElement("span")).textContent=e,i.addEventListener("copy",(function(n){n.stopPropagation(),n.preventDefault();var r=n.dataTransfer||n.clipboardData;r.clearData(),r.setData(jd,e),r.setData(Id,t)})),document.body.appendChild(i),r.selectNodeContents(i),o.addRange(r),!document.execCommand("copy"))return!1}catch(s){return!1}finally{i&&document.body.removeChild(i),n()}}var Nd=function(e){var t=e.type,n=e.selectedRecordIds,r=e.copiedRange,o=e.copiedColumns,i=e.copiedRecords,s=e.copiedTableId,a=e.tableData,l=e.copiedText,c=e.recordGetterById,d=e.isGroupView,u=e.recordGetterByIndex,p=e.event,h=void 0===p?{}:p,f=h.dataTransfer||h.clipboardData;if(t===Pa.DTABLE_FRAGMENT){var m=Array.isArray(n)&&n.length>0?function(e,t,n){var r=e.map((function(e){return n(e)}));return Md(r,t.columns)}(n,a,c):function(e,t,n,r){for(var o=e.topLeft,i=e.bottomRight,s=o.rowIdx,a=o.idx,l=o.groupRecordIndex,c=i.rowIdx,d=i.idx,u=t.columns,p=l,h=[],f=[],m=s;m<=c;m++)h.push(r({isGroupView:n,groupRecordIndex:p,recordIndex:m})),n&&p++;for(var g=a;g<=d;g++)f.push(tl(g,u));return Md(h,f)}(r,a,d,u),g={selectedRecordIds:n,copiedRange:r,copiedColumns:o,copiedRecords:i,copiedTableId:s},v=JSON.stringify(g);f?(f.setData(jd,m),f.setData(Id,v)):_d(m,v)}else{var y=Pa[t.toUpperCase()];f?f.setData(y,l):_d(l,{format:y})}};var Rd=function(e){var t=e.draggedRange,n=e.getSelectedRangeDimensions,r=e.getSelectedDimensions,o=t.overRecordIdx,i=t.bottomRight,s=i.idx,a=i.rowIdx,l=i.groupRowIndex;if(null!==o&&a<o){for(var c=n(t),d=a+1;d<=o;d++){var u=r({idx:s,rowIdx:d,groupRowIndex:l}).height;c.height+=u}return(0,m.jsx)(gd,(0,sr.Z)((0,sr.Z)({},c),{},{className:"react-grid-cell-dragged-over-down"}))}return null};var Td=function(e){var t=e.onDragStart,n=e.onDragEnd;return(0,m.jsx)("div",{className:"drag-handle",draggable:"true",onDragStart:t,onDragEnd:n})},Od=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={isMounted:!1},e.el=document.createElement("div"),e}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.props.target.appendChild(this.el),this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function(){this.props.target.removeChild(this.el)}},{key:"render",value:function(){return this.state.isMounted?l.createPortal(this.props.children,this.el):null}}]),n}(a.Component),Ed=Od,Pd=function(e){var t=e.column,n=e.record,r=e.onCommitCancel,o=(0,a.useMemo)((function(){var e=n[ai];return"string"===typeof e?"TRUE"===e.toUpperCase():e}),[n]),i=(0,a.useMemo)((function(){var e=t.key;return n[e]}),[t,n]),s=(0,a.useMemo)((function(){if(o)return"folder";if(!i)return"";var e=i.lastIndexOf(".");if(-1===e)return"";var t=i.slice(e).toLowerCase();return t.indexOf(" ")>-1?"":f.c.imageCheck(i)?"image":".sdoc"===t?"sdoc":"file"}),[o,i]),l=(0,a.useMemo)((function(){var e=n[li];return"/"===e?"":e}),[n]),c=(0,a.useMemo)((function(){return window.sfMetadataContext.getSetting("repoID")}),[]),d=(0,a.useMemo)((function(){return f.c.encodePath(f.c.joinPath(l,i))}),[l,i]),u=(0,a.useMemo)((function(){return"".concat(h.ze,"lib/").concat(c,"/file").concat(d)}),[d,c]);if((0,a.useEffect)((function(){"image"!==s&&r&&r()}),[s,r]),"image"===s){var p,g="gif"===i.substr(i.lastIndexOf(".")+1).toLowerCase(),v="";v=(null===(p=window.sfMetadataContext.getSetting("currentRepoInfo"))||void 0===p?void 0:p.encrypted)&&!g?"".concat(h.ze,"thumbnail/").concat(c,"/").concat(h.fp).concat(d):"".concat(h.ze,"repo/").concat(c,"/raw").concat(d);var y=[{name:i,url:u,src:v}];return(0,m.jsx)(Bl.Hv,{children:(0,m.jsx)(So.Z,{imageItems:y,imageIndex:0,closeImagePopup:r,moveToPrevImage:function(){},moveToNextImage:function(){}})})}return s&&"sdoc"!==s?window.open(window.location.href+f.c.encodePath(f.c.joinPath(l,i))):window.open(u),null},Zd=function(e){return e.column.type===Uo.FILE_NAME?(0,m.jsx)(Pd,(0,sr.Z)({},e)):null},Fd=function(e){return e.column?(0,m.jsx)(Zd,(0,sr.Z)({},e)):null},Ld=[],Ad=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).throttle=null,o.onColumnSelect=function(e){var t=o.props,n=t.columns;if(!t.isGroupView){for(var r=0,i=0;i<n.length;i++)if(e.key===n[i].key){r=i;break}var s=o.props.recordsCount;o.setState({selectedPosition:(0,sr.Z)((0,sr.Z)({},o.state.selectedPosition),{},{idx:r,rowIdx:0}),selectedRange:{startCell:{idx:r,rowIdx:0},topLeft:{idx:r,rowIdx:0},bottomRight:{idx:r,rowIdx:s-1},isDragging:!1}})}},o.onOpenEditorEvent=function(e){o.setState({openEditorMode:e}),o.openEditor()},o.onCloseEditorEvent=function(){o.state.isEditorEnabled&&o.closeEditor()},o.onSelectCell=function(e,t){var n=o.state,r=n.selectedPosition,i=n.isEditorEnabled,s=t?o.openEditor:function(){return null};i&&o.closeEditor(),o.setState((function(t){var n=(0,sr.Z)((0,sr.Z)({},r),e);return o.isCellWithinBounds(n)?{selectedPosition:n,selectedRange:{topLeft:n,bottomRight:n,startCell:n,cursorCell:n,isDragging:!1}}:t}),s)},o.selectNone=function(){var e={idx:-1,rowIdx:-1,groupRecordIndex:-1};o.setState({selectedPosition:e,selectedRange:{topLeft:e,bottomRight:e,startCell:null,cursorCell:null}}),o.props.selectNone()},o.getSelectedPosition=function(){var e=o.state.selectedRange,t=e.topLeft,n=e.bottomRight;return{top:t.rowIdx,bottom:n.rowIdx,left:t.idx,right:n.idx}},o.getSelectedRange=function(){return o.state.selectedRange},o.selectCell=function(e,t,n){var r={idx:n,groupRecordIndex:e,rowIdx:t};o.setState({selectedPosition:r,selectedRange:{topLeft:r,bottomRight:r,startCell:r,cursorCell:r}})},o.openEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;o.isSelectedCellIsLongText()&&(e&&e.stopPropagation(),e&&e.preventDefault());var t=(e||{}).key,n=o.state.selectedPosition,r=o.props.columns,i=cd({selectedPosition:n,columns:r}).type;!o.isSelectedCellEditable()&&!Ld.includes(i)||o.state.isEditorEnabled||o.setState({isEditorEnabled:!0,firstEditorKeyDown:t,editorPosition:o.getEditorPosition()})},o.openMobileEditor=function(){var e=o.props,t=e.recordGetterByIndex,n=e.isGroupView,r=e.columns,i=o.state.selectedPosition,s=ld({selectedPosition:i,recordGetterByIndex:t,isGroupView:n}),a=cd({selectedPosition:i,columns:r});if(!s||!a||!Ua[a.type])return!1;var l={recordData:s,column:a};return o.props.editMobileCell(l),!0},o.closeEditor=function(){o.setState({isEditorEnabled:!1,firstEditorKeyDown:null,editorPosition:null,openEditorMode:""})},o.onSelectCellRangeStarted=function(e){if(o.isCellWithinBounds(e)){var t=o.createSingleCellSelectedRange(e,!0);o.setState({selectedRange:t},(function(){pa(o.props.onCellRangeSelectionStarted)&&o.props.onCellRangeSelectionStarted(o.state.selectedRange)}))}},o.onSelectCellRangeUpdated=function(e,t,n){if((o.state.selectedRange.isDragging||t)&&o.isCellWithinBounds(e)){var r=function(e,t){var n=e.idx,r=e.rowIdx,o=e.groupRecordIndex,i=t.idx,s=t.rowIdx,a=t.groupRecordIndex,l=[n,i].sort((function(e,t){return e-t})),c=[r,s].sort((function(e,t){return e-t})),d=[o,a].sort((function(e,t){return e-t}));return{topLeft:{idx:l[0],rowIdx:c[0],groupRecordIndex:d[0]},bottomRight:{idx:l[1],rowIdx:c[1],groupRecordIndex:d[1]}}}(o.state.selectedRange.startCell||o.state.selectedPosition,e),i=r.topLeft,s=r.bottomRight,a=(0,sr.Z)((0,sr.Z)({startCell:o.state.selectedPosition},o.state.selectedRange),{},{topLeft:i,bottomRight:s,cursorCell:e});o.setState({selectedRange:a},(function(){pa(o.props.onCellRangeSelectionUpdated)&&o.props.onCellRangeSelectionUpdated(o.state.selectedRange),pa(n)&&n(o.state.selectedRange)}))}},o.onSelectCellRangeEnded=function(){var e=(0,sr.Z)((0,sr.Z)({},o.state.selectedRange),{},{isDragging:!1});o.setState({selectedRange:e},(function(){pa(o.props.onCellRangeSelectionCompleted)&&o.props.onCellRangeSelectionCompleted(o.state.selectedRange)}))},o.focus=function(){o.selectionMask&&!o.isFocused()&&o.selectionMask.focus()},o.isFocused=function(){return document.activeElement===o.selectionMask},o.isCellSelected=function(){var e=o.state.selectedPosition;return-1!==e.idx&&-1!==e.rowIdx},o.isCellWithinBounds=function(e){var t=e.idx,n=e.rowIdx,r=o.props,i=r.columns,s=r.recordsCount;return n>=0&&n<s&&t>=0&&t<i.length},o.isSelectedCellEditable=function(){var e=o.props,t=e.enableCellSelect,n=e.columns,r=e.isGroupView,i=e.recordGetterByIndex,s=e.onCheckCellIsEditable,a=function(e){e.enableCellSelect;var t=e.selectedPosition,n=e.columns,r=e.isGroupView,o=e.recordGetterByIndex,i=e.onCheckCellIsEditable,s=cd({selectedPosition:t,columns:n}),a=ld({selectedPosition:t,isGroupView:r,recordGetterByIndex:o});return!!window.sfMetadataContext.canModifyRow(a)&&(!pa(i)||i((0,sr.Z)({row:a,column:s},t)))}({enableCellSelect:t,columns:n,isGroupView:r,recordGetterByIndex:i,selectedPosition:o.state.selectedPosition,onCheckCellIsEditable:s});return a},o.isSelectedCellIsLongText=function(){var e=o.props.columns,t=o.state.selectedPosition,n=cd({selectedPosition:t,columns:e});return n&&n.type===Uo.LONG_TEXT},o.isGridSelected=function(){return o.isCellWithinBounds(o.state.selectedPosition)},o.getSelectedDimensions=function(e){var t=o.props,n=t.columns,r=t.rowHeight,i=t.isGroupView,s=t.groupOffsetLeft,a=t.getRowTop,l=o.props.getScrollLeft();return(0,sr.Z)({},function(e){var t=e.selectedPosition,n=e.columns,r=e.rowHeight,o=e.scrollLeft,i=e.isGroupView,s=e.groupOffsetLeft,a=e.getRecordTopFromRecordsBody,l=t.idx,c=t.rowIdx,d=t.groupRecordIndex,u={width:0,left:0,top:0,height:r,zIndex:1};if(l>=0){var p=n&&n[l];if(!p)return u;var h,f=p.frozen,m=p.width,g=f?o+p.left:p.left;return i?(g+=s,h=a(d)+1):h=a(c),{width:m,left:g,top:h,height:r,zIndex:f?3:1}}return u}({selectedPosition:e,columns:n,scrollLeft:l,rowHeight:r,isGroupView:i,groupOffsetLeft:s,getRecordTopFromRecordsBody:a}))},o.getSelectedRangeDimensions=function(e){var t=o.props,n=t.columns,r=t.rowHeight,i=t.isGroupView,s=t.groups,a=t.groupMetrics,l=t.groupOffsetLeft,c=t.getRowTop;return(0,sr.Z)({},ud({selectedRange:e,columns:n,rowHeight:r,isGroupView:i,groups:s,groupMetrics:a,groupOffsetLeft:l,getRecordTopFromRecordsBody:c}))},o.setScrollLeft=function(e){var t=(0,xt.Z)(o),n=t.selectionMask,r=t.state.selectedPosition;o.setMaskScrollLeft(n,r,e)},o.setMaskScrollLeft=function(e,t,n){if(e){var r=t.idx,i=t.rowIdx,s=t.groupRecordIndex;if(r>=0&&i>=0){var a=o.props,l=a.columns,c=a.getRowTop,d=a.isGroupView,u=a.groupOffsetLeft,p=l[r];if(!!p.frozen){var h=o.container.getClientRects()[0].top,f=o.props.getTableContentRect().left,m=h+c(d?s:i),g=f+p.left;d&&(m+=1,g+=u),e.style.position="fixed",e.style.top=m+"px",e.style.left=g+"px",e.style.transform="none"}}}},o.cancelSetScrollLeft=function(){o.selectionMask&&o.cancelSetMaskScrollLeft(o.selectionMask,o.state.selectedPosition)},o.cancelSetMaskScrollLeft=function(e,t){var n=o.getSelectedDimensions(t),r=n.left,i=n.top;e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.transform="translate(".concat(r,"px, ").concat(i,"px)")},o.getEditorPosition=function(){if(o.selectionMask){var e=o.props.editorPortalTarget,t=o.selectionMask.getBoundingClientRect(),n=t.left,r=t.top;if(e===document.body){var i=document.scrollingElement||document.documentElement;return{left:n+i.scrollLeft,top:r+i.scrollTop}}var s=e.getBoundingClientRect(),a=s.left,l=s.top;return{left:n-a+e.scrollLeft,top:r-l+e.scrollTop}}},o.onCommit=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];o.props.modifyRecord(e),t&&o.closeEditor()},o.onCommitCancel=function(){o.closeEditor()},o.onKeyDown=function(e){var t,n=e.keyCode;if(function(e){return(!0===e.ctrlKey||!0===e.metaKey)&&"Control"!==e.key}(e))o.onPressKeyWithCtrl(e);else if(n===Ao().Escape)o.onPressEscape(e);else if(n===Ao().Tab)o.onPressTab(e);else if(o.isKeyboardNavigationEvent(e))o.changeCellFromEvent(e);else if((t=n)>47&&t<58||32===t||13===t||t>64&&t<91||t>95&&t<112||t>185&&t<193||t>218&&t<223||n===Ao().Enter)o.openEditor(e);else if(n===Ao().Backspace||n===Ao().Delete){"rdg-selected"===e.target.className&&(e.preventDefault(),o.handleSelectCellsDelete())}},o.handleSelectCellsDelete=function(){var e=o.props,t=e.isGroupView,n=e.recordGetterByIndex,r=e.columns,i=o.state.selectedRange,s=i.topLeft,a=i.bottomRight,l=pd({selectedRange:i,isGroupView:t,recordGetterByIndex:n}).filter((function(e){return window.sfMetadataContext.canModifyRow(e)}));if(0!==l.length){for(var c=s.idx,d=a.idx,u=[],p=[],h=c;h<=d;h++){var f=r[h];if(!f||Qo[f.type]||!window.sfMetadataContext.canModifyCell(f))break;var m=f.type,g=f.data;u.push(f),m===Uo.LINK&&g&&p.push(f)}if(0!==u.length){var v=[],y={},x={},w={},b={},S={},C={};if(l.forEach((function(e){var t=e._id,n={},r={},o={},i={};if(u.forEach((function(t){var s=t.key,a=t.type,l=e[s];if(a===Uo.LINK){if(!Array.isArray(l)||0===l.length)return;return o[s]=null,void(i[s]=l)}(l||0===l||Array.isArray(l)&&l.length>0)&&(r[s]=l,a===Uo.FILE?n[s]=[]:n[s]=null)})),Object.keys(o).length>0&&(S[t]=o,C[t]=i),Object.keys(n).length>0){v.push(t);var s=wd(u,n),a=wd(u,r);y[t]=s,x[t]=n,w[t]=a,b[t]=r}})),v.length>0){o.props.updateRecords({recordIds:v,idRecordUpdates:y,idOriginalRecordUpdates:x,idOldRecordData:w,idOriginalOldRecordData:b,isCopyPaste:!0})}}}},o.onCopy=function(e){e.preventDefault();var t=o.props.recordMetrics,n=kd.getSelectedIds(t);if(n.length>0)o.copyRows(e,n);else{var r=window.getSelection().toString();if(!r&&e.target.value){var i=e.target,s=i.selectionStart,a=i.selectionEnd;r=e.target.value.substring(s,a)}r?o.copyText(e,r):o.isCellMaskActive()&&o.onCopyCells(e)}},o.onPaste=function(e){if(o.isCellMaskActive()&&"r"!==window.sfMetadataContext.getPermission()){var t=o.props,n=t.columns,r=t.isGroupView,i=o.state,s=i.selectedPosition,a=i.selectedRange,l=s.idx,c=s.rowIdx;if(-1!==l&&-1!==c){var d=Fl(e);if(d){var u=d.type,p=d[Pa.DTABLE_FRAGMENT],h=0,f=0;if(u===Pa.DTABLE_FRAGMENT){var m=p.selectedRecordIds,g=p.copiedRange;if(Array.isArray(m)&&m.length>0)h=m.length,f=n.length;else{var v=g.topLeft,y=g.bottomRight,x=v.idx,w=v.rowIdx,b=y.idx;h=y.rowIdx-w+1,f=b-x+1}}else{var S=p.copiedRecords,C=p.copiedColumns;h=S.length,f=C.length}var D=o.isMultiplePaste(h,f);o.props.paste({copied:p,multiplePaste:D,type:u,pasteRange:a,isGroupView:r}),D||o.setPasteRange(h,f)}}}},o.copyText=function(e,t){Nd({type:"text",event:e,copiedText:t})},o.copyRows=function(e,t){var n=o.props,r=n.table,i=n.columns,s=n.recordGetterById,a=n.isGroupView,l=n.getCopiedRecordsAndColumnsFromRange,c=t.length;W.Z.success(c>1?(0,h.ih)("xxx rows are copied.").replace("xxx",c):(0,h.ih)("1 row is copied."));var d=Pa.DTABLE_FRAGMENT,u=l({type:d,copied:{selectedRecordIds:t},isGroupView:a}),p=u.copiedRecords,f=u.copiedColumns,m=r._id;Nd({type:d,event:e,selectedRecordIds:t,copiedRecords:p,copiedColumns:f,copiedTableId:m,tableData:{columns:i},recordGetterById:s})},o.onCopyCells=function(e){var t=o.props,n=t.table,r=t.columns,i=t.isGroupView,s=t.recordGetterByIndex,a=t.getCopiedRecordsAndColumnsFromRange,l=o.state,c=l.selectedPosition,d=l.selectedRange,u=n._id,p=c.rowIdx,f=c.idx;if(!(p<0||f<0)){var m=d.topLeft,g=d.bottomRight,v=Pa.DTABLE_FRAGMENT,y=(g.rowIdx-m.rowIdx+1)*(g.idx-m.idx+1);W.Z.success(y>1?(0,h.ih)("xxx cells copied").replace("xxx",y):(0,h.ih)("1 cell copied"));var x=a({type:v,copied:{copiedRange:d},isGroupView:i}),w=x.copiedRecords,b=x.copiedColumns;Nd({type:v,event:e,copiedRange:(0,sr.Z)({},d),copiedRecords:w,copiedColumns:b,copiedTableId:u,tableData:{columns:r},isGroupView:i,recordGetterByIndex:s})}},o.isMultiplePaste=function(e,t){var n=o.state.selectedRange,r=n.topLeft,i=n.bottomRight,s=r.idx,a=r.rowIdx,l=i.idx,c=i.rowIdx;return Number.isInteger((l-s+1)/t)&&Number.isInteger((c-a+1)/e)},o.setPasteRange=function(e,t){var n=o.props,r=n.recordsCount,i=n.columns,s=o.state,a=s.selectedPosition,l=s.selectedRange,c=l.topLeft,d=c.idx,u=c.rowIdx,p=i.length,h=a.groupRecordIndex,f=d+t-1,m=u+e-1;f>=p&&(f=p-1),m>=r&&(m=r-1);var g={topLeft:c,startCell:a,bottomRight:{idx:f,rowIdx:m,groupRecordIndex:h},cursorCell:{idx:a.idx,rowIdx:a.rowIdx,groupRecordIndex:h}};return o.setState({selectedRange:(0,sr.Z)((0,sr.Z)({},l),g)},(function(){o.focus()})),g},o.onPressKeyWithCtrl=function(){},o.onPressEscape=function(){},o.onPressTab=function(e){o.changeCellFromEvent(e)},o.getLeftInterval=function(){var e=o.props,t=e.isGroupView,n=e.columns,r=e.groupOffsetLeft,i=e.frozenColumnsWidth,s=0;return!!n[0]&&n[0].frozen?(s=r+i,t&&(s+=r)):s=0,s},o.handleVerticalArrowAction=function(e,t){var n=o.props,r=n.isGroupView,i=n.groupMetrics,s=n.rowHeight,a="ArrowDown"===t?1:-1;if(r){for(var l,c=(i.groupRows||[]).length,d=e.groupRecordIndex+a;d>0&&d<c&&(l=id(d,i)).type!==Ba;)d+=a;if(!l||l.type!==Ba)return;var u,p=o.props.getGroupCanvasScrollTop()||0,h=l,f=h.rowIdx,m=h.top;return m<=p+16?u=m-16:m+150-p>=window.innerHeight-32-16&&(u=m+150-window.innerHeight+32+s+16),void 0!==u&&o.props.setGroupCanvasScrollTop(u),(0,sr.Z)((0,sr.Z)({},e),{},{rowIdx:f,groupRecordIndex:d})}return(0,sr.Z)((0,sr.Z)({},e),{},{rowIdx:e.rowIdx+a})},o.handleLeftArrowAction=function(e){var t=o.selectionMask;if(t){var n=o.props.columns,r=t.getBoundingClientRect(),i=o.getLeftInterval(),s=n[e.idx-1]?n[e.idx-1].width:0,a=o.props.getTableContentRect(),l=a.left,c=a.right,d=l+130;if(r.x<0||r.x>c)o.props.scrollToColumn(e.idx-1);else if(s>r.x-i-d){var u=s-(r.x-i-d);o.props.setRecordsScrollLeft(o.props.getScrollLeft()-u)}return(0,sr.Z)((0,sr.Z)({},e),{},{idx:0===e.idx?0:e.idx-1})}},o.handleRightArrowAction=function(e){var t=o.selectionMask;if(t){var n=o.props.columns,r=t.getBoundingClientRect(),i=e.idx,s=n[i];if(1===i&&!0===s.frozen)o.props.scrollToColumn(1);else{var a=o.props.getTableContentRect().right,l=n[i+1]?n[i+1].width:0;if(r.x<0||r.x>a)o.props.scrollToColumn(i+1);else if(r.x+r.width+l>a){var c=l-(a-r.x-r.width);o.props.setRecordsScrollLeft(o.props.getScrollLeft()+c)}}return(0,sr.Z)((0,sr.Z)({},e),{},{idx:e.idx+1})}},o.getKeyNavActionFromEvent=function(e){var t=o.props,n=t.getVisibleIndex,r=t.onHitBottomBoundary,i=t.onHitTopBoundary,s=n(),a=s.rowVisibleStartIdx,l=s.rowVisibleEndIdx,c={ArrowDown:{getNext:function(e){return o.handleVerticalArrowAction(e,"ArrowDown")},isCellAtBoundary:function(e){return e.rowIdx>=l-1},onHitBoundary:r},ArrowUp:{getNext:function(e){return o.handleVerticalArrowAction(e,"ArrowUp")},isCellAtBoundary:function(e){return 0!==e.rowIdx&&e.rowIdx<=a},onHitBoundary:i},ArrowRight:{getNext:function(e){return o.handleRightArrowAction(e)},isCellAtBoundary:function(){return!1}},ArrowLeft:{getNext:function(e){return o.handleLeftArrowAction(e)},isCellAtBoundary:function(){return!1}}};return e.keyCode===Ao().Tab?!0===e.shiftKey?c.ArrowLeft:c.ArrowRight:c[e.key]},o.changeCellFromEvent=function(e){if(e.preventDefault(),(e.keyCode!==Ao().ChineseInputMethod||!o.state.isEditorEnabled)&&!o.throttle){var t=o.state.selectedPosition,n=o.getKeyNavActionFromEvent(e),r=n.getNext(t);r&&(o.checkIsAtGridBoundary(n,r),o.props.onCellClick(r),o.onSelectCell((0,sr.Z)({},r)),o.throttle=!0,setTimeout((function(){o.throttle=!1}),30))}},o.onFocus=function(){},o.onScroll=function(e){e.stopPropagation()},o.setSelectionMaskRef=function(e){o.selectionMask=e},o.setSelectionRangeMaskRef=function(e){o.selectedRangeMask=e},o.setContainerRef=function(e){o.container=e},o.isCellMaskActive=function(){var e=document.activeElement;return e&&("cell-mask"===e.getAttribute("data-test")||"active-editor"===e.getAttribute("data-test"))},o.handleDragCopy=function(e){var t=o.props,n=t.columns,r=t.groupMetrics,i=t.table,s=i.rows,a=i.id_row_map,l=t.gridUtils,c=t.updateRecords,d=l.getUpdateDraggedRecords(e,n,s,a,r);c((0,sr.Z)((0,sr.Z)({},d),{},{isCopyPaste:!0}))},o.handleDragStart=function(e){var t=o.state.selectedRange,n=t.topLeft,r=t.bottomRight,i=t.startCell,s=t.cursorCell,a=e&&e.target&&e.target.className;if(n.idx>-1&&a){try{e.dataTransfer.setData("text/plain","")}catch(l){e.dataTransfer.setData("text","")}o.setState({draggedRange:{topLeft:n,bottomRight:r,startCell:i,cursorCell:s}})}},o.handleDragEnter=function(e){var t=e.overRecordIdx,n=e.overGroupRecordIndex;null!=o.state.draggedRange&&o.setState((function(e){var r=e.draggedRange;return{draggedRange:(0,sr.Z)((0,sr.Z)({},r),{},{overRecordIdx:t,overGroupRecordIndex:n})}}))},o.handleDragEnd=function(){var e=o.state,t=e.draggedRange,n=e.selectedRange,r=xa()(n);if(null!==t){var i=t.overRecordIdx,s=t.overGroupRecordIndex,a=t.bottomRight;null!==i&&a.rowIdx<i&&(o.handleDragCopy(t),r.bottomRight.rowIdx=i,r.cursorCell.rowIdx=i,r.bottomRight.groupRowIndex=s,r.cursorCell.groupRowIndex=s),o.setState({draggedRange:null,selectedRange:r})}},o.renderSingleCellSelectView=function(){var e=o.props.columns,t=o.state,n=t.isEditorEnabled,r=t.selectedPosition,i=o.isSelectedCellEditable()&&!1,s=(cd({selectedPosition:r,columns:e})||{}).type;if(n&&s!==Uo.RATE&&s!==Uo.CHECKBOX)return null;if(!o.isGridSelected())return null;var a={innerRef:o.setSelectionMaskRef,selectedPosition:r,getSelectedDimensions:o.getSelectedDimensions};return(0,m.jsx)(yd,(0,sr.Z)((0,sr.Z)({},a),{},{children:i?(0,m.jsx)(Td,{onDragStart:o.handleDragStart,onDragEnd:o.handleDragEnd}):null}))},o.renderCellRangeSelectView=function(){var e=o.state.selectedRange,t=o.props,n=t.columns,r=t.rowHeight,i=o.isSelectedCellEditable()&&!1;return[(0,m.jsx)(vd,{innerRef:o.setSelectionRangeMaskRef,selectedRange:e,columns:n,rowHeight:r,getSelectedRangeDimensions:o.getSelectedRangeDimensions,children:i?(0,m.jsx)(Td,{onDragStart:o.handleDragStart,onDragEnd:o.handleDragEnd}):null},"range-mask"),(0,m.jsx)(yd,{innerRef:o.setSelectionMaskRef,selectedPosition:e.startCell,getSelectedDimensions:o.getSelectedDimensions},"selection-mask")]},o.renderMobileOperations=function(){var e=o.props,t=e.canAddRow,n=e.columns,r=o.state.selectedPosition,i=!(-1===r.idx&&-1===r.rowIdx),s=i&&cd({selectedPosition:r,columns:n}),a=i&&s&&Ua[s.type]&&o.isSelectedCellEditable(),l=o.props.getMobileFloatIconStyle(),c={bottom:t||a?102:42},d=[(0,m.jsx)("span",{className:"mobile-float-icon mobile-more-icon",style:Object.assign(c,l),onClick:o.props.onToggleMobileMoreOperations,children:(0,m.jsx)("i",{className:"sf-metadata-font sf-metadata-icon-more-level"})},"mobile-more-icon")];return t&&!a&&d.push((0,m.jsx)("span",{className:"mobile-float-icon mobile-insert-row-icon",style:Object.assign({bottom:42},l),onClick:o.props.onToggleInsertRecordDialog,children:(0,m.jsx)("i",{className:"sf-metadata-font sf-metadata-icon-add-table"})},"mobile-insert-row-icon")),a&&d.push((0,m.jsx)("span",{className:"mobile-float-icon mobile-edit-cell-icon",style:Object.assign({bottom:42},l),onClick:o.openMobileEditor,children:(0,m.jsx)("i",{className:"sf-metadata-font sf-metadata-icon-rename"})},"mobile-edit-cell-icon")),d};var i={idx:-1,rowIdx:-1,groupRecordIndex:-1};return o.state={selectedPosition:i,selectedRange:{topLeft:i,bottomRight:i,startCell:null,cursorCell:null,isDragging:!1},draggedRange:null,isEditorEnabled:!1,openEditorMode:""},o.selectionMask=null,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.unsubscribeSelectColumn=window.sfMetadataContext.eventBus.subscribe(Ea.SELECT_COLUMN,this.onColumnSelect),this.unsubscribeDragEnter=window.sfMetadataContext.eventBus.subscribe(Ea.DRAG_ENTER,this.handleDragEnter),this.unsubscribeSelectCell=window.sfMetadataContext.eventBus.subscribe(Ea.SELECT_CELL,this.onSelectCell),this.unsubscribeSelectNone=window.sfMetadataContext.eventBus.subscribe(Ea.SELECT_NONE,this.selectNone),this.unsubscribeSelectStart=window.sfMetadataContext.eventBus.subscribe(Ea.SELECT_START,this.onSelectCellRangeStarted),this.unsubscribeSelectUpdate=window.sfMetadataContext.eventBus.subscribe(Ea.SELECT_UPDATE,this.onSelectCellRangeUpdated),this.unsubscribeSelectEnd=window.sfMetadataContext.eventBus.subscribe(Ea.SELECT_END,this.onSelectCellRangeEnded),this.unsubscribeOpenEditorEvent=window.sfMetadataContext.eventBus.subscribe(Ea.OPEN_EDITOR,this.onOpenEditorEvent),this.unsubscribeCloseEditorEvent=window.sfMetadataContext.eventBus.subscribe(Ea.CLOSE_EDITOR,this.onCloseEditorEvent),this.unsubscribeCopy=window.sfMetadataContext.eventBus.subscribe(Ea.COPY_CELLS,this.onCopy),this.unsubscribePaste=window.sfMetadataContext.eventBus.subscribe(Ea.PASTE_CELLS,this.onPaste)}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,r=n.selectedRange,o=n.isEditorEnabled,i=t.selectedRange,s=o!==t.isEditorEnabled&&!o;(r!==i&&(r.topLeft!==i.topLeft||r.bottomRight!==i.bottomRight)||s)&&this.focus()}},{key:"componentWillUnmount",value:function(){this.unsubscribeSelectColumn(),this.unsubscribeSelectCell(),this.unsubscribeSelectStart(),this.unsubscribeSelectUpdate(),this.unsubscribeSelectEnd(),this.unsubscribeOpenEditorEvent(),this.unsubscribeCloseEditorEvent(),this.unsubscribeCopy(),this.unsubscribePaste(),this.setState=function(e,t){}}},{key:"createSingleCellSelectedRange",value:function(e,t){return{topLeft:e,bottomRight:e,startCell:e,cursorCell:e,isDragging:t}}},{key:"isKeyboardNavigationEvent",value:function(e){return null!=this.getKeyNavActionFromEvent(e)}},{key:"checkIsAtGridBoundary",value:function(e,t){var n=e.isCellAtBoundary,r=e.onHitBoundary;n(t)&&r(t)}},{key:"render",value:function(){var e=this.state,t=e.selectedRange,n=e.isEditorEnabled,r=e.draggedRange,o=e.selectedPosition,i=e.firstEditorKeyDown,s=e.openEditorMode,a=e.editorPosition,l=this.props,c=l.table,d=l.columns,u=l.isGroupView,p=l.recordGetterByIndex,h=l.scrollTop,f=l.getScrollLeft,g=l.editorPortalTarget,v=function(e){var t=e.topLeft,n=e.bottomRight;return t.idx===n.idx&&t.rowIdx===n.rowIdx}(t);return(0,m.jsxs)("div",{className:"interaction-mask",ref:this.setContainerRef,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onScroll:this.onScroll,tabIndex:0,"aria-hidden":"true",children:[r&&(0,m.jsx)(Rd,{draggedRange:r,getSelectedDimensions:this.getSelectedDimensions,getSelectedRangeDimensions:this.getSelectedRangeDimensions}),v&&this.renderSingleCellSelectView(),!v&&this.renderCellRangeSelectView(),n&&(0,m.jsx)(Ed,{target:g,children:(0,m.jsx)(Fd,(0,sr.Z)({table:c,columns:d,isGroupView:u,scrollTop:h,firstEditorKeyDown:i,openEditorMode:s,portalTarget:g,scrollLeft:f(),record:ld({selectedPosition:o,isGroupView:u,recordGetterByIndex:p}),column:cd({selectedPosition:o,columns:d}),onCommit:this.onCommit,onCommitCancel:this.onCommitCancel,editorPosition:a},(0,sr.Z)((0,sr.Z)({},this.getSelectedDimensions(o)),this.state.editorPosition)))})]})}}]),n}(a.Component);Ad.defaultProps={enableCellSelect:!0,isGroupView:!1,groupOffsetLeft:0};var Ud=Ad,zd=function(e,t,n){var r=0,o=0,i=Bd(e,t);if(!i)return null;for(var s=0;s<t;s++){var a=Bd(e,s);a&&(a.width&&(r+=a.width),rl(a)&&(o+=a.width))}return Al?r-(n-i.width)/2:r-o},Bd=function(e,t){return Array.isArray(e)?e[t]:"undefined"!==typeof Immutable?e.get(t):void 0},Gd=function(e,t){for(var n=t,r=0;r<e.length;r++){if((n-=e[r].width)<0)return r}},Hd=function(e,t,n){for(var r=t+n,o=0;o<e.length;o++){if((r-=e[o].width)<0)return o-1-1}return e.length-1},Yd=33,Vd=window.innerHeight-174,Wd=Math.max,Kd=Math.min,qd=Math.ceil,$d=Math.round,Xd=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).getVisibleIndex=function(){return{rowVisibleStartIdx:o.rowVisibleStart,rowVisibleEndIdx:o.rowVisibleEnd}},o.getShownRecords=function(){return o.getShownRecordIds().map((function(e){return o.props.recordGetterById(e)}))},o.setRecordVisibleEnd=function(){return Wd(qd(Vd/Yd),0)},o.setColumnVisibleEnd=function(){for(var e=o.props,t=e.columns,n=e.getScrollLeft,r=0,i=(0,e.getTableContentRect)().width+n(),s=0;s<t.length;s++){if((i-=t[s].width)<0)return s}return r},o.recalculateRenderIndex=function(e){var t=o.state,n=t.startRenderIndex,r=t.endRenderIndex,i=o.resultContentRef.scrollTop,s=Math.max(0,Math.floor(i/Yd)-10),a=Math.min(Math.ceil((i+o.resultContentRef.offsetHeight)/Yd)+10,e.length);s!==n&&o.setState({startRenderIndex:s}),a!==r&&o.setState({endRenderIndex:a})},o.getInitEndIndex=function(e){return Math.min(Math.ceil(window.innerHeight/Yd)+10,e.recordsCount)},o.getShownRecordIds=function(){var e=o.props.recordIds,t=o.state,n=t.startRenderIndex,r=t.endRenderIndex;return e.slice(n,r)},o.getRowTop=function(e){return Yd*e},o.getRowHeight=function(){return Yd},o.jumpToRow=function(e){var t=o.props.recordsCount,n=o.getRowHeight(),r=o.resultContentRef.offsetHeight,i=Math.min(e*n,t*n-r);o.setScrollTop(i)},o.scrollToColumn=function(e){var t=o.props,n=t.columns,r=(0,t.getTableContentRect)().width,i=zd(n,e,r);null!==i&&o.props.setRecordsScrollLeft(i),o.updateColVisibleIndex(i)},o.updateColVisibleIndex=function(e){var t=o.props.columns,n=Gd(t,e),r=Hd(t,window.innerWidth,e);o.columnVisibleStart=n,o.columnVisibleEnd=r},o.setScrollTop=function(e){o.resultContentRef.scrollTop=e},o.setScrollLeft=function(e){var t=(0,xt.Z)(o).interactionMask;t&&t.setScrollLeft(e)},o.cancelSetScrollLeft=function(){var e=(0,xt.Z)(o).interactionMask;e&&e.cancelSetScrollLeft()},o.getClientScrollTopOffset=function(e){var t=o.getRowHeight(),n=e.scrollTop%t;return n>0?t-n:0},o.onHitBottomCanvas=function(){var e=o.getRowHeight(),t=o.resultContentRef;t.scrollTop+=e+o.getClientScrollTopOffset(t)},o.onHitTopCanvas=function(){var e=o.getRowHeight(),t=o.resultContentRef;t.scrollTop-=e-o.getClientScrollTopOffset(t)},o.getScrollTop=function(){return o.resultContentRef?o.resultContentRef.scrollTop:0},o.getRecordBodyHeight=function(){return o.resultContentRef?o.resultContentRef.offsetHeight:0},o.onScroll=function(){var e=o.props.recordsCount,t=o.state,n=t.startRenderIndex,r=t.endRenderIndex,i=o.resultContentRef,s=i.offsetHeight,a=i.scrollTop,l=Math.max(0,Math.floor(a/Yd)-10),c=Math.min(Math.ceil((a+o.resultContentRef.offsetHeight)/Yd)+10,e);o.oldScrollTop=a;var d=qd(o.resultContentRef.offsetHeight/Yd),u=Wd(0,$d(a/Yd)),p=Kd(u+d,e);o.rowVisibleStart=u,o.rowVisibleEnd=p,o.props.cacheScrollTop(a),(Math.abs(l-n)>5||l<5)&&o.setState({startRenderIndex:l}),(Math.abs(c-r)>5||c>e-5)&&o.setState({endRenderIndex:c}),s+a>=o.resultContentRef.scrollHeight&&o.props.scrollToLoadMore(),o.isScrollingRightScrollbar||o.setRightScrollbarScrollTop(o.oldScrollTop),o.clearScrollbarTimer(),o.scrollbarTimer=setTimeout((function(){o.setState({isScrollingRightScrollbar:!1})}),300)},o.onRowExpand=function(e){o.props.onRowExpand&&o.props.onRowExpand(e)},o.onScrollbarScroll=function(e){o.oldScrollTop!==e&&o.setState({isScrollingRightScrollbar:!0},(function(){o.setScrollTop(e)}))},o.onScrollbarMouseUp=function(){o.setState({isScrollingRightScrollbar:!1})},o.setRightScrollbarScrollTop=function(e){o.rightScrollbar&&o.rightScrollbar.setScrollTop(e)},o.onDeleteRecords=function(){o.interactionMask&&o.interactionMask.selectNone(),o.props.selectNone(),o.props.onDeleteRecords(o.state.activeRecords)},o.onInsertRecords=function(e){var t=e.insertRecordsNumber,n=o.state.activeRecords[0],r=n&&n._id;r&&o.props.insertRecords({upperRecordId:r,insertRecordsNumber:t})},o.addBlankRecord=function(){var e=o.props,t=e.recordsCount,n=e.recordIds,r=t-1,i=r>-1&&n[r];o.props.insertRecords({upperRecordId:i,insertRecordsNumber:1})},o.onDuplicateRecord=function(){o.props.duplicateRecord(o.state.activeRecords[0])},o.onDuplicateRecords=function(){o.props.duplicateRecords(o.state.activeRecords)},o.selectNoneCells=function(){o.interactionMask&&o.interactionMask.selectNone();var e=o.state.selectedPosition;!e||e.idx<0||e.rowIdx<0||o.selectNone()},o.selectNone=function(){o.setState({selectedPosition:{idx:-1,rowIdx:-1}})},o.selectCell=function(e,t){window.sfMetadataContext.eventBus.dispatch(Ea.SELECT_CELL,e,t)},o.selectStart=function(e){window.sfMetadataContext.eventBus.dispatch(Ea.SELECT_START,e)},o.selectUpdate=function(e,t,n){window.sfMetadataContext.eventBus.dispatch(Ea.SELECT_UPDATE,e,t,n)},o.selectEnd=function(){window.sfMetadataContext.eventBus.dispatch(Ea.SELECT_END)},o.onCellClick=function(e,t){var n=o.state.selectedPosition;if(hd(t)){if(!n||-1===n.idx)return void o.selectCell(e,!1);o.selectUpdate(e,!0)}else{var r=o.props.columns,i=il(e,r),s=dd(e,r,!1,o.props.recordGetterByIndex);o.selectCell(e,i&&s)}o.props.onCellClick(e),o.setState({selectedPosition:e})},o.onCellDoubleClick=function(e,t){var n=o.props.columns,r=ol(e,n),i=dd(e,n,!1,o.props.recordGetterByIndex);o.selectCell(e,r&&i)},o.onCellMouseDown=function(e,t){hd(t)||(o.selectCell(e),o.selectStart(e),window.addEventListener("mouseup",o.onWindowMouseUp))},o.onCellMouseEnter=function(e){o.selectUpdate(e,!1,o.updateViewableArea)},o.onCellMouseMove=function(e){o.selectUpdate(e,!1,o.updateViewableArea)},o.onWindowMouseUp=function(e){window.removeEventListener("mouseup",o.onWindowMouseUp),hd(e)||(o.selectEnd(),o.clearHorizontalScroll())},o.onCellRangeSelectionUpdated=function(e){o.props.onCellRangeSelectionUpdated(e)},o.updateViewableArea=function(e){var t=e.cursorCell.mousePosition,n=t.x,r=t.y,i=100;if(n+i>window.innerWidth)o.scrollToRight();else if(n-i<Za+o.props.frozenColumnsWidth)o.scrollToLeft();else if(r+i>window.innerHeight-130){var s=o.getScrollTop();o.resultContentRef.scrollTop=s+8,o.clearHorizontalScroll()}else if(r-i<130){var a=o.getScrollTop();a-16>=0&&(o.resultContentRef.scrollTop=a-8),o.clearHorizontalScroll()}else o.clearHorizontalScroll()},o.scrollToRight=function(){o.timer||(o.timer=setInterval((function(){var e=o.props.getScrollLeft();o.props.setRecordsScrollLeft(e+20)}),10))},o.scrollToLeft=function(){o.timer||(o.timer=setInterval((function(){var e=o.props.getScrollLeft();e<=0?o.clearHorizontalScroll():o.props.setRecordsScrollLeft(e-20)}),10))},o.clearHorizontalScroll=function(){o.timer&&(clearInterval(o.timer),o.timer=null)},o.clearScrollbarTimer=function(){o.scrollbarTimer&&(clearTimeout(o.scrollbarTimer),o.scrollbarTimer=null)},o.getCellMetaData=function(){return o.cellMetaData||(o.cellMetaData={onCellClick:o.onCellClick,onCellDoubleClick:o.onCellDoubleClick,onCellMouseDown:o.onCellMouseDown,onCellMouseEnter:o.onCellMouseEnter,onCellMouseMove:o.onCellMouseMove,onDragEnter:o.handleDragEnter}),o.cellMetaData},o.handleDragEnter=function(e){var t=e.overRecordIdx,n=e.overGroupRecordIndex;window.sfMetadataContext.eventBus.dispatch(Ea.DRAG_ENTER,{overRecordIdx:t,overGroupRecordIndex:n})},o.setRightScrollbar=function(e){o.rightScrollbar=e},o.setInteractionMaskRef=function(e){o.interactionMask=e},o.setResultRef=function(e){o.resultRef=e},o.setResultContentRef=function(e){o.resultContentRef=e},o.renderRecords=function(){o.recordFrozenRefs=[],o.frozenBtnAddRecordRefs=[];var e=o.props,t=e.recordsCount,n=e.columns,r=e.colOverScanStartIdx,i=e.colOverScanEndIdx,s=e.lastFrozenColumnKey,a=e.recordMetrics,l=e.showCellColoring,c=e.columnColors,d=o.state,u=d.startRenderIndex,p=d.endRenderIndex,h=d.selectedPosition,f=o.getCellMetaData(),g=t-1,v=o.getShownRecordIds(),y=o.props.getScrollLeft(),x=o.getRowHeight(),w=v.map((function(e,t){var d=o.props.recordGetterById(e),p=kd.isRecordSelected(e,a),v=u+t,w=g===v,b=o.props.hasSelectedCell({recordIndex:v},h),S=l?c[e]:{};return(0,m.jsx)(Qc,{ref:function(e){o.recordFrozenRefs.push(e)},isSelected:p,index:v,isLastRecord:w,record:d,columns:n,colOverScanStartIdx:r,colOverScanEndIdx:i,lastFrozenColumnKey:s,scrollLeft:y,height:x,cellMetaData:f,hasSelectedCell:b,selectedPosition:o.state.selectedPosition,selectNoneCells:o.selectNoneCells,onSelectRecord:o.props.onSelectRecord,onRowExpand:o.onRowExpand,modifyRecord:o.props.modifyRecord,searchResult:o.props.searchResult,columnColor:S},e||v)})),b=u*Yd,S=(t-p)*Yd;if(b>0){var C={height:b,width:"100%"},D=(0,m.jsx)("div",{className:"d-flex align-items-end",style:C,children:(0,m.jsx)(Bl.gb,{})},"upper-placeholder");w.unshift(D)}if(S>0){var k={height:S,width:"100%"},j=(0,m.jsx)("div",{style:k,children:(0,m.jsx)(Bl.gb,{})},"below-placeholder");w.push(j)}return w},o.state={startRenderIndex:0,endRenderIndex:o.getInitEndIndex(e),isContextMenuShow:!1,activeRecords:[],menuPosition:null,selectedPosition:null,isScrollingRightScrollbar:!1},o.resultContentRef=null,o.resultRef=null,o.recordFrozenRefs=[],o.frozenBtnAddRecordRefs=[],o.rowVisibleStart=0,o.rowVisibleEnd=o.setRecordVisibleEnd(),o.columnVisibleStart=0,o.columnVisibleEnd=o.setColumnVisibleEnd(),o.timer=null,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.props.onRef(this),window.sfMetadataBody=this,document.addEventListener("contextmenu",this.handleContextMenu)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.recordsCount,n=e.recordIds;t===this.props.recordsCount&&n===this.props.recordIds||this.recalculateRenderIndex(n)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("contextmenu",this.handleContextMenu),this.clearHorizontalScroll(),this.clearScrollbarTimer(),this.setState=function(e,t){}}},{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{id:"canvas",className:"sf-metadata-result-table-content",ref:this.setResultContentRef,onScroll:this.onScroll,children:[(0,m.jsx)(Ud,{ref:this.setInteractionMaskRef,canAddRow:this.props.canAddRow,table:this.props.table,columns:this.props.columns,recordsCount:this.props.recordsCount,recordMetrics:this.props.recordMetrics,rowHeight:this.getRowHeight(),getRowTop:this.getRowTop,scrollTop:this.oldScrollTop,getScrollLeft:this.props.getScrollLeft,getTableContentRect:this.props.getTableContentRect,getMobileFloatIconStyle:this.props.getMobileFloatIconStyle,onToggleMobileMoreOperations:this.props.onToggleMobileMoreOperations,editorPortalTarget:this.props.editorPortalTarget,onCellRangeSelectionUpdated:this.onCellRangeSelectionUpdated,modifyRecord:this.props.modifyRecord,recordGetterByIndex:this.props.recordGetterByIndex,recordGetterById:this.props.recordGetterById,updateRecords:this.props.updateRecords,paste:this.props.paste,editMobileCell:this.props.editMobileCell,frozenColumnsWidth:this.props.frozenColumnsWidth,selectNone:this.selectNone,getVisibleIndex:this.getVisibleIndex,onHitBottomBoundary:this.onHitBottomCanvas,onHitTopBoundary:this.onHitTopCanvas,onCellClick:this.onCellClick,scrollToColumn:this.scrollToColumn,setRecordsScrollLeft:this.props.setRecordsScrollLeft,gridUtils:this.props.gridUtils,getCopiedRecordsAndColumnsFromRange:this.props.getCopiedRecordsAndColumnsFromRange}),(0,m.jsx)("div",{className:"sf-metadata-result-table",style:{width:this.props.totalWidth+Za},ref:this.setResultRef,children:this.renderRecords()})]}),(0,m.jsx)(Gc,{table:this.props.table,ref:this.setRightScrollbar,onScrollbarScroll:this.onScrollbarScroll,onScrollbarMouseUp:this.onScrollbarMouseUp})]})}}]),n}(a.Component);Xd.defaultProps={editorPortalTarget:document.body,scrollToRowIndex:0};var Jd=Xd,Qd=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).renderCollaborator=function(e){var t=e||{},n=t.email,r=t.avatar_url,o=t.name;return(0,m.jsxs)("div",{className:"collaborator",children:[(0,m.jsx)("span",{className:"collaborator-avatar-container",children:(0,m.jsx)("img",{src:r,alt:o,className:"collaborator-avatar"})}),(0,m.jsx)("span",{className:"collaborator-name",title:o,"aria-label":o,children:o})]},n)},o.renderGroupCellVal=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(e.type){case Uo.CREATOR:case Uo.LAST_MODIFIER:return n?(0,m.jsx)(Kc,{value:n,field:e}):o.EmptyDOM;default:return t||o.EmptyDOM}},o.state={creator:null},o.EmptyDOM="(".concat((0,h.ih)("Empty"),")"),o.deletedOptionTips=(0,h.ih)(Va),o.collaborators=window.sfMetadataContext.getCollaboratorsFromCache(),o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.column,n=e.originalCellValue,r=e.cellValue;return(0,m.jsxs)("div",{className:"group-title",children:[(0,m.jsx)("div",{className:"group-column-name",children:t.name}),(0,m.jsx)("div",{className:"group-cell-value",children:this.renderGroupCellVal(t,r,n)})]})}}]),n}(a.Component),eu=Qd,tu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.isExpanded,r=t.firstColumnFrozen,o=t.lastColumnFrozen,i=t.firstColumnKey,s=t.maxLevel,a=t.group,l=t.width,c=a.column,d=a.count,u=a.level,p=a.cell_value,f=a.original_cell_value,g=Br()("group-expand-icon","sf-metadata-font",n?"sf-metadata-icon-drop-down":"sf-metadata-icon-right-slide"),v={zIndex:r&&2,height:La,width:l};return(0,m.jsxs)("div",{ref:function(t){return e.groupHeaderLeft=t},className:Br()("group-header-left group-header-cell",{"table-last--frozen":o}),style:v,"data-column_key":i,children:[(0,m.jsx)("div",{className:"group-expand",onClick:this.props.onExpandGroupToggle,children:(0,m.jsx)("span",{children:(0,m.jsx)("i",{className:g})})}),(0,m.jsx)(eu,{column:c||{},originalCellValue:f,cellValue:p}),(0,m.jsx)("div",{className:"group-rows-count",children:(0,m.jsxs)("div",{className:"group-rows-count-content",children:[u===s&&(0,m.jsx)("span",{className:"count-title",children:(0,h.ih)("Count")}),(0,m.jsx)("span",{className:"count-num",children:d})]})})]})}}]),n}(a.Component),nu=tu,ru=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).fixedFrozenDOMs=function(t,n){e.leftContainer&&(e.leftContainer.style.position="fixed",e.leftContainer.style.marginLeft="0px",e.leftContainer.style.marginTop=-n+"px")},e.setContainerRef=function(t){e.leftContainer=t},e.cancelFixFrozenDOMs=function(t){e.leftContainer&&(e.leftContainer.style.position="absolute",e.leftContainer.style.marginLeft=t+"px",e.leftContainer.style.marginTop="0px")},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.isExpanded,r=t.maxLevel,o=t.group,i=t.formulaRow,s=t.leftPaneWidth,a=t.height,l=t.firstColumnFrozen,c=t.lastColumnFrozen,d=t.firstColumnKey,u={zIndex:l?2:0,width:s,height:a};return(0,m.jsx)("div",{className:"group-container group-container-left",style:u,ref:this.setContainerRef,children:(0,m.jsx)(nu,{ref:function(t){return e.leftHeader=t},isExpanded:n,firstColumnFrozen:l,lastColumnFrozen:c,firstColumnKey:d,width:s,maxLevel:r,group:o,formulaRow:i,onExpandGroupToggle:this.props.onExpandGroupToggle})})}}]),n}(a.Component),ou=ru,iu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).fixedFrozenDOMs=function(t,n){if(e.headerCell){var r=e.props,o=r.firstColumnWidth,i=r.groupOffsetLeft,s=e.props.getTableContentRect();e.headerCell.style.position="fixed",e.headerCell.style.marginLeft=Za+o+i+s+"px",e.headerCell.style.marginTop=-n+"px"}},e.cancelFixFrozenDOMs=function(t){e.headerCell&&(e.headerCell.style.position="absolute",e.headerCell.style.marginLeft=t+"px",e.headerCell.style.marginTop=0)},e.getStyle=function(){var t=e.props,n=t.offsetLeft,r=t.column,o=t.isExpanded,i={position:"absolute",width:r.width,height:La-(o?1:2),left:n};return rl(r)&&(i.zIndex=2),i},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.column,r=t.isLastFrozenColumn;return(0,m.jsx)("div",{ref:function(t){return e.headerCell=t},className:Br()("summary-item group-header-cell",{"table-last--frozen":r}),style:this.getStyle(),"data-column_key":n.key})}}]),n}(a.PureComponent),su=iu,au=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).headerCells={},e.setHeaderCellRef=function(t){return function(n){e.headerCells[t]=n}},e.fixedFrozenDOMs=function(t,n){e.props.columns.forEach((function(r){var o=e.headerCells[r.key];rl(r)&&o&&o.fixedFrozenDOMs(t,n)}))},e.cancelFixFrozenDOMs=function(t){e.props.columns.forEach((function(n){var r=e.headerCells[n.key];rl(n)&&r&&r.cancelFixFrozenDOMs(t)}))},e.getGroupSummaries=function(){var t=e.props,n=t.group,r=t.isExpanded,o=t.columns,i=t.groupOffsetLeft,s=t.lastFrozenColumnKey,a=t.summaryConfigs,l=o.slice(1),c=o[0]?o[0].width:0,d=0;return l.map((function(t,o){var u=t.key,p=a&&a[u]?a[u]:"Sum",h=n.summaries[u];return 0!==o&&(d+=l[o-1].width),(0,m.jsx)(su,{ref:e.setHeaderCellRef(u),firstColumnWidth:c,groupOffsetLeft:i,isLastFrozenColumn:u===s,offsetLeft:d,column:t,isExpanded:r,summary:h,summaryMethod:p,getTableContentRect:e.props.getTableContentRect},u)}))},e}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsx)("div",{className:"group-header-right",style:{height:La},children:this.getGroupSummaries()})}}]),n}(a.Component),lu=au,cu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).fixedFrozenDOMs=function(t,n){e.rightHeader&&e.rightHeader.fixedFrozenDOMs(t,n)},e.cancelFixFrozenDOMs=function(t){e.rightHeader&&e.rightHeader.cancelFixFrozenDOMs(t)},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.group,r=t.isExpanded,o=t.columns,i=t.summaryConfigs,s=t.rightPaneWidth,a=t.leftPaneWidth,l=t.height,c=t.groupOffsetLeft,d=t.lastFrozenColumnKey,u={left:a,width:s,height:l};return(0,m.jsx)("div",{className:"group-container group-container-right",style:u,children:(0,m.jsx)(lu,{ref:function(t){return e.rightHeader=t},groupOffsetLeft:c,lastFrozenColumnKey:d,group:n,isExpanded:r,columns:o,summaryConfigs:i,getTableContentRect:this.props.getTableContentRect})})}}]),n}(a.Component),du=cu,uu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).fixedFrozenDOMs=function(t,n){if(e.backDrop){var r=e.props.getTableContentRect();e.backDrop.style.position="fixed",e.backDrop.style.marginLeft=r+"px",e.backDrop.style.marginTop=-n+"px"}e.leftContainer&&e.leftContainer.fixedFrozenDOMs(t,n),e.rightContainer&&e.rightContainer.fixedFrozenDOMs(t,n)},e.cancelFixFrozenDOMs=function(t){e.backDrop&&(e.backDrop.style.position="absolute",e.backDrop.style.marginLeft=t-Fa+"px",e.backDrop.style.marginTop="0px"),e.leftContainer&&e.leftContainer.cancelFixFrozenDOMs(t),e.rightContainer&&e.rightContainer.cancelFixFrozenDOMs(t)},e.setContainer=function(t){e.group=t},e.setBackDrop=function(t){e.backDrop=t},e.onExpandGroupToggle=function(){var t=e.props.groupPathString;e.props.onExpandGroupToggle(t)},e}return(0,o.Z)(n,[{key:"shouldComponentUpdate",value:function(e){return e.groupPathString!==this.props.groupPathString||e.group!==this.props.group||e.width!==this.props.width||e.height!==this.props.height||e.top!==this.props.top||e.columns!==this.props.columns||e.rowHeight!==this.props.rowHeight||e.isExpanded!==this.props.isExpanded||e.scrollLeft!==this.props.scrollLeft||e.lastFrozenColumnKey!==this.props.lastFrozenColumnKey||e.summaryConfigs!==this.props.summaryConfigs}},{key:"componentDidMount",value:function(){this.props.lastFrozenColumnKey&&!Al&&this.checkScroll()}},{key:"checkScroll",value:function(){var e=this.props.scrollLeft;this.cancelFixFrozenDOMs(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.group,r=t.columns,o=t.width,i=t.isExpanded,s=t.folding,a=t.summaryConfigs,l=t.height,c=t.backdropHeight,d=t.top,u=t.groupOffsetLeft,p=t.lastFrozenColumnKey,h=t.maxLevel,f=n.left,g=n.level,v=1===g,y=Br()("group-item","group-level-".concat(g),i?"expanded-group":"folded-group",s?"folding":""),x=r[0]||{},w=rl(x),b=x.width||0,S=Za+b+(v?0:(g-1)*Fa-1),C=o-S,D={height:l,width:o,top:d,left:f},k={height:c,width:S+Fa,zIndex:2};return(0,m.jsxs)("div",{className:y,ref:this.setContainer,style:D,children:[g===h&&w&&!Al&&(0,m.jsx)("div",{className:"group-backdrop",ref:this.setBackDrop,style:k}),(0,m.jsx)(ou,{ref:function(t){return e.leftContainer=t},group:n,firstColumnFrozen:w,lastColumnFrozen:x.key===p,leftPaneWidth:S,height:l,isExpanded:i,firstColumnKey:x.key,maxLevel:h,onExpandGroupToggle:this.onExpandGroupToggle}),(0,m.jsx)(du,{ref:function(t){return e.rightContainer=t},group:n,isExpanded:i,leftPaneWidth:S,rightPaneWidth:C,height:l,groupOffsetLeft:u,lastFrozenColumnKey:p,columns:r,summaryConfigs:a,getTableContentRect:this.props.getTableContentRect})]})}}]),n}(a.Component),pu=uu,hu=["startRenderIndex","endRenderIndex"],fu="path_folded_group",mu=Math.max,gu=Math.min,vu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).getShownRecords=function(){var e=o.state,t=e.startRenderIndex,n=e.endRenderIndex,r=e.groupMetrics;return o.getVisibleGroupRecords(t,n,r.groupRows).map((function(e){return o.props.recordGetterById(e.rowId)})).filter((function(e){return!!e}))},o.getGroupVisibleBoundaries=function(e,t,n,r){var o=n.groupRows,i=n.groupRowsHeight,s=n.maxLevel;if(!Array.isArray(o)||0===o.length)return{startRenderIndex:0,endRenderIndex:0};for(var a=0,l=0,c=La*s+10*r,d=mu(0,t-(La*s+10*r)),u=gu(i,t+e+c),p=o.length,h=0;h<p;h++){var f=o[h].top;f<=d&&a++,f<=u&&l++}return{startRenderIndex:a,endRenderIndex:l}},o.setGroupNode=function(e){return function(t){o.groupsNode[e]=t}},o.setResultContentRef=function(e){o.resultContentRef=e},o.setInteractionMaskRef=function(e){o.interactionMask=e},o.setResultRef=function(e){o.resultRef=e},o.setScrollTop=function(e){o.resultContentRef.scrollTop=e},o.setScrollLeft=function(e){o.interactionMask&&o.interactionMask.setScrollLeft(e)},o.cancelSetScrollLeft=function(){o.interactionMask&&o.interactionMask.cancelSetScrollLeft()},o.setRightScrollbar=function(e){o.rightScrollbar=e},o.setColumnVisibleEnd=function(){for(var e=o.props,t=e.columns,n=e.getScrollLeft,r=0,i=(0,e.getTableContentRect)().width+n(),s=0;s<t.length;s++){if((i-=t[s].width)<0)return s}return r},o.getScrollTop=function(){return o.resultContentRef?o.resultContentRef.scrollTop:0},o.getRowHeight=function(){return 32},o.getRowTop=function(e){var t=o.state.groupMetrics,n=id(e,t);return n&&n.top||0},o.jumpToRow=function(e){var t=o.state.groupMetrics,n=o.resultContentRef.offsetHeight,r=o.getRowTop(e),i=Math.min(r,t.groupRowsHeight-n);o.setScrollTop(i)},o.scrollToColumn=function(e){var t=o.props,n=t.columns,r=(0,t.getTableContentRect)().width,i=zd(n,e,r);null!==i&&o.props.setRecordsScrollLeft(i),o.updateColVisibleIndex(i)},o.updateColVisibleIndex=function(e){var t=o.props.columns,n=Gd(t,e),r=Hd(t,window.innerWidth,e);o.columnVisibleStart=n,o.columnVisibleEnd=r},o.getRecordBodyHeight=function(){return o.resultContentRef?o.resultContentRef.offsetHeight:0},o.updateViewableArea=function(e){var t=e.cursorCell.mousePosition,n=t.x,r=t.y,i=100;if(n+i>window.innerWidth)o.scrollToRight();else if(n-i<Za+o.props.frozenColumnsWidth)o.scrollToLeft();else if(r+i>window.innerHeight-130){var s=o.getScrollTop();o.resultContentRef.scrollTop=s+8,o.clearHorizontalScroll()}else if(r-i<130){var a=o.getScrollTop();a-16>=0&&(o.resultContentRef.scrollTop=a-8),o.clearHorizontalScroll()}else o.clearHorizontalScroll()},o.scrollToRight=function(){o.scrollTimer||(o.scrollTimer=setInterval((function(){var e=o.props.getScrollLeft();o.props.setRecordsScrollLeft(e+20)}),10))},o.scrollToLeft=function(){o.scrollTimer||(o.scrollTimer=setInterval((function(){var e=o.props.getScrollLeft();e<=0?o.clearHorizontalScroll():o.props.setRecordsScrollLeft(e-20)}),10))},o.clearHorizontalScroll=function(){o.scrollTimer&&(clearInterval(o.scrollTimer),o.scrollTimer=null)},o.clearScrollbarTimer=function(){o.scrollbarTimer&&(clearTimeout(o.scrollbarTimer),o.scrollbarTimer=null)},o.getCellMetaData=function(){return o.cellMetaData||(o.cellMetaData={onCellClick:o.onCellClick,onCellDoubleClick:o.onCellDoubleClick,onCellMouseDown:o.onCellMouseDown,onCellMouseEnter:o.onCellMouseEnter,onCellMouseMove:o.onCellMouseMove,onDragEnter:o.handleDragEnter}),o.cellMetaData},o.handleDragEnter=function(e){var t=e.overRecordIdx,n=e.overGroupRecordIndex;window.sfMetadataContext.eventBus.dispatch(Ea.DRAG_ENTER,{overRecordIdx:t,overGroupRecordIndex:n})},o.getGroupMetrics=function(){return o.state.groupMetrics},o.getGroupRecordByIndex=function(e){var t=o.getGroupMetrics();return id(e,t)},o.fixFrozenDoms=function(e,t){(rl(o.props.columns[0])||0!==e)&&Object.keys(o.groupsNode).forEach((function(n){var r=o.groupsNode[n];r&&r.fixedFrozenDOMs(e,t)}))},o.cancelFixFrozenDOMs=function(e){(rl(o.props.columns[0])||0!==e)&&o.groupsNode&&Object.keys(o.groupsNode).forEach((function(t){var n=o.groupsNode[t];n&&n.cancelFixFrozenDOMs(e)}))},o.onResize=function(){var e=window.innerHeight;if(e){var t=o.resultContentRef.scrollTop,n=o.getRowHeight();o.updateScroll({gridHeight:e,scrollTop:t,rowHeight:n})}},o.onScroll=function(){var e=o.resultContentRef,t=e.offsetHeight,n=e.scrollTop;o.oldScrollTop=n,o.props.cacheScrollTop(n),o.updateScroll({scrollTop:n}),t+n>=o.resultContentRef.scrollHeight&&o.props.scrollToLoadMore(),o.isScrollingRightScrollbar||o.setRightScrollbarScrollTop(o.oldScrollTop),o.clearScrollbarTimer(),o.scrollbarTimer=setTimeout((function(){o.setState({isScrollingRightScrollbar:!1})}),300)},o.onRowExpand=function(e){o.props.expandRow(o.props.table,o.props.columns,e)},o.setRightScrollbarScrollTop=function(e){o.rightScrollbar&&o.rightScrollbar.setScrollTop(e)},o.onScrollbarScroll=function(e){o.oldScrollTop!==e&&o.setState({isScrollingRightScrollbar:!0},(function(){o.setScrollTop(e)}))},o.onScrollbarMouseUp=function(){o.setState({isScrollingRightScrollbar:!1})},o.onCellClick=function(e,t){var n=o.state.selectedPosition;if(hd(t)){if(!n||-1===n.idx)return void o.selectCell(e,!1);o.selectUpdate(e,!0)}else{var r=o.props.columns,i=il(e,r),s=dd(e,r,!0,o.props.recordGetterByIndex);o.selectCell(e,i&&s)}o.props.onCellClick(e),o.setState({selectedPosition:e})},o.onCellDoubleClick=function(e,t){var n=o.props.columns,r=ol(e,n),i=dd(e,n,!0,o.props.recordGetterByIndex);o.selectCell(e,r&&i)},o.onCellMouseDown=function(e,t){hd(t)||(o.selectCell(e),o.selectStart(e),window.addEventListener("mouseup",o.onWindowMouseUp))},o.onCellMouseEnter=function(e){o.selectUpdate(e,!1,o.updateViewableArea)},o.onCellMouseMove=function(e){o.selectUpdate(e,!1,o.updateViewableArea)},o.onWindowMouseUp=function(e){window.removeEventListener("mouseup",o.onWindowMouseUp),hd(e)||(o.selectEnd(),o.clearHorizontalScroll())},o.onCellRangeSelectionUpdated=function(e){o.props.onCellRangeSelectionUpdated(e)},o.selectNoneCells=function(){o.interactionMask&&o.interactionMask.selectNone();var e=o.state.selectedPosition;!e||e.idx<0||e.rowIdx<0||o.selectNone()},o.selectNone=function(){o.setState({selectedPosition:{idx:-1,rowIdx:-1,groupRecordIndex:-1}})},o.selectCell=function(e,t){window.sfMetadataContext.eventBus.dispatch(Ea.SELECT_CELL,e,t)},o.selectStart=function(e){window.sfMetadataContext.eventBus.dispatch(Ea.SELECT_START,e)},o.selectUpdate=function(e,t,n){window.sfMetadataContext.eventBus.dispatch(Ea.SELECT_UPDATE,e,t,n)},o.selectEnd=function(){window.sfMetadataContext.eventBus.dispatch(Ea.SELECT_END)},o.onCloseContextMenu=function(){o.setState({isContextMenuShow:!1,menuPosition:null,activeRecords:[]})},o.onDeleteRecords=function(){o.interactionMask&&o.interactionMask.selectNone(),o.props.selectNone(),o.props.onDeleteRecords(o.state.activeRecords)},o.onInsertRecords=function(e){var t=e.insertRecordsNumber,n=o.state.activeRecords[0],r=n&&n._id;r&&o.props.insertRecords({upperRecordId:r,insertRecordsNumber:t})},o.addBlankRecord=function(e){var t=o.state.groupMetrics,n=e>0&&id(e-1,t);o.props.insertRecords({upperRecordId:n&&n.rowId,insertRecordsNumber:1})},o.onDuplicateRecord=function(){o.props.duplicateRecord(o.state.activeRecords[0])},o.onDuplicateRecords=function(){o.props.duplicateRecords(o.state.activeRecords)},o.getNextScrollState=function(e){var t=e.gridHeight,n=e.scrollTop,r=e.rowHeight,i=e.groupMetrics,s=e.pathFoldedGroupMap,a=t||window.innerHeight,l=r||o.getRowHeight(),c=i||o.state.groupMetrics,d=s||o.state.pathFoldedGroupMap,u=o.getGroupVisibleBoundaries(a,n,c,l);return{startRenderIndex:u.startRenderIndex,endRenderIndex:u.endRenderIndex,groupMetrics:c,pathFoldedGroupMap:d}},o.updateScroll=function(e){var t=e.startRenderIndex,n=e.endRenderIndex,r=(0,Po.Z)(e,hu),i=o.getNextScrollState(r);return t&&n&&(i.startRenderIndex=t,i.endRenderIndex=n),o.setState(i),i},o.isParentGroupContainer=function(e,t){var n=e.groupPath,r=e.level,o=e.type,i=t.groupPath,s=t.level;return o===za&&r>s&&n[0]===i[0]},o.getPrevGroupContainers=function(e,t,n){if(!e)return[];var r=e.level,i=e.groupRowIndex,s=e.type;if(0===i||r===n&&s===za)return[];for(var a=[],l=i-1;l>-1;){var c=t[l],d=c.type,u=c.level;if(d===za){if(r===n){a.push(c);break}if(o.isParentGroupContainer(c,e)&&a.unshift(c),u===n)break}l--}return a},o.getVisibleGroupRecords=function(e,t,n){var r=[],i=n[e],s=o.props.groupbys.length,a=o.getPrevGroupContainers(i,n,s);r.push.apply(r,(0,w.Z)(a));for(var l=e,c=[];l<=t;){var d=n[l];d&&d.visible&&(r.push(d),d.type===Ba&&c.push(d)),l++}return r},o.getFoldedGroups=function(){var e=o.props.getLocalPageConfigs();return e&&e[fu]||{}},o.getVisibleIndex=function(){return{rowVisibleStartIdx:o.rowVisibleStart,rowVisibleEndIdx:o.rowVisibleEnd}},o.updateFoldedGroups=function(e){var t=o.props.getLocalPageConfigs();t[fu]=e,o.props.setLocalPageConfigs(t),o.selectNoneCells()},o.collapseAllGroups=function(){var e=o.state.groupMetrics.groupRows,t={};e.forEach((function(e){var n=e.type,r=e.groupPathString;n===za&&(t[r]=!0)})),o.updateFoldedGroups(t);var n=o.props,r=n.groups,i=n.groupbys,s=n.allColumns,a=o.getRowHeight(),l=o.resultContentRef.scrollTop,c=ed(r,i,t,s,a,!1);o.updateScroll({scrollTop:l,rowHeight:a,groupMetrics:c})},o.expandAllGroups=function(){var e={};o.updateFoldedGroups(e);var t=o.props,n=t.groups,r=t.groupbys,i=t.allColumns,s=o.resultContentRef.scrollTop,a=o.getRowHeight(),l=ed(n,r,e,i,a,!1);o.updateScroll({scrollTop:s,rowHeight:a,groupMetrics:l})},o.onExpandGroupToggle=function(e){var t=o.state,n=t.groupMetrics,r=t.pathFoldedGroupMap,i=n.groupRows,s=n.maxLevel,a=i.find((function(t){return t.groupPathString===e&&t.type===za}));if(a){var l=a.groupRowIndex,c=a.groupPath,d=a.height,u=a.isExpanded,p=(0,sr.Z)({},r);u?p[e]=!0:delete p[e];var h=o.props,f=h.groups,m=h.groupbys,g=h.allColumns,v=o.resultContentRef.scrollTop,y=o.getRowHeight(),x=ed(f,m,p,g,y,!1);if(a.count>=50)return o.forbidRecordsAnimation(),o.updateFoldedGroups(p),void o.updateScroll({scrollTop:v,rowHeight:y,groupMetrics:x,pathFoldedGroupMap:p});var w,b=o.getGroupVisibleBoundaries(window.innerHeight,v,x,y),S=b.startRenderIndex,C=b.endRenderIndex;if(u){var D=(w=n).groupRows;if(s>1)for(var k=-(d-La),j=l-1;j>-1;j--){var I=D[j],M=I.groupPath;if(o.isParentGroupContainer(I,a)&&(I.height=I.height+k),M[0]!==c[0])break}for(var _=l+1;_<D.length;_++){var N=D[_],R=N.groupPath;if(od(N,a)&&(N.visible=!1),R[0]!==c[0])break}D[l]=(0,sr.Z)((0,sr.Z)({},D[l]),{},{isExpanded:!1,height:La})}else for(var T=(w=x).groupRows,O=a.top+La,E=l+1;E<T.length;E++){var P=T[E],Z=P.groupPath;if(od(P,a)&&(P.height=0,P.top=O),Z[0]!==c[0])break}o.expandingGroupPathString=e,o.nextPathFoldedGroupMap=p,o.setState({groupMetrics:w,startRenderIndex:S,endRenderIndex:C}),o.updateFoldedGroups(p)}},o.forbidRecordsAnimation=function(){o.disabledAnimation=!0;var e=o.groupRows.className,t=zl(e,"animation");t!==e&&(o.groupRows.className=t)},o.ableRecordsAnimation=function(){o.disabledAnimation=!1;var e=o.groupRows.className,t=Ul(e,"animation");t!==e&&(o.groupRows.className=t)},o.openDownloadFilesDialog=function(){var e=o.state,t=e.column,n=e.activeRecords;o.props.cacheDownloadFilesProps(t,n),o.props.openDownloadFilesDialog()},o.checkSupportDownloadFiles=function(){var e=o.state.column,t=o.interactionMask.getSelectedPosition(),n=t.left;return!(t.right>n)&&(e.type===Uo.FILE||e.type===Uo.IMAGE)},o.renderGroups=function(){var e=o.props,t=e.totalWidth,n=e.containerWidth,r=e.appPage,i=e.columns,s=e.colOverScanStartIdx,a=e.colOverScanEndIdx,l=e.groupOffsetLeft,c=e.recordMetrics,d=e.summaryConfigs,u=e.lastFrozenColumnKey,p=e.showCellColoring,h=e.columnColors;o.recordFrozenRefs=[],o.frozenBtnAddRecordRefs=[];var f=t+Za,g=o.state,v=g.startRenderIndex,y=g.endRenderIndex,x=g.groupMetrics,w=g.selectedPosition,b=x.groupRows,S=x.maxLevel,C=o.props.getScrollLeft(),D=o.getCellMetaData(),k=o.getVisibleGroupRecords(v,y,b),j=[],I=i.length,M=i[I-1],_=x.groupRowsHeight;k.forEach((function(e){var t=e.type,n=e.level,g=e.key,v=e.left,y=e.top,x=e.isExpanded,b=e.height,k=e.groupPathString,I=e.groupRowIndex;if(t===za){var M=f+2*(n-1)*Fa,_=o.expandingGroupPathString===k&&!x,N=b+Fa;j.push((0,m.jsx)(pu,{ref:o.setGroupNode(k),groupPathString:k,group:e,height:b,backdropHeight:N,width:M,top:y,maxLevel:S,groupOffsetLeft:l,scrollLeft:C,columns:i,summaryConfigs:d,isExpanded:x,folding:_,lastFrozenColumnKey:u,getTableContentRect:o.props.getTableContentRect,onExpandGroupToggle:o.onExpandGroupToggle},g))}else if(t===Ba){var R=e.rowId,T=e.rowIdx,O=e.isLastRow,E=R&&o.props.recordGetterById(R),P=kd.isRecordSelected(R,c),Z=o.props.hasSelectedCell({groupRecordIndex:I},w),F=p?h[R]:{};if(!E)return;j.push((0,m.jsx)(Qc,{isGroupView:!0,ref:function(e){o.recordFrozenRefs.push(e)},isSelected:P,groupRecordIndex:I,index:T,isLastRecord:O,lastFrozenColumnKey:u,record:E,columns:i,colOverScanStartIdx:s,colOverScanEndIdx:a,left:v,top:y,height:b,scrollLeft:C,cellMetaData:D,searchResult:o.props.searchResult,hasSelectedCell:Z,selectedPosition:o.state.selectedPosition,selectNoneCells:o.selectNoneCells,onSelectRecord:o.props.onSelectRecord,onRowExpand:o.onRowExpand,modifyRecord:o.props.modifyRecord,lockRecordViaButton:o.props.lockRecordViaButton,modifyRecordViaButton:o.props.modifyRecordViaButton,reloadRecords:o.props.reloadRecords,appPage:r,columnColor:F},R||T))}}));var N=u===M.key,R=Br()("canvas-groups-rows","animation",{"single-column":nl(M),"disabled-add-record":!0,"all-columns-frozen":N,frozen:N||!!u}),T={height:_,width:n+(2*(S-1)+1)*Fa};return(0,m.jsx)("div",{className:R,style:T,ref:function(e){return o.groupRows=e},children:j})};var i=e.groups,s=e.groupbys,a=e.allColumns,l=o.getRowHeight(),c=o.getFoldedGroups(),d=ed(i,s,c,a,l,!1),u=o.getGroupVisibleBoundaries(window.innerHeight,0,d,l),p=u.startRenderIndex,h=u.endRenderIndex;return o.state={isContextMenuShow:!1,activeRecords:[],menuPosition:null,groupMetrics:d,startRenderIndex:p,endRenderIndex:h,pathFoldedGroupMap:c,isScrollingRightScrollbar:!1,selectedPosition:null},o.groupsNode={},o.recordFrozenRefs=[],o.frozenBtnAddRecordRefs=[],o.rowVisibleStart=p,o.rowVisibleEnd=h,o.columnVisibleStart=0,o.columnVisibleEnd=o.setColumnVisibleEnd(),o.disabledAnimation=!1,o.nextPathFoldedGroupMap=null,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){window.sfMetadataBody=this,window.addEventListener("resize",this.onResize),this.props.onRef(this),this.unSubscribeCollapseAllGroups=window.sfMetadataContext.eventBus.subscribe(Ea.COLLAPSE_ALL_GROUPS,this.collapseAllGroups),this.unSubscribeExpandAllGroups=window.sfMetadataContext.eventBus.subscribe(Ea.EXPAND_ALL_GROUPS,this.expandAllGroups)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.groupbys,r=t.groups,o=t.allColumns,i=t.searchResult,s=this.resultContentRef.scrollTop,a=this.getRowHeight();if(n!==e.groupbys||r!==e.groups||i!==e.searchResult){var l=window.innerHeight,c=(i||{}).matchedCells,d=Array.isArray(c)&&c.length>0?{}:this.getFoldedGroups(),u=ed(r,n,d,o,a,!1);this.updateScroll({gridHeight:l,scrollTop:s,groupMetrics:u,rowHeight:a})}if(this.disabledAnimation&&this.ableRecordsAnimation(),this.expandingGroupPathString){var p=ed(r,n,this.nextPathFoldedGroupMap,o,a,!1);this.updateScroll({scrollTop:s,groupMetrics:p,pathFoldedGroupMap:this.nextPathFoldedGroupMap}),this.expandingGroupPathString=null,this.nextPathFoldedGroupMap=null}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),this.unSubscribeCollapseAllGroups(),this.unSubscribeExpandAllGroups(),this.clearHorizontalScroll(),this.clearScrollbarTimer(),this.setState=function(e,t){}}},{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{id:"group-canvas",className:"sf-metadata-result-table-content",ref:this.setResultContentRef,onScroll:this.onScroll,children:[(0,m.jsx)(Ud,{isGroupView:!0,ref:this.setInteractionMaskRef,table:this.props.table,columns:this.props.columns,recordsCount:this.props.recordsCount,recordMetrics:this.props.recordMetrics,groups:this.props.groups,groupMetrics:this.state.groupMetrics,rowHeight:this.getRowHeight(),groupOffsetLeft:this.props.groupOffsetLeft,scrollTop:this.oldScrollTop,getRowTop:this.getRowTop,getScrollLeft:this.props.getScrollLeft,getTableContentRect:this.props.getTableContentRect,getMobileFloatIconStyle:this.props.getMobileFloatIconStyle,onToggleMobileMoreOperations:this.props.onToggleMobileMoreOperations,onToggleInsertRecordDialog:this.props.onToggleInsertRecordDialog,editorPortalTarget:this.props.editorPortalTarget,onCellRangeSelectionUpdated:this.onCellRangeSelectionUpdated,modifyRecord:this.props.modifyRecord,recordGetterByIndex:this.props.recordGetterByIndex,recordGetterById:this.props.recordGetterById,updateRecords:this.props.updateRecords,deleteRecordsLinks:this.props.deleteRecordsLinks,paste:this.props.paste,editMobileCell:this.props.editMobileCell,frozenColumnsWidth:this.props.frozenColumnsWidth,selectNone:this.selectNone,onCellClick:this.onCellClick,getVisibleIndex:this.getVisibleIndex,getGroupCanvasScrollTop:this.getScrollTop,setGroupCanvasScrollTop:this.setScrollTop,scrollToColumn:this.scrollToColumn,setRecordsScrollLeft:this.props.setRecordsScrollLeft,gridUtils:this.props.gridUtils,getCopiedRecordsAndColumnsFromRange:this.props.getCopiedRecordsAndColumnsFromRange}),(0,m.jsx)("div",{className:"sf-metadata-result-table",ref:this.setResultRef,children:this.renderGroups()})]}),(0,m.jsx)(Gc,{table:this.props.table,ref:this.setRightScrollbar,onScrollbarScroll:this.onScrollbarScroll,onScrollbarMouseUp:this.onScrollbarMouseUp})]})}}]),n}(a.Component);vu.defaultProps={editorPortalTarget:document.body,scrollToRowIndex:0};var yu=vu,xu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onClick=function(){W.Z.closeAll(),e.props.load(1e5)},e}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)("div",{className:"load-all-tip",children:[(0,m.jsx)("span",{children:(0,h.ih)("Loaded 50,000 records.")}),(0,m.jsx)("div",{className:"load-all ml-2",onClick:this.onClick,children:(0,h.ih)("Click to load more")})]})}}]),n}(a.Component),wu=xu,bu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onClick=function(){if(!e.props.isLoadingMore){var t=e.props.recordsCount<5e4?5e4:1e5;e.props.loadAll(t,(function(t){t?W.Z.success((0,m.jsx)(wu,{load:e.props.loadAll}),{duration:5}):W.Z.success((0,h.ih)("All records loaded"))}))}},e.setSummaryScrollLeft=function(t){e.summaryItemsRef.scrollLeft=t},e.getSelectedCellsCount=function(e){var t=e.topLeft,n=e.bottomRight;return-1===t.rowIdx?0:(n.idx-t.idx+1)*(n.rowIdx-t.rowIdx+1)},e.getSummaries=function(){var t=e.props,n=t.isGroupView,r=t.hasSelectedRecord,o=t.recordMetrics,i=t.selectedRange,s=t.summaries,a=t.recordGetterByIndex;if(r){var l=kd.getSelectedIds(o),c=l&&l.map((function(t){return e.props.recordGetterById(t)})).filter(Boolean);return e.props.getRecordsSummaries(c)}if(e.getSelectedCellsCount(i)>1){var d=pd({selectedRange:i,isGroupView:n,recordGetterByIndex:a});return e.props.getRecordsSummaries(d)}return s},e.getSummaryItems=function(){var t=e.props,n=t.columns,r=t.hasMore,o=t.isLoadingMore||r?n.slice(1,n.length):n,i=Za,s=Array.isArray(o)&&o.map((function(e,t){var n=e.width,r=e.key;return i+=n,(0,m.jsx)("div",{className:"summary-item",style:{width:n}},r)}));return{summaryItems:s,totalWidth:i}},e.getRecord=function(){var t=e.props,n=t.hasMore,r=t.hasSelectedRecord,o=t.recordMetrics,i=t.selectedRange,s=t.recordsCount;if(r){var a=kd.getSelectedIds(o).length;return a>1?(0,h.ih)("xxx_records_selected").replace("xxx",a):(0,h.ih)("1 record selected")}var l=e.getSelectedCellsCount(i);if(l>1)return(0,h.ih)("xxx cells selected").replace("xxx",l);var c=(0,h.ih)("No record");return s>1?c=(0,h.ih)("xxx records").replace("xxx",s):1===s&&(c=(0,h.ih)("1 record")),n&&(c+=" +"),c},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.hasMore,r=t.isLoadingMore,o=t.columns,i=t.groupOffsetLeft,s=this.getSummaryItems(),a=s.summaryItems,l=s.totalWidth,c=(r||n?Za+o[0].width:Za)+i;return(0,m.jsxs)("div",{className:"sf-metadata-result-footer",style:{zIndex:4,transform:"translateZ(1000px)"},children:[(0,m.jsxs)("div",{className:"rows-record d-flex text-nowrap",style:{width:c},children:[(0,m.jsx)("span",{children:this.getRecord()}),!r&&n&&(0,m.jsx)("span",{className:"load-all ml-4",onClick:this.onClick,children:(0,h.ih)("Load all")}),r&&(0,m.jsxs)("span",{className:"loading-message ml-4",children:[(0,m.jsx)("span",{className:"mr-2",children:(0,h.ih)("Loading")}),(0,m.jsx)(Bl.gb,{})]})]}),(0,m.jsx)("div",{className:"summaries-pane",children:(0,m.jsx)("div",{className:"summaries-scroll",ref:function(t){return e.summaryItemsRef=t},children:(0,m.jsx)("div",{style:{width:l+240},children:a||""})})})]})}}]),n}(a.Component),Su=bu,Cu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).createColumnMetrics=function(e){var t=e.columns,n=e.table;return sl(t,[],n._id)},o.createRowMetrics=function(){arguments.length>0&&void 0!==arguments[0]||o.props;return{idSelectedRecordMap:{}}},o.setScrollLeft=function(e){o.resultContainerRef.scrollLeft=e},o.resizeColumnWidth=function(e,t){if(!(t<50)){var n=o.props.columns,r=Object.assign({},e,{width:t}),i=n.findIndex((function(t){return t.key===e.key})),s=n.slice(0);s[i]=r,s=function(e){var t=[],n=0;return e.forEach((function(e){t.push((0,sr.Z)((0,sr.Z)({},e),{},{left:n})),n+=e.width})),t}(s);var a=sl(s,n);o.setState({columnMetrics:a},(function(){var n=window.sfMetadataContext.localStorage.getItem("columns_width")||{};window.sfMetadataContext.localStorage.setItem("columns_width",(0,sr.Z)((0,sr.Z)({},n),{},(0,Fr.default)({},e.key,t)))}))}},o.getScrollPosition=function(){var e=window.sfMetadataContext.localStorage.getItem("scroll_left")+"",t=window.sfMetadataContext.localStorage.getItem("scroll_top")+"";e&&t&&o.bodyRef&&(e=Number(e),t=Number(t),o.bodyRef.setScrollTop(t),o.setScrollLeft(e),o.handleHorizontalScroll(e,t))},o.storeScrollPosition=function(){var e=o.bodyRef.getScrollTop(),t=o.getScrollLeft();window.sfMetadataContext.localStorage.setItem("scroll_left",t),o.storeScrollTop(e)},o.storeScrollTop=function(e){window.sfMetadataContext.localStorage.setItem("scroll_top",e)},o.onContentScroll=function(e){var t=e.target.scrollLeft,n=o.bodyRef.getScrollTop(),r=o.scrollLeft-t,i=o.scrollTop-n;o.scrollLeft=t,0!==i&&(o.scrollTop=n),0!==i||0===r&&0!==t||o.handleHorizontalScroll(t,n),o.storeScrollPosition(),window.sfMetadataContext.eventBus.dispatch(Ea.CLOSE_EDITOR)},o.handleHorizontalScroll=function(e,t){var n=o.props.getTableContentRect().width;if(Al)o.updateHorizontalScrollState({scrollLeft:e,columnMetrics:o.state.columnMetrics,gridWidth:n});else{var r,i=o.resultContainerRef?o.resultContainerRef.className:"";(r=e>0?Ul(i,"horizontal-scroll"):zl(i,"horizontal-scroll"))!==i&&o.resultContainerRef&&(o.resultContainerRef.className=r),o.lastScrollLeft=e,o.handleFrozenDOMsPosition(e,t),o.recordsFooterRef.setSummaryScrollLeft(e),o.isScrollByScrollbar||o.handleScrollbarScroll(e),o.bodyRef&&o.bodyRef.interactionMask&&o.bodyRef.setScrollLeft(e),o.updateHorizontalScrollState({scrollLeft:e,columnMetrics:o.state.columnMetrics,gridWidth:n})}},o.handleFrozenDOMsPosition=function(e,t){var n=o.state.columnMetrics.lastFrozenColumnKey;o.props.isGroupView&&!n||(o.clearSetAbsoluteTimer(),o.setFixed(e,t),o.timer=setTimeout((function(){o.setAbsolute(e,t)}),100))},o.handleScrollbarScroll=function(e){o.horizontalScrollbar&&(o.isScrollByScrollbar?o.isScrollByScrollbar=!1:o.setHorizontalScrollbarScrollLeft(e))},o.onHorizontalScrollbarScroll=function(e){o.isScrollByScrollbar=!0,o.setScrollLeft(e)},o.onHorizontalScrollbarMouseUp=function(){o.isScrollByScrollbar=!1},o.setHorizontalScrollbarScrollLeft=function(e){o.horizontalScrollbar&&o.horizontalScrollbar.setScrollLeft(e)},o.setFixed=function(e,t){o.bodyRef.recordFrozenRefs.forEach((function(e){e&&(e.frozenColumns.style.position="fixed",e.frozenColumns.style.marginLeft="0px",e.frozenColumns.style.marginTop="-"+t+"px")})),o.bodyRef.frozenBtnAddRecordRefs.forEach((function(e){e&&(e.frozenColumns.style.position="fixed",e.frozenColumns.style.marginLeft="0px",e.frozenColumns.style.marginTop="-"+t+"px")})),o.bodyRef.fixFrozenDoms&&o.bodyRef.fixFrozenDoms(e,t)},o.setAbsolute=function(e){var t=o.props.isGroupView,n=o.state.columnMetrics.lastFrozenColumnKey;t&&!n||(o.bodyRef.recordFrozenRefs.forEach((function(t){t&&(t.frozenColumns.style.position="absolute",t.frozenColumns.style.marginLeft=e+"px",t.frozenColumns.style.marginTop="0px")})),o.bodyRef.frozenBtnAddRecordRefs.forEach((function(t){t&&(t.frozenColumns.style.position="absolute",t.frozenColumns.style.marginLeft=e+"px",t.frozenColumns.style.marginTop="0px")})),o.bodyRef.cancelFixFrozenDOMs&&o.bodyRef.cancelFixFrozenDOMs(e),o.bodyRef&&o.bodyRef.interactionMask&&o.bodyRef.cancelSetScrollLeft())},o.clearSetAbsoluteTimer=function(){o.timer&&(clearTimeout(o.timer),o.timer=null)},o.getScrollLeft=function(){return Al?0:o.scrollLeft||0},o.getScrollTop=function(){return Al?0:o.scrollTop||0},o.setHorizontalScrollbarRef=function(e){o.horizontalScrollbar=e},o.setResultContainerRef=function(e){o.resultContainerRef=e},o.updateSelectedRange=function(e){o.setState({selectedRange:e})},o.onClickContainer=function(e){var t=Ll(e);(t.includes("sf-metadata-result-content")||t.includes("sf-metadata-result-table-content"))&&window.sfMetadataContext.eventBus.dispatch(Ea.CLOSE_EDITOR)},o.onCellClick=function(e){if(e){var t=(0,sr.Z)({},e);o.updateSelectedRange({topLeft:t,bottomRight:t})}o.onDeselectAllRecords()},o.onCellRangeSelectionUpdated=function(e){o.onCellClick(),o.updateSelectedRange(e)},o.onCopyCells=function(e){window.sfMetadataContext.eventBus.dispatch(Ea.COPY_CELLS,e)},o.onPasteCells=function(e){window.sfMetadataContext.eventBus.dispatch(Ea.PASTE_CELLS,e)},o.onTouchStart=function(e){if(e.target&&["canvas","group-canvas"].includes(e.target.id)){var t={startX:e.changedTouches[0].clientX,startY:e.changedTouches[0].clientY};o.setState({touchStartPosition:t})}},o.onTouchEnd=function(e){if(e.target&&["canvas","group-canvas"].includes(e.target.id)){var t=e.changedTouches[0],n=t.clientX,r=t.clientY,i=o.state.touchStartPosition;Math.abs(i.startX-n)<5&&Math.abs(i.startY-r)<5&&window.sfMetadataContext.eventBus.dispatch(Ea.SELECT_NONE)}},o.onMouseDown=function(e){var t=Ll(e);if(!(t.indexOf("sf-metadata-result-table-cell")>-1)){(["canvas","group-canvas"].includes(e.target.id)||t.includes("sf-metadata-result-content"))&&window.sfMetadataContext.eventBus.dispatch(Ea.SELECT_NONE)}},o.selectNone=function(){o.setState({selectedRange:{topLeft:o.initPosition,bottomRight:o.initPosition}}),o.onDeselectAllRecords()},o.onSelectRecord=function(e,t){var n=e.groupRecordIndex,r=e.recordIndex;if(t.stopPropagation(),hd(t))o.selectRecordWithShift({groupRecordIndex:n,recordIndex:r});else{var i=o.props.isGroupView,s=o.state.recordMetrics,a=o.props.recordGetterByIndex({isGroupView:i,groupRecordIndex:n,recordIndex:r});if(a){var l=a._id;if(kd.isRecordSelected(l,s))return o.deselectRecord(l),void o.setState({lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1}});o.selectRecord(l),o.setState({lastRowIdxUiSelected:{groupRecordIndex:n,recordIndex:r}})}}},o.selectRecordWithShift=function(e){var t=e.groupRecordIndex,n=e.recordIndex,r=o.props,i=r.recordIds,s=r.isGroupView,a=o.state,l=a.lastRowIdxUiSelected,c=a.recordMetrics,d=[];if(s){if(!window.sfMetadataBody||!window.sfMetadataBody.getGroupMetrics)return;for(var u=window.sfMetadataBody.getGroupMetrics().groupRows,p=[t,l.groupRecordIndex].sort((function(e,t){return e-t})),h=p[0];h<=p[1];h++){var f=u[h];f.type===Ba&&d.push(f.rowId)}}else{var m=i[n];if(!m)return;var g=l.recordIndex;if(g<0)return o.selectRecord(m),void o.setState({lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:n}});if(n===g||kd.isRecordSelected(m,c))return o.deselectRecord(m),void o.setState({lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1}});d=o.getRecordIdsBetweenRange({start:g,end:n})}0!==d.length&&(o.selectRecordsById(d),o.setState({lastRowIdxUiSelected:{groupRecordIndex:t,recordIndex:n}}))},o.getRecordIdsBetweenRange=function(e){for(var t=e.start,n=e.end,r=o.props.recordIds,i=Math.min(t,n),s=Math.max(t,n),a=[],l=i;l<=s;l++){var c=r[l];c&&a.push(c)}return a},o.selectRecord=function(e){var t=o.state.recordMetrics;if(!kd.isRecordSelected(e,t)){var n=(0,sr.Z)({},t);kd.selectRecord(e,n),o.setState({recordMetrics:n})}},o.selectRecordsById=function(e){var t=o.state.recordMetrics;if(0!==e.filter((function(e){return!kd.isRecordSelected(e,t)})).length){var n=(0,sr.Z)({},t);kd.selectRecordsById(e,n),o.setState({recordMetrics:n})}},o.deselectRecord=function(e){var t=o.state.recordMetrics;if(kd.isRecordSelected(e,t)){var n=(0,sr.Z)({},t);kd.deselectRecord(e,n),o.setState({recordMetrics:n})}},o.selectAllRecords=function(){var e=o.props,t=e.recordIds,n=e.isGroupView,r=o.state.recordMetrics,i=(0,sr.Z)({},r),s=[];if(n){if(!window.sfMetadataBody||!window.sfMetadataBody.getGroupMetrics)return;window.sfMetadataBody.getGroupMetrics().groupRows.forEach((function(e){e.type===Ba&&s.push(e.rowId)}))}else s=t;kd.selectRecordsById(s,i),o.setState({recordMetrics:i})},o.onDeselectAllRecords=function(){var e=o.state.recordMetrics;if(kd.hasSelectedRecords(e)){var t=(0,sr.Z)({},e);kd.deselectAllRecords(t),o.setState({recordMetrics:t,lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1}})}},o.hasSelectedCell=function(e,t){var n=e.groupRecordIndex,r=e.recordIndex;if(!t)return!1;var i=o.props.isGroupView,s=t.groupRecordIndex,a=t.rowIdx;return i?n===s:r===a},o.hasSelectedRecord=function(){var e=o.state.recordMetrics;if(!kd.hasSelectedRecords(e))return!1;var t=kd.getSelectedIds(e),n=t&&t.map((function(e){return o.props.recordGetterById(e)})).filter(Boolean);return n&&n.length>0},o.getHorizontalScrollState=function(e){var t=e.gridWidth,n=e.columnMetrics,r=e.scrollLeft,o=n.columns,i=o.length,s=function(e,t,n){var r=function(e,t){for(var n=t,r=e.slice(0),o=0;o<r.length;o++)if((n-=e[o].width)<0)return o}(e,t),o=function(e,t,n){for(var r=t+n,o=0;o<e.length;o++)if((r-=e[o].width)<0)return o-1;return e.length-1}(e,n,t);return{colVisibleStartIdx:r,colVisibleEndIdx:o}}(o,r,t),a=s.colVisibleStartIdx,l=s.colVisibleEndIdx,c=function(e){return Math.max(0,10*Math.floor(e/10)-10)}(a),d=function(e,t){return Math.min(10*Math.ceil(e/10)+10,t)}(l,i);return{colOverScanStartIdx:c,colOverScanEndIdx:d}},o.updateHorizontalScrollState=function(e){var t=e.columnMetrics,n=e.gridWidth,r=e.scrollLeft,i=o.getHorizontalScrollState({columnMetrics:t,gridWidth:n,scrollLeft:r});o.setState(i)},o.cacheDownloadFilesProps=function(e,t){},o.downloadColumnAllFiles=function(e){},o.openDownloadFilesDialog=function(){},o.closeDownloadFilesDialog=function(){},o.renderRecordsBody=function(e){e.containerWidth;var t=o.state,n=t.recordMetrics,r=t.columnMetrics,i=t.colOverScanStartIdx,s=t.colOverScanEndIdx,a=r.columns,l=r.allColumns,c=r.totalWidth,d=r.lastFrozenColumnKey,u=r.frozenColumnsWidth,p=(0,sr.Z)((0,sr.Z)({},o.props),{},{columns:a,allColumns:l,totalWidth:c,lastFrozenColumnKey:d,frozenColumnsWidth:u,recordMetrics:n,colOverScanStartIdx:i,colOverScanEndIdx:s,hasSelectedRecord:o.hasSelectedRecord(),getScrollLeft:o.getScrollLeft,getScrollTop:o.getScrollTop,selectNone:o.selectNone,onCellClick:o.onCellClick,onCellRangeSelectionUpdated:o.onCellRangeSelectionUpdated,onSelectRecord:o.onSelectRecord,setRecordsScrollLeft:o.setScrollLeft,hasSelectedCell:o.hasSelectedCell,cacheScrollTop:o.storeScrollTop});return o.props.isGroupView?(0,m.jsx)(yu,(0,sr.Z)((0,sr.Z)({onRef:function(e){o.bodyRef=e}},p),{},{groups:o.props.groups,groupbys:o.props.groupbys,groupOffsetLeft:o.props.groupOffsetLeft})):(0,m.jsx)(Jd,(0,sr.Z)((0,sr.Z)({onRef:function(e){o.bodyRef=e}},p),{},{recordIds:o.props.recordIds}))},o.scrollTop=0,o.isScrollByScrollbar=!1;var i=window.sfMetadataContext.localStorage.getItem("scroll_left");o.scrollLeft=i?Number(i):0,o.lastScrollLeft=o.scrollLeft,o.initPosition={idx:-1,rowIdx:-1,groupRecordIndex:-1};var s=o.createColumnMetrics(e),a=e.getTableContentRect().width,l=o.getHorizontalScrollState({gridWidth:a,columnMetrics:s,scrollLeft:0});return o.state=(0,sr.Z)({columnMetrics:s,recordMetrics:o.createRowMetrics(),lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1},touchStartPosition:{},selectedRange:{topLeft:o.initPosition,bottomRight:o.initPosition}},l),o.isWindows=/windows|win32/i.test(navigator.userAgent),o.isWebkit=navigator.userAgent.toLowerCase().includes("webkit"),o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){document.addEventListener("copy",this.onCopyCells),document.addEventListener("paste",this.onPasteCells),window.isMobile?(window.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchend",this.onTouchEnd)):document.addEventListener("mousedown",this.onMouseDown),this.unsubscribeSelectNone=window.sfMetadataContext.eventBus.subscribe(Ea.SELECT_NONE,this.selectNone),this.getScrollPosition()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t,n=e.columns,r=(0,e.getTableContentRect)().width;if(this.props.columns!==n){var o=this.createColumnMetrics(e);this.updateHorizontalScrollState({columnMetrics:o,scrollLeft:this.lastScrollLeft,gridWidth:r}),this.setState({columnMetrics:o})}else(null===(t=this.props.getTableContentRect())||void 0===t?void 0:t.width)!==r&&this.updateHorizontalScrollState({columnMetrics:this.state.columnMetrics,scrollLeft:this.lastScrollLeft,gridWidth:r})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("copy",this.onCopyCells),document.removeEventListener("paste",this.onPasteCells),window.isMobile?(window.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchend",this.onTouchEnd)):document.removeEventListener("mousedown",this.onMouseDown),this.clearSetAbsoluteTimer(),this.setState=function(e,t){}}},{key:"render",value:function(){var e=this,t=this.props,n=t.recordIds,r=t.recordsCount,o=t.table,i=t.isGroupView,s=t.groupOffsetLeft,l=this.state,c=l.recordMetrics,d=l.columnMetrics,u=l.selectedRange,p=l.colOverScanStartIdx,h=l.colOverScanEndIdx,f=d.columns,g=d.totalWidth,v=d.lastFrozenColumnKey,y=g+Za+240,x=this.hasSelectedRecord(),w=kd.isSelectedAll(n,c);return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("div",{className:"sf-metadata-result-container ".concat(this.isWindows?"windows-browser":""),ref:this.setResultContainerRef,onScroll:this.onContentScroll,onClick:this.onClickContainer,children:(0,m.jsxs)("div",{className:"sf-metadata-result-content",style:{width:y},children:[(0,m.jsx)(zc,{onRef:function(t){e.headerFrozenRef=t},containerWidth:y,table:o,columns:f,colOverScanStartIdx:p,colOverScanEndIdx:h,hasSelectedRecord:x,isSelectedAll:w,isGroupView:i,groupOffsetLeft:s,lastFrozenColumnKey:v,resizeColumnWidth:this.resizeColumnWidth,selectNoneRecords:this.selectNone,selectAllRecords:this.selectAllRecords,downloadColumnAllFiles:this.downloadColumnAllFiles}),this.renderRecordsBody({containerWidth:y})]})}),this.isWindows&&this.isWebkit&&(0,m.jsx)(Yc,{ref:this.setHorizontalScrollbarRef,innerWidth:g+240,onScrollbarScroll:this.onHorizontalScrollbarScroll,onScrollbarMouseUp:this.onHorizontalScrollbarMouseUp}),(0,m.jsx)(Su,{ref:function(t){return e.recordsFooterRef=t},recordsCount:r,hasMore:this.props.hasMore,columns:f,groupOffsetLeft:s,recordMetrics:c,selectedRange:u,isGroupView:i,hasSelectedRecord:x,isLoadingMore:this.props.isLoadingMore,recordGetterById:this.props.recordGetterById,recordGetterByIndex:this.props.recordGetterByIndex,getRecordsSummaries:function(){},loadAll:this.props.loadAll})]})}}]),n}(a.Component),Du=Cu,ku=function(e){return e.value},ju=function(){function e(t,n){(0,r.Z)(this,e),this.metadata=t,this.api=n}return(0,o.Z)(e,[{key:"getCopiedContent",value:function(e){var t=this,n=e.type,r=e.copied,o=e.isGroupView;if(n===Pa.DTABLE_FRAGMENT){var i=this.tablePage.state.shownColumns,s=r.selectedRecordIds,a=r.copiedRange;if(Array.isArray(s)&&s.length>0)return{copiedRecords:s.map((function(e){return t.tablePage.recordGetterById(e)})),copiedColumns:(0,w.Z)(i)};for(var l=[],c=[],d=a.topLeft,u=a.bottomRight,p=d.rowIdx,h=d.idx,f=d.groupRecordIndex,m=u.rowIdx,g=u.idx,v=f,y=p;y<=m;y++)l.push(this.tablePage.recordGetterByIndex({isGroupView:o,groupRecordIndex:v,recordIndex:y})),o&&v++;for(var x=h;x<=g;x++)c.push(tl(x,i));return{copiedRecords:l,copiedColumns:c}}return{copiedRecords:r.copiedRecords,copiedColumns:r.copiedColumns}}},{key:"paste",value:function(){var e=(0,Vt.Z)((0,Yt.Z)().mark((function e(t){var n,r,o,i,s,a,l,c,d,u,p,h,f,m,g,v,y,x,w,b,S,C,D,k,j,I,M,_,N,R,T,O,E,P,Z,F,L,A,U,z,B,G,H,Y;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.copied,r=t.multiplePaste,o=t.pasteRange,i=t.isGroupView,s=this.metadata,a=s.row_ids,l=s.columns,c=o.topLeft,d=o.bottomRight,u=void 0===d?{}:d,p=c.rowIdx,h=c.idx,f=c.groupRecordIndex,m=u.rowIdx,g=u.idx,v=n.copiedRecords,y=n.copiedColumns,x=v.length,w=y.length,b=r?m-p+1:x,S=r?g-h+1:w,C=a.length,!(x>C-p)){e.next=14;break}return e.abrupt("return");case 14:D=[],k={},j={},I={},M={},_=f,N=0;case 21:if(!(N<b)){e.next=54;break}if(R=this.tablePage.recordGetterByIndex({isGroupView:i,groupRecordIndex:_,recordIndex:p+N}),i&&_++,R){e.next=26;break}return e.abrupt("continue",51);case 26:T=R._id,O=v[N%x],E={},P={},Z=0;case 32:if(!(Z<S)){e.next=50;break}if((F=tl(Z+h,l))&&!Qo[F.type]){e.next=36;break}return e.abrupt("continue",47);case 36:if(L=tl(Z%w,y),A=F.key,U=L.key,z=Object.prototype.hasOwnProperty.call(R,A)?R[A]:null,B=Object.prototype.hasOwnProperty.call(O,U)?O[U]:null,(G=this.convertCellValue(B,z,F,L))!==z){e.next=45;break}return e.abrupt("continue",47);case 45:E[A]=G,P[A]=z;case 47:Z++,e.next=32;break;case 50:Object.keys(E).length>0&&(D.push(T),H=E,Y=P,k[T]=H,j[T]=E,I[T]=Y,M[T]=P);case 51:N++,e.next=21;break;case 54:if(0!==D.length){e.next=56;break}return e.abrupt("return");case 56:this.modifyRecords(D,k,j,I,M,true);case 57:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLinkedRowsIdsByNameColumn",value:function(e,t,n,r){if(!Array.isArray(e)||0===e.length)return[];var o=String(n),i=e.find((function(e){var t;return(null===(t=e["0000"])||void 0===t?void 0:t.trim())===o.trim()}))||null;if(i)return r[t]=[{display_value:o,row_id:i._id}],[i._id];var s=[];if(o.includes(",")||o.includes("\uff0c")){var a=o.split(/[,\uff0c]/).map((function(e){return e.trim()})).filter((function(e,t,n){return n.indexOf(e)===t}));if(!Array.isArray(a)||0===a.length)return[];r[t]=[],a.forEach((function(n){var o=e.find((function(e){var t;return(null===(t=e["0000"])||void 0===t?void 0:t.trim())===n}))||null;o&&(r[t].push({display_value:n,row_id:o._id}),s.push(o._id))}))}return s}},{key:"getUpdateDraggedRecords",value:function(e,t,n,r,o){for(var i=[],s={},a={},l={},c={},d=e.overRecordIdx,u=e.topLeft,p=e.bottomRight,h=u.idx,f=p.idx,m=p.rowIdx,g=p.groupRecordIndex,v=this.getdraggedRangeMatrix(t,e,n,o,r),y=this.getDraggedRangeRules(v,t,h),x=v[0].length,w=v[0].length,b=g+1,S=m+1;S<=d;S++){var C=void 0;if(b)C=r[id(b,o).rowId];else C=n[S];var D=C,k=D._id;if(w++,!D._locked){i.push(k);for(var j=(S-m-1)%x,I=h;I<=f;I++){var M=t[I],_=M.key,N=M.type;if(M.editable&&!Qo[N]&&!Ha.includes(N)){var R=v[I-h][j],T=(0,y[_])({n:w-1,value:R});s[k]=Object.assign({},s[k],(0,Fr.default)({},_,T)),a[k]=Object.assign({},a[k],(0,Fr.default)({},_,C[_]));var O=s[k],E=a[k];l[k]=Object.assign({},l[k],O),c[k]=Object.assign({},c[k],E)}}b++}}return{recordIds:i,idOriginalRecordUpdates:s,idRecordUpdates:l,idOriginalOldRecordData:a,idOldRecordData:c}}},{key:"getdraggedRangeMatrix",value:function(e,t,n,r,o){for(var i=[],s=t.topLeft,a=t.bottomRight,l=s.idx,c=s.rowIdx,d=s.groupRecordIndex,u=a.idx,p=a.rowIdx,h=l;h<=u;h++){var f=d;i[h-l]=[];for(var m=e[h].key,g=c;g<=p;g++){var v=void 0;if(f)v=o[id(f,r).rowId];else v=n[g];i[h-l][g-c]=v[m],f++}}return i}},{key:"getDraggedRangeRules",value:function(e,t,n){var r=this,o={};return e.forEach((function(e,i){var s=t[i+n],a=s.type,l=s.data,c=s.key,d=ku;if(e.length>1)switch(a){case Uo.DATE:var u=l&&l.format&&l.format.indexOf("HH:mm")>-1?"YYYY-MM-DD HH:mm":"YYYY-MM-DD",p=e[0],h=r.getYearTolerance(e);if(h){d=function(e){var t=e.n;return ba()(p).add(t*h,"years").format(u)};break}var f=r.getMonthTolerance(e);if(f){d=function(e){var t=e.n;return ba()(p).add(t*f,"months").format(u)};break}var m=r.getDayTolerance(e);if(m){d=function(e){var t=e.n*m+r.getDateStringValue(p);return ba()(t).format(u)};break}break;case Uo.NUMBER:d=r.getLeastSquares(e);break;case Uo.TEXT:d=r._getTextRule(e);break;case Uo.RATE:d=r.getRatingLeastSquares(e,l);break;default:d=ku}o[c]=d})),o}},{key:"getDateStringValue",value:function(e){var t=ba()(e);return t.isValid()?t.valueOf():0}},{key:"getYearTolerance",value:function(e){var t=ba()(e[0]),n=ba()(e[1]);if(!t.isValid()||!n.isValid())return 0;if(t.month()!==n.month()||t.date()!==n.date()||t.hour()!==n.hour()||t.minute()!==n.minute())return 0;var r=t.year(),o=n.year()-r;return e.every((function(e,t){var n=ba()(e);return!!n.isValid()&&n.year()===t*o+r}))?o:0}},{key:"getMonthTolerance",value:function(e){var t=ba()(e[0]),n=ba()(e[1]);if(!t.isValid()||!n.isValid())return 0;if(t.date()!==n.date()||t.hour()!==n.hour()||t.minute()!==n.minute())return 0;var r=n.month()-t.month()+12*(n.year()-t.year()),o=e.every((function(t,n){var o=n*r,i=ba()(t);return!!i.isValid()&&i.isSame(ba()(e[0]).add(o,"month"),"minute")}));return o?r:0}},{key:"getDayTolerance",value:function(e){var t=this,n=this.getDateStringValue(e[0]),r=this.getDateStringValue(e[1])-n,o=e.every((function(e,o){return!!ba()(e).isValid()&&t.getDateStringValue(e)===o*r+n}));return o?r:0}},{key:"getLeastSquares",value:function(e){var t,n,r,o,i=0,s=0,a=0,l=0,c=0,d=[];return e.forEach((function(e,t){void 0!==e&&null!==e&&""!==e?(c++,i+=t,s+=e,l+=e*t,a+=Math.pow(t,2)):d.push(t)})),c<2?ku:(t=(l-c*(r=i/c)*(o=s/c))/(a-c*Math.pow(r,2)),n=o-t*r,function(r){var o=r.n;return d.length&&d.includes(o%e.length)?"":Number(parseFloat(o*t+n).toFixed(8))})}}]),e}(),Iu=ju,Mu=["metadata","modifyRecord","modifyRecords","loadMore","loadAll","searchResult"],_u=function(e){var t,n,r=e.metadata,o=e.modifyRecord,i=e.modifyRecords,s=e.loadMore,l=e.loadAll,c=(e.searchResult,(0,Po.Z)(e,Mu)),d=(0,a.useMemo)((function(){return new Iu(r,{modifyRecord:o,modifyRecords:i})}),[r,o,i]),u=jl().openRecordDetails,p=(0,a.useMemo)((function(){return((null===r||void 0===r?void 0:r.groupbys)||[]).length}),[r]),h=(0,a.useMemo)((function(){return p*Fa}),[p]),f=(0,a.useCallback)((function(e){var t=e.rowId,n=e.updates,r=e.originalUpdates,i=e.oldRowData,s=e.originalOldRowData;o&&o(t,n,i,r,s)}),[o]),g=(0,a.useCallback)((function(e){var t=e.recordIds,n=e.idRecordUpdates,r=e.idOriginalRecordUpdates,o=e.idOldRecordData,s=e.idOriginalOldRecordData,a=e.isCopyPaste;i&&i(t,n,r,o,s,void 0!==a&&a)}),[i]);return(0,m.jsx)("div",{className:Br()("table-main-container container-fluid p-0",(0,Fr.default)({},"group-level-".concat(p+1),p>0)),children:(0,m.jsx)(Du,(0,sr.Z)({columns:r.view.columns,recordIds:r.view.rows||[],groups:r.groups,groupbys:r.groupbys,recordsCount:(null===r||void 0===r||null===(t=r.view)||void 0===t||null===(n=t.rows)||void 0===n?void 0:n.length)||0,table:r,hasMore:r.hasMore,gridUtils:d,scrollToLoadMore:s,loadAll:l,groupOffsetLeft:h,modifyRecord:f,updateRecords:g,onRowExpand:u},c))})},Nu=function(){var e=(0,a.useState)(!1),t=(0,ge.Z)(e,2),n=t[0],r=t[1],o=wl(),i=o.metadata,s=o.errorMsg,l=o.store,c=(0,a.useRef)(null),d=(0,a.useCallback)((function(e){if(!e.target.className.includes("editor-main"))return ms(e)?(e.preventDefault(),void window.sfMetadataContext.eventBus.dispatch(Ea.SEARCH_CELLS)):void 0}),[]),u=(0,a.useCallback)((function(){return!1}),[]),p=(0,a.useCallback)((function(){}),[]),g=(0,a.useCallback)((0,Vt.Z)((0,Yt.Z)().mark((function e(){var t;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.hasMore){e.next=2;break}return e.abrupt("return");case 2:return r(!0),e.prev=3,e.next=6,l.loadMore(Ka);case 6:r(!1),e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(3),t=f.c.getErrorMsg(e.t0),W.Z.danger(t),r(!1),e.abrupt("return");case 15:case"end":return e.stop()}}),e,null,[[3,9]])}))),[i,l]),v=(0,a.useCallback)(function(){var e=(0,Vt.Z)((0,Yt.Z)().mark((function e(t,n){var o,s,a;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.hasMore){e.next=2;break}return e.abrupt("return");case 2:return r(!0),o=i.row_ids.length,s=o%qa!==0?qa-o%qa:qa,e.prev=5,e.next=8,l.loadMore(s);case 8:r(!1),e.next=17;break;case 11:return e.prev=11,e.t0=e.catch(5),a=f.c.getErrorMsg(e.t0),W.Z.danger(a),r(!1),e.abrupt("return");case 17:l.data.hasMore&&l.data.row_ids.length<t?v(t,n):("function"===typeof n&&n(l.data.hasMore),r(!1));case 18:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t,n){return e.apply(this,arguments)}}(),[i,l]),y=(0,a.useCallback)((function(e,t,n,r,o){}),[]),x=(0,a.useCallback)((function(e,t,n,r,o){var i=[e],s=(0,Fr.default)({},e,t),a=(0,Fr.default)({},e,r),l=(0,Fr.default)({},e,n),c=(0,Fr.default)({},e,o);y(i,s,a,l,c)}),[y]),w=(0,a.useCallback)((function(e){var t=i.row_ids.length,n=[],r=[],o=[],s={};return e.forEach((function(e){return s[e]=e})),i.row_ids.forEach((function(e,a){if(s[e]){var l=0===a?null:i.row_ids[a-1],c=a===t-1?null:i.row_ids[a+1];n.push(e),r.push(l),o.push(c)}})),{rowIdsInOrder:n,upperRowIds:r,belowRowIds:o}}),[i]),b=(0,a.useCallback)((function(e,t){l.modifyFilters(t,e),l.saveView()}),[l]),S=(0,a.useCallback)((function(e){l.modifySorts(e),l.saveView()}),[l]),C=(0,a.useCallback)((function(){}),[]),D=(0,a.useCallback)((function(){}),[]),k=(0,a.useCallback)((function(e){return i.id_row_map[e]}),[i]),j=(0,a.useCallback)((function(e){var t=i.view.rows[e];return t&&k(t)}),[i,k]),I=(0,a.useCallback)((function(e){if(!window.sfMetadataBody||!window.sfMetadataBody.getGroupRecordByIndex)return null;var t=window.sfMetadataBody.getGroupRecordByIndex(e).rowId;return t&&k(t)}),[k]),M=(0,a.useCallback)((function(e){var t=e.isGroupView,n=e.groupRecordIndex,r=e.recordIndex;return t&&I(n),j(r)}),[I,j]),_=(0,a.useCallback)((function(){var e;return(null===c||void 0===c||null===(e=c.current)||void 0===e?void 0:e.getBoundingClientRect())||{x:0,right:window.innerWidth}}),[c]);return(0,a.useEffect)((function(){document.addEventListener("keydown",d);var e=window.sfMetadataContext.eventBus.subscribe(Ea.SELECT_CELL,p);return function(){document.removeEventListener("keydown",d),e()}}),[]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"sf-metadata-wrapper",children:[(0,m.jsx)(Mc,{view:i.view,modifyFilters:b,modifySorts:S,modifyGroupbys:C,modifyHiddenColumns:D}),(0,m.jsxs)("div",{className:"sf-metadata-main",children:[s&&(0,m.jsx)("div",{className:"d-center-middle error",children:(0,h.ih)(s)}),!s&&(0,m.jsx)("div",{className:"sf-metadata-container",ref:c,children:(0,m.jsx)(_u,{isGroupView:u(),isLoadingMore:n,loadMore:g,metadata:i,modifyRecord:x,modifyRecords:y,recordGetterById:k,recordGetterByIndex:M,getTableContentRect:_,getAdjacentRowsIds:w,loadAll:v})})]})]}),(0,m.jsx)(Gl,{})]})},Ru=function(){return wl().isLoading?(0,m.jsx)(Bl.sM,{}):(0,m.jsx)(Nu,{})},Tu=function(e){var t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));return(0,m.jsx)(xl,(0,sr.Z)((0,sr.Z)({},t),{},{children:(0,m.jsx)(Sl,{children:(0,m.jsx)(kl,{children:(0,m.jsx)(Ru,{})})})}))},Ou=n(21803),Eu=function(e){var t=e.value,n=e.repoID,r=e.toggle,o=e.submit,i=(0,a.useState)(t),s=(0,ge.Z)(i,2),l=s[0],c=s[1],d=(0,a.useState)(!1),u=(0,ge.Z)(d,2),g=u[0],v=u[1],y=(0,a.useCallback)((function(){g||r&&r()}),[g,r]),x=(0,a.useCallback)((function(){v(!0),co[l?"createMetadata":"deleteMetadata"](n).then((function(e){o(l),r()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t),v(!1)}))}),[n,l,o,r]),w=(0,a.useCallback)((function(){c(!l)}),[l]);return(0,m.jsxs)(p.Z,{className:"metadata-status-management-dialog",isOpen:!0,toggle:y,children:[(0,m.jsx)(I.Z,{toggle:y,children:(0,h.ih)("Extended properties management")}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)(Ou.Z,{checked:l,disabled:g,size:"large",textPosition:"right",className:"change-metadata-status-management w-100",onChange:w,placeholder:(0,h.ih)("Enable extended properties")}),(0,m.jsx)("div",{className:"tip",children:(0,h.ih)("After enable extended properties for files, you can add different properties to files, like collaborators, file expiring time, file description. You can also create different views for files based extended properties.")})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:y,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",disabled:t===l||g,onClick:x,children:(0,h.ih)("Submit")})]})]})},Pu=function(e){var t=e.repoID,n=e.currentPath,r=e.onNodeClick,o=(0,a.useMemo)((function(){return{children:[],path:"/"+Xn.$s.FILE_EXTENDED_PROPERTIES,isExpanded:!1,isLoaded:!0,isPreload:!0,object:{file_tags:[],id:Xn.$s.FILE_EXTENDED_PROPERTIES,name:(0,h.ih)("File extended properties"),type:Xn.$s.FILE_EXTENDED_PROPERTIES,isDir:function(){return!1}},parentNode:{},key:t}}),[t]),i=(0,a.useState)(!1),s=(0,ge.Z)(i,2),l=s[0],c=s[1],d=(0,a.useCallback)((function(){c(!0)}),[]),u=(0,a.useCallback)((function(){c(!0)}),[]),p=(0,a.useCallback)((function(){c(!1)}),[]);return(0,m.jsx)("div",{className:"tree-view tree metadata-tree-view",children:(0,m.jsx)("div",{className:"tree-node",children:(0,m.jsx)("div",{className:"children",style:{paddingLeft:20},children:(0,m.jsxs)("div",{className:Br()("tree-node-inner text-nowrap",{"tree-node-inner-hover":l,"tree-node-hight-light":n===o.path}),title:(0,h.ih)("File extended properties"),onMouseEnter:d,onMouseOver:u,onMouseLeave:p,onClick:function(){return r(o)},children:[(0,m.jsx)("div",{className:"tree-node-text",children:(0,h.ih)("File extended properties")}),(0,m.jsx)("div",{className:"left-icon",children:(0,m.jsx)("div",{className:"tree-node-icon",children:(0,m.jsx)(Nr.Z,{symbol:"table",className:"metadata-views-icon"})})})]})})})})},Zu=function(e){var t=e.userPerm,n=e.repoID,r=e.currentPath,o=e.onNodeClick,i=(0,a.useMemo)((function(){return window.app.pageOptions.enableMetadataManagement}),[window.app.pageOptions.enableMetadataManagement]),s=(0,a.useState)(!0),l=(0,ge.Z)(s,2),c=l[0],d=l[1],u=(0,a.useState)(!1),p=(0,ge.Z)(u,2),g=p[0],v=p[1],y=(0,a.useState)(!1),x=(0,ge.Z)(y,2),w=x[0],b=x[1],S=(0,a.useMemo)((function(){return i?"rw"!==t&&"admin"!==t?[]:[{key:"extended-properties",value:(0,h.ih)("Extended properties")}]:[]}),[i,t]);(0,a.useEffect)((function(){if(i){var e=co.getMetadataStatus(n);Promise.all([e]).then((function(e){var t=(0,ge.Z)(e,1)[0];b(t.data.enabled),d(!1)})).catch((function(e){var t=f.c.getErrorMsg(e,!0);W.Z.danger(t),d(!1)}))}else d(!1)}),[]);var C=(0,a.useCallback)((function(e){"extended-properties"!==e||v(!0)}),[]),D=(0,a.useCallback)((function(){v(!1)}),[]),k=(0,a.useCallback)((function(e){w!==e&&b(e)}),[w]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Do,{title:(0,h.ih)("Views"),moreKey:{name:"views"},moreOperations:S,moreOperationClick:C,children:!c&&w&&(0,m.jsx)(Pu,{repoID:n,currentPath:r,onNodeClick:o})}),g&&(0,m.jsx)(Eu,{value:w,repoID:n,toggle:D,submit:k})]})},Fu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onNodeClick=function(e){var t;o.setState({opNode:e}),f.c.imageCheck((null===e||void 0===e||null===(t=e.object)||void 0===t?void 0:t.name)||"")?o.showNodeImagePopup(e):o.props.onNodeClick(e)},o.onMenuItemClick=function(e,t){switch(o.setState({opNode:t}),e){case"New Folder":t?o.onAddFolderToggle():o.onAddFolderToggle("root");break;case"New File":t?o.onAddFileToggle():o.onAddFileToggle("root");break;case"Rename":o.onRenameToggle();break;case"Delete":o.onDeleteNode(t);break;case"Copy":o.onCopyToggle();break;case"Move":o.onMoveToggle();break;case"Open in New Tab":o.onOpenFile(t)}},o.onAddFileToggle=function(e){if("root"===e){var t=o.props.treeData.root;o.setState({isAddFileDialogShow:!o.state.isAddFileDialogShow,opNode:t})}else o.setState({isAddFileDialogShow:!o.state.isAddFileDialogShow})},o.onAddFolderToggle=function(e){if("root"===e){var t=o.props.treeData.root;o.setState({isAddFolderDialogShow:!o.state.isAddFolderDialogShow,opNode:t})}else o.setState({isAddFolderDialogShow:!o.state.isAddFolderDialogShow})},o.onRenameToggle=function(){o.setState({isRenameDialogShow:!o.state.isRenameDialogShow})},o.onCopyToggle=function(){o.setState({isCopyDialogShow:!o.state.isCopyDialogShow})},o.onMoveToggle=function(){o.setState({isMoveDialogShow:!o.state.isMoveDialogShow})},o.onAddFolderNode=function(e){o.setState({isAddFolderDialogShow:!o.state.isAddFolderDialogShow}),o.props.onAddFolderNode(e)},o.onRenameNode=function(e){o.setState({isRenameDialogShow:!o.state.isRenameDialogShow});var t=o.state.opNode;o.props.onRenameNode(t,e)},o.onDeleteNode=function(e){o.props.onDeleteNode(e)},o.onOpenFile=function(e){var t=h.ze+"lib/"+o.props.repoID+"/file"+f.c.encodePath(e.path);window.open(t,"_blank")},o.checkDuplicatedName=function(e){var t=o.state.opNode;return(t.parentNode?t.parentNode:t).children.map((function(e){return e.object})).some((function(t){return t.name===e}))},o.showNodeImagePopup=function(e){var t=e.parentNode.children.filter((function(e){return f.c.imageCheck(e.object.name)})).map((function(e){return e.object.name}));o.setState({isNodeImagePopupOpen:!0,imageNodeItems:o.prepareImageItems(e),imageIndex:t.indexOf(e.object.name)})},o.prepareImageItems=function(e){var t=e.parentNode.children.filter((function(e){return f.c.imageCheck(e.object.name)})),n=!o.props.currentRepoInfo.encrypted;return t.map((function(t){return function(t){var r=t.object.name,i=f.c.encodePath(f.c.joinPath(e.parentNode.path,r)),s="gif"===r.substr(r.lastIndexOf(".")+1).toLowerCase(),a=o.props.repoID,l="";return l=n&&!s?"".concat(h.ze,"thumbnail/").concat(a,"/").concat(h.fp).concat(i):"".concat(h.ze,"repo/").concat(a,"/raw").concat(i),{name:r,url:"".concat(h.ze,"lib/").concat(a,"/file").concat(i),src:l}}(t)}))},o.closeNodeImagePopup=function(){o.setState({isNodeImagePopupOpen:!1})},o.moveToPrevImage=function(){var e=o.state.imageNodeItems.length;o.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},o.moveToNextImage=function(){var e=o.state.imageNodeItems.length;o.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},o.stopTreeScrollPropagation=function(e){e.stopPropagation()},o.renderContent=function(){return o.props.isTreeDataLoading?(0,m.jsx)(D.Z,{}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Do,{title:(0,h.ih)("Files"),children:(0,m.jsx)(yo.Z,{userPerm:o.props.userPerm,isNodeMenuShow:o.isNodeMenuShow,treeData:o.props.treeData,currentPath:o.props.currentPath,onNodeClick:o.onNodeClick,onNodeExpanded:o.props.onNodeExpanded,onNodeCollapse:o.props.onNodeCollapse,onMenuItemClick:o.onMenuItemClick,onFreezedItem:o.onFreezedItem,onUnFreezedItem:o.onUnFreezedItem,onItemMove:o.props.onItemMove,currentRepoInfo:o.props.currentRepoInfo,selectedDirentList:o.props.selectedDirentList,onItemsMove:o.props.onItemsMove,repoID:o.props.repoID})}),(0,m.jsx)(Zu,{repoID:o.props.repoID,currentPath:o.props.currentPath,userPerm:o.props.userPerm,onNodeClick:o.onNodeClick})]})},o.state={opNode:null,isAddFileDialogShow:!1,isAddFolderDialogShow:!1,isRenameDialogShow:!1,isNodeImagePopupOpen:!1,imageNodeItems:[],imageIndex:0,isCopyDialogShow:!1,isMoveDialogShow:!1,isMutipleOperation:!1},o.isNodeMenuShow=!0,o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({opNode:e.currentNode})}},{key:"render",value:function(){var e=this.props.navRate?"0 0 "+100*this.props.navRate+"%":"0 0 25%",t=this.props.inResizing?"none":"";return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("div",{className:"dir-content-nav",role:"navigation",style:{flex:e,userSelect:t},onScroll:this.stopTreeScrollPropagation,children:this.renderContent()}),this.state.isAddFolderDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Wn.Z,{parentPath:this.state.opNode.path,onAddFolder:this.onAddFolderNode,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onAddFolderToggle})}),this.state.isAddFileDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Kn.Z,{parentPath:this.state.opNode.path,onAddFile:this.props.onAddFileNode,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onAddFileToggle})}),this.state.isRenameDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(xo,{currentNode:this.state.opNode,onRename:this.onRenameNode,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.onRenameToggle})}),this.state.isCopyDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(wo,{path:this.state.opNode.parentNode.path,repoID:this.props.repoID,dirent:this.state.opNode.object,onItemCopy:this.props.onItemCopy,repoEncrypted:this.props.currentRepoInfo.encrypted,onCancelCopy:this.onCopyToggle,isMutipleOperation:this.state.isMutipleOperation})}),this.state.isMoveDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(bo,{path:this.state.opNode.parentNode.path,repoID:this.props.repoID,dirent:this.state.opNode.object,onItemMove:this.props.onItemMove,repoEncrypted:this.props.currentRepoInfo.encrypted,onCancelMove:this.onMoveToggle,isMutipleOperation:this.state.isMutipleOperation})}),this.state.isNodeImagePopupOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(So.Z,{imageItems:this.state.imageNodeItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeNodeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})})]})}}]),n}(a.Component);Fu.defaultProps={navRate:.25};var Lu=Fu,Au=n(88376),Uu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onEditClick=function(t){t.preventDefault();var n=e.props,r=n.path,o=n.repoID,i=h.ze+"lib/"+o+"/file"+f.c.encodePath(r)+"?mode=edit";window.open(i)},e.onOpenFile=function(t){t.preventDefault();var n=e.props,r=n.path,o=n.repoID,i=h.ze+"lib/"+o+"/file"+f.c.encodePath(r);window.open(i,"_blank")},e}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){if(this.props.hash){var e=this.props.hash;setTimeout((function(){window.location.hash=e}),500)}}},{key:"render",value:function(){return this.props.isFileLoadedErr?(0,m.jsx)("div",{className:"message err-tip",children:(0,h.ih)("File does not exist.")}):"__sf-metadata"===this.props.content?(window.sfMetadata={siteRoot:h.ze,lang:h.KQ,mediaUrl:h.si},(0,m.jsxs)("div",{className:"w-100 h-100 o-hidden d-flex",style:{paddingRight:10,flexDirection:"column",alignItems:"center"},children:[(0,m.jsx)("div",{className:"",style:{width:"100%",height:10,zIndex:7,transform:"translateZ(1000px)",position:"relative",background:"#fff"}}),(0,m.jsx)(Tu,{repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo})]})):(0,m.jsx)(Au.Z,{isTOCShow:!1,isFileLoading:this.props.isFileLoading,markdownContent:this.props.content,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick,repoID:this.props.repoID,path:this.props.path,children:(0,m.jsx)("span",{className:"wiki-open-file position-fixed",onClick:this.onOpenFile,children:(0,m.jsx)("i",{className:"sf3-font sf3-font-expand-arrows-alt"})})})}}]),n}(a.Component),zu=Uu,Bu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onCreateNewFile=function(e){o.setState({fileType:e,isCreateFileDialogShow:!o.state.isCreateFileDialogShow})},o.onCreateFileToggle=function(){o.setState({fileType:"",isCreateFileDialogShow:!o.state.isCreateFileDialogShow})},o.checkDuplicatedName=function(){return!1},o.state={fileType:"",isCreateFileDialogShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){if(this.props.isDirentListLoading)return(0,m.jsx)(D.Z,{});var e=this.props.currentRepoInfo;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{className:"tip-for-new-file",children:[(0,m.jsx)("p",{className:"text-secondary text-center",children:(0,h.ih)("This folder has no content at this time.")}),(0,m.jsxs)("p",{className:"text-secondary text-center",children:[(0,h.ih)("You can create files quickly")," +"]}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".md"),children:"+ Markdown"}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".pptx"),children:"+ PPT"}),(0,m.jsx)("br",{}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".docx"),children:"+ Word"}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".xlsx"),children:"+ Excel"}),(0,m.jsx)("br",{}),h.np&&!e.encrypted&&(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".sdoc"),children:"+ SeaDoc"})]}),this.state.isCreateFileDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Kn.Z,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,toggleDialog:this.onCreateFileToggle,checkDuplicatedName:this.checkDuplicatedName})})]})}}]),n}(a.Component),Gu=n(70155),Hu=n(52522),Yu=n(23396),Vu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.fileTag,n=e.length,r=e.index,o="file-tag-".concat(t.id,"-").concat(mr());return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{className:"file-tag",id:o,style:{zIndex:n-r,backgroundColor:t.color}},t.id),(0,m.jsx)(Oe.Z,{target:o,placement:"bottom",children:t.name})]})}}]),n}(a.PureComponent),Wu=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).toggleOpMenu=function(){o.setState({isOpMenuOpen:!o.state.isOpMenuOpen})},o.onMouseEnter=function(){o.props.isItemFreezed||o.setState({highlight:!0,isOperationShow:!0}),o.state.canDrag&&o.setState({isDragTipShow:!0})},o.onMouseOver=function(){o.props.isItemFreezed||o.setState({highlight:!0,isOperationShow:!0}),o.state.canDrag&&o.setState({isDragTipShow:!0})},o.onMouseLeave=function(){o.props.isItemFreezed||o.setState({highlight:!1,isOperationShow:!1}),o.setState({isDragTipShow:!1})},o.unfreezeItem=function(){o.setState({highlight:!1,isOperationShow:!1}),o.props.unfreezeItem()},o.onItemSelected=function(){o.props.onItemSelected(o.props.dirent)},o.onItemStarred=function(e){var t=o.props.dirent,n=o.props.repoID,r=o.getDirentPath(t);e.preventDefault(),t.starred?C.I.unstarItem(n,r).then((function(){o.props.updateDirent(o.props.dirent,"starred",!1)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})):C.I.starItem(n,r).then((function(){o.props.updateDirent(o.props.dirent,"starred",!0)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onDirentClick=function(e){e.stopPropagation(),"TD"==e.target.tagName&&o.props.onDirentClick(o.props.dirent)},o.onItemClick=function(e){e.preventDefault();var t=o.props.dirent;o.state.isRenameing||(t.isDir()?o.props.onItemClick(t):o.canPreview&&(f.c.imageCheck(t.name)?o.props.showImagePopup(t):o.props.onItemClick(t)))},o.onItemDelete=function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),o.props.onItemDelete(o.props.dirent)},o.onItemShare=function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),o.setState({isShareDialogShow:!o.state.isShareDialogShow})},o.exportDocx=function(){var e=window.app.config.serviceURL+"/repo/sdoc_export_to_docx/"+o.props.repoID+"/?file_path="+o.getDirentPath(o.props.dirent);window.location.href=e},o.closeSharedDialog=function(){o.setState({isShareDialogShow:!o.state.isShareDialogShow})},o.onMobileMenuItemClick=function(e){var t=e.target.getAttribute("data-op");o.onMenuItemClick(t,e)},o.onMenuItemClick=function(e,t){switch(e){case"Download":o.onItemDownload(t);break;case"Share":o.onItemShare(t);break;case"Delete":o.onItemDelete(t);break;case"Rename":o.onItemRenameToggle();break;case"Move":o.onItemMoveToggle();break;case"Copy":o.onItemCopyToggle();break;case"Tags":o.onEditFileTagToggle();break;case"Permission":o.onPermissionItem();break;case"Unlock":case"Unfreeze Document":o.onUnlockItem();break;case"Lock":o.onLockItem();break;case"Freeze Document":o.onFreezeDocument();break;case"Convert to Markdown":o.onItemConvert(t,"markdown");break;case"Convert to docx":o.onItemConvert(t,"docx");break;case"Export docx":o.exportDocx();break;case"Convert to sdoc":o.onItemConvert(t,"sdoc");break;case"History":o.onHistory();break;case"Access Log":o.onAccessLog();break;case"Properties":o.props.onDirentClick(o.props.dirent),o.props.showDirentDetail("info");break;case"Open via Client":o.onOpenViaClient();break;case"Convert with ONLYOFFICE":o.onConvertWithONLYOFFICE()}},o.onItemConvert=function(e,t){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),o.props.onItemConvert(o.props.dirent,t)},o.onEditFileTagToggle=function(){o.setState({isEditFileTagShow:!o.state.isEditFileTagShow})},o.onFileTagChanged=function(){var e=o.getDirentPath(o.props.dirent);o.props.onFileTagChanged(o.props.dirent,e)},o.onItemRenameToggle=function(){o.props.onItemRenameToggle(o.props.dirent),o.setState({isOperationShow:!1,isRenameing:!0,canDrag:!1})},o.onRenameConfirm=function(e){o.props.onItemRename(o.props.dirent,e),o.onRenameCancel()},o.onRenameCancel=function(){o.setState({isRenameing:!1,canDrag:o.canDrag}),o.unfreezeItem()},o.onItemMoveToggle=function(){o.setState({isMoveDialogShow:!o.state.isMoveDialogShow})},o.onItemCopyToggle=function(){o.setState({isCopyDialogShow:!o.state.isCopyDialogShow})},o.onPermissionItem=function(){o.setState({isPermissionDialogOpen:!o.state.isPermissionDialogOpen})},o.onLockItem=function(){var e=o.props.repoID,t=o.getDirentPath(o.props.dirent);C.I.lockfile(e,t).then((function(){o.props.updateDirent(o.props.dirent,"is_locked",!0),o.props.updateDirent(o.props.dirent,"locked_by_me",!0);var e=h.b6.split("@");o.props.updateDirent(o.props.dirent,"lock_owner_name",e[0])})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onFreezeDocument=function(){var e=o.props.repoID,t=o.getDirentPath(o.props.dirent);C.I.lockfile(e,t,-1).then((function(){o.props.updateDirent(o.props.dirent,"is_freezed",!0),o.props.updateDirent(o.props.dirent,"is_locked",!0),o.props.updateDirent(o.props.dirent,"locked_by_me",!0);var e=h.b6.split("@");o.props.updateDirent(o.props.dirent,"lock_owner_name",e[0])})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onUnlockItem=function(){var e=o.props.repoID,t=o.getDirentPath(o.props.dirent);C.I.unlockfile(e,t).then((function(){o.props.updateDirent(o.props.dirent,"is_locked",!1),o.props.updateDirent(o.props.dirent,"locked_by_me",!1),o.props.updateDirent(o.props.dirent,"lock_owner_name","")})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onHistory=function(){var e=o.props.repoID,t=o.getDirentPath(o.props.dirent),n=Hu.Z.getUrl({type:"file_revisions",repoID:e,filePath:t});location.href=n},o.onAccessLog=function(){var e=o.getDirentPath(o.props.dirent),t=h.ze+"repo/file-access/"+o.props.repoID+"/?p="+encodeURIComponent(e);window.open(t)},o.onOpenViaClient=function(){var e=o.props.repoID,t=o.getDirentPath(o.props.dirent),n=Hu.Z.getUrl({type:"open_via_client",repoID:e,filePath:t});location.href=n},o.onConvertWithONLYOFFICE=function(){var e=o.props.repoID,t=o.getDirentPath(o.props.dirent);C.I.onlyofficeConvert(e,t).then((function(e){o.props.loadDirentList(e.data.parent_dir)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onItemDownload=function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation();var t=o.props.dirent,n=o.props.repoID,r=o.getDirentPath(t);if("dir"===t.type)h.Zb?C.I.zipDownload(n,o.props.path,o.props.dirent.name).then((function(e){var t=e.data.zip_token;location.href="".concat(h.gc,"zip/").concat(t)})).catch((function(e){var t=f.c.getErrorMsg(e);o.setState({isLoading:!1,errorMsg:t})})):o.setState({isZipDialogOpen:!0});else{var i=Hu.Z.getUrl({type:"download_file_url",repoID:n,filePath:r});location.href=i}},o.closeZipDialog=function(){o.setState({isZipDialogOpen:!1})},o.getDirentPath=function(e){var t=o.props.path;return"/"===t?t+e.name:t+"/"+e.name},o.onTagTooltipToggle=function(e){e.stopPropagation(),o.setState({isShowTagTooltip:!o.state.isShowTagTooltip})},o.onItemMove=function(e,t,n,r){o.props.onItemMove(e,t,n,r)},o.onItemDragStart=function(e){if(f.c.isIEBrower()||!o.state.canDrag)return!1;e.dataTransfer.effectAllowed="move";var t=o.props.selectedDirentList;if(t.length>0&&t.includes(o.props.dirent)){o.props.onShowDirentsDraggablePreview(),e.dataTransfer.setDragImage(o.refs.empty_content,0,0);var n=t.map((function(e){var t=o.getDirentPath(e);return{nodeDirent:e,nodeParentPath:o.props.path,nodeRootPath:t}}));return n=JSON.stringify(n),void e.dataTransfer.setData("applicaiton/drag-item-info",n)}e.dataTransfer&&e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(o.refs.drag_icon,15,15);var r=o.getDirentPath(o.props.dirent),i={nodeDirent:o.props.dirent,nodeParentPath:o.props.path,nodeRootPath:r};i=JSON.stringify(i),e.dataTransfer.setData("applicaiton/drag-item-info",i)},o.onItemDragEnter=function(e){if(f.c.isIEBrower()||!o.state.canDrag)return!1;"dir"===o.props.dirent.type&&(e.stopPropagation(),o.setState({isDropTipshow:!0}))},o.onItemDragOver=function(e){if(f.c.isIEBrower()||!o.state.canDrag)return!1;"copy"!==e.dataTransfer.dropEffect&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},o.onItemDragLeave=function(e){if(f.c.isIEBrower()||!o.state.canDrag)return!1;"dir"===o.props.dirent.type&&e.stopPropagation(),o.setState({isDropTipshow:!1})},o.onItemDragDrop=function(e){if(f.c.isIEBrower()||!o.state.canDrag)return!1;if(o.setState({isDropTipshow:!1}),!e.dataTransfer.files.length&&"dir"===o.props.dirent.type){e.stopPropagation();var t=e.dataTransfer.getData("applicaiton/drag-item-info");if(t=JSON.parse(t),Array.isArray(t)){var n=t.map((function(e){return e.nodeRootPath})),r=f.c.joinPath(o.props.path,o.props.dirent.name);if(n.some((function(e){return e===r})))return;o.props.onItemsMove(o.props.currentRepoInfo,r)}else{var i=t,s=i.nodeDirent,a=i.nodeParentPath,l=i.nodeRootPath,c=o.props.dirent;if(s.name!==c.name&&("dir"!==c.type||"dir"!==s.type||a===o.props.path||-1===o.props.path.indexOf(l))){var d=f.c.joinPath(o.props.path,o.props.dirent.name);o.onItemMove(o.props.currentRepoInfo,s,d,a)}}}},o.onItemMouseDown=function(e){o.props.onItemMouseDown(e)},o.onItemContextMenu=function(e){var t=o.props.dirent;o.props.onItemContextMenu(e,t)},o.renderItemOperation=function(){var e=o.props,t=e.dirent,n=e.currentRepoInfo,r=e.selectedDirentList,i=!0,s=!0,l=(0,xt.Z)(o),c=l.isCustomPermission,d=l.customPermission;if(c){var u=d.permission;i=u.download,s=u.delete}var p=f.c.isHasPermissionToShare(n,t.permission,t);return(0,m.jsx)(a.Fragment,{children:r.length>1?(0,m.jsx)(a.Fragment,{children:o.state.isOperationShow&&!t.isSelected&&(0,m.jsxs)("div",{className:"operations",children:[("rw"===t.permission||"r"===t.permission||c&&i)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font sf3-font-download1",title:(0,h.ih)("Download"),role:"button","aria-label":(0,h.ih)("Download"),onClick:o.onItemDownload}),p&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-share sf3-font",title:(0,h.ih)("Share"),role:"button","aria-label":(0,h.ih)("Share"),onClick:o.onItemShare}),("rw"===t.permission||"cloud-edit"===t.permission||c&&s)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-delete1 sf3-font",title:(0,h.ih)("Delete"),role:"button","aria-label":(0,h.ih)("Delete"),onClick:o.onItemDelete}),(0,m.jsx)(Co.Z,{item:o.props.dirent,isHandleContextMenuEvent:!0,getMenuList:o.props.getDirentItemMenuList,onMenuItemClick:o.onMenuItemClick,unfreezeItem:o.unfreezeItem,freezeItem:o.props.freezeItem})]})}):(0,m.jsx)(a.Fragment,{children:o.state.isOperationShow&&(0,m.jsxs)("div",{className:"operations",children:[("rw"===t.permission||"r"===t.permission||c&&i)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font sf3-font-download1",title:(0,h.ih)("Download"),role:"button","aria-label":(0,h.ih)("Download"),onClick:o.onItemDownload}),p&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-share sf3-font",title:(0,h.ih)("Share"),role:"button","aria-label":(0,h.ih)("Share"),onClick:o.onItemShare}),("rw"===t.permission||"cloud-edit"===t.permission||c&&s)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-delete1 sf3-font",title:(0,h.ih)("Delete"),role:"button","aria-label":(0,h.ih)("Delete"),onClick:o.onItemDelete}),(0,m.jsx)(Co.Z,{item:o.props.dirent,isHandleContextMenuEvent:!0,getMenuList:o.props.getDirentItemMenuList,onMenuItemClick:o.onMenuItemClick,unfreezeItem:o.unfreezeItem,freezeItem:o.props.freezeItem})]})})})};var i=o.props.dirent,s=f.c.getUserPermission(i.permission),l=s.isCustomPermission,c=s.customPermission;if(o.isCustomPermission=l,o.customPermission=c,o.canPreview=!0,o.canDrag="rw"===i.permission,l){var d=c.permission,u=d.preview,p=d.modify;o.canPreview=u||p,o.canDrag=p}return o.state={isOperationShow:!1,highlight:!1,isZipDialogOpen:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isShareDialogShow:!1,isMutipleOperation:!1,canDrag:o.canDrag,isShowTagTooltip:!1,isDragTipShow:!1,isDropTipshow:!1,isEditFileTagShow:!1,isPermissionDialogOpen:!1,isOpMenuOpen:!1},o.tagListTitleID="tag-list-title-".concat(mr()),o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;e.isItemFreezed===this.props.isItemFreezed||e.isItemFreezed||this.setState({highlight:!1,isOperationShow:!1},(function(){e.activeDirent&&e.activeDirent.name===e.dirent.name&&t.setState({isOperationShow:!0})}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.path,r=t.dirent,o=t.activeDirent,i=f.c.joinPath(n,r.name),s="";this.props.currentRepoInfo&&(s=h.ze+"library/"+this.props.repoID+"/"+this.props.currentRepoInfo.repo_name+f.c.encodePath(i));var l=h.ze+"lib/"+this.props.repoID+"/file"+f.c.encodePath(i);r.is_sdoc_revision&&r.revision_id&&(l=h.ze+"lib/"+this.props.repoID+"/revisions/"+r.revision_id+"/");var c=f.c.getDirentIcon(r),d=o&&o.name===r.name||r.isSelected,p=this.state.highlight?"tr-highlight ":"";p+=this.state.isDropTipshow?"tr-drop-effect":"",p+=d?"tr-active":"",p+=d?"tr-active":"";var g=r.is_freezed?(0,h.ih)("Frozen by {name}"):(0,h.ih)("locked by {name}");g=g.replace("{name}",r.lock_owner_name);var v=f.c.isDesktop(),y=this.state.canDrag,x="".concat(h.si,"img/file-").concat(r.is_freezed?"freezed-32.svg":"locked-32.png"),w=r.is_freezed?(0,h.ih)("freezed"):(0,h.ih)("locked"),b=(0,m.jsxs)("tr",{className:p,draggable:y,onFocus:this.onMouseEnter,onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onClick:this.onDirentClick,onDragStart:this.onItemDragStart,onDragEnter:this.onItemDragEnter,onDragOver:this.onItemDragOver,onDragLeave:this.onItemDragLeave,onDrop:this.onItemDragDrop,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu,children:[(0,m.jsx)("td",{className:"pl10 ".concat(this.state.isDragTipShow?"tr-drag-effect":""),children:(0,m.jsx)("input",{type:"checkbox",className:"vam",onChange:this.onItemSelected,checked:d,"aria-label":d?(0,h.ih)("Unselect this item"):(0,h.ih)("Select this item")})}),(0,m.jsx)("td",{className:"pl10",children:void 0!==r.starred&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":r.starred?(0,h.ih)("Unstar"):(0,h.ih)("Star"),onClick:this.onItemStarred,children:(0,m.jsx)("i",{className:"sf3-font ".concat(r.starred?"sf3-font-star":"sf3-font-star-empty")})})}),(0,m.jsx)("td",{className:"pl10",children:(0,m.jsxs)("div",{className:"dir-icon",children:[this.canPreview&&r.encoded_thumbnail_src?(0,m.jsx)("img",{ref:"drag_icon",src:"".concat(h.ze).concat(r.encoded_thumbnail_src),className:"thumbnail cursor-pointer",onClick:this.onItemClick,alt:""}):(0,m.jsx)("img",{ref:"drag_icon",src:c,width:"24",alt:""}),r.is_locked&&(0,m.jsx)("img",{className:"locked",src:x,alt:w,title:g}),(0,m.jsx)("div",{ref:"empty_content",style:{position:"absolute",width:"1px",height:"1px"}})]})}),(0,m.jsxs)("td",{className:"name",children:[this.state.isRenameing&&(0,m.jsx)(Zt.Z,{hasSuffix:"dir"!==r.type,name:r.name,onRenameConfirm:this.onRenameConfirm,onRenameCancel:this.onRenameCancel}),!this.state.isRenameing&&(0,m.jsx)(a.Fragment,{children:r.isDir()||this.canPreview?(0,m.jsx)("a",{href:"dir"===r.type?s:l,onClick:this.onItemClick,children:r.name}):(0,m.jsx)("a",{className:"sf-link",onClick:this.onItemClick,children:r.name})})]}),(0,m.jsxs)("td",{className:"tag-list-title",children:["dir"!==r.type&&r.file_tags&&r.file_tags.length>0&&(0,m.jsx)("div",{id:this.tagListTitleID,className:"dirent-item tag-list tag-list-stacked",children:r.file_tags.map((function(e,t){return(0,m.jsx)(Vu,{fileTag:e,length:r.file_tags.length,index:t},t)}))}),"dir"!==r.type&&(!r.file_tags||0==r.file_tags.length)&&(0,m.jsx)("div",{id:this.tagListTitleID,className:"dirent-item tag-list tag-list-stacked"})]}),(0,m.jsx)("td",{className:"operation",children:this.renderItemOperation()}),(0,m.jsx)("td",{className:"file-size",children:r.size&&r.size}),(0,m.jsx)("td",{className:"last-update",title:S().unix(r.mtime).format("llll"),children:r.mtime_relative})]}),C=(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{onClick:this.onItemClick,children:(0,m.jsxs)("div",{className:"dir-icon",children:[this.canPreview&&r.encoded_thumbnail_src?(0,m.jsx)("img",{src:"".concat(h.ze).concat(r.encoded_thumbnail_src),className:"thumbnail cursor-pointer",alt:""}):(0,m.jsx)("img",{src:c,width:"24",alt:""}),r.is_locked&&(0,m.jsx)("img",{className:"locked",src:x,alt:w,title:g})]})}),(0,m.jsxs)("td",{onClick:this.onItemClick,children:[this.state.isRenameing&&(0,m.jsx)(Zt.Z,{hasSuffix:"dir"!==r.type,name:r.name,onRenameConfirm:this.onRenameConfirm,onRenameCancel:this.onRenameCancel}),!this.state.isRenameing&&(0,m.jsx)(a.Fragment,{children:r.isDir()||this.canPreview?(0,m.jsx)("a",{href:"dir"===r.type?s:l,children:r.name}):(0,m.jsx)("a",{className:"sf-link",children:r.name})}),(0,m.jsx)("br",{}),r.size&&(0,m.jsx)("span",{className:"item-meta-info",children:r.size}),(0,m.jsx)("span",{className:"item-meta-info",children:r.mtime_relative})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(H.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[void 0!==r.starred&&(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.onItemStarred,children:r.starred?(0,h.ih)("Unstar"):(0,h.ih)("Star")}),this.props.getDirentItemMenuList(r,!0).map((function(t,n){return"Divider"!=t&&"Open via Client"!=t.key?(0,m.jsx)(V.Z,{className:"mobile-menu-item","data-op":t.key,onClick:e.onMobileMenuItemClick,children:t.value},n):null}))]})]})]})})]});return(0,m.jsxs)(a.Fragment,{children:[v?b:C,this.state.isMoveDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(bo,{path:this.props.path,repoID:this.props.repoID,dirent:this.props.dirent,isMutipleOperation:this.state.isMutipleOperation,onItemMove:this.props.onItemMove,onCancelMove:this.onItemMoveToggle,repoEncrypted:this.props.repoEncrypted})}),this.state.isCopyDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(wo,{path:this.props.path,repoID:this.props.repoID,dirent:this.props.dirent,isMutipleOperation:this.state.isMutipleOperation,onItemCopy:this.props.onItemCopy,onCancelCopy:this.onItemCopyToggle,repoEncrypted:this.props.repoEncrypted})}),(0,m.jsx)(u(),{query:"(min-width: 768px)",children:this.state.isEditFileTagShow&&(0,m.jsx)(Rr.Z,{repoID:this.props.repoID,repoTags:this.props.repoTags,fileTagList:r.file_tags,filePath:i,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged,target:this.tagListTitleID,isEditFileTagShow:this.state.isEditFileTagShow})}),(0,m.jsx)(u(),{query:"(max-width: 767.8px)",children:this.state.isEditFileTagShow&&(0,m.jsx)(nr,{repoID:this.props.repoID,repoTags:this.props.repoTags,fileTagList:r.file_tags,filePath:i,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged})}),this.state.isZipDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Yu.Z,{repoID:this.props.repoID,path:this.props.path,target:this.props.dirent.name,toggleDialog:this.closeZipDialog})}),this.state.isShareDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Te.Z,{itemType:r.type,itemName:r.name,itemPath:i,userPerm:r.permission,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.closeSharedDialog})}),this.state.isPermissionDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Pt,{toggleDialog:this.onPermissionItem,repoID:this.props.repoID,folderPath:i,folderName:r.name,isDepartmentRepo:this.props.isGroupOwnedRepo})})]})}}]),n}(a.Component),Ku=n(92161),qu=n(30426),$u=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).handleDragEnd=function(){e.element.style.opacity=0,e.props.onHideDirentsDraggablePreview()},e.handleDragOver=function(t){if(f.c.isIEBrower())return!1;t.preventDefault(),t.dataTransfer.dropEffect="move",e.element.style.top=t.clientY+"px",e.element.style.left=t.clientX+"px"},e.handleDrop=function(t){e.element.style.opacity=0,e.props.onHideDirentsDraggablePreview()},e}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){document.addEventListener("dragover",this.handleDragOver),document.addEventListener("drop",this.handleDrop),document.addEventListener("dragend",this.handleDragEnd)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("dragover",this.handleDragOver),document.removeEventListener("drop",this.handleDrop),document.removeEventListener("dragend",this.handleDragEnd)}},{key:"render",value:function(){var e=this,t=this.props.selectedDirentList,n={position:"absolute",opacity:1,pointerEvents:"none",display:"block",left:"-9999px",top:"-9999px",zIndex:101,maxHeight:document.documentElement.clientHeight,overflow:"hidden"};return(0,m.jsx)("div",{style:n,ref:function(t){return e.element=t},children:t.map((function(e,t){var n=f.c.getDirentIcon(e);return(0,m.jsx)("div",{children:e.encoded_thumbnail_src?(0,m.jsx)("img",{src:"".concat(h.ze).concat(e.encoded_thumbnail_src),className:"thumbnail cursor-pointer",alt:""}):(0,m.jsx)("img",{src:n,width:"24",alt:""})},t)}))})}}]),n}(a.Component),Xu=$u,Ju=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).freezeItem=function(){o.setState({isItemFreezed:!0})},o.unfreezeItem=function(){o.setState({isItemFreezed:!1})},o.onItemRename=function(e,t){if(o.props.direntList.some((function(e){return e.name===t}))){var n=(0,h.ih)('The name "{name}" is already taken. Please choose a different name.');return n=n.replace("{name}",f.c.HTMLescape(t)),W.Z.danger(n),!1}o.props.onItemRename(e,t)},o.onItemRenameToggle=function(){o.freezeItem()},o.onItemSelected=function(e){o.setState({activeDirent:null}),o.props.onItemSelected(e)},o.onDirentClick=function(e){(0,qu.SC)(),o.props.selectedDirentList.length>0&&!o.state.activeDirent||(o.setState({activeDirent:e}),o.props.onDirentClick(e))},o.sortByName=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortItems("name",t)},o.sortByTime=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortItems("time",t)},o.sortBySize=function(e){e.preventDefault();var t="asc"==o.props.sortOrder?"desc":"asc";o.props.sortItems("size",t)},o.prepareImageItem=function(e){var t=e.name,n=o.props.repoID,r=f.c.encodePath(f.c.joinPath(o.props.path,t)),i="".concat(h.ze,"repo/").concat(n,"/raw").concat(r);return{name:t,url:"".concat(h.ze,"lib/").concat(n,"/file").concat(r),src:i}},o.showImagePopup=function(e){var t=o.props.fullDirentList.filter((function(e){return f.c.imageCheck(e.name)})),n=t.map((function(e){return o.prepareImageItem(e)}));o.setState({isImagePopupOpen:!0,imageItems:n,imageIndex:t.indexOf(e)})},o.moveToPrevImage=function(){var e=o.state.imageItems.length;o.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},o.moveToNextImage=function(){var e=o.state.imageItems.length;o.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},o.closeImagePopup=function(){o.setState({isImagePopupOpen:!1})},o.onCreateFileToggle=function(e){o.setState({isCreateFileDialogShow:!o.state.isCreateFileDialogShow,fileType:e||""})},o.onCreateFolderToggle=function(){o.setState({isCreateFolderDialogShow:!o.state.isCreateFolderDialogShow})},o.onAddFolder=function(e){o.setState({isCreateFolderDialogShow:!1}),o.props.onAddFolder(e)},o.checkDuplicatedName=function(e){return o.props.direntList.some((function(t){return t.name===e}))},o.onMoveToggle=function(){o.setState({isMoveDialogShow:!o.state.isMoveDialogShow})},o.onCopyToggle=function(){o.setState({isCopyDialogShow:!o.state.isCopyDialogShow})},o.onItemsDownload=function(){var e=o.props,t=e.path,n=e.repoID,r=e.selectedDirentList;if(r.length){if(1===r.length&&!r[0].isDir()){var i=f.c.joinPath(t,r[0].name),s=Hu.Z.getUrl({type:"download_file_url",repoID:n,filePath:i});return void(location.href=s)}var a=r.map((function(e){return e.name}));o.setState({isProgressDialogShow:!0,downloadItems:a})}},o.onCloseZipDownloadDialog=function(){o.setState({isProgressDialogShow:!1})},o.onMouseDown=function(e){2!==e.button||e.stopPropagation()},o.handleContextClick=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.preventDefault(),e.stopPropagation();var i=e.clientX||e.touches&&e.touches[0].pageX,s=e.clientY||e.touches&&e.touches[0].pageY;o.props.posX&&(i-=o.props.posX),o.props.posY&&(s-=o.props.posY),(0,qu.SC)();var a={id:t,position:{x:i,y:s},target:e.target,currentObject:r,menuList:n};0!==n.length&&(0,qu.AE)(a)},o.onContainerClick=function(){(0,qu.SC)(),o.state.activeDirent&&o.onDirentClick(null)},o.onContainerMouseDown=function(e){o.onMouseDown(e)},o.onContainerContextMenu=function(e){e.preventDefault();var t=o.props.userPerm,n=f.c.getUserPermission(o.props.userPerm),r=n.isCustomPermission,i=n.customPermission;if("admin"===t||"rw"===t||r){var s=ar.Z.NEW_FOLDER,a=ar.Z.NEW_FILE,l=ar.Z.NEW_MARKDOWN_FILE,c=ar.Z.NEW_EXCEL_FILE,d=ar.Z.NEW_POWERPOINT_FILE,u=ar.Z.NEW_WORD_FILE,p=ar.Z.NEW_SEADOC_FILE,m=[s,a,"Divider",l,c,d,u],g=o.props.currentRepoInfo;if(h.np&&!g.encrypted&&m.push(p),0===o.props.selectedDirentList.length){if(r)if(!i.permission.create)return;var v=m;o.handleContextClick(e,"dirent-container-menu",v)}else if(1===o.props.selectedDirentList.length)if(o.state.activeDirent){if(o.onDirentClick(null),e.preventDefault(),e.persist(),r)if(!i.permission.modify)return;setTimeout((function(){var t=m;o.handleContextClick(e,"dirent-container-menu",t)}),0)}else{var y=o.props.selectedDirentList[0],x=o.getDirentItemMenuList(y,!0);o.handleContextClick(e,"dirent-item-menu",x,y)}else{var w=[];if(r){var b=i.permission,S=b.modify,C=b.copy,D=b.download,k=b.delete;S&&w.push(ar.Z.MOVE),C&&w.push(ar.Z.COPY),D&&w.push(ar.Z.DOWNLOAD),k&&w.push(ar.Z.DELETE)}else w=[ar.Z.MOVE,ar.Z.COPY,ar.Z.DOWNLOAD,ar.Z.DELETE];o.handleContextClick(e,"dirents-menu",w)}}},o.onContainerMenuItemClick=function(e){switch(e){case"New Folder":o.onCreateFolderToggle();break;case"New File":o.onCreateFileToggle();break;case"New Markdown File":o.onCreateFileToggle(".md");break;case"New Excel File":o.onCreateFileToggle(".xlsx");break;case"New PowerPoint File":o.onCreateFileToggle(".pptx");break;case"New Word File":o.onCreateFileToggle(".docx");break;case"New SeaDoc File":o.onCreateFileToggle(".sdoc")}(0,qu.SC)()},o.onDirentsMenuItemClick=function(e){switch(e){case"Move":o.onMoveToggle();break;case"Copy":o.onCopyToggle();break;case"Download":o.onItemsDownload();break;case"Delete":o.props.onItemsDelete()}(0,qu.SC)()},o.onThreadMouseDown=function(e){o.onMouseDown(e)},o.onThreadContextMenu=function(e){e.stopPropagation()},o.onItemMouseDown=function(e){o.onMouseDown(e)},o.onItemContextMenu=function(e,t){if(!(o.props.selectedDirentList.length>1)){o.onDirentClick(t);var n=o.getDirentItemMenuList(t,!0);o.handleContextClick(e,"dirent-item-menu",n,t)}},o.setDirentItemRef=function(e){return function(t){o.direntItems[e]=t}},o.onMenuItemClick=function(e,t,n){var r=o.getDirentIndex(t);o.direntItems[r].onMenuItemClick(e,n),(0,qu.SC)()},o.onShowMenu=function(e){o.freezeItem()},o.onHideMenu=function(e){o.unfreezeItem()},o.getDirentIndex=function(e){for(var t=o.props.direntList,n=0,r=0;r<t.length;r++)if(t[r].name===e.name){n=r;break}return n},o.getDirentItemMenuList=function(e,t){var n=o.isRepoOwner,r=o.props.currentRepoInfo;return f.c.getDirentOperationList(n,r,e,t)},o.onTableDragEnter=function(e){if(f.c.isIEBrower()||!o.canDrop)return!1;if(o.enteredCounter++,0!==o.enteredCounter){if(o.state.isListDropTipShow)return;o.setState({isListDropTipShow:!0})}},o.onTableDragOver=function(e){if(f.c.isIEBrower()||!o.canDrop)return!1;"copy"!==e.dataTransfer.dropEffect&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},o.onTableDragLeave=function(e){if(f.c.isIEBrower()||!o.canDrop)return!1;o.enteredCounter--,0===o.enteredCounter&&o.setState({isListDropTipShow:!1})},o.tableDrop=function(e){if(f.c.isIEBrower()||!o.canDrop)return!1;if(e.persist(),o.enteredCounter=0,o.setState({isListDropTipShow:!1}),!e.dataTransfer.files.length){var t=e.dataTransfer.getData("applicaiton/drag-item-info"),n=t=JSON.parse(t),r=n.nodeDirent,i=n.nodeParentPath,s=n.nodeRootPath;Array.isArray(t)||s!==o.props.path&&i!==o.props.path&&-1===o.props.path.indexOf(s)&&o.props.onItemMove(o.props.currentRepoInfo,r,o.props.path,i)}},o.onShowDirentsDraggablePreview=function(){o.setState({isShowDirentsDraggablePreview:!0})},o.onHideDirentsDraggablePreview=function(){o.setState({isShowDirentsDraggablePreview:!1})},o.state={isItemFreezed:!1,isImagePopupOpen:!1,imageItems:[],imageIndex:0,fileType:"",isCreateFileDialogShow:!1,isCreateFolderDialogShow:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isProgressDialogShow:!1,downloadItems:[],isMutipleOperation:!0,activeDirent:null,isListDropTipShow:!1,isShowDirentsDraggablePreview:!1},o.enteredCounter=0,o.isRepoOwner=e.currentRepoInfo.owner_email===h.b6,o.isAdmin=e.currentRepoInfo.is_admin,o.repoEncrypted=e.currentRepoInfo.encrypted,o.clickedDirent=null,o.direntItems=[],o.currentItemRef=null,o.zipToken=null;var i=e.userPerm;o.canDrop="rw"===i;var s=f.c.getUserPermission(i),a=s.isCustomPermission,l=s.customPermission;if(a){var c=l.permission.modify;o.canDrop=c}return o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.direntList,r=t.sortBy,o=t.sortOrder;if(this.props.isDirentListLoading)return(0,m.jsx)(D.Z,{});var i="name"==r,s="time"==r,l="size"==r,c="asc"==o?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),d=f.c.isDesktop();return(0,m.jsxs)("div",{className:"table-container ".concat(this.state.isListDropTipShow&&this.canDrop?"table-drop-active":""),onMouseDown:this.onContainerMouseDown,onContextMenu:this.onContainerContextMenu,onClick:this.onContainerClick,onDragEnter:this.onTableDragEnter,onDragOver:this.onTableDragOver,onDragLeave:this.onTableDragLeave,onDrop:this.tableDrop,children:[(0,m.jsxs)("table",{className:"table-hover ".concat(d?"":"table-thead-hidden"),children:[d?(0,m.jsx)("thead",{onMouseDown:this.onThreadMouseDown,onContextMenu:this.onThreadContextMenu,children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"3%",className:"pl10",children:(0,m.jsx)("input",{type:"checkbox",className:"vam",onChange:this.props.onAllItemSelected,checked:this.props.isAllItemSelected,"aria-label":this.props.isAllItemSelected?(0,h.ih)("Unselect all items"):(0,h.ih)("Select all items")})}),(0,m.jsx)("th",{width:"3%",className:"pl10"}),(0,m.jsx)("th",{width:"5%",className:"pl10"}),(0,m.jsx)("th",{width:"39%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,h.ih)("Name")," ",i&&c]})}),(0,m.jsx)("th",{width:"6%"}),(0,m.jsx)("th",{width:"18%"}),(0,m.jsx)("th",{width:"11%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize,children:[(0,h.ih)("Size")," ",l&&c]})}),(0,m.jsx)("th",{width:"15%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,h.ih)("Last Update")," ",s&&c]})})]})}):(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:n.map((function(t,n){return(0,m.jsx)(Wu,{ref:e.setDirentItemRef(n),dirent:t,path:e.props.path,repoID:e.props.repoID,currentRepoInfo:e.props.currentRepoInfo,isAdmin:e.isAdmin,isRepoOwner:e.isRepoOwner,repoEncrypted:e.repoEncrypted,enableDirPrivateShare:e.props.enableDirPrivateShare,isGroupOwnedRepo:e.props.isGroupOwnedRepo,onItemClick:e.props.onItemClick,onItemRenameToggle:e.onItemRenameToggle,onItemSelected:e.onItemSelected,onItemDelete:e.props.onItemDelete,onItemRename:e.onItemRename,onItemMove:e.props.onItemMove,onItemCopy:e.props.onItemCopy,onItemConvert:e.props.onItemConvert,updateDirent:e.props.updateDirent,isItemFreezed:e.state.isItemFreezed,freezeItem:e.freezeItem,unfreezeItem:e.unfreezeItem,onDirentClick:e.onDirentClick,showImagePopup:e.showImagePopup,onItemMouseDown:e.onItemMouseDown,onItemContextMenu:e.onItemContextMenu,selectedDirentList:e.props.selectedDirentList,activeDirent:e.state.activeDirent,repoTags:e.props.repoTags,onFileTagChanged:e.props.onFileTagChanged,getDirentItemMenuList:e.getDirentItemMenuList,showDirentDetail:e.props.showDirentDetail,onItemsMove:e.props.onItemsMove,onShowDirentsDraggablePreview:e.onShowDirentsDraggablePreview,loadDirentList:e.props.loadDirentList},n)}))})]}),(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(Ku.Z,{id:"dirent-container-menu",onMenuItemClick:this.onContainerMenuItemClick}),(0,m.jsx)(Ku.Z,{id:"dirent-item-menu",onMenuItemClick:this.onMenuItemClick,onShowMenu:this.onShowMenu,onHideMenu:this.onHideMenu}),(0,m.jsx)(Ku.Z,{id:"dirents-menu",onMenuItemClick:this.onDirentsMenuItemClick}),this.state.isShowDirentsDraggablePreview&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Xu,{selectedDirentList:this.props.selectedDirentList,onHideDirentsDraggablePreview:this.onHideDirentsDraggablePreview,dragStartPosition:this.state.dragStartPosition})}),this.state.isImagePopupOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(So.Z,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})}),this.state.isCreateFolderDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Wn.Z,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})}),this.state.isCreateFileDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Kn.Z,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onCreateFileToggle})}),this.state.isMoveDialogShow&&(0,m.jsx)(bo,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMutipleOperation:this.state.isMutipleOperation,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle}),this.state.isCopyDialogShow&&(0,m.jsx)(wo,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,selectedDirentList:this.props.selectedDirentList,isMutipleOperation:this.state.isMutipleOperation,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isProgressDialogShow&&(0,m.jsx)(Yu.Z,{repoID:this.props.repoID,path:this.props.path,target:this.state.downloadItems,toggleDialog:this.onCloseZipDownloadDialog})]})]})}}]),n}(a.Component),Qu=Ju,ep=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){return"/"===this.props.path&&0===this.props.direntList.length?(0,m.jsx)(Bu,{path:this.props.path,isDirentListLoading:this.props.isDirentListLoading,onAddFile:this.props.onAddFile,currentRepoInfo:this.props.currentRepoInfo}):(0,m.jsxs)(a.Fragment,{children:[this.props.isRepoInfoBarShow&&(0,m.jsx)(Gu.Z,{repoID:this.props.repoID,currentPath:this.props.path,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged}),(0,m.jsx)(Qu,{path:this.props.path,currentRepoInfo:this.props.currentRepoInfo,repoID:this.props.repoID,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onItemClick:this.props.onItemClick,onItemSelected:this.props.onItemSelected,onItemDelete:this.props.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onDirentClick:this.props.onDirentClick,isDirentListLoading:this.props.isDirentListLoading,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllItemSelected,onAllItemSelected:this.props.onAllItemSelected,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemConvert:this.props.onItemConvert,onItemsDelete:this.props.onItemsDelete,onAddFile:this.props.onAddFile,onAddFolder:this.props.onAddFolder,repoTags:this.props.repoTags,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail,loadDirentList:this.props.loadDirentList})]})}}]),n}(a.Component),tp=ep,np=n(92534),rp=n.n(np),op=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).onItemMove=function(e,t,n,r){o.props.onItemMove(e,t,n,r)},o.onItemClick=function(e){e.preventDefault(),e.stopPropagation();var t=o.props,n=t.dirent,r=t.activeDirent;n.isDir()?o.props.onItemClick(n):o.canPreview&&(n===r?(o.setState({isGridSelected:!1}),f.c.imageCheck(n.name)?o.props.showImagePopup(n):o.props.onItemClick(n)):(o.setState({isGridSelected:!1}),o.props.onGridItemClick(o.props.dirent)))},o.onItemLinkClick=function(e){e.preventDefault();var t=o.props.dirent;t.isDir()?o.props.onItemClick(t):o.canPreview&&(f.c.imageCheck(t.name)?o.props.showImagePopup(t):o.props.onItemClick(t))},o.onGridItemDragStart=function(e){if(f.c.isIEBrower()||!o.canDrag)return!1;var t={nodeDirent:o.props.dirent,nodeParentPath:o.props.path};t=JSON.stringify(t),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("applicaiton/drag-item-info",t)},o.onGridItemDragEnter=function(e){if(f.c.isIEBrower()||!o.canDrag)return!1;"dir"===o.props.dirent.type&&o.setState({isGridDropTipShow:!0})},o.onGridItemDragOver=function(e){if(f.c.isIEBrower()||!o.canDrag)return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},o.onGridItemDragLeave=function(e){if(f.c.isIEBrower()||!o.canDrag)return!1;o.setState({isGridDropTipShow:!1})},o.onGridItemDragDrop=function(e){if(f.c.isIEBrower()||!o.canDrag)return!1;if(o.setState({isGridDropTipShow:!1}),!e.dataTransfer.files.length){var t=e.dataTransfer.getData("applicaiton/drag-item-info"),n=t=JSON.parse(t),r=n.nodeDirent,i=n.nodeParentPath,s=o.props.dirent;if(r.name!==s.name&&"dir"===s.type){var a=f.c.joinPath(o.props.path,o.props.dirent.name);o.onItemMove(o.props.currentRepoInfo,r,a,i)}}},o.onGridItemMouseDown=function(e){o.props.onGridItemMouseDown(e)},o.getFileUrl=function(e){var t=e.split("/");return-1!==t.indexOf("48")&&t.splice(t.indexOf("48"),1,"192"),t.join("/")},o.onGridItemContextMenu=function(e){var t=o.props.dirent;o.props.onGridItemContextMenu(e,t)},o.state={isGridSelected:!1,isGridDropTipShow:!1};var i=o.props.dirent,s=f.c.getUserPermission(i.permission),a=s.isCustomPermission,l=s.customPermission;if(o.isCustomPermission=a,o.customPermission=l,o.canPreview=!0,o.canDrag="rw"===i.permission,a){var c=l.permission,d=c.preview,u=c.modify;o.canPreview=d||u,o.canDrag=u}return o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;this.setState({isGridSelected:!1},(function(){e.activeDirent&&e.activeDirent.name===e.dirent.name&&t.setState({isGridSelected:!0})}))}},{key:"render",value:function(){var e=this.props,t=e.dirent,n=e.path,r=f.c.joinPath(n,t.name),o=f.c.getDirentIcon(t,!0),i=t.encoded_thumbnail_src?this.getFileUrl(t.encoded_thumbnail_src):"",s="",l="";t.file_tags&&t.file_tags.length>0&&(s=rp()(t.name).slice(0,7),l=t.file_tags.map((function(e){return e.name})).join(" "));var c="";this.props.currentRepoInfo&&(c=h.ze+"library/"+this.props.repoID+"/"+this.props.currentRepoInfo.repo_name+f.c.encodePath(r));var d=h.ze+"lib/"+this.props.repoID+"/file"+f.c.encodePath(r);t.is_sdoc_revision&&t.revision_id&&(d=h.ze+"lib/"+this.props.repoID+"/revisions/"+t.revision_id+"/");var u="grid-file-img-link cursor-pointer";u+=this.state.isGridSelected?" grid-selected-active":" ",u+=this.state.isGridDropTipShow?" grid-drop-show":" ";var p=t.is_freezed?(0,h.ih)("Frozen by {name}"):(0,h.ih)("locked by {name}");p=p.replace("{name}",t.lock_owner_name);var g="".concat(h.si,"img/file-").concat(t.is_freezed?"freezed":"locked","-32.png"),v=t.is_freezed?(0,h.ih)("freezed"):(0,h.ih)("locked");return(0,m.jsx)(a.Fragment,{children:(0,m.jsxs)("li",{className:"grid-item",onContextMenu:this.onGridItemContextMenu,onMouseDown:this.onGridItemMouseDown,children:[(0,m.jsxs)("div",{className:u,draggable:this.canDrag,onClick:this.onItemClick,onDragStart:this.onGridItemDragStart,onDragEnter:this.onGridItemDragEnter,onDragOver:this.onGridItemDragOver,onDragLeave:this.onGridItemDragLeave,onDrop:this.onGridItemDragDrop,children:[this.canPreview&&t.encoded_thumbnail_src?(0,m.jsx)("img",{src:"".concat(h.ze).concat(i),ref:this.gridIcon,className:"thumbnail",onClick:this.onItemClick,alt:""}):(0,m.jsx)("img",{src:o,ref:this.gridIcon,width:"96",alt:""}),t.is_locked&&(0,m.jsx)("img",{className:"grid-file-locked-icon",src:g,alt:v,title:p})]}),(0,m.jsxs)("div",{className:"grid-file-name",onDragStart:this.onGridItemDragStart,draggable:this.canDrag,children:["dir"!==t.type&&t.file_tags&&t.file_tags.length>0&&(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("div",{id:"tag-list-title-".concat(s),className:"dirent-item tag-list tag-list-stacked d-inline-block align-middle",children:t.file_tags.map((function(e,n){var r=t.file_tags.length;return(0,m.jsx)("span",{className:"file-tag",style:{zIndex:r-n,backgroundColor:e.color}},e.id)}))}),(0,m.jsx)(Oe.Z,{target:"tag-list-title-".concat(s),placement:"bottom",children:l})]}),t.isDir()||this.canPreview?(0,m.jsx)("a",{className:"grid-file-name-link ".concat(this.state.isGridSelected?"grid-link-selected-active":""),href:"dir"===t.type?c:d,onClick:this.onItemLinkClick,children:t.name}):(0,m.jsx)("a",{className:"sf-link grid-file-name-link ".concat(this.state.isGridSelected?"grid-link-selected-active":""),onClick:this.onItemLinkClick,children:t.name})]})]})})}}]),n}(a.Component),ip=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleChange=function(e){e.target.value.trim()?o.setState({isSubmitBtnActive:!0}):o.setState({isSubmitBtnActive:!1}),o.setState({newName:e.target.value})},o.handleSubmit=function(){var e=o.validateInput(),t=e.isValid,n=e.errMessage;if(t)if(o.checkDuplicatedName()){var r=(0,h.ih)('The name "{name}" is already taken. Please choose a different name.');r=r.replace("{name}",f.c.HTMLescape(o.state.newName)),o.setState({errMessage:r})}else o.props.onRename(o.state.newName),o.props.toggleCancel();else o.setState({errMessage:n})},o.handleKeyDown=function(e){"Enter"===e.key&&o.handleSubmit()},o.toggle=function(){o.props.toggleCancel()},o.changeState=function(e){var t=e.name;o.setState({newName:t})},o.validateInput=function(){var e=o.state.newName.trim(),t=!0,n="";return e?e.indexOf("/")>-1?{isValid:t=!1,errMessage:n=(0,h.ih)("Name should not include '/'.")}:{isValid:t,errMessage:n}:{isValid:t=!1,errMessage:n=(0,h.ih)("Name is required.")}},o.checkDuplicatedName=function(){return o.props.checkDuplicatedName(o.state.newName)},o.onAfterModelOpened=function(){if(o.newInput.current){o.newInput.current.focus();var e=o.props.dirent;if("file"===e.type){var t=e.name.lastIndexOf(".md");o.newInput.current.setSelectionRange(0,t,"forward")}else o.newInput.current.setSelectionRange(0,-1)}},o.state={newName:"",errMessage:"",isSubmitBtnActive:!1},o.newInput=a.createRef(),o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({newName:this.props.dirent.name})}},{key:"componentDidMount",value:function(){var e=this.props.dirent;this.changeState(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.changeState(e.dirent)}},{key:"render",value:function(){var e=this.props.dirent.type;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.toggle,onOpened:this.onAfterModelOpened,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:"file"===e?(0,h.ih)("Rename File"):(0,h.ih)("Rename Folder")}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)("p",{children:"file"===e?(0,h.ih)("New file name"):(0,h.ih)("New folder name")}),(0,m.jsx)(L.Z,{onKeyDown:this.handleKeyDown,innerRef:this.newInput,value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&(0,m.jsx)(st.Z,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggle,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),sp=ip,ap=(n(62012),function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onCreateFileToggle=function(e){o.setState({isCreateFileDialogShow:!o.state.isCreateFileDialogShow,fileType:e||""})},o.onGridItemClick=function(e){(0,qu.SC)(),o.setState({activeDirent:e}),o.props.onGridItemClick(e)},o.onMoveToggle=function(){o.setState({isMoveDialogShow:!o.state.isMoveDialogShow})},o.onCopyToggle=function(){o.setState({isCopyDialogShow:!o.state.isCopyDialogShow})},o.onAddFolder=function(e){o.setState({isCreateFolderDialogShow:!1}),o.props.onAddFolder(e)},o.onItemShare=function(e){e.nativeEvent.stopImmediatePropagation(),o.setState({isShareDialogShow:!o.state.isShareDialogShow})},o.closeSharedDialog=function(){o.setState({isShareDialogShow:!o.state.isShareDialogShow})},o.onItemDelete=function(e,t){t.nativeEvent.stopImmediatePropagation(),o.props.onItemDelete(e)},o.onItemConvert=function(e,t,n){t.nativeEvent.stopImmediatePropagation(),o.props.onItemConvert(e,n)},o.exportDocx=function(){var e=window.app.config.serviceURL+"/repo/sdoc_export_to_docx/"+o.props.repoID+"/?file_path="+o.getDirentPath(o.props.dirent);window.location.href=e},o.onMenuItemClick=function(e,t,n){switch((0,qu.SC)(),e){case"Download":o.onItemDownload(t,n);break;case"Share":o.onItemShare(n);break;case"Delete":o.onItemDelete(t,n);break;case"Rename":o.onItemRenameToggle();break;case"Move":o.onItemMoveToggle();break;case"Copy":o.onItemCopyToggle();break;case"Unfreeze Document":case"Unlock":o.onUnlockItem(t);break;case"Freeze Document":o.onFreezeDocument(t);break;case"Convert to Markdown":o.onItemConvert(t,n,"markdown");break;case"Convert to docx":o.onItemConvert(t,n,"docx");break;case"Export docx":o.exportDocx();break;case"Convert to sdoc":o.onItemConvert(t,n,"sdoc");break;case"Tags":o.onEditFileTagToggle();break;case"Permission":o.onPermissionItem();break;case"Lock":o.onLockItem(t);break;case"History":o.onHistory(t);break;case"New Folder":o.onCreateFolderToggle(t);break;case"New File":o.onCreateFileToggle("");break;case"New Markdown File":o.onCreateFileToggle(".md");break;case"New Excel File":o.onCreateFileToggle(".xlsx");break;case"New PowerPoint File":o.onCreateFileToggle(".pptx");break;case"New Word File":o.onCreateFileToggle(".docx");break;case"New SeaDoc File":o.onCreateFileToggle(".sdoc");break;case"Access Log":o.onAccessLog(t);break;case"Properties":o.props.showDirentDetail("info");break;case"Open via Client":o.onOpenViaClient(t)}},o.onEditFileTagToggle=function(){o.setState({isEditFileTagShow:!o.state.isEditFileTagShow})},o.onFileTagChanged=function(){var e=o.state.activeDirent?o.state.activeDirent:"",t=f.c.joinPath(o.props.path,e.name);o.props.onFileTagChanged(e,t)},o.getDirentPath=function(e){var t=o.props.path;return"/"===t?t+e.name:t+"/"+e.name},o.closeZipDialog=function(){o.setState({isZipDialogOpen:!1})},o.onItemDownload=function(e,t){t.nativeEvent.stopImmediatePropagation();var n=e,r=o.props.repoID,i=o.getDirentPath(n);if("dir"===n.type)o.setState({isZipDialogOpen:!0});else{var s=Hu.Z.getUrl({type:"download_file_url",repoID:r,filePath:i});location.href=s}},o.onCreateFolderToggle=function(){o.setState({isCreateFolderDialogShow:!o.state.isCreateFolderDialogShow})},o.onItemRenameToggle=function(){o.setState({isRenameDialogShow:!o.state.isRenameDialogShow})},o.onItemMoveToggle=function(){o.setState({isMoveDialogShow:!o.state.isMoveDialogShow})},o.onItemCopyToggle=function(){o.setState({isCopyDialogShow:!o.state.isCopyDialogShow})},o.onPermissionItem=function(){o.setState({isPermissionDialogOpen:!o.state.isPermissionDialogOpen})},o.onLockItem=function(e){var t=o.props.repoID,n=o.getDirentPath(e);C.I.lockfile(t,n).then((function(){o.props.updateDirent(e,"is_locked",!0),o.props.updateDirent(e,"locked_by_me",!0);var t=h.b6.split("@");o.props.updateDirent(e,"lock_owner_name",t[0])})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onFreezeDocument=function(e){var t=o.props.repoID,n=o.getDirentPath(e);C.I.lockfile(t,n,-1).then((function(){o.props.updateDirent(e,"is_freezed",!0),o.props.updateDirent(e,"is_locked",!0),o.props.updateDirent(e,"locked_by_me",!0);var t=h.b6.split("@");o.props.updateDirent(e,"lock_owner_name",t[0])})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onUnlockItem=function(e){var t=o.props.repoID,n=o.getDirentPath(e);C.I.unlockfile(t,n).then((function(){o.props.updateDirent(e,"is_locked",!1),o.props.updateDirent(e,"locked_by_me",!1),o.props.updateDirent(e,"lock_owner_name","")})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onHistory=function(e){var t=o.props.repoID,n=o.getDirentPath(e),r=Hu.Z.getUrl({type:"file_revisions",repoID:t,filePath:n});location.href=r},o.onAccessLog=function(e){var t=o.getDirentPath(e),n=h.ze+"repo/file-access/"+o.props.repoID+"/?p="+encodeURIComponent(t);window.open(n)},o.onOpenViaClient=function(e){var t=o.props.repoID,n=o.getDirentPath(e),r=Hu.Z.getUrl({type:"open_via_client",repoID:t,filePath:n});location.href=r},o.onItemRename=function(e){o.props.onItemRename(o.state.activeDirent,e)},o.prepareImageItem=function(e){var t=e.name,n=o.props.repoID,r=f.c.encodePath(f.c.joinPath(o.props.path,t)),i="".concat(h.ze,"repo/").concat(n,"/raw").concat(r);return{name:t,url:"".concat(h.ze,"lib/").concat(n,"/file").concat(r),src:i}},o.showImagePopup=function(e){var t=o.props.fullDirentList.filter((function(e){return f.c.imageCheck(e.name)})),n=t.map((function(e){return o.prepareImageItem(e)}));o.setState({isImagePopupOpen:!0,imageItems:n,imageIndex:t.indexOf(e)})},o.closeImagePopup=function(){o.setState({isImagePopupOpen:!1})},o.moveToPrevImage=function(){var e=o.state.imageItems.length;o.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},o.moveToNextImage=function(){var e=o.state.imageItems.length;o.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},o.checkDuplicatedName=function(e){return f.c.checkDuplicatedNameInList(o.props.direntList,e)},o.onMouseDown=function(e){e.stopPropagation(),e.button},o.onGridContainerMouseDown=function(e){o.onMouseDown(e)},o.onGridItemMouseDown=function(e){o.onMouseDown(e)},o.gridContainerClick=function(){(0,qu.SC)(),o.props.isDirentDetailShow||o.onGridItemClick(null)},o.onGridContainerContextMenu=function(e){e.preventDefault();var t=o.props.userPerm;if("admin"===t||"rw"===t){var n=ar.Z.NEW_FOLDER,r=ar.Z.NEW_FILE,i=ar.Z.NEW_MARKDOWN_FILE,s=ar.Z.NEW_EXCEL_FILE,a=ar.Z.NEW_POWERPOINT_FILE,l=ar.Z.NEW_WORD_FILE,c=ar.Z.NEW_SEADOC_FILE,d=[n,r,"Divider",i,s,a,l],u=o.props.currentRepoInfo;h.np&&!u.encrypted&&d.push(c),o.handleContextClick(e,"dirent-grid-container-menu",d)}},o.onGridItemContextMenu=function(e,t){var n=o.getDirentItemMenuList(t,!0);o.handleContextClick(e,"grid-item-contextmenu",n,t),o.props.onGridItemClick&&o.props.onGridItemClick(t)},o.handleContextClick=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.preventDefault(),e.stopPropagation();var i=e.clientX||e.touches&&e.touches[0].pageX,s=e.clientY||e.touches&&e.touches[0].pageY;o.props.posX&&(i-=o.props.posX),o.props.posY&&(s-=o.props.posY),(0,qu.SC)(),o.setState({activeDirent:r});var a={id:t,position:{x:i,y:s},target:e.target,currentObject:r,menuList:n};0!==n.length&&(0,qu.AE)(a)},o.getDirentItemMenuList=function(e,t){var n=o.isRepoOwner,r=o.props.currentRepoInfo;return f.c.getDirentOperationList(n,r,e,t)},o.state={isImagePopupOpen:!1,imageItems:[],imageIndex:0,isShareDialogShow:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isEditFileTagShow:!1,isZipDialogOpen:!1,isRenameDialogShow:!1,isCreateFolderDialogShow:!1,isCreateFileDialogShow:!1,fileType:"",isPermissionDialogOpen:!1,isMutipleOperation:!1,isGridItemFreezed:!1,activeDirent:null},o.isRepoOwner=e.currentRepoInfo.owner_email===h.b6,o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.direntList,r=t.path,o=this.state.activeDirent?this.state.activeDirent:"",i=f.c.joinPath(r,o.name);return this.props.isDirentListLoading?(0,m.jsx)(D.Z,{}):(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("ul",{className:"grid-view",onClick:this.gridContainerClick,onContextMenu:this.onGridContainerContextMenu,onMouseDown:this.onGridContainerMouseDown,children:0!==n.length&&n.map((function(t,n){return(0,m.jsx)(op,{dirent:t,repoID:e.props.repoID,path:e.props.path,onItemClick:e.props.onItemClick,currentRepoInfo:e.props.currentRepoInfo,showImagePopup:e.showImagePopup,onGridItemContextMenu:e.onGridItemContextMenu,onItemMove:e.props.onItemMove,onGridItemMouseDown:e.onGridItemMouseDown,onGridItemClick:e.onGridItemClick,activeDirent:e.state.activeDirent},n)}))}),(0,m.jsx)(Ku.Z,{id:"grid-item-contextmenu",onMenuItemClick:this.onMenuItemClick}),(0,m.jsx)(Ku.Z,{id:"dirent-grid-container-menu",onMenuItemClick:this.onMenuItemClick}),this.state.isCreateFolderDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Wn.Z,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})}),this.state.isCreateFileDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Kn.Z,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onCreateFileToggle})}),this.state.isMoveDialogShow&&(0,m.jsx)(bo,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMutipleOperation:this.state.isMutipleOperation,onItemMove:this.props.onItemMove,onCancelMove:this.onMoveToggle,dirent:this.state.activeDirent}),this.state.isZipDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Yu.Z,{repoID:this.props.repoID,path:this.props.path,target:o.name,toggleDialog:this.closeZipDialog})}),this.state.isCopyDialogShow&&(0,m.jsx)(wo,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMutipleOperation:this.state.isMutipleOperation,onItemCopy:this.props.onItemCopy,onCancelCopy:this.onCopyToggle,dirent:this.state.activeDirent}),this.state.isEditFileTagShow&&(0,m.jsx)(nr,{repoID:this.props.repoID,fileTagList:o.file_tags,filePath:i,toggleCancel:this.onEditFileTagToggle,repoTags:this.props.repoTags,onFileTagChanged:this.onFileTagChanged}),this.state.isShareDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Te.Z,{itemType:o.type,itemName:o.name,itemPath:i,userPerm:o.permission,repoID:this.props.repoID,repoEncrypted:!1,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.closeSharedDialog})}),this.state.isRenameDialogShow&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(sp,{dirent:this.state.activeDirent,onRename:this.onItemRename,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.onItemRenameToggle})}),this.state.isPermissionDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Pt,{toggleDialog:this.onPermissionItem,repoID:this.props.repoID,folderPath:i,folderName:o.name,isDepartmentRepo:this.props.isGroupOwnedRepo})}),this.state.isImagePopupOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(So.Z,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})})]})}}]),n}(a.Component)),lp=ap,cp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){return"/"===this.props.path&&0===this.props.direntList.length?(0,m.jsx)(Bu,{path:this.props.path,isDirentListLoading:this.props.isDirentListLoading,onAddFile:this.props.onAddFile,currentRepoInfo:this.props.currentRepoInfo}):(0,m.jsxs)(a.Fragment,{children:[this.props.isRepoInfoBarShow&&(0,m.jsx)(Gu.Z,{repoID:this.props.repoID,currentPath:this.props.path,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged}),(0,m.jsx)(lp,{path:this.props.path,repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,onAddFile:this.props.onAddFile,onItemClick:this.props.onItemClick,onItemDelete:this.props.onItemDelete,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,isDirentListLoading:this.props.isDirentListLoading,updateDirent:this.props.updateDirent,onRenameNode:this.props.onRenameNode,showDirentDetail:this.props.showDirentDetail,onGridItemClick:this.props.onGridItemClick,isDirentDetailShow:this.props.isDirentDetailShow,onItemRename:this.props.onItemRename,onAddFolder:this.props.onAddFolder,repoTags:this.props.repoTags,onFileTagChanged:this.props.onFileTagChanged})]})}}]),n}(a.Component),dp=cp,up=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onResizeMouseUp=function(){o.state.inResizing&&o.setState({inResizing:!1}),o.setCookie("navRate",o.state.navRate)},o.onResizeMouseDown=function(){o.containerWidth=o.refs.viewModeContainer.clientWidth,o.setState({inResizing:!0})},o.onResizeMouseMove=function(e){var t=o.containerWidth/.78*.22+3,n=(e.nativeEvent.clientX-t)/o.containerWidth;n<.1?o.setState({inResizing:!1,navRate:.12}):n>.4?o.setState({inResizing:!1,navRate:.38}):o.setState({navRate:n})},o.setCookie=function(e,t){var n=e+"="+t+";";document.cookie=n},o.getCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0,o=n.length;r<o;r++){var i=n[r].trim();if(0==i.indexOf(t))return 1*i.substring(t.length,i.length)}return""},o.state={inResizing:!1,navRate:.25},o.containerWidth=null,o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){var e=this.getCookie("navRate");e&&this.setState({navRate:e})}},{key:"render",value:function(){var e=this.props,t=e.currentMode,n=e.isTreePanelShown,r=this.state.inResizing?this.onResizeMouseMove:null,o=this.state.inResizing?"none":"",i="1 0 "+100*(1-this.state.navRate-.05)+"%";return(0,m.jsxs)("div",{className:"dir-colunm-view",onMouseMove:r,onMouseUp:this.onResizeMouseUp,ref:"viewModeContainer",children:[n&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Lu,{currentPath:this.props.path,userPerm:this.props.userPerm,isTreeDataLoading:this.props.isTreeDataLoading,treeData:this.props.treeData,currentNode:this.props.currentNode,onNodeClick:this.props.onNodeClick,onNodeCollapse:this.props.onNodeCollapse,onNodeExpanded:this.props.onNodeExpanded,onAddFolderNode:this.props.onAddFolderNode,onAddFileNode:this.props.onAddFileNode,onRenameNode:this.props.onRenameNode,onDeleteNode:this.props.onDeleteNode,repoID:this.props.repoID,navRate:this.state.navRate,inResizing:this.state.inResizing,currentRepoInfo:this.props.currentRepoInfo,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove}),(0,m.jsx)("div",{className:"dir-content-resize",onMouseDown:this.onResizeMouseDown})]}),(0,m.jsx)("div",{className:"dir-content-main",style:{userSelect:o,flex:i},onScroll:this.props.isViewFile?function(){}:this.props.onItemsScroll,children:this.props.isViewFile?(0,m.jsx)(zu,{path:this.props.path,repoID:this.props.repoID,hash:this.props.hash,isFileLoading:this.props.isFileLoading,isFileLoadedErr:this.props.isFileLoadedErr,filePermission:this.props.filePermission,content:this.props.content,currentRepoInfo:this.props.currentRepoInfo,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick}):"list"==t?(0,m.jsx)(tp,{path:this.props.path,repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,isRepoInfoBarShow:this.props.isRepoInfoBarShow,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onItemClick:this.props.onItemClick,onItemSelected:this.props.onItemSelected,onItemDelete:this.props.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,onDirentClick:this.props.onDirentClick,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllItemSelected,onAllItemSelected:this.props.onAllItemSelected,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,repoTags:this.props.repoTags,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail}):(0,m.jsx)(dp,{path:this.props.path,repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,onRenameNode:this.props.onRenameNode,isRepoInfoBarShow:this.props.isRepoInfoBarShow,repoTags:this.props.repoTags,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,onAddFile:this.props.onAddFile,onItemClick:this.props.onItemClick,onItemDelete:this.props.onItemDelete,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,updateDirent:this.props.updateDirent,onAddFolder:this.props.onAddFolder,showDirentDetail:this.props.showDirentDetail,onGridItemClick:this.props.onDirentClick,isDirentDetailShow:this.props.isDirentDetailShow,onItemRename:this.props.onItemRename,onFileTagChanged:this.props.onFileTagChanged})})]})}}]),n}(a.Component),pp=up,hp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMoveToggle=function(){o.setState({isMoveDialogShow:!o.state.isMoveDialogShow})},o.onCopyToggle=function(){o.setState({isCopyDialogShow:!o.state.isCopyDialogShow})},o.onItemsDelete=function(){o.props.onItemsDelete()},o.onItemsDownload=function(){var e=o.props,t=e.path,n=e.repoID,r=e.selectedDirentList;if(r.length){if(1===r.length&&!r[0].isDir()){var i=f.c.joinPath(t,r[0].name),s=Hu.Z.getUrl({type:"download_file_url",repoID:n,filePath:i});return void(location.href=s)}if(h.Zb){var a=o.props.selectedDirentList.map((function(e){return e.name}));C.I.zipDownload(n,t,a).then((function(e){var t=e.data.zip_token;location.href="".concat(h.gc,"zip/").concat(t)})).catch((function(e){var t=f.c.getErrorMsg(e);o.setState({isLoading:!1,errorMsg:t})}))}else o.setState({isZipDialogOpen:!0})}},o.closeZipDialog=function(){o.setState({isZipDialogOpen:!1})},o.checkDuplicatedName=function(e){return f.c.checkDuplicatedNameInList(o.props.direntList,e)},o.onItemRename=function(e){var t=o.props.selectedDirentList[0];o.props.onItemRename(t,e)},o.onPermissionItem=function(){o.setState({showLibContentViewDialogs:!o.state.showLibContentViewDialogs,isPermissionDialogOpen:!o.state.isPermissionDialogOpen})},o.onStartRevise=function(e){var t=o.props.repoID,n=o.getDirentPath(e);C.I.sdocStartRevise(t,n).then((function(e){var n=h.ze+"lib/"+t+"/file"+f.c.encodePath(e.data.file_path);window.open(n)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.getDirentMenuList=function(e){var t=o.props.isRepoOwner,n=o.props.currentRepoInfo,r=f.c.getDirentOperationList(t,n,e,!0),i=["Move","Copy","Delete","Download"];return r="dir"==e.type?r.filter((function(e,t){return-1==i.indexOf(e.key)&&"Divider"!=e})):r.filter((function(e,t){return-1==i.indexOf(e.key)}))},o.onMenuItemClick=function(e){var t=o.props.selectedDirentList[0];switch(e){case"Share":o.setState({showLibContentViewDialogs:!0,showShareDialog:!0});break;case"Rename":o.setState({showLibContentViewDialogs:!0,isRenameDialogOpen:!0});break;case"Permission":o.onPermissionItem();break;case"Tags":o.listFileTags(t);break;case"Lock":o.lockFile(t);break;case"Unlock":o.unlockFile(t);break;case"History":o.onHistory(t);break;case"Access Log":o.onAccessLog(t);break;case"Properties":o.props.showDirentDetail("info");break;case"Open via Client":o.onOpenViaClient(t)}},o.lockFile=function(e){var t=o.getDirentPath(e);C.I.lockfile(o.props.repoID,t).then((function(t){t.data.is_locked&&(o.props.updateDirent(e,"is_locked",!0),o.props.updateDirent(e,"locked_by_me",!0),o.props.updateDirent(e,"lock_owner_name",h.u2),o.props.unSelectDirent())})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.unlockFile=function(e){var t=o.getDirentPath(e);C.I.unlockfile(o.props.repoID,t).then((function(t){t.data.is_locked||(o.props.updateDirent(e,"is_locked",!1),o.props.updateDirent(e,"locked_by_me",!1),o.props.updateDirent(e,"lock_owner_name",""),o.props.unSelectDirent())})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onOpenViaClient=function(e){var t=o.getDirentPath(e),n=Hu.Z.getUrl({type:"open_via_client",repoID:o.props.repoID,filePath:t});location.href=n},o.onHistory=function(e){var t=o.getDirentPath(e),n=Hu.Z.getUrl({type:"file_revisions",repoID:o.props.repoID,filePath:t});location.href=n},o.onAccessLog=function(e){var t=o.getDirentPath(e),n=h.ze+"repo/file-access/"+o.props.repoID+"/?p="+encodeURIComponent(t);window.open(n)},o.toggleCancel=function(){o.setState({showLibContentViewDialogs:!1,showShareDialog:!1,showEditFileTagDialog:!1,isRenameDialogOpen:!1,isPermissionDialogOpen:!1})},o.listFileTags=function(e){var t=o.getDirentPath(e);C.I.listFileTags(o.props.repoID,t).then((function(e){for(var t=e.data.file_tags,n=0,r=t.length;n<r;n++)t[n].id=t[n].file_tag_id;o.setState({fileTagList:t,showLibContentViewDialogs:!0,showEditFileTagDialog:!0})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onMenuFileTagChanged=function(){o.listFileTags(o.props.selectedDirentList[0]);for(var e=o.props.selectedDirentList.length,t=0;t<e;t++){var n=o.props.selectedDirentList[t],r=o.getDirentPath(n);o.props.onFilesTagChanged(n,r)}},o.getDirentPath=function(e){if(e)return f.c.joinPath(o.props.path,e.name)},o.state={isZipDialogOpen:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isMutipleOperation:!0,showLibContentViewDialogs:!1,showShareDialog:!1,showEditFileTagDialog:!1,fileTagList:[],multiFileTagList:[],isRenameDialogOpen:!1,isPermissionDialogOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.repoID,n=e.repoTags,r=e.userPerm,o=e.selectedDirentList,i=o[0],s=o.length,l=this.getDirentPath(i),c=f.c.getUserPermission(r),d=c.isCustomPermission,u=c.customPermission,p=!1,g=!1,v=!1,y=!1;switch(r){case"rw":case"admin":p=!0,g=!0,v=!0,y=!0;break;case"cloud-edit":p=!0,g=!0,v=!0;break;case"r":g=!0,y=!0}if(d){var x=u.permission;p=x.modify,g=x.copy,y=x.download,v=x.delete}return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{className:"selected-dirents-toolbar",children:[(0,m.jsxs)("span",{className:"cur-view-path-btn px-2",onClick:this.props.unSelectDirent,children:[(0,m.jsx)("span",{className:"sf3-font-x-01 sf3-font mr-2","aria-label":(0,h.ih)("Unselect"),title:(0,h.ih)("Unselect")}),(0,m.jsxs)("span",{children:[s," ",(0,h.ih)("selected")]})]}),p&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onMoveToggle,children:(0,m.jsx)("span",{className:"sf3-font-move1 sf3-font","aria-label":(0,h.ih)("Move"),title:(0,h.ih)("Move")})}),g&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onCopyToggle,children:(0,m.jsx)("span",{className:"sf3-font-copy1 sf3-font","aria-label":(0,h.ih)("Copy"),title:(0,h.ih)("Copy")})}),v&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onItemsDelete,children:(0,m.jsx)("span",{className:"sf3-font-delete1 sf3-font","aria-label":(0,h.ih)("Delete"),title:(0,h.ih)("Delete")})}),y&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onItemsDownload,children:(0,m.jsx)("span",{className:"sf3-font-download1 sf3-font","aria-label":(0,h.ih)("Download"),title:(0,h.ih)("Download")})}),1===s&&(0,m.jsx)(Co.Z,{item:this.props.selectedDirentList[0],toggleClass:"cur-view-path-btn sf3-font-more-vertical sf3-font",onMenuItemClick:this.onMenuItemClick,getMenuList:this.getDirentMenuList})]}),this.state.isMoveDialogShow&&(0,m.jsx)(bo,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,isMutipleOperation:this.state.isMutipleOperation,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle}),this.state.isCopyDialogShow&&(0,m.jsx)(wo,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,selectedDirentList:this.props.selectedDirentList,isMutipleOperation:this.state.isMutipleOperation,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isZipDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Yu.Z,{repoID:this.props.repoID,path:this.props.path,target:this.props.selectedDirentList.map((function(e){return e.name})),toggleDialog:this.closeZipDialog})}),this.state.showLibContentViewDialogs&&(0,m.jsxs)(a.Fragment,{children:[this.state.showShareDialog&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Te.Z,{itemType:i.type,itemName:i.name,itemPath:l,userPerm:i.permission,repoID:t,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.toggleCancel})}),this.state.isRenameDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(sp,{dirent:i,onRename:this.onItemRename,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.toggleCancel})}),this.state.isPermissionDialogOpen&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(Pt,{toggleDialog:this.toggleCancel,repoID:t,folderPath:l,folderName:i.name,isDepartmentRepo:this.props.isGroupOwnedRepo})}),this.state.showEditFileTagDialog&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(nr,{repoID:t,repoTags:n,filePath:l,fileTagList:this.state.fileTagList,toggleCancel:this.toggleCancel,onFileTagChanged:this.onMenuFileTagChanged})})]})]})}}]),n}(a.Component),fp=hp,mp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onPathClick=function(e){o.props.onMainNavBarClick(e),o.props.closeDirentDetail()},o.onItemClick=function(e){o.props.onItemClick(e),o.props.closeDirentDetail()},o.onDirentClick=function(e){o.setState({currentDirent:e}),o.props.onDirentClick(e)},o.onItemSelected=function(e){o.setState({currentDirent:e}),o.props.onItemSelected(e)},o.onItemDelete=function(e){o.checkCurrentDirent(e),o.props.onItemDelete(e)},o.onItemMove=function(e,t,n,r){o.checkCurrentDirent(t),o.props.onItemMove(e,t,n,r)},o.checkCurrentDirent=function(e){var t=o.state.currentDirent;t&&e.name===t.name&&o.setState({currentDirent:null})},o.onItemsScroll=function(e){var t=e.target;0!==t.scrollTop&&t.scrollTop+t.clientHeight+1>=t.scrollHeight&&o.props.onListContainerScroll()},o.state={currentDirent:null},o.errMessage=(0,m.jsx)("div",{className:"message err-tip",children:(0,h.ih)("Folder does not exist.")}),o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.path===this.props.path&&e.updateDetail===this.props.updateDetail||this.setState({currentDirent:null})}},{key:"render",value:function(){var e=this.props,t=e.path,n=e.repoID,r=e.usedRepoTags,o=!1;"/"===t&&0!==r.length&&(o=!0);var i={borderBottom:"none"};return this.props.isDirentSelected&&(i.transform="translateY(-50px)"),(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{className:"cur-view-container",children:["read-only"===this.props.currentRepoInfo.status&&(0,m.jsx)("div",{className:"readonly-tip-message",children:(0,h.ih)("This library has been set to read-only by admin and cannot be updated.")}),(0,m.jsxs)("div",{className:"cur-view-path d-block",style:i,children:[(0,m.jsx)(_r,{repoID:n,repoName:this.props.currentRepoInfo.repo_name,repoEncrypted:this.props.repoEncrypted,isGroupOwnedRepo:this.props.isGroupOwnedRepo,pathPrefix:this.props.pathPrefix,currentPath:this.props.path,userPerm:this.props.userPerm,isViewFile:this.props.isViewFile,onTabNavClick:this.props.onTabNavClick,onPathClick:this.onPathClick,updateUsedRepoTags:this.props.updateUsedRepoTags,fileTags:this.props.fileTags,onDeleteRepoTag:this.props.onDeleteRepoTag,direntList:this.props.direntList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,toggleTreePanel:this.props.toggleTreePanel,currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode,isCustomPermission:this.props.isCustomPermission,enableDirPrivateShare:this.props.enableDirPrivateShare,showShareBtn:this.props.showShareBtn,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onUploadFile:this.props.onUploadFile,onUploadFolder:this.props.onUploadFolder,fullDirentList:this.props.fullDirentList,filePermission:this.props.filePermission,onFileTagChanged:this.props.onToolbarFileTagChanged,repoTags:this.props.repoTags}),(0,m.jsx)(fp,{repoID:this.props.repoID,path:this.props.path,userPerm:this.props.userPerm,repoEncrypted:this.props.repoEncrypted,repoTags:this.props.repoTags,selectedDirentList:this.props.selectedDirentList,direntList:this.props.direntList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,onItemRename:this.props.onItemRename,isRepoOwner:this.props.isRepoOwner,currentRepoInfo:this.props.currentRepoInfo,enableDirPrivateShare:this.props.enableDirPrivateShare,updateDirent:this.props.updateDirent,unSelectDirent:this.props.unSelectDirent,onFilesTagChanged:this.props.onFilesTagChanged,showShareBtn:this.props.showShareBtn,isGroupOwnedRepo:this.props.isGroupOwnedRepo,showDirentDetail:this.props.showDirentDetail,currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode})]}),(0,m.jsxs)("div",{className:"cur-view-content lib-content-container ".concat(this.props.isTreePanelShown?"view-mode-container":""),onScroll:this.onItemsScroll,children:[!this.props.pathExist&&this.errMessage,this.props.pathExist&&(0,m.jsx)(pp,{isTreePanelShown:this.props.isTreePanelShown,currentMode:this.props.currentMode,path:this.props.path,repoID:n,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,isTreeDataLoading:this.props.isTreeDataLoading,treeData:this.props.treeData,currentNode:this.props.currentNode,onNodeClick:this.props.onNodeClick,onNodeCollapse:this.props.onNodeCollapse,onNodeExpanded:this.props.onNodeExpanded,onAddFolderNode:this.props.onAddFolder,onAddFileNode:this.props.onAddFile,onRenameNode:this.props.onRenameNode,onDeleteNode:this.props.onDeleteNode,isViewFile:this.props.isViewFile,isFileLoading:this.props.isFileLoading,isFileLoadedErr:this.props.isFileLoadedErr,hash:this.props.hash,filePermission:this.props.filePermission,content:this.props.content,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick,isRepoInfoBarShow:o,repoTags:this.props.repoTags,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onItemClick:this.onItemClick,onItemSelected:this.onItemSelected,onItemDelete:this.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,onDirentClick:this.onDirentClick,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllDirentSelected,onAllItemSelected:this.props.onAllDirentSelected,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail,onItemsScroll:this.onItemsScroll,isDirentDetailShow:this.props.isDirentDetailShow})]})]}),this.props.isDirentDetailShow&&(0,m.jsx)(a.Fragment,{children:(0,m.jsx)("div",{className:"cur-view-detail",children:"/"!==this.props.path||this.state.currentDirent?(0,m.jsx)(go,{repoID:n,path:this.props.path,dirent:this.state.currentDirent,currentRepoInfo:this.props.currentRepoInfo,repoTags:this.props.repoTags,fileTags:this.props.isViewFile?this.props.fileTags:[],onFileTagChanged:this.props.onFileTagChanged,onItemDetailsClose:this.props.closeDirentDetail,direntDetailPanelTab:this.props.direntDetailPanelTab}):(0,m.jsx)(vo,{currentRepo:this.props.currentRepoInfo,closeDetails:this.props.closeDirentDetail})})})]})}}]),n}(a.Component),gp=n(57313),vp=n.n(gp),yp="uploading",xp="error",wp="isSaving",bp="uploaded",Sp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onUploadCancel=function(e){e.preventDefault(),o.props.onUploadCancel(o.props.resumableFile)},o.onUploadRetry=function(e){e.preventDefault(),o.props.onUploadRetry(o.props.resumableFile)},o.formatFileSize=function(e){return"number"!==typeof e?"":e>=1e9?(e/1e9).toFixed(1)+" G":e>=1e6?(e/1e6).toFixed(1)+" M":e>=1e3?(e/1e3).toFixed(1)+" K":e.toFixed(1)+" B"},o.state={uploadState:yp},o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.resumableFile,n=yp;t.error?n=xp:(0!==t.remainingTime||t.isSaved||(n=wp),t.isSaved&&(n=bp)),this.setState({uploadState:n})}},{key:"render",value:function(){var e=this.props.resumableFile,t=Math.round(100*e.progress()),n=e.error;return(0,m.jsxs)("tr",{className:"file-upload-item",children:[(0,m.jsx)("td",{className:"upload-name",children:(0,m.jsx)("div",{className:"ellipsis",children:e.newFileName})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{className:"file-size",children:this.formatFileSize(e.size)})}),(0,m.jsxs)("td",{className:"upload-progress",children:[(this.state.uploadState===yp||this.state.uploadState===wp)&&(0,m.jsxs)(a.Fragment,{children:[e.size>=1e8&&(0,m.jsxs)(a.Fragment,{children:[e.isUploading()&&(0,m.jsxs)("div",{className:"progress-container",children:[(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})}),-1===e.remainingTime&&(0,m.jsx)("div",{className:"progress-text",children:(0,h.ih)("Preparing to upload...")}),e.remainingTime>0&&(0,m.jsxs)("div",{className:"progress-text",children:[(0,h.ih)("Remaining")," ",f.c.formatTime(e.remainingTime)]}),0===e.remainingTime&&(0,m.jsx)("div",{className:"progress-text",children:(0,h.ih)("Saving...")})]}),!e.isUploading()&&(0,m.jsx)("div",{className:"progress-container d-flex align-items-center",children:(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),e.size<1e8&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"progress-container d-flex align-items-center",children:(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})}),this.state.uploadState===yp&&(0,m.jsxs)(m.Fragment,{children:[0==t&&(0,m.jsx)("p",{className:"progress-text mb-0",children:(0,h.ih)("Waiting...")}),t>0&&(0,m.jsx)("p",{className:"progress-text mb-0",children:"".concat((0,h.ih)("Uploading...")," ").concat(t,"%")})]}),this.state.uploadState===wp&&(0,m.jsx)("p",{className:"progress-text mb-0",children:(0,h.ih)("Saving...")})]})]}),this.state.uploadState===bp&&(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"upload-success-icon sf2-icon-tick mr-2"}),(0,m.jsx)("span",{className:"upload-success-msg",children:(0,h.ih)("Uploaded")})]}),this.state.uploadState===xp&&(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"upload-failure-icon sf3-font sf3-font-info mr-2"}),(0,m.jsx)("span",{className:"upload-failure-msg",dangerouslySetInnerHTML:{__html:n}})]})]}),(0,m.jsx)("td",{className:"upload-operation",children:(0,m.jsxs)(a.Fragment,{children:[this.state.uploadState===yp&&(0,m.jsx)("a",{href:"#",onClick:this.onUploadCancel,role:"button",children:(0,h.ih)("Cancel")}),this.state.uploadState===xp&&(0,m.jsx)("a",{href:"#",onClick:this.onUploadRetry,role:"button",children:(0,h.ih)("Retry")})]})})]})}}]),n}(a.Component),Cp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.file;return(0,m.jsxs)("tr",{className:"file-upload-item",children:[(0,m.jsx)("td",{className:"upload-name",children:(0,m.jsx)("div",{className:"ellipsis",title:e.name,children:e.name})}),(0,m.jsx)("td",{children:f.c.bytesToSize(e.size)}),(0,m.jsx)("td",{children:(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"upload-failure-icon sf3-font sf3-font-info mr-2"}),(0,m.jsx)("span",{className:"upload-failure-msg",children:(0,h.ih)("File too large")})]})}),(0,m.jsx)("td",{})]})}}]),n}(a.Component),Dp=Cp,kp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onCancelAllUploading=function(){o.props.onCancelAllUploading()},o.onMinimizeUpload=function(e){e.nativeEvent.stopImmediatePropagation(),o.setState({isMinimized:!o.state.isMinimized})},o.onCloseUpload=function(e){e.nativeEvent.stopImmediatePropagation(),o.props.onCloseUploadDialog()},o.state={isMinimized:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.totalProgress,o=n.retryFileList,i=n.uploadBitrate,s=n.uploadFileList,a=n.forbidUploadFileList,l=n.isUploading,c=(0,h.ih)("{uploaded_files_num}/{all_files_num} Files").replace("{uploaded_files_num}",s.filter((function(e){return e.isSaved})).length).replace("{all_files_num}",s.length);if(!l){var d=s.filter((function(e){return e.error})).length+a.length;d>0&&(e=(0,h.ih)("{failed_files_num} file(s) failed to upload").replace("{failed_files_num}",d))}return(0,m.jsxs)("div",{className:"uploader-list-view mw-100",style:{height:this.state.isMinimized?document.querySelector(".uploader-list-header").offsetHeight:"20rem"},children:[(0,m.jsxs)("div",{className:"uploader-list-header flex-shrink-0",children:[(0,m.jsx)("div",{children:l?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:(0,h.ih)("File Uploading...")}),(0,m.jsx)("span",{className:"ml-2",children:"".concat(r,"% (").concat(f.c.formatBitRate(i),")")}),(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(r,"%")},"aria-valuenow":r,"aria-valuemin":"0","aria-valuemax":"100"})})]}):(0,m.jsx)(m.Fragment,{children:e?(0,m.jsx)("p",{className:"m-0 error",children:e}):(0,m.jsx)("p",{className:"m-0",children:(0,h.ih)("All files uploaded")})})}),(0,m.jsxs)("div",{className:"upload-dialog-op-container",children:[(0,m.jsx)("span",{className:"sf2-icon-minus upload-dialog-op",onClick:this.onMinimizeUpload}),!l&&(0,m.jsx)("span",{className:"sf2-icon-x1 upload-dialog-op",onClick:this.onCloseUpload})]})]}),(0,m.jsxs)("div",{className:"uploader-list-content",children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center border-bottom uploader-content-bar",children:[s.length>0&&(0,m.jsx)("span",{children:c}),(0,m.jsxs)("div",{className:"ml-auto",children:[(0,m.jsx)("button",{className:"btn btn-lg border-0 background-transparent px-0",onClick:this.props.onUploadRetryAll,disabled:0==o.length,children:(0,h.ih)("Retry All")}),(0,m.jsx)("button",{className:"btn btn-lg border-0 background-transparent px-0 ml-3",onClick:this.props.onCancelAllUploading,disabled:!l,children:(0,h.ih)("Cancel All")})]})]}),(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"40%",children:(0,h.ih)("name")}),(0,m.jsx)("th",{width:"15%",children:(0,h.ih)("size")}),(0,m.jsx)("th",{width:"30%",children:(0,h.ih)("progress")}),(0,m.jsx)("th",{width:"15%",children:(0,h.ih)("state")})]})}),(0,m.jsxs)("tbody",{children:[this.props.forbidUploadFileList.map((function(e,t){return(0,m.jsx)(Dp,{file:e},t)})),this.props.uploadFileList.map((function(e,n){return(0,m.jsx)(Sp,{resumableFile:e,onUploadCancel:t.props.onUploadCancel,onUploadRetry:t.props.onUploadRetry},n)}))]})]})]})]})}}]),n}(a.Component),jp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).toggle=function(t){t.nativeEvent.stopImmediatePropagation(),e.props.cancelFileUpload()},e.replaceRepetitionFile=function(t){t.nativeEvent.stopImmediatePropagation(),e.props.replaceRepetitionFile()},e.uploadFile=function(t){t.nativeEvent.stopImmediatePropagation(),e.props.uploadFile()},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.currentResumableFile.fileName;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:(0,m.jsx)("span",{children:(0,h.ih)("Replace file {filename}?").replace("{filename}",e)})}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)("p",{children:(0,h.ih)("A file with the same name already exists in this folder.")}),(0,m.jsx)("p",{children:(0,h.ih)("Replacing it will overwrite its content.")})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"primary",onClick:this.replaceRepetitionFile,children:(0,h.ih)("Replace")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.uploadFile,children:(0,h.ih)("Don't replace")}),(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggle,children:(0,h.ih)("Cancel")})]})]})}}]),n}(a.Component),Ip=jp,Mp=(n(87575),function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).componentWillUnmount=function(){window.onbeforeunload=null,!0===o.props.dragAndDrop&&o.resumable.disableDropOnDocument()},o.onbeforeunload=function(){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress)return""},o.bindCallbackHandler=function(){var e=o.props,t=e.minFileSizeErrorCallback,n=e.fileTypeErrorCallback;o.maxFilesErrorCallback&&(o.resumable.opts.maxFilesErrorCallback=o.maxFilesErrorCallback),t&&(o.resumable.opts.minFileSizeErrorCallback=o.props.minFileSizeErrorCallback),o.maxFileSizeErrorCallback&&(o.resumable.opts.maxFileSizeErrorCallback=o.maxFileSizeErrorCallback),n&&(o.resumable.opts.fileTypeErrorCallback=o.props.fileTypeErrorCallback)},o.bindEventHandler=function(){o.resumable.on("chunkingComplete",o.onChunkingComplete.bind((0,xt.Z)(o))),o.resumable.on("fileAdded",o.onFileAdded.bind((0,xt.Z)(o))),o.resumable.on("filesAddedComplete",o.filesAddedComplete.bind((0,xt.Z)(o))),o.resumable.on("fileProgress",o.onFileProgress.bind((0,xt.Z)(o))),o.resumable.on("fileSuccess",o.onFileUploadSuccess.bind((0,xt.Z)(o))),o.resumable.on("progress",o.onProgress.bind((0,xt.Z)(o))),o.resumable.on("complete",o.onComplete.bind((0,xt.Z)(o))),o.resumable.on("pause",o.onPause.bind((0,xt.Z)(o))),o.resumable.on("fileRetry",o.onFileRetry.bind((0,xt.Z)(o))),o.resumable.on("fileError",o.onFileError.bind((0,xt.Z)(o))),o.resumable.on("error",o.onError.bind((0,xt.Z)(o))),o.resumable.on("beforeCancel",o.onBeforeCancel.bind((0,xt.Z)(o))),o.resumable.on("cancel",o.onCancel.bind((0,xt.Z)(o))),o.resumable.on("dragstart",o.onDragStart.bind((0,xt.Z)(o)))},o.maxFilesErrorCallback=function(e,t){var n=h.dd,r=(0,h.ih)("Please upload no more than {maxFiles} files at a time.");r=r.replace("{maxFiles}",n),W.Z.danger(r)},o.maxFileSizeErrorCallback=function(e){var t=o.state.forbidUploadFileList;t.push(e),o.setState({forbidUploadFileList:t})},o.onChunkingComplete=function(e){var t="/"===o.props.path?"/":o.props.path+"/",n=e.fileName,r=e.relativePath,i=n===r;if(e.formData={},i)e.formData={parent_dir:t};else{var s=r.slice(0,r.lastIndexOf("/")+1);e.formData={parent_dir:t,relative_path:s}}},o.onFileAdded=function(e,t){var n=o.props.isCustomPermission;if(e.fileName===e.relativePath&&1===t.length){var r=!1;if(!n)for(var i=o.props.direntList,s=0;s<i.length;s++)if("file"===i[s].type&&i[s].name===e.fileName){r=!0;break}if(r)o.setState({isUploadRemindDialogShow:!0,currentResumableFile:e});else{o.setUploadFileList(o.resumable.files);var a=o.props,l=a.repoID,c=a.path;C.I.getFileServerUploadLink(l,c).then((function(t){o.resumable.opts.target=t.data+"?ret-json=1",o.resumableUpload(e)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}}else if(o.setUploadFileList(o.resumable.files),!o.isUploadLinkLoaded){o.isUploadLinkLoaded=!0;var d=o.props,u=d.repoID,p=d.path;C.I.getFileServerUploadLink(u,p).then((function(e){o.resumable.opts.target=e.data+"?ret-json=1",o.resumable.upload()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}},o.resumableUpload=function(e){var t=o.props,n=t.repoID,r=t.path;C.I.getFileUploadedBytes(n,r,e.fileName).then((function(t){var n=t.data.uploadedBytes,r=1024*parseInt(h.pL)*1024||1048576,i=Math.floor(n/r);e.markChunksCompleted(i),o.resumable.upload()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.filesAddedComplete=function(e,t){o.state.forbidUploadFileList.length>0&&0===t.length&&o.setState({isUploadProgressDialogShow:!0,totalProgress:100})},o.setUploadFileList=function(){var e=o.resumable.files;o.setState({uploadFileList:e,isUploadProgressDialogShow:!0}),f.c.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)},o.onFileProgress=function(e){var t=o.getBitrate(),n=o.state.uploadFileList.map((function(n){if(n.uniqueIdentifier===e.uniqueIdentifier&&t){var r=8*(n.size-n.size*n.progress()),o=Math.floor(r/t);n.remainingTime=o}return n}));o.setState({uploadBitrate:t,uploadFileList:n})},o.getBitrate=function(){var e=0,t=0,n=(new Date).getTime();if(o.resumable.files.forEach((function(t){e+=t.progress()*t.size})),o.timestamp){var r=n-o.timestamp;if(r<o.bitrateInterval)return o.state.uploadBitrate;(e<o.loaded||0===o.loaded)&&(o.loaded=e),t=(e-o.loaded)*(1e3/r)*8}return o.timestamp=n,o.loaded=e,t},o.onProgress=function(){var e=Math.round(100*o.resumable.progress());o.setState({totalProgress:e}),f.c.registerGlobalVariable("uploader","totalProgress",e)},o.onFileUploadSuccess=function(e,t){var n=e.formData,r=(new Date).getTime()/1e3;if(t=n.replace?t:JSON.parse(t)[0],n.relative_path){var i=n.relative_path,s=i.slice(0,i.indexOf("/")),a={id:t.id,name:s,type:"dir",mtime:r};o.notifiedFolders.some((function(e){return e.name===a.name}))||(o.notifiedFolders.push(a),o.props.onFileUploadSuccess(a));var l=o.state.uploadFileList.map((function(n){return n.uniqueIdentifier===e.uniqueIdentifier&&(n.newFileName=i+t.name,n.isSaved=!0),n}));o.setState({uploadFileList:l})}else if(n.replace){var c=e.fileName,d={id:t,name:c,type:"file",mtime:r};o.props.onFileUploadSuccess(d);var u=o.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.newFileName=c,t.isSaved=!0),t}));o.setState({uploadFileList:u})}else{var p={id:t.id,type:"file",name:t.name,size:t.size,mtime:r};o.props.onFileUploadSuccess(p);var h=o.state.uploadFileList.map((function(n){return n.uniqueIdentifier===e.uniqueIdentifier&&(n.newFileName=t.name,n.isSaved=!0),n}));o.setState({uploadFileList:h})}},o.getFileServerErrorMessage=function(e){return{"File locked by others.":(0,h.ih)("File is locked by others."),"Invalid filename.":(0,h.ih)("Invalid filename."),"File already exists.":(0,h.ih)("File already exists."),"File size is too large.":(0,h.ih)("File size is too large."),"Out of quota.":(0,h.ih)("Out of quota."),"Internal error.":(0,h.ih)("Internal Server Error")}[e]||e},o.onFileError=function(e,t){var n="";if(t){var r=t.replace(/\n/g,"");r=JSON.parse(r),n=o.getFileServerErrorMessage(r.error)}else n=(0,h.ih)("Network error");var i=o.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(o.state.retryFileList.push(t),t.error=n),t}));o.loaded=0,o.setState({retryFileList:o.state.retryFileList,uploadFileList:i})},o.onComplete=function(){o.notifiedFolders=[],o.isUploadLinkLoaded=!1},o.onPause=function(){},o.onError=function(e){o.isUploadLinkLoaded=!1,f.c.registerGlobalVariable("uploader","totalProgress",100)},o.onFileRetry=function(){},o.onBeforeCancel=function(){},o.onCancel=function(){},o.setHeaders=function(e,t){var n=t.offset,r=t.getOpt("chunkSize"),o=0===e.size?1:e.size,i=0!==n?n*r:0,s=Math.min(o,(n+1)*r)-1;return o-t.endByte<r&&!t.getOpt("forceChunkSize")&&(s=o),{Accept:"application/json; text/javascript, */*; q=0.01","Content-Disposition":'attachment; filename="'+encodeURI(e.fileName)+'"',"Content-Range":"bytes "+i+"-"+s+"/"+o}},o.setQuery=function(e){return e.formData},o.generateUniqueIdentifier=function(e){var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return rp()(t+new Date)+t},o.onClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},o.onFileUpload=function(){o.uploadInput.current.removeAttribute("webkitdirectory"),o.uploadInput.current.click()},o.onFolderUpload=function(){o.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory"),o.uploadInput.current.click()},o.onDragStart=function(){o.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory")},o.onCloseUploadDialog=function(){o.loaded=0,o.resumable.files=[],o.isUploadLinkLoaded=!1,o.setState({isUploadProgressDialogShow:!1,uploadFileList:[],forbidUploadFileList:[]}),f.c.registerGlobalVariable("uploader","isUploadProgressDialogShow",!1)},o.onUploadCancel=function(e){var t=o.state.uploadFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier||(t.cancel(),!1)}));o.resumable.isUploading()||(o.setState({totalProgress:100}),o.loaded=0),o.setState({uploadFileList:t})},o.onCancelAllUploading=function(){var e=o.state.uploadFileList.filter((function(e){return!Math.round(1!==e.progress())||(e.cancel(),!1)}));o.loaded=0,o.setState({totalProgress:100,uploadFileList:e}),o.isUploadLinkLoaded=!1},o.onUploadRetry=function(e){C.I.getFileServerUploadLink(o.props.repoID,o.props.path).then((function(t){o.resumable.opts.target=t.data+"?ret-json=1";var n=o.state.retryFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier})),r=o.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.error=null,o.retryUploadFile(t)),t}));o.setState({retryFileList:n,uploadFileList:r})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onUploadRetryAll=function(){C.I.getFileServerUploadLink(o.props.repoID,o.props.path).then((function(e){o.resumable.opts.target=e.data+"?ret-json=1",o.state.retryFileList.forEach((function(e){e.error=!1,o.retryUploadFile(e)}));var t=o.state.uploadFileList.slice(0);o.setState({retryFileList:[],uploadFileList:t})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.retryUploadFile=function(e){var t=o.props,n=t.repoID,r=t.path,i=e.fileName;if(!(e.fileName===e.relativePath)){var s=e.formData.relative_path;i=("/"===r?r+s:r+"/"+s)+i}e.bootstrap();var a=!1;e.resumableObj.on("chunkingComplete",(function(){a||C.I.getFileUploadedBytes(n,r,i).then((function(t){var n=t.data.uploadedBytes,r=1024*parseInt(h.pL)*1024||1048576,o=Math.floor(n/r);e.markChunksCompleted(o),e.resumableObj.upload()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})),a=!0}))},o.replaceRepetitionFile=function(){var e=o.props,t=e.repoID,n=e.path;C.I.getUpdateLink(t,n).then((function(e){o.resumable.opts.target=e.data;var t=o.resumable.files[o.resumable.files.length-1];t.formData.replace=1,t.formData.target_file=t.formData.parent_dir+t.fileName,o.setState({isUploadRemindDialogShow:!1}),o.setUploadFileList(o.resumable.files),o.resumable.upload()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.uploadFile=function(){var e=o.resumable.files[o.resumable.files.length-1],t=o.props,n=t.repoID,r=t.path;C.I.getFileServerUploadLink(n,r).then((function(t){o.resumable.opts.target=t.data+"?ret-json=1",o.setState({isUploadRemindDialogShow:!1,isUploadProgressDialogShow:!0,uploadFileList:[].concat((0,w.Z)(o.state.uploadFileList),[e])},(function(){o.resumable.upload()})),f.c.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.cancelFileUpload=function(){o.resumable.files.pop(),o.setState({isUploadRemindDialogShow:!1})},o.state={retryFileList:[],uploadFileList:[],forbidUploadFileList:[],totalProgress:0,isUploadProgressDialogShow:!1,isUploadRemindDialogShow:!1,currentResumableFile:null,uploadBitrate:0},o.uploadInput=a.createRef(),o.notifiedFolders=[],o.timestamp=null,o.loaded=0,o.bitrateInterval=500,window.onbeforeunload=o.onbeforeunload,o.isUploadLinkLoaded=!1,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.resumable=new(vp())({target:"",query:this.setQuery||{},fileType:this.props.filetypes,maxFiles:h.dd||void 0,maxFileSize:1e3*h.Og*1e3||void 0,testMethod:this.props.testMethod||"post",testChunks:this.props.testChunks||!1,headers:this.setHeaders||{},withCredentials:this.props.withCredentials||!1,chunkSize:1024*parseInt(h.pL)*1024||1048576,simultaneousUploads:this.props.simultaneousUploads||1,fileParameterName:this.props.fileParameterName,generateUniqueIdentifier:this.generateUniqueIdentifier,forceChunkSize:!0,maxChunkRetries:3,minFileSize:0}),this.resumable.assignBrowse(this.uploadInput.current,!0),!0===this.props.dragAndDrop&&this.resumable.enableDropOnDocument(),this.bindCallbackHandler(),this.bindEventHandler()}},{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("div",{className:"file-uploader-container",children:(0,m.jsx)("div",{className:"file-uploader",children:(0,m.jsx)("input",{className:"upload-input",type:"file",ref:this.uploadInput,onClick:this.onClick,"aria-label":(0,h.ih)("Upload")})})}),this.state.isUploadRemindDialogShow&&(0,m.jsx)(Ip,{currentResumableFile:this.state.currentResumableFile,replaceRepetitionFile:this.replaceRepetitionFile,uploadFile:this.uploadFile,cancelFileUpload:this.cancelFileUpload}),this.state.isUploadProgressDialogShow&&(0,m.jsx)(kp,{retryFileList:this.state.retryFileList,uploadFileList:this.state.uploadFileList,forbidUploadFileList:this.state.forbidUploadFileList,totalProgress:this.state.totalProgress,uploadBitrate:this.state.uploadBitrate,onCloseUploadDialog:this.onCloseUploadDialog,onCancelAllUploading:this.onCancelAllUploading,onUploadCancel:this.onUploadCancel,onUploadRetry:this.onUploadRetry,onUploadRetryAll:this.onUploadRetryAll,isUploading:this.resumable.isUploading()})]})}}]),n}(a.Component));Mp.defaultProps={isCustomPermission:!1};var _p=Mp,Np=n(88195),Rp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).deleteFolder=function(){o.props.deleteFolder(),o.props.toggleDialog()},o.state={sharedToUserCount:0,sharedToGroupCount:0},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.repoID,r=t.path;C.I.getRepoFolderShareInfo(n,r).then((function(t){e.setState({sharedToUserCount:t.data.shared_user_emails.length,sharedToGroupCount:t.data.shared_group_ids.length})}))}},{key:"render",value:function(){var e=this.state,t=e.sharedToUserCount,n=e.sharedToGroupCount,r=this.props,o=r.path,i=r.toggleDialog,s=f.c.getFileName(o),a='<span class="op-target">'+f.c.HTMLescape(s)+"</span>",l=(0,h.ih)("Are you sure you want to delete %s ?").replace("%s",a),c="";return(t>0||n>0)&&(c=(0,h.ih)("This folder has been shared to {user_amount} user(s) and {group_amount} group(s).").replace("{user_amount}",t).replace("{group_amount}",n)),(0,m.jsxs)(p.Z,{isOpen:!0,toggle:i,children:[(0,m.jsx)(I.Z,{toggle:i,children:(0,h.ih)("Delete Folder")}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:l}}),c&&(0,m.jsx)("p",{className:"error",children:c})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:i,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.deleteFolder,children:(0,h.ih)("Delete")})]})]})}}]),n}(a.Component),Tp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).showDirentDetail=function(e){e?o.setState({direntDetailPanelTab:e},(function(){o.setState({isDirentDetailShow:!0})})):o.setState({direntDetailPanelTab:"",isDirentDetailShow:!0})},o.toggleDirentDetail=function(){o.setState({direntDetailPanelTab:"",isDirentDetailShow:!o.state.isDirentDetailShow})},o.closeDirentDetail=function(){o.setState({isDirentDetailShow:!1,direntDetailPanelTab:""})},o.onpopstate=function(e){if(e.state&&e.state.key){if("/"===o.state.path)return;o.loadDirentList("/"),o.setState({path:"/",isViewFile:!1})}else if(e.state&&e.state.path){var t=e.state.path;if(o.state.isTreePanelShown&&f.c.isMarkdownFile(t))return void o.showFile(t);o.loadDirentList(t),o.setState({path:t,isViewFile:!1})}},o.onRepoUpdateEvent=function(){var e=new Date;if(!(parseFloat(e-o.lastModifyTime)/1e3<=5)){var t=o.props.repoID,n=o.state,r=n.path,i=n.dirID;o.state.isTreePanelShown?o.state.isViewFile?o.updateColumnMarkdownData(r):C.I.dirMetaData(t,r).then((function(e){e.data.id!==i&&o.loadDirentList(r)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})):C.I.dirMetaData(t,r).then((function(e){e.data.id!==i&&o.loadDirentList(r)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}},o.updateUsedRepoTags=function(){var e=o.props.repoID;C.I.listRepoTags(e).then((function(e){var t=[],n=[];e.data.repo_tags.forEach((function(e){var r=new An.Z(e);t.push(r),r.fileCount>0&&n.push(r)})),o.setState({repoTags:t,usedRepoTags:n})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.updateColumnMarkdownData=function(e){var t=o.props.repoID;o.setState({path:e,isViewFile:!0}),C.I.getFileInfo(t,e).then((function(n){var r=n.data,i=r.mtime,s=r.permission,a=r.last_modifier_name;C.I.getFileDownloadLink(t,e).then((function(e){C.I.getFileContent(e.data).then((function(e){o.state.content!==e.data&&o.setState({isFileLoading:!0}),o.setState({content:e.data,filePermission:s,latestContributor:a,lastModified:S().unix(i).fromNow(),isFileLoading:!1,isFileLoadedErr:!1})}))}))})).catch((function(){o.setState({isFileLoading:!1,isFileLoadedErr:!0})}))},o.loadDirData=function(e){var t=o.props.repoID;Zn.watchRepo(t,o.onRepoUpdateEvent),o.updateUsedRepoTags(),f.c.isMarkdownFile(e)?C.I.getFileInfo(o.props.repoID,e).then((function(){o.loadSidePanel(e),o.showFile(e)})).catch((function(){o.state.isTreePanelShown?(o.loadSidePanel(e),o.showDir(e)):o.showDir(e)})):o.state.isTreePanelShown?(o.loadSidePanel(e),o.showDir(e)):o.showDir(e)},o.loadSidePanel=function(e){var t=o.props.repoID;"/"===e?C.I.listDir(t,"/").then((function(e){var t=e.data,n=t.dirent_list,r=t.user_perm,i=o.state.treeData;o.addResponseListToNode(n,i.root),o.setState({isTreeDataLoading:!1,treeData:i,userPerm:r})})).catch((function(){o.setState({isTreeDataLoading:!1})})):o.loadNodeAndParentsByPath(e)},o.showDir=function(e){var t=o.props.repoID;if(o.state.isSessionExpired||o.setState({isDirentListLoading:!0,isViewFile:!1,selectedDirentList:[]}),o.loadDirentList(e),o.resetShowLength(),o.isNeedUpdateHistoryState){var n=o.state.currentRepoInfo,r=h.ze+"library/"+t+"/"+encodeURIComponent(n.repo_name)+f.c.encodePath(e);window.history.pushState({url:r,path:e},e,r)}else o.isNeedUpdateHistoryState=!0},o.showFile=function(e){var t=o.props.repoID;o.state.isTreePanelShown&&C.I.listFileTags(t,e).then((function(e){var t=e.data.file_tags.map((function(e){return new Ln.Z(e)}));o.setState({fileTags:t})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})),o.setState({isFileLoading:!0,path:e,isViewFile:!0}),C.I.getFileInfo(t,e).then((function(n){var r=n.data,i=r.mtime,s=r.permission,a=r.last_modifier_name;C.I.getFileDownloadLink(t,e).then((function(e){C.I.getFileContent(e.data).then((function(e){o.setState({content:e.data,filePermission:s,latestContributor:a,lastModified:S().unix(i).fromNow(),isFileLoading:!1,isFileLoadedErr:!1})}))}))})).catch((function(e){var t=f.c.getErrorMsg(e,!0);e.response&&403===e.response.status||W.Z.danger(t),o.setState({isFileLoading:!1,isFileLoadedErr:!0})}));var n=o.state.currentRepoInfo,r=h.ze+"library/"+t+"/"+encodeURIComponent(n.repo_name)+f.c.encodePath(e);window.history.pushState({url:r,path:e},e,r)},o.showFileMetadata=function(e){var t=o.props.repoID;o.setState({path:e,isViewFile:!0,isFileLoading:!1,isFileLoadedErr:!1,content:"__sf-metadata"});var n=o.state.currentRepoInfo,r=h.ze+"library/"+t+"/"+encodeURIComponent(n.repo_name);window.history.pushState({url:r,path:""},"",r)},o.loadDirentList=function(e){var t=o.props.repoID;C.I.listDir(t,e,{with_thumbnail:!0}).then((function(n){var r=[];n.data.dirent_list.forEach((function(e){var t=new Fn.Z(e);r.push(t)})),o.setState({pathExist:!0,userPerm:n.data.user_perm,isDirentListLoading:!1,direntList:f.c.sortDirents(r,o.state.sortBy,o.state.sortOrder),dirID:n.data.dir_id,path:e,isSessionExpired:!1}),!o.state.repoEncrypted&&r.length&&o.getThumbnails(t,e,o.state.direntList),o.state.currentRepoInfo.is_admin&&(o.foldersSharedOut?o.identifyFoldersSharedOut():(o.foldersSharedOut=[],C.I.getAllRepoFolderShareInfo(t).then((function(e){e.data.share_info_list.forEach((function(e){-1===o.foldersSharedOut.indexOf(e.path)&&o.foldersSharedOut.push(e.path)})),o.identifyFoldersSharedOut()}))))})).catch((function(e){f.c.getErrorMsg(e,!0),e.response&&403===e.response.status?o.setState({isDirentListLoading:!1}):o.setState({isDirentListLoading:!1,pathExist:!1})}))},o.identifyFoldersSharedOut=function(){var e=o.state,t=e.path,n=e.direntList;0!=o.foldersSharedOut.length&&(n.forEach((function(e){"dir"==e.type&&-1!==o.foldersSharedOut.indexOf(f.c.joinPath(t,e.name)+"/")&&(e.has_been_shared_out=!0)})),o.setState({direntList:n}))},o.onListContainerScroll=function(){var e=o.state.itemsShowLength+100;o.setState({itemsShowLength:e})},o.resetShowLength=function(){o.setState({itemsShowLength:100})},o.getThumbnails=function(e,t,n){var r=n.filter((function(e){return(f.c.imageCheck(e.name)||h.eA&&f.c.videoCheck(e.name)||h.mh&&f.c.pdfCheck(e.name))&&!e.encoded_thumbnail_src}));if(0!=r.length){var i=(0,xt.Z)(o),s=r.length;!function o(a){var l=r[a],c=[t,l.name].join("/");C.I.createThumbnail(e,c,48).then((function(e){l.encoded_thumbnail_src=e.data.encoded_thumbnail_src})).catch((function(e){})).then((function(){a<s-1?o(++a):i.setState({direntList:n})}))}(0)}},o.updateMoveCopyTreeNode=function(e){var t=o.props.repoID,n=o.state.treeData.clone().getNodeByPath(e);if(!n)return!1;var r=n.children.map((function(e){return e.object})).map((function(e){return e.name}));C.I.listDir(t,e).then((function(t){t.data.dirent_list.filter((function(e){return!r.includes(e.name)})).forEach((function(t){o.addNodeToTree(t.name,e,t.type)}))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.cancelCopyMoveDirent=function(){var e=o.state.asyncCopyMoveTaskId;C.I.cancelCopyMoveOperation(e),o.currentMoveItemName="",o.currentMoveItemPath="";var t=o.state.direntList;o.setState({direntList:t.slice(0)})},o.onMoveProgressDialogToggle=function(){100!==o.state.asyncOperationProgress&&o.cancelCopyMoveDirent(),o.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1})},o.onMoveItems=function(e,t){var n=o.props.repoID,r=o.state.selectedDirentList,i=o.getSelectedDirentNames(),s=o.getSelectedDirentPaths();C.I.moveDir(n,e.repo_id,t,o.state.path,i).then((function(a){if(n!==e.repo_id&&o.setState({asyncCopyMoveTaskId:a.data.task_id,asyncOperatedFilesLength:r.length,asyncOperationProgress:0,asyncOperationType:"move",isCopyMoveProgressDialogShow:!0},(function(){o.getAsyncCopyMoveProgress()})),n===e.repo_id){o.state.isTreePanelShown&&o.deleteTreeNodes(s),o.moveDirents(i),o.state.isTreePanelShown&&o.updateMoveCopyTreeNode(t);var l=f.c.getMoveSuccessMessage(i);W.Z.success(l)}})).catch((function(n){if(n.response.data.lib_need_decrypt)o.setState({libNeedDecryptWhenMove:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:t});else{var r=f.c.getErrorMsg(n);r===(0,h.ih)("Error")&&(r=f.c.getCopyFailedMessage(i)),W.Z.danger(r)}}))},o.onCopyItems=function(e,t){var n=o.props.repoID,r=o.state.selectedDirentList,i=o.getSelectedDirentNames();C.I.copyDir(n,e.repo_id,t,o.state.path,i).then((function(s){if(n!==e.repo_id&&o.setState({asyncCopyMoveTaskId:s.data.task_id,asyncOperatedFilesLength:r.length,asyncOperationProgress:0,asyncOperationType:"copy",isCopyMoveProgressDialogShow:!0},(function(){o.getAsyncCopyMoveProgress()})),n===e.repo_id){o.state.isTreePanelShown&&o.updateMoveCopyTreeNode(t),t===o.state.path&&o.loadDirentList(o.state.path);var a=f.c.getCopySuccessfulMessage(i);W.Z.success(a)}})).catch((function(n){if(n.response.data.lib_need_decrypt)o.setState({libNeedDecryptWhenCopy:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:t});else{var r=f.c.getErrorMsg(n);r===(0,h.ih)("Error")&&(r=f.c.getCopyFailedMessage(i)),W.Z.danger(r)}}))},o.restoreDeletedDirents=function(e,t,n){var r=o.props.repoID;n.preventDefault(),W.Z.closeAll(),C.I.restoreDirents(r,e,t).then((function(e){var t=e.data,n=t.success,r=t.failed;if(n.forEach((function(e){var t=f.c.getFileName(e.path),n=f.c.getDirName(e.path);e.is_dir?(o.state.isTreePanelShown&&o.addNodeToTree(t,n,"dir"),n!==o.state.path||o.state.isViewFile||o.addDirent(t,"dir")):(o.state.isTreePanelShown&&o.addNodeToTree(t,n,"file"),n!==o.state.path||o.state.isViewFile||o.addDirent(t,"file"))})),n.length){var i=n.length>1?(0,h.ih)("Restored {name} and {n} other items"):(0,h.ih)("Restored {name}");i=i.replace("{name}",n[0].path.split("/").pop()).replace("{n}",n.length-1),W.Z.success(i)}if(r.length){var s=r.length>1?(0,h.ih)("Failed to restore {name} and {n} other items"):(0,h.ih)("Failed to restore {name}");s=s.replace("{name}",r[0].path.split("/").pop()).replace("{n}",r.length-1),W.Z.danger(s)}})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onDeleteItems=function(){var e=o.props.repoID,t=o.getSelectedDirentPaths(),n=o.getSelectedDirentNames();o.setState({updateDetail:!o.state.updateDetail}),C.I.deleteMutipleDirents(e,o.state.path,n).then((function(e){o.state.isTreePanelShown&&o.deleteTreeNodes(t),o.deleteDirents(n);var r="";r=t.length>1?(r=(r=(0,h.ih)("Successfully deleted {name} and {n} other items.")).replace("{name}",n[0])).replace("{n}",n.length-1):(r=(0,h.ih)("Successfully deleted {name}.")).replace("{name}",n[0]);var i=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:r}),(0,m.jsx)("a",{className:"action-link p-0 ml-1",href:"#",onClick:o.restoreDeletedDirents.bind((0,xt.Z)(o),e.data.commit_id,t),children:(0,h.ih)("Undo")})]});W.Z.success(i,{duration:5})})).catch((function(e){var t=f.c.getErrorMsg(e);t===(0,h.ih)("Error")&&(t=(t=(t=(0,h.ih)("Failed to delete {name} and {n} other items.")).replace("{name}",n[0])).replace("{n}",n.length-1)),W.Z.danger(t)}))},o.onAddFolder=function(e){var t=o.props.repoID;C.I.createDir(t,e).then((function(){var t=f.c.getFileName(e),n=f.c.getDirName(e);o.state.isTreePanelShown&&o.addNodeToTree(t,n,"dir"),n!==o.state.path||o.state.isViewFile||o.addDirent(t,"dir")})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onAddFile=function(e){var t=o.props.repoID;C.I.createFile(t,e).then((function(t){var n=f.c.getFileName(e),r=f.c.getDirName(e);o.state.isTreePanelShown&&o.addNodeToTree(n,r,"file"),r!==o.state.path||o.state.isViewFile||o.addDirent(n,"file",t.data.size)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.switchViewMode=function(e){if(e!==o.state.currentMode)if("detail"!==e){_e.ZP.save("seafile_view_mode",e);var t=o.state.path;if(o.state.isTreePanelShown&&o.state.isViewFile){t=f.c.getDirName(t),o.setState({path:t,isViewFile:!1});var n=o.state.currentRepoInfo,r=h.ze+"library/"+n.repo_id+"/"+encodeURIComponent(n.repo_name)+f.c.encodePath(t);window.history.pushState({url:r,path:t},t,r)}o.state.isTreePanelShown&&o.loadSidePanel(o.state.path),o.isNeedUpdateHistoryState=!1,o.setState({currentMode:e}),o.showDir(t)}else o.toggleDirentDetail()},o.onSearchedClick=function(e){e.repo_id!==o.props.repoID&&o.openSearchedNewTab(e);var t=e.is_dir?e.path.slice(0,e.path.length-1):e.path;if(o.state.currentPath!==t)if(o.state.isTreePanelShown){for(var n=-1,r=f.c.getPaths(t),i=0;i<r.length;i++){var s=o.state.treeData.getNodeByPath(s);if(!s){n=i;break}}if(-1===n){var a=o.state.treeData.getNodeByPath(t);o.setState({currentNode:a})}else o.loadNodeAndParentsByPath(t);e.is_dir?o.showDir(t):f.c.isMarkdownFile(t)?o.showFile(t):o.openSearchedNewTab(e)}else e.is_dir?o.showDir(t):o.openSearchedNewTab(e)},o.openSearchedNewTab=function(e){var t=e.is_dir?e.path.slice(0,e.path.length-1):e.path,n=h.ze+"lib/"+e.repo_id+"/file"+f.c.encodePath(t);f.c.isWeChat()?location.href=n:window.open("about:blank").location.href=n},o.onMainNavBarClick=function(e){if(o.resetSelected(),o.state.isTreePanelShown){var t=o.state.treeData.clone(),n=t.getNodeByPath(e);t.expandNode(n),o.setState({treeData:t,currentNode:n})}o.showDir(e)},o.onLinkClick=function(e){var t=e,n=o.props.repoID;if(f.c.isInternalMarkdownLink(t,n)){var r=f.c.getPathFromInternalMarkdownLink(t,n);o.showFile(r)}else if(f.c.isInternalDirLink(t,n)){var i=f.c.getPathFromInternalDirLink(t,n);o.showDir(i)}else window.open(t)},o.onMainPanelItemRename=function(e,t){var n=f.c.joinPath(o.state.path,e.name);o.renameItem(n,e.isDir(),t)},o.onMainPanelItemDelete=function(e){var t=f.c.joinPath(o.state.path,e.name);o.deleteItem(t,e.isDir())},o.onRenameTreeNode=function(e,t){o.renameItem(e.path,e.object.isDir(),t)},o.onDeleteTreeNode=function(e){o.deleteItem(e.path,e.object.isDir())},o.renameItem=function(e,t,n){var r=o.props.repoID;t?C.I.renameDir(r,e,n).then((function(){o.renameItemAjaxCallback(e,n)})).catch((function(t){var n=f.c.getErrorMsg(t);if(n===(0,h.ih)("Error")){var r=f.c.getFileName(e);n=(0,h.ih)("Renaming {name} failed").replace("{name}",r)}W.Z.danger(n)})):C.I.renameFile(r,e,n).then((function(){o.renameItemAjaxCallback(e,n)})).catch((function(t){var n="";if((n=403==t.response.status&&t.response.data&&t.response.data.error_msg?t.response.data.error_msg:f.c.getErrorMsg(t))===(0,h.ih)("Error")){var r=f.c.getFileName(e);n=(0,h.ih)("Renaming {name} failed").replace("{name}",r)}W.Z.danger(n)}))},o.toggleDeleteFolderDialog=function(){o.setState({isDeleteFolderDialogOpen:!o.state.isDeleteFolderDialogOpen})},o.deleteFolder=function(){var e=o.props.repoID,t=o.state.folderToDelete;C.I.deleteDir(e,t).then((function(e){o.deleteItemAjaxCallback(t,!0);var n=f.c.getFileName(t),r=(0,h.ih)("Successfully deleted {name}").replace("{name}",n),i=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:r}),(0,m.jsx)("a",{className:"action-link p-0 ml-1",href:"#",onClick:o.restoreDeletedDirents.bind((0,xt.Z)(o),e.data.commit_id,[t]),children:(0,h.ih)("Undo")})]});W.Z.success(i,{duration:5})})).catch((function(e){var n=f.c.getErrorMsg(e);if(n===(0,h.ih)("Error")){var r=f.c.getFileName(t);n=(0,h.ih)("Failed to delete {name}").replace("{name}",r)}W.Z.danger(n)}))},o.onMoveItem=function(e,t,n,r){var i=o.props.repoID,s=t.name;r||(r=o.state.path);var a=f.c.joinPath(r,s);C.I.moveDir(i,e.repo_id,n,r,s).then((function(t){if(i!==e.repo_id&&o.setState({asyncCopyMoveTaskId:t.data.task_id,asyncOperatedFilesLength:1,asyncOperationProgress:0,asyncOperationType:"move",isCopyMoveProgressDialogShow:!0},(function(){o.currentMoveItemName=s,o.currentMoveItemPath=a,o.getAsyncCopyMoveProgress(s,a)})),o.state.isTreePanelShown&&o.deleteTreeNode(a),i===e.repo_id&&o.state.isTreePanelShown&&o.updateMoveCopyTreeNode(n),o.moveDirent(a,n),i===e.repo_id){var r=(0,h.ih)("Successfully moved {name}.");r=r.replace("{name}",s),W.Z.success(r)}})).catch((function(i){if(i.response.data.lib_need_decrypt)o.setState({libNeedDecryptWhenMove:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:n,copyMoveSingleItem:!0,srcDirentWhenCopyMove:t,srcNodeParentPathWhenCopyMove:r});else{var a=f.c.getErrorMsg(i);a===(0,h.ih)("Error")&&(a=(a=(0,h.ih)("Failed to move {name}.")).replace("{name}",s)),W.Z.danger(a)}}))},o.onCopyItem=function(e,t,n,r){var i=o.props.repoID,s=t.name;r||(r=o.state.path),C.I.copyDir(i,e.repo_id,n,r,s).then((function(t){if(i!==e.repo_id&&o.setState({asyncCopyMoveTaskId:t.data.task_id,asyncOperatedFilesLength:1,asyncOperationProgress:0,asyncOperationType:"copy",isCopyMoveProgressDialogShow:!0},(function(){o.getAsyncCopyMoveProgress()})),i===e.repo_id){o.state.isTreePanelShown&&o.updateMoveCopyTreeNode(n),n===r&&o.loadDirentList(o.state.path);var a=(0,h.ih)("Successfully copied %(name)s.");a=a.replace("%(name)s",s),W.Z.success(a)}})).catch((function(i){if(i.response.data.lib_need_decrypt)o.setState({libNeedDecryptWhenCopy:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:n,copyMoveSingleItem:!0,srcDirentWhenCopyMove:t,srcNodeParentPathWhenCopyMove:r});else{var a=f.c.getErrorMsg(i);a===(0,h.ih)("Error")&&(a=(a=(0,h.ih)("Failed to copy %(name)s")).replace("%(name)s",s)),W.Z.danger(a)}}))},o.onConvertItem=function(e,t){var n=f.c.joinPath(o.state.path,e.name),r=o.props.repoID;W.Z.notifyInProgress((0,h.ih)("Converting, please wait..."),{id:"conversion"}),C.I.convertFile(r,n,t).then((function(e){var t=e.data.obj_name,n=e.data.parent_dir+"/"+t,r=f.c.getDirName(n);o.state.isTreePanelShown&&o.addNodeToTree(t,r,"file"),o.addDirent(t,"file",e.data.size);var i=(0,h.ih)("Successfully converted the file.");W.Z.success(i,{id:"conversion"})})).catch((function(e){var t=f.c.getErrorMsg(e);if(t===(0,h.ih)("Error")){var r=f.c.getFileName(n);t=(0,h.ih)("Failed to convert {name}.").replace("{name}",r)}W.Z.danger(t,{id:"conversion"})}))},o.onDirentClick=function(e){var t=o.state.direntList.map((function(e){return e.isSelected=!1,e}));e?o.setState({direntList:t,isDirentSelected:!0,selectedDirentList:[e]}):o.setState({direntList:t,isDirentSelected:!1,selectedDirentList:[]})},o.onItemClick=function(e){o.resetSelected();var t=o.props.repoID,n=f.c.joinPath(o.state.path,e.name);if(e.isDir())o.state.isTreePanelShown&&o.loadTreeNodeByPath(n),o.showDir(n);else if(o.state.isTreePanelShown&&f.c.isMarkdownFile(n))o.showColumnMarkdownFile(n);else{var r=h.ze+"lib/"+t+"/file"+f.c.encodePath(n);e.is_sdoc_revision&&e.revision_id&&(r=h.ze+"lib/"+t+"/revisions/"+e.revision_id+"/"),f.c.isWeChat()?location.href=r:window.open(r)}},o.onDirentSelected=function(e){var t=o.state.direntList.map((function(t){return t.name===e.name&&(t.isSelected=!t.isSelected),t})),n=t.filter((function(e){return e.isSelected}));n.length?(o.setState({isDirentSelected:!0}),n.length===t.length?o.setState({isAllDirentSelected:!0,direntList:t,selectedDirentList:n}):o.setState({isAllDirentSelected:!1,direntList:t,selectedDirentList:n})):o.setState({isDirentSelected:!1,isAllDirentSelected:!1,direntList:t,selectedDirentList:[]})},o.onAllDirentSelected=function(){if(o.state.isAllDirentSelected){var e=o.state.direntList.map((function(e){return e.isSelected=!1,e}));o.setState({isDirentSelected:!1,isAllDirentSelected:!1,direntList:e,selectedDirentList:[]})}else{var t=o.state.direntList.map((function(e){return e.isSelected=!0,e}));o.setState({isDirentSelected:!0,isAllDirentSelected:!0,direntList:t,selectedDirentList:t})}},o.onFileTagChanged=function(e,t){var n=o.props.repoID;C.I.listFileTags(n,t).then((function(t){var n=t.data.file_tags.map((function(e){return new Ln.Z(e)}));o.state.isViewFile?o.setState({fileTags:n}):o.updateDirent(e,"file_tags",n)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})),o.updateUsedRepoTags()},o.onFileUploadSuccess=function(e){if(o.state.direntList.some((function(t){return t.name===e.name&&t.type===e.type})))for(var t=o.state.direntList,n=0;n<t.length;n++){var r=t[n];if(r.name===e.name&&r.type===e.type){var i=S().unix(e.mtime).fromNow();o.updateDirent(r,"mtime",i);break}}else{e.permission=o.state.userPerm;var s=new Fn.Z(e);o.state.isTreePanelShown&&o.addNodeToTree(s.name,o.state.path,s.type),"dir"===e.type?o.setState({direntList:[s].concat((0,w.Z)(o.state.direntList))}):o.setState({direntList:[].concat((0,w.Z)(o.state.direntList),[s])})}},o.addDirent=function(e,t,n){var r=o.createDirent(e,t,n),i=o.state.direntList;if("dir"===t)i.unshift(r);else{var s=i.length;if(0===s||"dir"===i[s-1].type)i.push(r);else{for(var a=0,l=0;l<=s;l++)if("file"===i[l].type){a=l;break}i.splice(a,0,r)}}o.setState({direntList:i})},o.renameDirent=function(e,t){var n=o.props.repoID,r=f.c.getDirName(e),i=f.c.joinPath(r,t);if(e===o.state.path){o.setState({path:i});var s=o.state.currentRepoInfo,a=h.ze+"library/"+n+"/"+encodeURIComponent(s.repo_name)+i;window.history.replaceState({url:a,path:i},i,a)}else if(f.c.isChildPath(e,o.state.path)){var l=f.c.getFileName(e),c=o.state.direntList.map((function(e){return e.name===l&&(e.name=t),e}));o.setState({direntList:c})}else if(f.c.isAncestorPath(e,o.state.path)){var d=f.c.renameAncestorPath(o.state.path,e,i);o.setState({path:d});var u=o.state.currentRepoInfo,p=h.ze+"library/"+n+"/"+encodeURIComponent(u.repo_name)+d;window.history.replaceState({url:p,path:d},d,p)}},o.deleteDirents=function(e){var t=o.state.direntList.filter((function(t){return-1===e.indexOf(t.name)}));o.recalculateSelectedDirents(e,t),o.setState({direntList:t})},o.moveDirent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=f.c.getFileName(e);if(t!==o.state.path){var r=o.state.direntList.filter((function(e){return e.name!==n}));o.recalculateSelectedDirents([n],r),o.setState({direntList:r})}else o.loadDirentList(o.state.path)},o.moveDirents=function(e){var t=o.state.direntList.filter((function(t){return-1===e.indexOf(t.name)}));o.recalculateSelectedDirents(e,t),o.setState({direntList:t,selectedDirentList:[],isDirentSelected:!1,isAllDirentSelected:!1})},o.updateDirent=function(e,t,n){var r=o.state.direntList.map((function(r){return r.name===e.name&&(r[t]=n),r}));o.setState({direntList:r})},o.loadTreeNodeByPath=function(e){var t=o.props.repoID,n=o.state.treeData.clone(),r=n.getNodeByPath(e);r.isLoaded?(n.getNodeByPath(r.parentNode.path).isExpanded=!0,o.setState({treeData:n,currentNode:r})):C.I.listDir(t,r.path).then((function(e){o.addResponseListToNode(e.data.dirent_list,r),n.getNodeByPath(r.parentNode.path).isExpanded=!0,o.setState({treeData:n,currentNode:r})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.loadNodeAndParentsByPath=function(e){var t=o.props.repoID,n=o.state.treeData.clone();f.c.isMarkdownFile(e)&&(e=f.c.getDirName(e)),C.I.listDir(t,e,{with_parents:!0}).then((function(e){for(var t=e.data,r=t.dirent_list,i=t.user_perm,s={},a=0;a<r.length;a++){var l=r[a],c=l.parent_dir,d="/"===c?"/":c.slice(0,c.length-1);s[d]||(s[d]=[]),s[d].push(l)}for(var u in s){var p=n.getNodeByPath(u);p.isLoaded||o.addResponseListToNode(s[u],p)}o.setState({isTreeDataLoading:!1,treeData:n,userPerm:i})})).catch((function(){o.setState({isLoadFailed:!0})}))},o.onTreeNodeClick=function(e){o.resetSelected();var t,n,r=o.props.repoID;if(o.state.pathExist||o.setState({pathExist:!0}),e.object.isDir()){var i=e.isLoaded;if(!e.isLoaded){var s=o.state.treeData.clone();e=s.getNodeByPath(e.path),C.I.listDir(r,e.path).then((function(t){o.addResponseListToNode(t.data.dirent_list,e),s.collapseNode(e),o.setState({treeData:s})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}if(i&&e.path===o.state.path)if(e.isExpanded){var a=Bn.Z.collapseNode(o.state.treeData,e);o.setState({treeData:a})}else{var l=o.state.treeData.clone();e=l.getNodeByPath(e.path),l.expandNode(e),o.setState({treeData:l})}}if(e.path!==o.state.path)if(e.object.isDir())o.showDir(e.path);else if(f.c.isMarkdownFile(e.path))e.path!==o.state.path&&o.showColumnMarkdownFile(e.path);else if(f.c.isFileMetadata(null===(t=e)||void 0===t||null===(n=t.object)||void 0===n?void 0:n.type))e.path!==o.state.path&&o.showFileMetadata(e.path);else{var c=h.ze+"lib/"+r+"/file"+f.c.encodePath(e.path),d=e.object;d.is_sdoc_revision&&d.revision_id&&(c=h.ze+"lib/"+r+"/revisions/"+d.revision_id+"/"),window.open(c)}},o.showColumnMarkdownFile=function(e){var t=o.props.repoID;C.I.getFileInfo(t,e).then((function(n){if(0===n.data.size){var r=window.open("about:blank"),i=h.ze+"lib/"+t+"/file"+f.c.encodePath(e);r.location.href=i}else o.showFile(e)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onTreeNodeCollapse=function(e){var t=Bn.Z.collapseNode(o.state.treeData,e);o.setState({treeData:t})},o.onTreeNodeExpanded=function(e){var t=o.props.repoID,n=o.state.treeData.clone();(e=n.getNodeByPath(e.path)).isLoaded?(n.expandNode(e),o.setState({treeData:n})):C.I.listDir(t,e.path).then((function(t){o.addResponseListToNode(t.data.dirent_list,e),o.setState({treeData:n})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.addNodeToTree=function(e,t,n){var r=o.createTreeNode(e,n),i=Bn.Z.addNodeToParentByPath(o.state.treeData,r,t);o.setState({treeData:i})},o.renameTreeNode=function(e,t){var n=Bn.Z.renameNodeByPath(o.state.treeData,e,t);o.setState({treeData:n})},o.deleteTreeNode=function(e){var t=Bn.Z.deleteNodeByPath(o.state.treeData,e);o.setState({treeData:t})},o.deleteTreeNodes=function(e){var t=Bn.Z.deleteNodeListByPaths(o.state.treeData,e);o.setState({treeData:t})},o.moveTreeNode=function(e,t,n,r){if(o.props.repoID===n.repo_id){var i=Bn.Z.moveNodeByPath(o.state.treeData,e,t,r);o.setState({treeData:i})}else{var s=Bn.Z.deleteNodeByPath(o.state.treeData,e);o.setState({treeData:s})}},o.copyTreeNode=function(e,t,n,r){if(o.props.repoID===n.repo_id){var i=Bn.Z.copyNodeByPath(o.state.treeData,e,t,r);o.setState({treeData:i})}},o.addResponseListToNode=function(e,t){t.isLoaded=!0,t.isExpanded=!0;var n=e.map((function(e){return new Fn.Z(e)})),r=(n=f.c.sortDirents(n,"name","asc")).map((function(e){return new zn.Z({object:e})}));t.addChildren(r)},o.getSelectedDirentPaths=function(){var e=[];return o.state.selectedDirentList.forEach((function(t){e.push(f.c.joinPath(o.state.path,t.name))})),e},o.getSelectedDirentNames=function(){var e=[];return o.state.selectedDirentList.forEach((function(t){e.push(t.name)})),e},o.resetSelected=function(){o.setState({isDirentSelected:!1,isAllDirentSelected:!1})},o.recalculateSelectedDirents=function(e,t){var n=o.state.selectedDirentList.slice(0);n.length>0&&(n=n.filter((function(t){return!e.includes(t.name)}))),o.setState({selectedDirentList:n,isDirentSelected:n.length>0,isAllDirentSelected:n.length===t.length})},o.onLibDecryptDialog=function(){o.setState({libNeedDecrypt:!1}),o.loadDirData(o.state.path)},o.onLibDecryptWhenCopyMove=function(){o.state.libNeedDecryptWhenCopy&&(o.state.copyMoveSingleItem?o.onCopyItem(o.state.destRepoWhenCopyMove,o.state.srcDirentWhenCopyMove,o.state.destDirentPathWhenCopyMove,o.state.srcNodeParentPathWhenCopyMove):o.onCopyItems(o.state.destRepoWhenCopyMove,o.state.destDirentPathWhenCopyMove),o.setState({libNeedDecryptWhenCopy:!1,copyMoveSingleItem:!1})),o.state.libNeedDecryptWhenMove&&(o.state.copyMoveSingleItem?o.onMoveItem(o.state.destRepoWhenCopyMove,o.state.srcDirentWhenCopyMove,o.state.destDirentPathWhenCopyMove,o.state.srcNodeParentPathWhenCopyMove):o.onMoveItems(o.state.destRepoWhenCopyMove,o.state.destDirentPathWhenCopyMove),o.setState({libNeedDecryptWhenMove:!1,copyMoveSingleItem:!1}))},o.sortItems=function(e,t){_e.ZP.save("seafile-repo-dir-sort-by",e),_e.ZP.save("seafile-repo-dir-sort-order",t),o.setState({sortBy:e,sortOrder:t,items:f.c.sortDirents(o.state.direntList,e,t)})},o.onUploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),o.uploader.onFileUpload()},o.onUploadFolder=function(e){e.nativeEvent.stopImmediatePropagation(),o.uploader.onFolderUpload()},o.onToolbarFileTagChanged=function(){var e=o.props.repoID,t=o.state.path;C.I.listFileTags(e,t).then((function(e){var t=e.data.file_tags.map((function(e){return new Ln.Z(e)}));o.setState({fileTags:t})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.unSelectDirent=function(){var e=o.state.direntList.map((function(e){return e.isSelected=!1,e}));o.setState({isDirentSelected:!1,direntList:e,selectedDirentList:[]});o.onDirentSelected({})},o.onDeleteRepoTag=function(e){var t=o.state.direntList.map((function(t){if(t.file_tags){var n=t.file_tags.filter((function(t){return t.repo_tag_id!==e}));t.file_tags=n}return t}));o.setState({direntList:t}),o.updateUsedRepoTags()},o.handleSubmit=function(e){var t={share_type:"personal",from:o.state.currentRepoInfo.owner_email};C.I.leaveShareRepo(o.props.repoID,t).then((function(e){(0,c.c4)(h.ze+"shared-libs/")})).catch((function(e){var t=f.c.getErrorMsg(e,!0);W.Z.danger(t)})),e.preventDefault()},o.toggleTreePanel=function(){o.setState({isTreePanelShown:!o.state.isTreePanelShown},(function(){o.state.isTreePanelShown&&o.loadSidePanel(o.state.path),localStorage.setItem("sf_dir_view_tree_panel_open",String(o.state.isTreePanelShown))}))};var i=!0,s=localStorage.getItem("sf_dir_view_tree_panel_open");return void 0!=s&&(i="true"==s),o.state={currentMode:_e.ZP.load("seafile_view_mode")||"list",isTreePanelShown:i,path:"",pathExist:!0,isViewFile:!1,hash:"",currentRepoInfo:null,repoName:"",repoEncrypted:!1,libNeedDecrypt:!1,isGroupOwnedRepo:!1,userPerm:"",selectedDirentList:[],fileTags:[],repoTags:[],usedRepoTags:[],isTreeDataLoading:!0,treeData:Bn.Z.buildTree(),currentNode:null,isFileLoading:!0,isFileLoadedErr:!1,filePermission:"",content:"",lastModified:"",latestContributor:"",isDirentListLoading:!0,direntList:[],isDirentSelected:!1,sortBy:_e.ZP.load("seafile-repo-dir-sort-by")||"name",sortOrder:_e.ZP.load("seafile-repo-dir-sort-order")||"asc",isAllDirentSelected:!1,dirID:"",errorMsg:"",isDirentDetailShow:!1,direntDetailPanelTab:"",updateDetail:!1,itemsShowLength:100,isSessionExpired:!1,isCopyMoveProgressDialogShow:!1,isDeleteFolderDialogOpen:!1,asyncCopyMoveTaskId:"",asyncOperationType:"move",asyncOperationProgress:0,asyncOperatedFilesLength:0},o.oldonpopstate=window.onpopstate,window.onpopstate=o.onpopstate,o.lastModifyTime=new Date,o.isNeedUpdateHistoryState=!0,o.currentMoveItemName="",o.currentMoveItemPath="",o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){var e=window.location.hash;"#"===e.slice(0,1)&&this.setState({hash:e})}},{key:"componentDidMount",value:function(){var e=(0,Vt.Z)((0,Yt.Z)().mark((function e(){var t,n,r,o,i,s,a,l,c;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.repoID,n=window.location.href.split("?")[0],n=decodeURIComponent(n),(r=(r=n.slice(n.indexOf(t)+t.length+1)).slice(r.indexOf("/"))).length>1&&"/"===r[r.length-1]&&(r=r.slice(0,r.length-1)),e.prev=6,e.next=9,C.I.getRepoInfo(t);case 9:if(o=e.sent,i=new Un.Z(o.data),s=i.owner_email.indexOf("@seafile_group")>-1,this.setState({currentRepoInfo:i}),!i.permission.startsWith("custom-")){e.next=19;break}return a=i.permission.split("-")[1],e.next=17,C.I.getCustomPermission(t,a);case 17:l=e.sent,window.custom_permission=l.data.permission;case 19:this.isNeedUpdateHistoryState=!1,this.setState({repoName:i.repo_name,libNeedDecrypt:i.lib_need_decrypt,repoEncrypted:i.encrypted,isGroupOwnedRepo:s,path:r}),i.lib_need_decrypt||this.loadDirData(r),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(6),e.t0.response?403==e.t0.response.status?(this.setState({isDirentListLoading:!1,errorMsg:(0,h.ih)("Permission denied")}),c=(0,h.ih)("Permission denied"),W.Z.danger(c)):404==e.t0.response.status?this.setState({isDirentListLoading:!1,errorMsg:(0,h.ih)("Library share permission not found.")}):this.setState({isDirentListLoading:!1,errorMsg:(0,h.ih)("Error")}):this.setState({isDirentListLoading:!1,errorMsg:(0,h.ih)("Please check the network.")});case 27:case"end":return e.stop()}}),e,this,[[6,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){window.onpopstate=this.oldonpopstate,Zn.unwatchRepo(this.props.repoID,this.onRepoUpdateEvent)}},{key:"componentDidUpdate",value:function(){this.lastModifyTime=new Date}},{key:"getAsyncCopyMoveProgress",value:function(){var e=(0,Vt.Z)((0,Yt.Z)().mark((function e(){var t,n,r,o,i,s,a,l,c,d;return(0,Yt.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.asyncOperationType,r=t.asyncCopyMoveTaskId,e.prev=1,e.next=4,C.I.queryAsyncOperationProgress(r);case 4:if(o=e.sent,!(i=o.data).failed){e.next=12;break}return s=(0,h.ih)("Failed to move files to another library."),"copy"===n&&(s=(0,h.ih)("Failed to copy files to another library.")),W.Z.danger(s),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),e.abrupt("return");case 12:if(!i.successful){e.next=19;break}return"move"===n&&(this.currentMoveItemName&&this.currentMoveItemPath?(this.state.isTreePanelShown&&this.deleteTreeNode(this.currentMoveItemPath),this.moveDirent(this.currentMoveItemName),this.currentMoveItemName="",this.currentMoveItemPath=""):(this.state.isTreePanelShown&&(a=this.getSelectedDirentPaths(),this.deleteTreeNodes(a)),l=this.getSelectedDirentNames(),this.moveDirents(l))),this.setState({isCopyMoveProgressDialogShow:!1}),c=(0,h.ih)("Successfully moved files to another library."),"copy"===n&&(c=(0,h.ih)("Successfully copied files to another library.")),W.Z.success(c),e.abrupt("return");case 19:d=i.total?parseInt((i.done/i.total*100).toFixed(2)):0,this.getAsyncCopyMoveProgress(),this.setState({asyncOperationProgress:d}),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(1),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1});case 27:case"end":return e.stop()}}),e,this,[[1,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"renameItemAjaxCallback",value:function(e,t){this.state.isTreePanelShown&&this.renameTreeNode(e,t),this.renameDirent(e,t)}},{key:"deleteItem",value:function(e,t){var n=this,r=this.props.repoID;t?this.setState({folderToDelete:e},(function(){n.toggleDeleteFolderDialog()})):C.I.deleteFile(r,e).then((function(r){n.deleteItemAjaxCallback(e,t);var o=f.c.getFileName(e),i=(0,h.ih)("Successfully deleted {name}").replace("{name}",o),s=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:i}),(0,m.jsx)("a",{className:"action-link p-0 ml-1",href:"#",onClick:n.restoreDeletedDirents.bind(n,r.data.commit_id,[e]),children:(0,h.ih)("Undo")})]});W.Z.success(s,{duration:5})})).catch((function(t){var n=f.c.getErrorMsg(t);if(n===(0,h.ih)("Error")){var r=f.c.getFileName(e);n=(0,h.ih)("Failed to delete {name}").replace("{name}",r)}W.Z.danger(n)}))}},{key:"deleteItemAjaxCallback",value:function(e){this.state.isTreePanelShown&&this.deleteTreeNode(e),this.deleteDirent(e)}},{key:"deleteDirent",value:function(e){if(e===this.state.path){var t=f.c.getDirName(e);this.showDir(t)}else if(f.c.isChildPath(e,this.state.path)){var n=f.c.getFileName(e),r=this.state.direntList.filter((function(e){return e.name!==n}));this.recalculateSelectedDirents([n],r),this.setState({direntList:r})}else if(f.c.isAncestorPath(e,this.state.path)){var o=f.c.getDirName(e);this.showDir(o)}}},{key:"createTreeNode",value:function(e,t){var n=this.createDirent(e,t);return new zn.Z({object:n})}},{key:"createDirent",value:function(e,t,n){var r=this.state.userPerm,o={name:e,type:t,mtime:(new Date).getTime()/1e3,size:n,permission:r};return new Fn.Z(o)}},{key:"render",value:function(){var e=this;if(this.state.libNeedDecrypt)return(0,m.jsx)(E.Z,{children:(0,m.jsx)(Gn,{repoID:this.props.repoID,onLibDecryptDialog:this.onLibDecryptDialog})});if(this.state.libNeedDecryptWhenCopy||this.state.libNeedDecryptWhenMove)return(0,m.jsx)(E.Z,{children:(0,m.jsx)(Gn,{repoID:this.state.destRepoWhenCopyMove.repo_id,onLibDecryptDialog:this.onLibDecryptWhenCopyMove})});if(this.state.errorMsg)return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("p",{className:"error mt-6 text-center",children:this.state.errorMsg}),(0,m.jsx)("button",{type:"submit",className:"btn btn-primary submit",onClick:this.handleSubmit,children:(0,h.ih)("Leave Share")})]});if(!this.state.currentRepoInfo)return"";var t=!1,n=this.state,r=n.currentRepoInfo,o=n.userPerm,i=n.isCopyMoveProgressDialogShow,s=n.isDeleteFolderDialogOpen,l=f.c.isHasPermissionToShare(r,o),c=r.owner_email===h.b6,d=r.is_virtual,u=r.is_admin;d||!c&&!u||(t=!0);var p=this.state.direntList.filter((function(t,n){return n<e.state.itemsShowLength})),g=!0,v=f.c.getUserPermission(o),y=v.isCustomPermission,x=v.customPermission;y&&(g=x.permission.upload);return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-north border-left-show",children:(0,m.jsx)(Yn,{isViewFile:this.state.isViewFile,filePermission:this.state.filePermission,fileTags:this.state.fileTags,onFileTagChanged:this.onToolbarFileTagChanged,onSideNavMenuClick:this.props.onMenuClick,repoID:this.props.repoID,path:this.state.path,isDirentSelected:this.state.isDirentSelected,selectedDirentList:this.state.selectedDirentList,onItemsMove:this.onMoveItems,onItemsCopy:this.onCopyItems,onItemsDelete:this.onDeleteItems,onItemRename:this.onMainPanelItemRename,direntList:this.state.direntList,repoName:this.state.repoName,repoEncrypted:this.state.repoEncrypted,isGroupOwnedRepo:this.state.isGroupOwnedRepo,userPerm:this.state.userPerm,showShareBtn:l,enableDirPrivateShare:t,onAddFile:this.onAddFile,onAddFolder:this.onAddFolder,onUploadFile:this.onUploadFile,onUploadFolder:this.onUploadFolder,currentMode:this.state.currentMode,switchViewMode:this.switchViewMode,onSearchedClick:this.onSearchedClick,isRepoOwner:c,currentRepoInfo:this.state.currentRepoInfo,updateDirent:this.updateDirent,onDirentSelected:this.onDirentSelected,showDirentDetail:this.showDirentDetail,unSelectDirent:this.unSelectDirent,onFilesTagChanged:this.onFileTagChanged,repoTags:this.state.repoTags})}),(0,m.jsxs)("div",{className:"main-panel-center flex-row",children:[(0,m.jsx)(mp,{repoEncrypted:this.state.repoEncrypted,isRepoOwner:c,onFilesTagChanged:this.onFileTagChanged,unSelectDirent:this.unSelectDirent,pathPrefix:this.props.pathPrefix,isTreePanelShown:this.state.isTreePanelShown,toggleTreePanel:this.toggleTreePanel,currentMode:this.state.currentMode,switchViewMode:this.switchViewMode,isCustomPermission:y,path:this.state.path,pathExist:this.state.pathExist,currentRepoInfo:this.state.currentRepoInfo,repoID:this.props.repoID,enableDirPrivateShare:t,userPerm:o,isGroupOwnedRepo:this.state.isGroupOwnedRepo,onTabNavClick:this.props.onTabNavClick,onMainNavBarClick:this.onMainNavBarClick,isViewFile:this.state.isViewFile,hash:this.state.hash,fileTags:this.state.fileTags,isFileLoading:this.state.isFileLoading,isFileLoadedErr:this.state.isFileLoadedErr,filePermission:this.state.filePermission,content:this.state.content,lastModified:this.state.lastModified,latestContributor:this.state.latestContributor,onLinkClick:this.onLinkClick,isTreeDataLoading:this.state.isTreeDataLoading,treeData:this.state.treeData,currentNode:this.state.currentNode,onNodeClick:this.onTreeNodeClick,onNodeCollapse:this.onTreeNodeCollapse,onNodeExpanded:this.onTreeNodeExpanded,onAddFolderNode:this.onAddFolder,onAddFileNode:this.onAddFile,onRenameNode:this.onRenameTreeNode,onDeleteNode:this.onDeleteTreeNode,repoTags:this.state.repoTags,usedRepoTags:this.state.usedRepoTags,updateUsedRepoTags:this.updateUsedRepoTags,isDirentListLoading:this.state.isDirentListLoading,direntList:p,fullDirentList:this.state.direntList,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,updateDirent:this.updateDirent,onDirentClick:this.onDirentClick,onItemClick:this.onItemClick,onItemSelected:this.onDirentSelected,onItemDelete:this.onMainPanelItemDelete,onItemRename:this.onMainPanelItemRename,onItemMove:this.onMoveItem,onItemCopy:this.onCopyItem,onItemConvert:this.onConvertItem,onAddFolder:this.onAddFolder,onAddFile:this.onAddFile,onFileTagChanged:this.onFileTagChanged,isDirentSelected:this.state.isDirentSelected,isAllDirentSelected:this.state.isAllDirentSelected,onAllDirentSelected:this.onAllDirentSelected,isDirentDetailShow:this.state.isDirentDetailShow,selectedDirent:this.state.selectedDirentList&&this.state.selectedDirentList[0],selectedDirentList:this.state.selectedDirentList,onItemsMove:this.onMoveItems,onItemsCopy:this.onCopyItems,onItemsDelete:this.onDeleteItems,closeDirentDetail:this.closeDirentDetail,showDirentDetail:this.showDirentDetail,direntDetailPanelTab:this.state.direntDetailPanelTab,onDeleteRepoTag:this.onDeleteRepoTag,onToolbarFileTagChanged:this.onToolbarFileTagChanged,updateDetail:this.state.updateDetail,onListContainerScroll:this.onListContainerScroll,loadDirentList:this.loadDirentList,showShareBtn:l,onUploadFile:this.onUploadFile,onUploadFolder:this.onUploadFolder}),g&&this.state.pathExist&&!this.state.isViewFile&&(0,m.jsx)(_p,{ref:function(t){return e.uploader=t},dragAndDrop:!0,path:this.state.path,repoID:this.props.repoID,direntList:this.state.direntList,onFileUploadSuccess:this.onFileUploadSuccess,isCustomPermission:y})]}),i&&(0,m.jsx)(Np.Z,{type:this.state.asyncOperationType,asyncOperatedFilesLength:this.state.asyncOperatedFilesLength,asyncOperationProgress:this.state.asyncOperationProgress,toggleDialog:this.onMoveProgressDialogToggle}),s&&(0,m.jsx)(Rp,{repoID:this.props.repoID,path:this.state.folderToDelete,deleteFolder:this.deleteFolder,toggleDialog:this.toggleDeleteFolderDialog})]})}}]),n}(a.Component),Op=Tp,Ep=n(19778),Pp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.members;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.Z,{toggle:this.props.toggleDialog,children:"".concat((0,h.ih)("Group members")," (").concat(e.length,")")}),(0,m.jsx)(M.Z,{className:"px-0",children:(0,m.jsx)("ul",{className:"list-unstyled",children:e.map((function(e,t){return(0,m.jsxs)("li",{className:"group-member px-4 py-2 d-flex align-items-center",children:[(0,m.jsx)("img",{src:e.avatar_url,alt:e.name,className:"avatar"}),(0,m.jsx)("span",{className:"ml-2 text-truncate",title:e.name,children:e.name})]},t)}))})})]})}}]),n}(a.Component),Zp=Pp,Fp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).dismissGroup=function(){var e=(0,xt.Z)(o);C.I.deleteGroup(o.props.groupID).then((function(t){e.props.onGroupChanged()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)(p.Z,{isOpen:this.props.showDismissGroupDialog,toggle:this.props.toggleDismissGroupDialog,children:[(0,m.jsx)(I.Z,{children:(0,h.ih)("Delete Group")}),(0,m.jsx)(M.Z,{children:(0,m.jsx)("span",{children:(0,h.ih)("Really want to delete this group?")})}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.props.toggleDismissGroupDialog,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.dismissGroup,children:(0,h.ih)("Delete")})]})]})}}]),n}(a.Component),Lp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleGroupNameChange=function(e){e.target.value.trim()?o.setState({isSubmitBtnActive:!0}):o.setState({isSubmitBtnActive:!1});var t=e.target.value;o.setState({newGroupName:t})},o.renameGroup=function(){var e=o.state.newGroupName.trim();if(e){var t=(0,xt.Z)(o);C.I.renameGroup(o.props.groupID,e).then((function(e){t.props.loadGroup(o.props.groupID),t.props.onGroupChanged(e.data.id)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}o.setState({newGroupName:""}),o.props.toggleRenameGroupDialog()},o.handleKeyDown=function(e){13===e.keyCode&&o.renameGroup()},o.state={newGroupName:o.props.currentGroupName,isSubmitBtnActive:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)(p.Z,{isOpen:this.props.showRenameGroupDialog,toggle:this.props.toggleRenameGroupDialog,children:[(0,m.jsx)(I.Z,{children:(0,h.ih)("Rename Group")}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)("label",{htmlFor:"newGroupName",children:(0,h.ih)("Rename group to")}),(0,m.jsx)(L.Z,{type:"text",id:"newGroupName",value:this.state.newGroupName,onChange:this.handleGroupNameChange,onKeyDown:this.handleKeyDown})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.props.toggleRenameGroupDialog,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.renameGroup,disabled:!this.state.isSubmitBtnActive,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),Ap=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleSelectChange=function(e){o.setState({selectedOption:e,errMessage:""}),o.options=[]},o.transferGroup=function(){var e=o.state.selectedOption&&o.state.selectedOption.email;e&&C.I.transferGroup(o.props.groupID,e).then((function(e){o.props.toggleTransferGroupDialog()})).catch((function(e){var t=f.c.getErrorMsg(e);o.setState({errMessage:t})}))},o.toggle=function(){o.props.toggleTransferGroupDialog()},o.state={selectedOption:null,errMessage:""},o.options=[],o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:(0,h.ih)("Transfer Group")}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)("p",{children:(0,h.ih)("Transfer group to")}),(0,m.jsx)(It.Z,{ref:"userSelect",isMulti:!1,className:"reviewer-select",placeholder:(0,h.ih)("Please enter 1 or more character"),onSelectChange:this.handleSelectChange}),(0,m.jsx)("div",{className:"error",children:this.state.errMessage})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggle,children:(0,h.ih)("Close")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.transferGroup,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),Up=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggle=function(){o.props.toggleImportMembersDialog()},o.openFileInput=function(){o.fileInputRef.current.click()},o.uploadFile=function(e){if(o.fileInputRef.current.files.length){var t=o.fileInputRef.current.files[0].name;if("xlsx"==t.substr(t.lastIndexOf(".")+1)){var n=o.fileInputRef.current.files[0];o.props.importMembersInBatch(n),o.toggle()}else o.setState({errorMsg:(0,h.ih)("Please choose a .xlsx file.")})}},o.state={errorMsg:""},o.fileInputRef=a.createRef(),o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state.errorMsg;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:(0,h.ih)("Import members from a .xlsx file")}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)("p",{children:h.Iu}),(0,m.jsx)("p",{children:(0,m.jsx)("a",{className:"text-secondary small",href:"".concat(h.ze,"api/v2.1/group-members-import-example/"),children:(0,h.ih)("Download an example file")})}),(0,m.jsx)("button",{className:"btn btn-outline-primary",onClick:this.openFileInput,children:(0,h.ih)("Upload file")}),(0,m.jsx)("input",{className:"d-none",type:"file",onChange:this.uploadFile,ref:this.fileInputRef}),e&&(0,m.jsx)(st.Z,{color:"danger",children:e})]}),(0,m.jsx)(N.Z,{children:(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggle,children:(0,h.ih)("Cancel")})})]})}}]),n}(a.Component),zp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.groupMembers,n=e.changeMember,r=e.deleteMember,o=e.groupID,i=e.isOwner,s=e.isItemFreezed,a=e.toggleItemFreezed;return(0,m.jsxs)(_.Z,{size:"sm",className:"manage-members-table",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"10%"}),(0,m.jsx)("th",{width:"45%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"35%",children:(0,h.ih)("Role")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:t.map((function(e,t){return(0,m.jsx)(Bp,{item:e,changeMember:n,deleteMember:r,groupID:o,isOwner:i,isItemFreezed:s,toggleItemFreezed:a},t)}))})]})}}]),n}(a.Component),Bp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onChangeUserRole=function(e){var t="Admin"===e.value?"True":"False";C.I.setGroupAdmin(o.props.groupID,o.props.item.email,t).then((function(e){o.props.changeMember(e.data)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.deleteMember=function(){var e=o.props.item;C.I.deleteGroupMember(o.props.groupID,e.email).then((function(t){o.props.deleteMember(e),W.Z.success((0,h.ih)("Successfully deleted {name}.").replace("{name}",e.name))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.handleMouseOver=function(){o.props.isItemFreezed||o.setState({highlight:!0})},o.handleMouseLeave=function(){o.props.isItemFreezed||o.setState({highlight:!1})},o.translateRole=function(e){return"Admin"===e?(0,h.ih)("Admin"):"Member"===e?(0,h.ih)("Member"):"Owner"===e?(0,h.ih)("Owner"):void 0},o.roleOptions=[{value:"Admin",text:(0,h.ih)("Admin"),isSelected:!1},{value:"Member",text:(0,h.ih)("Member"),isSelected:!1}],o.state={highlight:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state.highlight,t=this.props,n=t.item,r=t.isOwner,o="Owner"!==n.role&&!0===r||"Member"===n.role&&!1===r,i=n.role;this.roleOptions=this.roleOptions.map((function(e){return e.isSelected=e.value==i,e}));var s=this.roleOptions.filter((function(e){return e.isSelected}))[0];return(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,className:this.state.highlight?"tr-highlight":"",tabIndex:"0",onFocus:this.handleMouseOver,children:[(0,m.jsx)("th",{scope:"row",children:(0,m.jsx)("img",{className:"avatar",src:n.avatar_url,alt:""})}),(0,m.jsx)("td",{children:n.name}),(0,m.jsxs)("td",{children:[(!1===r||!0===r&&"Owner"===n.role)&&(0,m.jsx)("span",{className:"group-admin",children:this.translateRole(n.role)}),!0===r&&"Owner"!==n.role&&(0,m.jsx)(we.Z,{isDropdownToggleShown:e,currentSelectedOption:s,options:this.roleOptions,selectOption:this.onChangeUserRole,toggleItemFreezed:this.props.toggleItemFreezed})]}),(0,m.jsx)("td",{children:o&&this.state.highlight&&(0,m.jsx)(At.Z,{className:"action-icon sf2-icon-x3",title:(0,h.ih)("Delete"),op:this.deleteMember})})]})}}]),n}(a.PureComponent),Gp=zp,Hp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).listGroupMembers=function(e){var t=o.props.groupID,n=o.state,r=n.perPage,i=n.groupMembers;C.I.listGroupMembers(t,e,r).then((function(t){var n=t.data;o.setState({isLoading:!1,isLoadingMore:!1,page:e,hasNextPage:!(n.length<r),groupMembers:i.concat(n)})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t),o.setState({isLoading:!1,isLoadingMore:!1,hasNextPage:!1})}))},o.onSelectChange=function(e){o.setState({selectedOption:e,errMessage:[]})},o.addGroupMember=function(){for(var e=[],t=0;t<o.state.selectedOption.length;t++)e.push(o.state.selectedOption[t].email);C.I.addGroupMembers(o.props.groupID,e).then((function(e){var t=e.data.success;o.setState({groupMembers:[].concat(t,o.state.groupMembers),selectedOption:null}),o.refs.userSelect.clearSelect(),e.data.failed.length>0&&o.setState({errMessage:e.data.failed})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.toggleItemFreezed=function(e){o.setState({isItemFreezed:e})},o.handleScroll=function(e){var t=o.state,n=t.page,r=t.hasNextPage,i=t.isLoadingMore;if(r&&!i){var s=e.target.clientHeight,a=e.target.scrollHeight;s+e.target.scrollTop+1>=a&&o.setState({isLoadingMore:!0},(function(){o.listGroupMembers(n+1)}))}},o.changeMember=function(e){o.setState({groupMembers:o.state.groupMembers.map((function(t){return t.email==e.email&&(t=e),t}))})},o.deleteMember=function(e){var t=o.state.groupMembers;t.splice(t.indexOf(e),1),o.setState({groupMembers:t})},o.searchMembers=function(e){var t=o.state.groupMembers,n=e.target.value,r=n.trim().toLowerCase(),i=t.filter((function(e){return e.name.toLowerCase().indexOf(r)>-1}));o.setState({keyword:n,membersFound:i})},o.clearSearch=function(){o.setState({keyword:"",membersFound:[]})},o.onSearchInputFocus=function(){o.setState({searchActive:!0})},o.onSearchInputBlur=function(){o.setState({searchActive:!1})},o.state={isLoading:!0,isLoadingMore:!1,groupMembers:[],page:1,perPage:100,hasNextPage:!1,selectedOption:null,errMessage:[],isItemFreezed:!1,searchActive:!1,keyword:"",membersFound:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.listGroupMembers(this.state.page)}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.hasNextPage,r=e.groupMembers,o=e.keyword,i=e.membersFound,s=e.searchActive;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("p",{className:"mb-2",children:(0,h.ih)("Add group member")}),(0,m.jsxs)("div",{className:"add-members",children:[(0,m.jsx)(It.Z,{placeholder:(0,h.ih)("Search users"),onSelectChange:this.onSelectChange,ref:"userSelect",isMulti:!0,className:"add-members-select"}),this.state.selectedOption?(0,m.jsx)(R.Z,{color:"secondary",onClick:this.addGroupMember,children:(0,h.ih)("Submit")}):(0,m.jsx)(R.Z,{color:"secondary",disabled:!0,children:(0,h.ih)("Submit")})]}),this.state.errMessage.length>0&&this.state.errMessage.map((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,m.jsx)("div",{className:"group-error error",children:e.error_msg},t)})),r.length>10&&(0,m.jsxs)(kt.Z,{className:"search-group-members rounded ".concat(s?"active":""),children:[(0,m.jsx)(Jt.Z,{children:(0,m.jsx)("i",{className:"sf3-font sf3-font-search","aria-hidden":!0})}),(0,m.jsx)(L.Z,{type:"text",className:"input-group-input px-0",placeholder:(0,h.ih)("Search group members"),value:o,onChange:this.searchMembers,onFocus:this.onSearchInputFocus,onBlur:this.onSearchInputBlur}),o&&(0,m.jsx)(Jt.Z,{children:(0,m.jsx)("i",{className:"sf2-icon-x1","aria-hidden":!0,onClick:this.clearSearch})})]}),(0,m.jsx)("div",{className:"manage-members",onScroll:o.trim()?function(){}:this.handleScroll,children:t?(0,m.jsx)(D.Z,{}):(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(Gp,{groupMembers:o.trim()?i:r,changeMember:this.changeMember,deleteMember:this.deleteMember,groupID:this.props.groupID,isOwner:this.props.isOwner,isItemFreezed:this.state.isItemFreezed,toggleItemFreezed:this.toggleItemFreezed}),!o.trim()&&n&&(0,m.jsx)(D.Z,{})]})})]})}}]),n}(a.Component),Yp=Hp,Vp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.groupID,n=e.isOwner,r=e.toggleManageMembersDialog;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:r,className:"group-manage-members-dialog",children:[(0,m.jsx)(I.Z,{toggle:r,children:(0,h.ih)("Manage group members")}),(0,m.jsx)(M.Z,{className:"pb-0",children:(0,m.jsx)(Yp,{groupID:t,isOwner:n})})]})}}]),n}(a.Component),Wp=Vp,Kp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).leaveGroup=function(){C.I.quitGroup(o.props.groupID,h.b6).then((function(e){o.props.onGroupChanged()})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.props.toggleLeaveGroupDialog,children:[(0,m.jsx)(I.Z,{toggle:this.props.toggleLeaveGroupDialog,children:(0,h.ih)("Leave Group")}),(0,m.jsx)(M.Z,{children:(0,m.jsx)("p",{children:(0,h.ih)("Really want to leave this group?")})}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.props.toggleLeaveGroupDialog,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.leaveGroup,children:(0,h.ih)("Leave")})]})]})}}]),n}(a.Component),qp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleDropdownMenu=function(){o.setState({isDropdownMenuOpen:!o.state.isDropdownMenuOpen})},o.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.toggleDropdownMenu()},o.onMenuItemKeyDown=function(e,t){"Enter"!=t.key&&"Space"!=t.key||e.onClick()},o.state={isDropdownMenuOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props.opList;return(0,m.jsx)(a.Fragment,{children:(0,m.jsxs)(H.Z,{isOpen:this.state.isDropdownMenuOpen,toggle:this.toggleDropdownMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",role:"button",className:"sf3-font-down sf3-font ml-1 sf-dropdown-toggle",onClick:this.toggleDropdownMenu,onKeyDown:this.onDropdownToggleKeyDown,"data-toggle":"dropdown"}),(0,m.jsx)(Me.Z,{children:t.map((function(t,n){return"Divider"==t?(0,m.jsx)(V.Z,{divider:!0},n):(0,m.jsx)(V.Z,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:t.text},n)}))})]})})}}]),n}(a.Component),$p=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).loadGroup=function(e){C.I.getGroup(e).then((function(e){var t=new Ep.Z(e.data),n=o.getEmptyTip(t),r=t.admins.indexOf(h.b6)>-1,i=t.owner===h.b6,s=0!==t.parent_group_id;o.setState({emptyTip:n,currentGroup:t,isStaff:r,isDepartmentGroup:s,isOwner:i,currentPage:1,repoList:[]},(function(){o.loadRepos(o.state.currentPage),o.listGroupMembers()}))})).catch((function(e){o.setState({isLoading:!1,errMessage:f.c.getErrorMsg(e,!0)})}))},o.loadRepos=function(e){var t=o.state.perPage;C.I.listGroupRepos(o.props.groupID,e,t).then((function(n){var r=!0;n.data.length<t&&(r=!1);var i=o.state.repoList,s=n.data.map((function(e){return new Ne(e)}));s.length&&(i=i.concat(s)),o.setState({isLoading:!1,isLoadingMore:!1,currentPage:e,hasNextPage:r,repoList:f.c.sortRepos(i,o.state.sortBy,o.state.sortOrder)})})).catch((function(e){o.setState({isLoading:!1,isLoadingMore:!1,errMessage:f.c.getErrorMsg(e,!0)})}))},o.getEmptyTip=function(e){var t=null;return e&&(t=0===e.parent_group_id?(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No libraries shared with this group")}),(0,m.jsx)("p",{children:(0,h.ih)('No libraries have been shared with this group yet. A library shared with a group can be accessed by all group members. You can share a library with a group in "My Libraries". You can also create a new library to be shared with this group by clicking the "New Library" button in the menu bar.')})]}):-1==e.admins.indexOf(h.b6)?(0,m.jsx)(j.Z,{children:(0,m.jsx)("h2",{children:(0,h.ih)("No libraries")})}):(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No libraries")}),(0,m.jsx)("p",{children:(0,h.ih)('You can create libraries by clicking the "New Library" button above.')})]})),t},o.onCreateRepoToggle=function(){o.setState({isCreateRepoDialogShow:!o.state.isCreateRepoDialogShow})},o.onCreateRepo=function(e,t){var n=o.props.groupID;t&&"department"===t?C.I.createGroupOwnedLibrary(n,e).then((function(e){var t={repo_id:e.data.id,repo_name:e.data.name,owner_name:e.data.group_name,owner_email:e.data.owner,permission:e.data.permission,mtime:e.data.mtime,size:e.data.size,encrypted:e.data.encrypted},n=new Ne(t),r=o.addRepoItem(n);o.setState({repoList:r})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})):C.I.createGroupRepo(n,e).then((function(e){var t=new Ne(e.data),n=o.addRepoItem(t);o.setState({repoList:n})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})),o.onCreateRepoToggle()},o.onItemDelete=function(e){var t=o.props.groupID,n=o.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));o.setState({repoList:n}),o.loadGroup(t)},o.addRepoItem=function(e){var t=o.state.repoList.map((function(e){return e}));return t.unshift(e),t},o.onItemUnshare=function(e){var t=o.state.currentGroup;C.I.unshareRepoToGroup(e.repo_id,t.id).then((function(){var n=o.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));o.setState({repoList:n}),o.loadGroup(t.id)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onItemRename=function(e,t){C.I.renameGroupOwnedLibrary(o.props.groupID,e.repo_id,t).then((function(n){var r=o.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n}));o.setState({repoList:r})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onMonitorRepo=function(e,t){var n=o.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));o.setState({repoList:n})},o.toggleDismissGroupDialog=function(){o.setState({showDismissGroupDialog:!o.state.showDismissGroupDialog,showGroupDropdown:!1})},o.toggleRenameGroupDialog=function(){o.setState({showRenameGroupDialog:!o.state.showRenameGroupDialog,showGroupDropdown:!1})},o.toggleTransferGroupDialog=function(){o.setState({showTransferGroupDialog:!o.state.showTransferGroupDialog,showGroupDropdown:!1})},o.toggleImportMembersDialog=function(){o.setState({showImportMembersDialog:!o.state.showImportMembersDialog})},o.importMembersInBatch=function(e){W.Z.notify((0,h.ih)("It may take some time, please wait.")),C.I.importGroupMembersViaFile(o.state.currentGroup.id,e).then((function(e){e.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);W.Z.danger(t)}))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.toggleManageMembersDialog=function(){o.setState({showManageMembersDialog:!o.state.showManageMembersDialog,showGroupDropdown:!1})},o.toggleLeaveGroupDialog=function(){o.setState({isLeaveGroupDialogOpen:!o.state.isLeaveGroupDialogOpen,showGroupDropdown:!1})},o.listGroupMembers=function(){C.I.listGroupMembers(o.props.groupID).then((function(e){o.setState({groupMembers:e.data})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.toggleGroupMembersPopover=function(e){"open"===e?(o.listGroupMembers(),o.setState({showGroupMembersPopover:!0})):o.setState({showGroupMembersPopover:!1})},o.sortItems=function(e,t){_e.ZP.save("seafile-repo-dir-sort-by",e),_e.ZP.save("seafile-repo-dir-sort-order",t),o.setState({sortBy:e,sortOrder:t,repoList:f.c.sortRepos(o.state.repoList,e,t)})},o.translateRole=function(e){return"Admin"===e?(0,h.ih)("Admin"):"Member"===e?(0,h.ih)("Member"):"Owner"===e?(0,h.ih)("Owner"):void 0},o.toggleSortOptionsDialog=function(){o.setState({isSortOptionsDialogOpen:!o.state.isSortOptionsDialogOpen})},o.handleScroll=function(e){var t=o.state,n=t.currentPage,r=t.hasNextPage,i=t.isLoadingMore;if(r&&!i){var s=e.target.clientHeight,a=e.target.scrollHeight;s+e.target.scrollTop+1>=a&&o.setState({isLoadingMore:!0},(function(){o.loadRepos(n+1)}))}},o.toggleMembersDialog=function(){o.setState({isMembersDialogOpen:!o.state.isMembersDialogOpen})},o.getOpList=function(){var e=o.state,t=e.currentGroup,n=e.isDepartmentGroup,r=e.isStaff,i=e.isOwner,s=[];return(!n&&h.cA||n&&r)&&s.push({text:(0,h.ih)("New Library"),onClick:o.onCreateRepoToggle}),s.push({text:(0,h.ih)("Members"),onClick:o.toggleMembersDialog}),t&&((r||i)&&(s.push({text:(0,h.ih)("Rename"),onClick:o.toggleRenameGroupDialog}),i&&s.push({text:(0,h.ih)("Transfer"),onClick:o.toggleTransferGroupDialog}),s.push({text:(0,h.ih)("Import members"),onClick:o.toggleImportMembersDialog}),s.push({text:(0,h.ih)("Manage members"),onClick:o.toggleManageMembersDialog}),i&&s.push({text:(0,h.ih)("Delete group"),onClick:o.toggleDismissGroupDialog})),i||n||s.push({text:(0,h.ih)("Leave group"),onClick:o.toggleLeaveGroupDialog})),s},o.state={isLoading:!0,isLoadingMore:!1,errMessage:"",emptyTip:null,currentGroup:null,currentRepo:null,isStaff:!1,isOwner:!1,sortBy:_e.ZP.load("seafile-repo-dir-sort-by")||"name",sortOrder:_e.ZP.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1,repoList:[],currentPage:1,perPage:300,hasNextPage:!1,libraryType:"group",isCreateRepoDialogShow:!1,isDepartmentGroup:!1,showGroupDropdown:!1,showGroupMembersPopover:!1,showRenameGroupDialog:!1,showDismissGroupDialog:!1,showTransferGroupDialog:!1,showImportMembersDialog:!1,showManageMembersDialog:!1,groupMembers:[],isLeaveGroupDialogOpen:!1,isMembersDialogOpen:!1},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this.props.groupID;this.loadGroup(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.groupID!==this.props.groupID&&this.loadGroup(e.groupID)}},{key:"render",value:function(){var e=this.state,t=e.errMessage,n=e.emptyTip,r=e.currentGroup,o=e.isDepartmentGroup,i=e.groupMembers,s=e.isMembersDialogOpen,l=0;o&&r.group_quota&&(l=r.group_quota_usage/r.group_quota*100+"%");var c=this.getOpList();return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{className:"main-panel-north border-left-show",children:[(0,m.jsx)("div",{className:"cur-view-toolbar",children:(0,m.jsx)("span",{className:"sf2-icon-menu side-nav-toggle d-md-none",title:"Side Nav Menu",onClick:this.props.onShowSidePanel})}),(0,m.jsx)(xn.Z,{onSearchedClick:this.props.onSearchedClick})]}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:r&&(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{className:"sf-heading d-flex align-items-center",children:[o&&(0,m.jsx)("span",{className:"sf3-font-department sf3-font nav-icon",title:(0,h.ih)("This is a special group representing a department.")}),(0,m.jsx)("span",{children:r.name}),(0,m.jsx)(qp,{opList:c})]}),(0,m.jsxs)("div",{className:"path-tool",children:[o&&(0,m.jsx)(m.Fragment,{children:r.group_quota>0&&(0,m.jsx)("div",{className:"department-usage-container",children:(0,m.jsxs)("div",{className:"department-usage",children:[(0,m.jsx)("span",{id:"quota-bar",className:"department-quota-bar",children:(0,m.jsx)("span",{id:"quota-usage",className:"usage",style:{width:l}})}),(0,m.jsxs)("span",{className:"department-quota-info",children:[f.c.bytesToSize(r.group_quota_usage)," / ",f.c.bytesToSize(r.group_quota)]})]})})}),!f.c.isDesktop()&&this.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(ve,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})]})]})}),(0,m.jsxs)("div",{className:"cur-view-content d-block",onScroll:this.handleScroll,children:[this.state.isLoading&&(0,m.jsx)(D.Z,{}),!this.state.isLoading&&t&&(0,m.jsx)("div",{className:"error text-center mt-2",children:t}),!this.state.isLoading&&0===this.state.repoList.length&&n,!this.state.isLoading&&this.state.repoList.length>0&&(0,m.jsx)(In,{repoList:this.state.repoList,hasNextPage:this.state.hasNextPage,currentGroup:this.state.currentGroup,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,onItemUnshare:this.onItemUnshare,onItemDelete:this.onItemDelete,onItemRename:this.onItemRename,onMonitorRepo:this.onMonitorRepo})]})]})}),this.state.isCreateRepoDialogShow&&!this.state.isDepartmentGroup&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(lt,{libraryType:this.state.libraryType,onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo})}),this.state.isCreateRepoDialogShow&&this.state.isDepartmentGroup&&(0,m.jsx)(lt,{onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo,libraryType:"department"}),s&&(0,m.jsx)(Zp,{members:i,toggleDialog:this.toggleMembersDialog}),this.state.showRenameGroupDialog&&(0,m.jsx)(Lp,{showRenameGroupDialog:this.state.showRenameGroupDialog,toggleRenameGroupDialog:this.toggleRenameGroupDialog,loadGroup:this.loadGroup,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged,currentGroupName:r.name}),this.state.showDismissGroupDialog&&(0,m.jsx)(Fp,{showDismissGroupDialog:this.state.showDismissGroupDialog,toggleDismissGroupDialog:this.toggleDismissGroupDialog,loadGroup:this.loadGroup,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged}),this.state.showTransferGroupDialog&&(0,m.jsx)(Ap,{toggleTransferGroupDialog:this.toggleTransferGroupDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged}),this.state.showImportMembersDialog&&(0,m.jsx)(Up,{toggleImportMembersDialog:this.toggleImportMembersDialog,importMembersInBatch:this.importMembersInBatch}),this.state.showManageMembersDialog&&(0,m.jsx)(Wp,{toggleManageMembersDialog:this.toggleManageMembersDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged,isOwner:this.state.isOwner}),this.state.isLeaveGroupDialogOpen&&(0,m.jsx)(Kp,{toggleLeaveGroupDialog:this.toggleLeaveGroupDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged})]})}}]),n}(a.Component),Xp=n(9368),Jp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleDialog=function(){o.setState({isDialogOpen:!o.state.isDialogOpen})},o.state={isDialogOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)(m.Fragment,{children:[f.c.isDesktop()?(0,m.jsx)("div",{className:"operation",children:(0,m.jsxs)("button",{className:"btn btn-secondary operation-item",onClick:this.toggleDialog,children:[(0,m.jsx)("i",{className:"sf3-font-new-group1 sf3-font text-secondary mr-1"}),(0,h.ih)("New Group")]})}):(0,m.jsx)("span",{className:"sf2-icon-plus mobile-toolbar-icon",title:(0,h.ih)("New Group"),onClick:this.toggleDialog}),this.state.isDialogOpen&&(0,m.jsx)(Xp.Z,{toggleDialog:this.toggleDialog,onCreateGroup:this.props.onCreateGroup})]})}}]),n}(a.Component),Qp=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onItemUnshare=function(e){var t=o.props.group;C.I.unshareRepoToGroup(e.repo_id,t.id).then((function(){t.repos=t.repos.filter((function(t){return t.repo_id!==e.repo_id})),o.props.updateGroup(t)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onItemDelete=function(e){var t=o.props.group;t.repos=t.repos.filter((function(t){return t.repo_id!==e.repo_id})),o.props.updateGroup(t)},o.onItemRename=function(e,t){var n=o.props.group;C.I.renameGroupOwnedLibrary(n.id,e.repo_id,t).then((function(n){var r=o.props.group;r.repos=r.repos.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n})),o.props.updateGroup(r)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onMonitorRepo=function(e,t){var n=o.props.group;n.repos=n.repos.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n})),o.props.updateGroup(n)},o.toggleCreateRepoDialog=function(){o.setState({isCreateRepoDialogOpen:!o.state.isCreateRepoDialogOpen})},o.onCreateRepo=function(e){var t=o.props.group,n=t.id,r=t.repos;C.I.createGroupOwnedLibrary(n,e).then((function(e){var n={repo_id:e.data.id,repo_name:e.data.name,owner_name:e.data.group_name,owner_email:e.data.owner,permission:e.data.permission,mtime:e.data.mtime,size:e.data.size,encrypted:e.data.encrypted},i=new Ne(n);r.unshift(i),o.props.updateGroup(t)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)})),o.toggleCreateRepoDialog()},o.state={isCreateRepoDialogOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.group,n=e.currentViewMode,r=void 0===n?"list":n,o=t.parent_group_id,i=t.admins,s=(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(r,"-mode"),children:(0,h.ih)("No libraries")}),a=0!=o&&i.indexOf(h.b6)>-1;return(0,m.jsxs)("div",{className:"pb-3",children:[(0,m.jsx)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat("list"==r?"sf-border-bottom":""),children:(0,m.jsxs)("h4",{className:"sf-heading m-0 d-flex align-items-center",children:[(0,m.jsx)("span",{className:"".concat(0==t.parent_group_id?"sf3-font-group":"sf3-font-department"," sf3-font nav-icon"),"aria-hidden":"true"}),(0,m.jsx)("a",{href:"".concat(h.ze,"group/").concat(t.id,"/"),title:t.name,className:"ellipsis",children:t.name}),a&&(0,m.jsx)(qp,{opList:[{text:(0,h.ih)("New Library"),onClick:this.toggleCreateRepoDialog}]})]})}),0===t.repos.length?s:(0,m.jsx)(In,{theadHidden:!0,isShowRepoOwner:!1,currentGroup:this.props.group,repoList:t.repos,onItemUnshare:this.onItemUnshare,onItemDelete:this.onItemDelete,onItemRename:this.onItemRename,onMonitorRepo:this.onMonitorRepo,currentViewMode:r}),this.state.isCreateRepoDialogOpen&&(0,m.jsx)(lt,{onCreateToggle:this.toggleCreateRepoDialog,onCreateRepo:this.onCreateRepo,libraryType:"department"})]})}}]),n}(a.Component),eh=Qp,th=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).listGroups=function(){C.I.listGroups(!0).then((function(e){var t=e.data.map((function(e){var t=new Ep.Z(e);return t.repos=e.repos.map((function(e){return new Ne(e)})),t}));o.setState({isLoading:!1,groupList:t.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1}))})})).catch((function(e){o.setState({isLoading:!1,errorMsg:f.c.getErrorMsg(e,!0)})}))},o.onCreateGroup=function(e){var t=new Ep.Z(e),n=o.state.groupList;n.unshift(t),o.setState({groupList:n})},o.updateGroup=function(e){var t=o.state.groupList;o.setState({groupList:t.map((function(t){return t.id==e.id&&(t=e),t}))})},o.state={isLoading:!0,errorMsg:"",groupList:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.listGroups()}},{key:"render",value:function(){var e=this,t=(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No groups")}),h.Wz?(0,m.jsx)("p",{children:(0,h.ih)('You are not in any groups. Groups allow multiple people to collaborate on libraries. You can create a group by clicking the "New Group" button in the menu bar.')}):(0,m.jsx)("p",{children:(0,h.ih)("You are not in any groups. Groups allow multiple people to collaborate on libraries. Groups you join will be listed here.")})]});return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(xe.Z,{onShowSidePanel:this.props.onShowSidePanel,onSearchedClick:this.props.onSearchedClick,children:h.Wz&&(0,m.jsx)(Jp,{onCreateGroup:this.onCreateGroup})}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.ih)("My Groups")})}),(0,m.jsxs)("div",{className:"cur-view-content cur-view-content-groups",children:[this.state.isLoading&&(0,m.jsx)(D.Z,{}),!this.state.isLoading&&this.state.errorMsg&&(0,m.jsx)("div",{className:"error text-center mt-2",children:this.state.errorMsg}),!this.state.isLoading&&!this.state.errorMsg&&0==this.state.groupList.length&&t,!this.state.isLoading&&this.state.groupList.map((function(t,n){return(0,m.jsx)(eh,{group:t,updateGroup:e.updateGroup},n)}))]})]})})]})}}]),n}(a.Component),nh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,r.Z)(this,n),t.call(this,e)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.onShowSidePanel,n=e.onSearchedClick,r=e.toggleInvitePeopleDialog;return(0,m.jsxs)("div",{className:"main-panel-north border-left-show",children:[(0,m.jsxs)("div",{className:"cur-view-toolbar",children:[(0,m.jsx)("span",{title:"Side Nav Menu",onClick:t,className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none"}),f.c.isDesktop()?(0,m.jsx)("div",{className:"operation",children:(0,m.jsxs)(R.Z,{color:"btn btn-secondary operation-item",onClick:r,children:[(0,m.jsx)("i",{className:"sf3-font sf3-font-enlarge text-secondary mr-1"}),(0,h.ih)("Invite Guest")]})}):(0,m.jsx)("span",{className:"sf2-icon-plus mobile-toolbar-icon",title:(0,h.ih)("Invite Guest"),onClick:r})]}),(0,m.jsx)(xn.Z,{searchPlaceholder:this.props.searchPlaceholder,onSearchedClick:n})]})}}]),n}(a.Component),rh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleInputChange=function(e){var t=e.target.value;o.setState({emails:t}),o.state.errorMsg&&o.setState({errorMsg:""})},o.handleKeyDown=function(e){13===e.keyCode&&(e.preventDefault(),o.handleSubmitInvite())},o.handleSubmitInvite=function(){var e=o.state.emails.trim();if(!e)return o.setState({errorMsg:(0,h.ih)("It is required.")}),!1;for(var t=[],n=0,r=(e=e.split(",")).length;n<r;n++){var i=e[n].trim();i&&t.push(i)}if(!t.length)return o.setState({errorMsg:(0,h.ih)("Email is invalid.")}),!1;o.setState({isSubmitting:!0}),C.I.invitePeople(t).then((function(e){o.props.toggleDialog();var t=e.data.success;if(t.length){var n="";n=1==t.length?(0,h.ih)("Successfully invited %(email).").replace("%(email)",t[0].accepter):(0,h.ih)("Successfully invited %(email) and %(num) other people.").replace("%(email)",t[0].accepter).replace("%(num)",t.length-1),W.Z.success(n),o.props.onInvitePeople(t)}var r=e.data.failed;if(r.length)for(var i=0,s=r.length;i<s;i++){var a=r[i].email+": "+r[i].error_msg;W.Z.danger(a)}})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t),o.props.toggleDialog()}))},o.state={emails:"",errorMsg:"",isSubmitting:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state.isSubmitting;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.Z,{toggle:this.props.toggleDialog,children:(0,h.ih)("Invite Guest")}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)("label",{htmlFor:"emails",children:(0,h.ih)("Emails")}),(0,m.jsx)(L.Z,{type:"text",id:"emails",placeholder:(0,h.ih)("Emails, separated by ','"),value:this.state.emails,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown}),(0,m.jsx)("p",{className:"error mt-2",children:this.state.errorMsg})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.props.toggleDialog,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{className:"submit-btn",color:"primary",onClick:this.handleSubmitInvite,disabled:e,children:e?(0,m.jsx)(D.Z,{}):(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),oh=rh,ih=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onRevokeInvitation=function(){o.setState({isSubmitting:!0}),C.I.revokeInvitation(o.props.token).then((function(e){o.props.revokeInvitation(),o.props.toggleDialog();var t=(0,h.ih)("Successfully revoked access of user {placeholder}.").replace("{placeholder}",o.props.accepter);W.Z.success(t)})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t),o.props.toggleDialog()}))},o.state={isSubmitting:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.toggleDialog,t=this.state.isSubmitting,n='<span class="op-target">'+f.c.HTMLescape(this.props.accepter)+"</span>",r=(0,h.ih)("Are you sure to revoke access of user {placeholder} ?").replace("{placeholder}",n);return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:e,children:[(0,m.jsx)(I.Z,{toggle:e,children:(0,h.ih)("Revoke Access")}),(0,m.jsx)(M.Z,{children:(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:r}})}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:e,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{className:"submit-btn",color:"primary",onClick:this.onRevokeInvitation,disabled:t,children:t?(0,m.jsx)(D.Z,{}):(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),sh=ih,ah=(n(94817),function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleOpMenu=function(){o.setState({isOpMenuOpen:!o.state.isOpMenuOpen})},o.onMouseEnter=function(){o.setState({isOpIconShown:!0})},o.onMouseLeave=function(){o.setState({isOpIconShown:!1})},o.deleteItem=function(e){e.preventDefault(),o.setState({isOpIconShown:!1});var t=o.props.invitation.token;C.I.deleteInvitation(t).then((function(e){o.setState({deleted:!0}),W.Z.success((0,h.ih)("Successfully deleted 1 item."))})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t),o.setState({isOpIconShown:!0})}))},o.revokeItem=function(){o.setState({deleted:!0})},o.toggleRevokeDialog=function(e){e.preventDefault(),o.setState({isRevokeDialogOpen:!o.state.isRevokeDialogOpen})},o.state={isOpIconShown:!1,isOpMenuOpen:!1,isRevokeDialogOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.state,t=e.isOpIconShown,n=e.deleted,r=e.isRevokeDialogOpen;if(n)return null;var o=this.props.invitation,i=(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,tabIndex:"0",children:[(0,m.jsx)("td",{children:o.accepter}),(0,m.jsx)("td",{children:S()(o.invite_time).format("YYYY-MM-DD")}),(0,m.jsx)("td",{children:S()(o.expire_time).format("YYYY-MM-DD")}),(0,m.jsx)("td",{children:o.accept_time&&(0,m.jsx)("i",{className:"sf2-icon-tick invite-accept-icon"})}),(0,m.jsx)("td",{children:t&&(o.accept_time?(0,m.jsx)("a",{href:"#",role:"button",className:"action-icon sf3-font sf3-font-cancel-invitation",title:(0,h.ih)("Revoke Access"),"aria-label":(0,h.ih)("Revoke Access"),onClick:this.toggleRevokeDialog}):(0,m.jsx)("a",{href:"#",role:"button",className:"action-icon sf2-icon-x3",title:(0,h.ih)("Delete"),"aria-label":(0,h.ih)("Delete"),onClick:this.deleteItem}))})]}),s=(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{children:[o.accepter,(0,m.jsx)("br",{}),(0,m.jsxs)("span",{className:"item-meta-info",children:[S()(o.invite_time).format("YYYY-MM-DD"),(0,m.jsxs)("span",{className:"small",children:["(",(0,h.ih)("Invite Time"),")"]})]}),(0,m.jsxs)("span",{className:"item-meta-info",children:[S()(o.expire_time).format("YYYY-MM-DD"),(0,m.jsxs)("span",{className:"small",children:["(",(0,h.ih)("Expiration"),")"]})]}),(0,m.jsx)("span",{className:"item-meta-info",children:o.accept_time&&(0,h.ih)("Accepted")})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(H.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(Y.Z,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:o.accept_time?(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.toggleRevokeDialog,children:(0,h.ih)("Revoke Access")}):(0,m.jsx)(V.Z,{className:"mobile-menu-item",onClick:this.deleteItem,children:(0,h.ih)("Delete")})})]})]})})]});return(0,m.jsxs)(a.Fragment,{children:[this.props.isDesktop?i:s,r&&(0,m.jsx)(sh,{accepter:o.accepter,token:o.token,revokeInvitation:this.revokeItem,toggleDialog:this.toggleRevokeDialog})]})}}]),n}(a.Component)),lh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,r.Z)(this,n),t.call(this,e)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.invitationsList;if(t)return(0,m.jsx)(D.Z,{});if(n)return(0,m.jsx)("p",{className:"error text-center mt-2",children:n});if(!r.length)return(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No guest invitations")}),(0,m.jsx)("p",{children:(0,h.ih)('You have not invited any guests yet. A guest can access shared libraries through the web interface allowing more efficient ways to collaborate than through links. You can invite a guest by clicking the "Invite Guest" button in the menu bar.')})]});var o=f.c.isDesktop();return(0,m.jsxs)("table",{className:"table-hover".concat(o?"":" table-thead-hidden"),children:[(0,m.jsx)("thead",{children:o?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"25%",children:(0,h.ih)("Email")}),(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Invite Time")}),(0,m.jsx)("th",{width:"20%",children:(0,h.ih)("Expiration")}),(0,m.jsx)("th",{width:"18%",children:(0,h.ih)("Accepted")}),(0,m.jsx)("th",{width:"7%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"92%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsx)(ah,{isDesktop:o,invitation:e},t)}))})]})}}]),n}(a.Component),ch=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onInvitePeople=function(e){e.push.apply(e,o.state.invitationsList),o.setState({invitationsList:e})},o.toggleInvitePeopleDialog=function(){o.setState({isInvitePeopleDialogOpen:!o.state.isInvitePeopleDialogOpen})},o.state={loading:!0,errorMsg:"",invitationsList:[],isInvitePeopleDialogOpen:!1},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;C.I.listInvitations().then((function(t){e.setState({invitationsList:t.data,loading:!1})})).catch((function(t){e.setState({loading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(nh,{onShowSidePanel:this.props.onShowSidePanel,onSearchedClick:this.props.onSearchedClick,toggleInvitePeopleDialog:this.toggleInvitePeopleDialog}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.ih)("Invite Guest")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(lh,{data:this.state})})]})}),this.state.isInvitePeopleDialogOpen&&(0,m.jsx)(oh,{onInvitePeople:this.onInvitePeople,toggleDialog:this.toggleInvitePeopleDialog})]})}}]),n}(a.Component),dh=n(60354),uh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).inputNewName=function(e){o.setState({name:e.target.value})},o.handleKeyDown=function(e){"Enter"===e.key&&o.handleSubmit()},o.handleSubmit=function(){var e=o.state.name.trim(),t=o.state.selectedOption?o.state.selectedOption.id:null;e&&(o.props.addWiki(e,t),o.props.toggleCancel())},o.toggle=function(){o.props.toggleCancel()},o.handleSelectChange=function(e){o.setState({selectedOption:e})},o.state={name:"",isSubmitBtnActive:!1,selectedOption:null,options:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;h._y&&dh.Z.listWikiDepartments().then((function(t){for(var n=t.data.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})),r=[],o=0;o<n.length;o++){var i={};i.value=n[o].name,i.id=n[o].id,i.label=n[o].name,r.push(i)}if(e.setState({options:r}),e.props.currentDeptID){var s=r.find((function(t){return t.id==e.props.currentDeptID}));e.setState({selectedOption:s})}})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}},{key:"render",value:function(){return(0,m.jsxs)(p.Z,{isOpen:!0,autoFocus:!1,toggle:this.toggle,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:(0,h.ih)("Add Wiki")}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)(it.Z,{children:(0,h.ih)("Name")}),(0,m.jsx)(L.Z,{onKeyDown:this.handleKeyDown,autoFocus:!0,value:this.state.name,onChange:this.inputNewName}),h._y&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(it.Z,{className:"mt-4",children:[(0,h.ih)("Wiki owner")," (",(0,h.ih)("Optional"),")"]}),(0,m.jsx)(at.ME,{onChange:this.handleSelectChange,options:this.state.options,hideSelectedOptions:!0,placeholder:(0,h.ih)("Select a department"),maxMenuHeight:200,value:this.state.selectedOption,components:{NoOptionsMessage:(0,m.jsx)("div",{style:{margin:"6px 10px",textAlign:"center",color:"hsl(0,0%,50%)"},children:(0,h.ih)("No department")})},noOptionsMessage:function(){return(0,h.ih)("No options available")}})]})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggle,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.name.trim(),children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),ph=uh;var hh=function(e){var t=e.handleSubmit,n=e.toggleCancel,r=e.title,o=e.content,i=e.footer;return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:n,children:[(0,m.jsx)(I.Z,{toggle:n,children:r}),(0,m.jsx)(M.Z,{children:o}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:n,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:t,children:i})]})]})},fh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleChange=function(e){o.setState({isSubmitBtnActive:!!e.target.value.trim(),newName:e.target.value})},o.handleSubmit=function(){var e=o.validateInput(),t=e.isValid,n=e.errMessage;t?o.props.onRename(o.state.newName.trim()):o.setState({errMessage:n})},o.handleKeyDown=function(e){"Enter"===e.key&&o.handleSubmit()},o.toggle=function(){o.props.toggleCancel()},o.validateInput=function(){var e=o.state.newName.trim(),t=!0,n="";return e?e.indexOf("/")>-1?{isValid:t=!1,errMessage:n=(0,h.ih)("Name should not include '/'.")}:{isValid:t,errMessage:n}:{isValid:t=!1,errMessage:n=(0,h.ih)("Name is required.")}},o.state={newName:e.wiki.name,errMessage:"",isSubmitBtnActive:!1},o.newInput=a.createRef(),o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsxs)(p.Z,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.Z,{toggle:this.toggle,children:(0,h.ih)("Rename Wiki")}),(0,m.jsxs)(M.Z,{children:[(0,m.jsx)("p",{children:(0,h.ih)("New Wiki name")}),(0,m.jsx)(L.Z,{onKeyDown:this.handleKeyDown,innerRef:this.newInput,placeholder:"newName",value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&(0,m.jsx)(st.Z,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.Z,{children:[(0,m.jsx)(R.Z,{color:"secondary",onClick:this.toggle,children:(0,h.ih)("Cancel")}),(0,m.jsx)(R.Z,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,h.ih)("Submit")})]})]})}}]),n}(a.Component),mh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onRenameToggle=function(e){o.setState({isShowRenameDialog:!o.state.isShowRenameDialog})},o.onDeleteToggle=function(e){e.preventDefault(),o.setState({isShowDeleteDialog:!o.state.isShowDeleteDialog})},o.onDeleteCancel=function(){o.setState({isShowDeleteDialog:!o.state.isShowDeleteDialog})},o.deleteWiki=function(){var e=o.props.wiki;o.props.deleteWiki(e),o.setState({isShowDeleteDialog:!o.state.isShowDeleteDialog})},o.renameWiki=function(e){o.props.wiki.name!==e&&o.props.renameWiki(o.props.wiki,e),o.setState({isShowRenameDialog:!1})},o.clickWikiCard=function(e){window.open(e)},o.toggleDropDownMenu=function(){o.setState({isItemMenuShow:!o.state.isItemMenuShow})},o.onClickDropdown=function(e){e.preventDefault(),e.stopPropagation()},o.renderAvatar=function(){var e=o.props.wiki,t=e.owner_nickname,n=e.owner_avatar_url;return(0,m.jsxs)("div",{className:"wiki-card-item-avatar-container",children:[(0,m.jsx)("img",{className:"wiki-card-item-avatar",src:n,alt:t}),(0,m.jsx)("span",{className:"wiki-card-item-owner text-truncate",title:t,children:t})]})},o.renderDept=function(){var e=o.props.wiki;return(0,m.jsxs)("div",{className:"wiki-card-item-avatar-container",children:[(0,m.jsx)("span",{className:"sf3-font-department sf3-font nav-icon"}),(0,m.jsx)("span",{className:"wiki-card-item-owner text-truncate",title:e.owner_nickname,children:e.owner_nickname})]})},o.state={isShowDeleteDialog:!1,isShowRenameDialog:!1,isItemMenuShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.wiki,n=e.isDepartment,r=e.isShowAvatar,o="v2"!==t.version,i="".concat(h.ze,"published/").concat(encodeURIComponent(t.slug),"/"),s="".concat(h.ze,"wikis/").concat(t.id,"/"),a=o?"".concat(t.name," (old version)"):t.name;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"wiki-card-item ".concat(this.state.isItemMenuShow?"wiki-card-item-menu-open":""),onClick:this.clickWikiCard.bind(this,o?i:s),children:[(0,m.jsxs)("div",{className:"wiki-card-item-top",children:[(0,m.jsx)("span",{className:"sf3-font-wiki sf3-font","aria-hidden":"true"}),(0,m.jsxs)(H.Z,{isOpen:this.state.isItemMenuShow,toggle:this.toggleDropDownMenu,onClick:this.onClickDropdown,children:[(0,m.jsx)(Y.Z,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow,"aria-haspopup":!0,style:{minWidth:"0"}}),(0,m.jsxs)(Me.Z,{right:!0,className:"dtable-dropdown-menu",children:[(0,m.jsx)(V.Z,{onClick:this.onRenameToggle,children:(0,h.ih)("Rename")}),o?(0,m.jsx)(V.Z,{onClick:this.onDeleteToggle,children:(0,h.ih)("Unpublish")}):(0,m.jsx)(V.Z,{onClick:this.onDeleteToggle,children:(0,h.ih)("Delete")})]})]})]}),(0,m.jsx)("div",{className:"wiki-item-name text-truncate",title:a,"aria-label":a,children:a}),(0,m.jsx)("div",{className:"wiki-item-owner",children:r&&(n?this.renderDept():this.renderAvatar())}),(0,m.jsx)("div",{className:"wiki-item-updated-time",children:S()(t.updated_at).fromNow()})]}),this.state.isShowDeleteDialog&&(0,m.jsx)(E.Z,{children:o?(0,m.jsx)(hh,{toggleCancel:this.onDeleteCancel,handleSubmit:this.deleteWiki,title:(0,h.ih)("Unpublish Wiki"),content:(0,m.jsxs)("p",{children:[(0,h.ih)("Are you sure you want to unpublish Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,h.ih)("Unpublish")}):(0,m.jsx)(hh,{toggleCancel:this.onDeleteCancel,handleSubmit:this.deleteWiki,title:(0,h.ih)("Delete Wiki"),content:(0,m.jsxs)("p",{children:[(0,h.ih)("Are you sure you want to delete Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,h.ih)("Delete")})}),this.state.isShowRenameDialog&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(fh,{toggleCancel:this.onRenameToggle,onRename:this.renameWiki,wiki:t})})]})}}]),n}(a.Component);var gh=function(e){return(0,m.jsxs)("div",{className:"wiki-card-item wiki-card-item-add d-flex flex-column align-items-center justify-content-center",onClick:e.toggelAddWikiDialog,children:[(0,m.jsx)("span",{children:"+"}),(0,m.jsx)("span",{children:(0,h.ih)("Add Wiki")})]})},vh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onResize=function(){if(!f.t){var e=Math.floor(.78*window.innerWidth/180),t=(Math.floor((.78*window.innerWidth-16*(e+1))/e)+"px ").repeat(e);o.groupItemsRef.current&&(o.groupItemsRef.current.style.gridTemplateColumns=t)}},o.groupItemsRef=a.createRef(),o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"render",value:function(){var e=this,t=this.props,n=t.wikis,r=t.title,o=t.isDepartment,i=t.toggelAddWikiDialog,s=Math.floor(.78*window.innerWidth/180),a=(Math.floor((.78*window.innerWidth-16*(s+1))/s)+"px ").repeat(s);return(0,m.jsxs)("div",{className:"wiki-card-group mb-4",children:[(0,m.jsxs)("h4",{className:"sf-heading",children:[(0,m.jsx)("span",{className:"sf3-font nav-icon sf3-font-".concat(o?"department":"mine"),"aria-hidden":"true"}),r]}),(0,m.jsxs)("div",{className:"wiki-card-group-items",style:{gridTemplateColumns:f.t?"48% 48%":a},ref:this.groupItemsRef,children:[n.map((function(t,n){return(0,m.jsx)(mh,{wiki:t,deleteWiki:e.props.deleteWiki,isDepartment:o,isShowAvatar:e.props.isShowAvatar,renameWiki:e.props.renameWiki},n+t.id+t.name)})),i&&(0,m.jsx)(gh,{toggelAddWikiDialog:i})]})]})}}]),n}(a.Component),yh=vh,xh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).classifyWikis=function(e){for(var t=[],n=[],r={},o=0;o<e.length;o++)"v1"===e[o].version?t.push(e[o]):e[o].owner===h.b6?n.push(e[o]):(r[e[o].owner]||(r[e[o].owner]=[]),r[e[o].owner].push(e[o]));return{department2WikisMap:r,myWikis:n,v1Wikis:t}},o.state={departmentMap:{}},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;if(h.pR&&h._y){var t={};dh.Z.listWikiDepartments().then((function(n){n.data.forEach((function(e){return t[e.id]=!0})),e.setState({departmentMap:t})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))}}},{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.wikis,o=this.props.toggelAddWikiDialog;if(t)return(0,m.jsx)("span",{className:"loading-icon loading-tip"});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var i=this.classifyWikis(r),s=i.v1Wikis,a=i.myWikis,l=i.department2WikisMap,c=[];for(var d in c.push((0,m.jsx)(yh,{deleteWiki:this.props.deleteWiki,renameWiki:this.props.renameWiki,wikis:a,title:(0,h.ih)("My Wikis"),isDepartment:!1,isShowAvatar:!1,toggelAddWikiDialog:h.pR?o.bind(this,null):null},"my-Wikis")),l)c.push((0,m.jsx)(yh,{deleteWiki:this.props.deleteWiki,renameWiki:this.props.renameWiki,wikis:l[d],title:l[d][0].owner_nickname,isDepartment:!0,isShowAvatar:!1,toggelAddWikiDialog:h.pR&&this.state.departmentMap[d]?o.bind(this,d):null},"department-Wikis-"+d));return c.push((0,m.jsx)(yh,{deleteWiki:this.props.deleteWiki,renameWiki:this.props.renameWiki,wikis:s,title:(0,h.ih)("Old Wikis"),isDepartment:!1,isShowAvatar:!0},"old-Wikis")),c}}]),n}(a.Component),wh=xh,bh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).getWikis=function(){var e=[];dh.Z.listWikis().then((function(t){(e=e.concat(t.data.data)).map((function(e){return e.version="v1"})),dh.Z.listWikis2().then((function(t){var n=t.data.wikis;n.map((function(e){return e.version="v2"})),o.setState({loading:!1,wikis:e.concat(n)})})).catch((function(e){o.setState({loading:!1,errorMsg:f.c.getErrorMsg(e,!0)})}))})).catch((function(e){o.setState({loading:!1,errorMsg:f.c.getErrorMsg(e,!0)})}))},o.clickMenuToggle=function(e){e.preventDefault(),o.onMenuToggle()},o.onMenuToggle=function(){o.setState({isShowAddWikiMenu:!o.state.isShowAddWikiMenu})},o.toggelAddWikiDialog=function(e){o.state.isShowAddDialog?o.setState({isShowAddDialog:!1,currentDeptID:""}):o.setState({isShowAddDialog:!0,currentDeptID:e})},o.addWiki=function(e,t){dh.Z.addWiki2(e,t).then((function(e){var t=o.state.wikis.slice(0),n=e.data;n.version="v2",t.push(n),o.setState({wikis:t,currentDeptID:""})})).catch((function(e){if(e.response){var t=f.c.getErrorMsg(e);W.Z.danger(t)}}))},o.deleteWiki=function(e){"v1"===e.version?dh.Z.deleteWiki(e.id).then((function(){var t=o.state.wikis.filter((function(t){return t.name!==e.name}));o.setState({wikis:t})})).catch((function(e){if(e.response){var t=e.response.data.error_msg;W.Z.danger(t)}})):dh.Z.deleteWiki2(e.id).then((function(){var t=o.state.wikis.filter((function(t){return t.name!==e.name}));o.setState({wikis:t})})).catch((function(e){if(e.response){var t=e.response.data.error_msg;W.Z.danger(t)}}))},o.renameWiki=function(e,t){"v1"===e.version?dh.Z.renameWiki(e.id,t).then((function(){var n=o.state.wikis.map((function(n){return n.id===e.id&&"v1"===n.version&&(n.name=t),n}));o.setState({wikis:n})})).catch((function(e){if(e.response){var t=e.response.data.error_msg;W.Z.danger(t)}})):dh.Z.renameWiki2(e.id,t).then((function(){var n=o.state.wikis.map((function(n){return n.id===e.id&&"v2"===n.version&&(n.name=t),n}));o.setState({wikis:n})})).catch((function(e){if(e.response){var t=e.response.data.error_msg;W.Z.danger(t)}}))},o.toggleDropdownMenu=function(e){e.stopPropagation(),o.setState({isDropdownMenuShown:!o.state.isDropdownMenuShown})},o.state={loading:!0,errorMsg:"",currentDeptID:"",wikis:[],isShowAddWikiMenu:!1,isShowAddDialog:!1,isDropdownMenuShown:!1},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.getWikis()}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{className:"main-panel-north border-left-show",children:[(0,m.jsx)("div",{className:"cur-view-toolbar",children:(0,m.jsx)("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:"Side Nav Menu",onClick:this.props.onShowSidePanel})}),(0,m.jsx)(xn.Z,{onSearchedClick:this.props.onSearchedClick})]}),this.state.isShowAddDialog&&(0,m.jsx)(E.Z,{children:(0,m.jsx)(ph,{toggleCancel:this.toggelAddWikiDialog,addWiki:this.addWiki,currentDeptID:this.state.currentDeptID})}),(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"wikis",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,h.ih)("Wikis")}),h.pR&&(0,m.jsxs)(H.Z,{direction:"down",className:"add-wiki-dropdown",isOpen:this.state.isDropdownMenuShown,toggle:this.toggleDropdownMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsx)(Y.Z,{tag:"i",className:"px-1",children:(0,m.jsx)("span",{className:"sf3-font sf3-font-down","aria-hidden":"true"})}),(0,m.jsx)(Me.Z,{children:(0,m.jsx)(V.Z,{onClick:function(){e.toggelAddWikiDialog()},children:(0,h.ih)("Add Wiki")})})]})]})}),(this.state.loading||0!==this.state.wikis.length)&&(0,m.jsx)("div",{className:"cur-view-content pb-4",children:(0,m.jsx)(wh,{data:this.state,deleteWiki:this.deleteWiki,renameWiki:this.renameWiki,toggelAddWikiDialog:this.toggelAddWikiDialog})}),!this.state.loading&&0===this.state.wikis.length&&(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsxs)(j.Z,{children:[(0,m.jsx)("h2",{children:(0,h.ih)("No Wikis")}),(0,m.jsx)("p",{children:(0,h.ih)("You have not any wikis yet.")}),(0,m.jsx)("p",{children:(0,h.ih)("A wiki can be accessed by anyone, not only users, via its URL.")}),(0,m.jsx)("p",{children:(0,h.ih)('You can add a wiki by clicking the "Add Wiki" button in the menu bar.')})]})})]})})]})}}]),n}(a.Component),Sh=bh,Ch=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggleDropdownMenu=function(){o.setState({isDropdownMenuOpen:!o.state.isDropdownMenuOpen})},o.state={isDropdownMenuOpen:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.state.isDropdownMenuOpen,n=this.props.sortOptions;return(0,m.jsxs)(H.Z,{isOpen:t,toggle:this.toggleDropdownMenu,children:[(0,m.jsx)(Y.Z,{tag:"div","data-toggle":"dropdown",title:(0,h.ih)("Switch view mode"),"aria-label":(0,h.ih)("Switch view mode"),"aria-expanded":t,children:(0,m.jsxs)("span",{className:"cur-view-path-btn px-1",role:"button",children:[(0,m.jsx)("i",{className:"sf3-font-sort2 sf3-font"}),(0,m.jsx)("i",{className:"sf3-font-down sf3-font"})]})}),(0,m.jsx)(Me.Z,{right:!0,className:"mt-1",children:n.map((function(t,n){return(0,m.jsx)(V.Z,{onClick:e.props.onSelectSortOption.bind(e,t),children:(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,m.jsx)("span",{className:"mr-8",children:t.text}),(0,m.jsx)("span",{children:t.isSelected&&(0,m.jsx)("i",{className:"sf2-icon-tick"})})]})},n)}))})]})}}]),n}(a.Component),Dh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).toggle=function(){e.props.toggleDialog()},e}return(0,o.Z)(n,[{key:"render",value:function(){return(0,m.jsx)(p.Z,{isOpen:!0,toggle:this.toggle,children:(0,m.jsxs)(M.Z,{children:[(0,m.jsx)("button",{type:"button",className:"close text-gray",onClick:this.toggle,children:(0,m.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),(0,m.jsxs)("div",{className:"p-2 text-center",children:[(0,m.jsx)("img",{src:"".concat(h.si,"img/welcome.png"),width:"408",alt:""}),(0,m.jsx)("h3",{id:"dialogTitle",className:"mt-6 mb-4",children:(0,h.ih)("Welcome to {site_name_placeholder}").replace("{site_name_placeholder}",h.aD)}),h.cA?(0,m.jsx)("p",{children:(0,h.ih)("{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. We have created a personal library for you. You can create more libraries later.").replace("{site_name_placeholder}",h.aD)}):(0,m.jsx)("p",{children:(0,h.ih)("{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. However, since you are a guest user now, you can not create libraries.").replace("{site_name_placeholder}",h.aD)})]})]})})}}]),n}(a.Component),kh=Dh,jh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).sortRepos=function(e,t){var n=f.c.sortRepos(e,o.state.sortBy,o.state.sortOrder),r=n.filter((function(e){return"mine"===e.type})),i=n.filter((function(e){return"shared"===e.type})),s=n.filter((function(e){return"public"===e.type}));return{allRepoList:n,myRepoList:r,sharedRepoList:i,publicRepoList:s,groupList:t.map((function(e){return e.repos=f.c.sortRepos(e.repos,o.state.sortBy,o.state.sortOrder),e}))}},o.toggleSortOptionsDialog=function(){o.setState({isSortOptionsDialogOpen:!o.state.isSortOptionsDialogOpen})},o.onCreateRepo=function(e){o.toggleCreateRepoDialog(),C.I.createMineRepo(e).then((function(e){var t=new Ne({repo_id:e.data.repo_id,repo_name:e.data.repo_name,size:e.data.repo_size,mtime:e.data.mtime,owner_email:e.data.email,encrypted:e.data.encrypted,permission:e.data.permission,storage_name:e.data.storage_name});o.state.repoList.unshift(t),o.setState({repoList:o.state.repoList})})).catch((function(e){var t=f.c.getErrorMsg(e);W.Z.danger(t)}))},o.onSelectSortOption=function(e){var t=e.value.split("-"),n=(0,ge.Z)(t,2),r=n[0],i=n[1];o.setState({sortBy:r,sortOrder:i},(function(){localStorage.setItem("sf_repos_sort_by",r),localStorage.setItem("sf_repos_sort_order",i);var e=o.state,t=e.allRepoList,n=e.groupList,s=o.sortRepos(t,n),a=s.allRepoList,l=s.myRepoList,c=s.sharedRepoList,d=s.publicRepoList,u=s.groupList;o.setState({allRepoList:a,groupList:u,sharedRepoList:c,publicRepoList:d,repoList:l})}))},o.sortRepoList=function(e,t){_e.ZP.save("seafile-repo-dir-sort-by",e),_e.ZP.save("seafile-repo-dir-sort-order",t),o.setState({sortBy:e,sortOrder:t,repoList:f.c.sortRepos(o.state.repoList,e,t)})},o.onTransferRepo=function(e){var t=o.state.repoList.filter((function(t){return t.repo_id!==e}));o.setState({repoList:t})},o.onRenameRepo=function(e,t){var n=o.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n}));o.setState({repoList:n})},o.onMonitorRepo=function(e,t){var n=o.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));o.setState({repoList:n})},o.onDeleteRepo=function(e){var t=o.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));o.setState({repoList:t})},o.toggleGuideForNewDialog=function(){window.app.pageOptions.guideEnabled=!1,o.setState({isGuideForNewDialogOpen:!1})},o.updateGroup=function(e){var t=o.state.groupList;o.setState({groupList:t.map((function(t){return t.id==e.id&&(t=e),t}))})},o.toggleCreateRepoDialog=function(){o.setState({isCreateRepoDialogOpen:!o.state.isCreateRepoDialogOpen})},o.switchViewMode=function(e){o.setState({currentViewMode:e},(function(){localStorage.setItem("sf_repo_list_view_mode",e)}))},o.sortOptions=[{value:"name-asc",text:(0,h.ih)("By name ascending")},{value:"name-desc",text:(0,h.ih)("By name descending")},{value:"time-asc",text:(0,h.ih)("By time ascending")},{value:"time-desc",text:(0,h.ih)("By time descending")}],o.state={errorMsg:"",isLoading:!0,repoList:[],isSortOptionsDialogOpen:!1,isGuideForNewDialogOpen:window.app.pageOptions.guideEnabled,groupList:[],sharedRepoList:[],publicRepoList:[],isCreateRepoDialogOpen:!1,currentViewMode:localStorage.getItem("sf_repo_list_view_mode")||"list",sortBy:localStorage.getItem("sf_repos_sort_by")||"name",sortOrder:localStorage.getItem("sf_repos_sort_order")||"asc"},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this,t=C.I.listRepos({type:["mine","shared","public"]}),n=C.I.listGroups(!0);Promise.all([t,n]).then((function(t){var n=(0,ge.Z)(t,2),r=n[0],o=n[1],i=r.data.repos.map((function(e){return new Ne(e)})),s=o.data.map((function(e){var t=new Ep.Z(e);return t.repos=e.repos.map((function(e){return new Ne(e)})),t})).sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})),a=e.sortRepos(i,s),l=a.allRepoList,c=a.myRepoList,d=a.sharedRepoList,u=a.publicRepoList,p=a.groupList;e.setState({isLoading:!1,allRepoList:l,groupList:p,sharedRepoList:d,publicRepoList:u,repoList:c})})).catch((function(t){e.setState({isLoading:!1,errorMsg:f.c.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoading,r=t.currentViewMode,o=t.sortBy,i=t.sortOrder,s=f.c.isDesktop(),l=this.sortOptions.map((function(e){return(0,sr.Z)((0,sr.Z)({},e),{},{isSelected:e.value=="".concat(o,"-").concat(i)})}));return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(xe.Z,{onShowSidePanel:this.props.onShowSidePanel,onSearchedClick:this.props.onSearchedClick}),(0,m.jsxs)("div",{className:"main-panel-center flex-row",children:[(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,h.ih)("Files")}),s&&(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("div",{className:"mr-2",children:(0,m.jsx)(Ir,{currentViewMode:r,switchViewMode:this.switchViewMode})}),(0,m.jsx)(Ch,{sortOptions:l,onSelectSortOption:this.onSelectSortOption})]})]}),n?(0,m.jsx)(D.Z,{}):(0,m.jsxs)("div",{className:"cur-view-content",id:"files-content-container",children:[f.c.isDesktop()&&"list"==r&&(0,m.jsx)("table",{"aria-hidden":!0,className:"my-3",children:(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.ih)("Library Type")})}),(0,m.jsx)("th",{width:"35%",children:(0,h.ih)("Name")}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.ih)("Actions")})}),(0,m.jsx)("th",{width:"14%",children:(0,h.ih)("Size")}),(0,m.jsx)("th",{width:"17%",children:(0,h.ih)("Last Update")}),(0,m.jsx)("th",{width:"17%",children:(0,h.ih)("Owner")})]})})}),h.cA&&(0,m.jsxs)("div",{className:"pb-3",children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat("list"==r?"sf-border-bottom":""),children:[(0,m.jsxs)("h4",{className:"sf-heading m-0 d-flex align-items-center",children:[(0,m.jsx)("span",{className:"sf3-font-mine sf3-font nav-icon","aria-hidden":"true"}),(0,h.ih)("My Libraries"),(0,m.jsx)(qp,{opList:[{text:(0,h.ih)("New Library"),onClick:this.toggleCreateRepoDialog}]})]}),!f.c.isDesktop()&&this.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})]}),this.state.errorMsg?(0,m.jsx)("p",{className:"error text-center mt-8",children:this.state.errorMsg}):0===this.state.repoList.length?(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(r,"-mode"),children:(0,h.ih)("No libraries")}):(0,m.jsx)(vn,{sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,repoList:this.state.repoList,onRenameRepo:this.onRenameRepo,onDeleteRepo:this.onDeleteRepo,onTransferRepo:this.onTransferRepo,onMonitorRepo:this.onMonitorRepo,onRepoClick:this.onRepoClick,sortRepoList:this.sortRepoList,inAllLibs:!0,currentViewMode:r})]}),(0,m.jsx)("div",{className:"pb-3",children:(0,m.jsx)(Le,{repoList:this.state.sharedRepoList,inAllLibs:!0,currentViewMode:r})}),h.ei&&(0,m.jsx)("div",{className:"pb-3",children:(0,m.jsx)(Tn,{repoList:this.state.publicRepoList,inAllLibs:!0,currentViewMode:r})}),(0,m.jsx)("div",{className:"group-list-panel",children:this.state.groupList.length>0&&this.state.groupList.map((function(t,n){return(0,m.jsx)(eh,{group:t,updateGroup:e.updateGroup,currentViewMode:r},n)}))})]})]}),!n&&!this.state.errorMsg&&this.state.isGuideForNewDialogOpen&&(0,m.jsx)(kh,{toggleDialog:this.toggleGuideForNewDialog}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(ve,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortRepoList}),this.state.isCreateRepoDialogOpen&&(0,m.jsx)(lt,{libraryType:"mine",onCreateRepo:this.onCreateRepo,onCreateToggle:this.toggleCreateRepoDialog})]})]})}}]),n}(a.Component),Ih=jh,Mh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.onShowSidePanel,n=e.onSearchedClick;return(0,m.jsxs)("div",{className:"main-panel-north",children:[(0,m.jsx)("div",{className:"cur-view-toolbar",children:(0,m.jsx)("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:"Side Nav Menu",onClick:t})}),(0,m.jsx)(xn.Z,{searchPlaceholder:this.props.searchPlaceholder,onSearchedClick:n})]})}}]),n}(a.Component),_h=Mh,Nh=function(e){return function(t){(0,i.Z)(l,t);var n=(0,s.Z)(l);function l(e){return(0,r.Z)(this,l),n.call(this,e)}return(0,o.Z)(l,[{key:"render",value:function(){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(_h,(0,sr.Z)({},this.props)),(0,m.jsx)(e,(0,sr.Z)({},this.props))]})}}]),l}(a.Component)},Rh=(n(54890),n(98391),n(53379),Nh(z)),Th=Nh(G),Oh=Nh(X),Eh=Nh(te),Ph=Nh(Le),Zh=Nh(ze),Fh=Nh(Ve),Lh=Nh(le),Ah=Nh(pe),Uh=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onpopstate=function(e){if(e.state&&e.state.currentTab&&e.state.pathPrefix){var t=e.state,n=t.currentTab,r=t.pathPrefix;o.setState({currentTab:n,pathPrefix:r})}},o.navigateClientUrlToLib=function(){if(window.location.hash&&-1!=window.location.hash.indexOf("common/lib")){var e=window.location.hash.split("/"),t=e[e.length-2],n=h.ze+"library/"+t+"/";(0,c.c4)(n,{repalce:!0})}},o.onCloseSidePanel=function(){o.setState({isSidePanelClosed:!o.state.isSidePanelClosed})},o.onShowSidePanel=function(){o.setState({isSidePanelClosed:!o.state.isSidePanelClosed})},o.onSearchedClick=function(e){if(!0===e.is_dir){o.setState({currentTab:"",pathPrefix:[]});var t=h.ze+"library/"+e.repo_id+"/"+e.repo_name+e.path;(0,c.c4)(t,{repalce:!0})}else{var n=h.ze+"lib/"+e.repo_id+"/file"+f.c.encodePath(e.path);if(f.c.isWeChat())location.href=n;else window.open("about:blank").location.href=n}},o.onGroupChanged=function(e){setTimeout((function(){var t;t=e?h.ze+"group/"+e+"/":h.ze+"libraries/",window.location=t.toString()}),1)},o.tabItemClick=function(e,t){var n=[];(t||o.dirViewPanels.indexOf(e)>-1)&&(n=o.generatorPrefix(e,t)),o.setState({currentTab:e,pathPrefix:n},(function(){var e=o.state,t=e.currentTab,n=e.pathPrefix;window.history.replaceState({currentTab:t,pathPrefix:n},null)})),f.c.isDesktop()||o.state.isSidePanelClosed||o.setState({isSidePanelClosed:!0})},o.generatorPrefix=function(e,t){var n=[];if(t){var r={url:h.ze+"group/"+t+"/",showName:e,name:e,id:t};n.push(r)}else{var i={url:h.ze+e+"/",showName:o.getTabShowName(e),name:e,id:null};n.push(i)}return n},o.getTabShowName=function(e){switch(e){case"libraries":return"Files";case"my-libs":return"My Libraries";case"shared-libs":return"Shared with me";case"org":return"Shared with all"}},o.toggleSidePanel=function(){o.setState({isSidePanelClosed:!o.state.isSidePanelClosed})},o.state={isOpen:!1,isSidePanelClosed:!1,currentTab:"",pathPrefix:[]},o.dirViewPanels=["libraries","my-libs","shared-libs","org"],window.onpopstate=o.onpopstate,o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillMount",value:function(){f.c.isDesktop()||this.setState({isSidePanelClosed:!0})}},{key:"componentDidMount",value:function(){var e;if(this.navigateClientUrlToLib(),location.pathname==h.ze)e="libraries";else{var t=window.location.href.split("/");e=t[t.length-2]}this.setState({currentTab:e})}},{key:"render",value:function(){var e=this.state,t=e.currentTab,n=e.isSidePanelClosed;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(v,{}),(0,m.jsxs)("div",{id:"main",children:[(0,m.jsx)(y.Z,{isSidePanelClosed:this.state.isSidePanelClosed,onCloseSidePanel:this.onCloseSidePanel,currentTab:t,tabItemClick:this.tabItemClick}),(0,m.jsx)(x.Z,{children:(0,m.jsxs)(c.F0,{className:"reach-router",children:[(0,m.jsx)(Ih,{path:h.ze,onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Ih,{path:h.ze+"libraries",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Rh,{path:h.ze+"dashboard",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Th,{path:h.ze+"my-activities",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Oh,{path:h.ze+"starred",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Eh,{path:h.ze+"linked-devices",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Lh,{path:h.ze+"share-admin-libs",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Ah,{path:h.ze+"share-admin-folders",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Ce,{path:h.ze+"share-admin-share-links",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Ie,{path:h.ze+"share-admin-upload-links",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Ph,{path:h.ze+"shared-libs",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Zh,{path:h.ze+"shared-with-ocm",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Fh,{path:h.ze+"ocm-via-webdav",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(yn,{path:h.ze+"my-libs",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Cn,{path:h.ze+"my-libs/deleted/",onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Op,{path:h.ze+"library/:repoID/*",pathPrefix:this.state.pathPrefix,onMenuClick:this.onShowSidePanel,onTabNavClick:this.tabItemClick}),(0,m.jsx)(nt,{path:h.ze+"remote-library/:providerID/:repoID/*",pathPrefix:this.state.pathPrefix,onMenuClick:this.onShowSidePanel,onTabNavClick:this.tabItemClick}),(0,m.jsx)(th,{path:h.ze+"groups",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)($p,{path:h.ze+"group/:groupID",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick,onGroupChanged:this.onGroupChanged}),(0,m.jsx)(Sh,{path:h.ze+"published",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),(0,m.jsx)(Tn,{path:h.ze+"org/",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick,onTabNavClick:this.tabItemClick}),(0,m.jsx)(ch,{path:h.ze+"invitations/",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick})]})}),(0,m.jsx)(u(),{query:"(max-width: 767.8px)",children:(0,m.jsx)(p.Z,{zIndex:"1030",isOpen:!n,toggle:this.toggleSidePanel,contentClassName:"d-none"})})]})]})}}]),n}(a.Component);l.render((0,m.jsx)(Uh,{}),document.getElementById("wrapper"))},30426:function(e,t,n){"use strict";n.d(t,{AE:function(){return c},SC:function(){return d},bg:function(){return s},cI:function(){return a}});var r=n(71843),o=n.n(r),i=n(30171),s="REACT_CONTEXTMENU_SHOW",a="REACT_CONTEXTMENU_HIDE";function l(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;"function"===typeof window.CustomEvent?n=new window.CustomEvent(e,{detail:t}):(n=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!0,t),r&&(r.dispatchEvent(n),o()(i.h,t))}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;l(s,o()({},e,{type:s}),t)}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;l(a,o()({},e,{type:a}),t)}},92161:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(18760),c=n(30426),d=n(30171),u=n(83854),p=n(46417),h=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).registerHandlers=function(){document.addEventListener("mousedown",o.handleOutsideClick),document.addEventListener("touchstart",o.handleOutsideClick),document.addEventListener("scroll",o.handleHide),document.addEventListener("contextmenu",o.handleHide),document.addEventListener("keydown",o.handleKeyNavigation),window.addEventListener("resize",o.handleHide)},o.unregisterHandlers=function(){document.removeEventListener("mousedown",o.handleOutsideClick),document.removeEventListener("touchstart",o.handleOutsideClick),document.removeEventListener("scroll",o.handleHide),document.removeEventListener("contextmenu",o.handleHide),document.removeEventListener("keydown",o.handleKeyNavigation),window.removeEventListener("resize",o.handleHide)},o.handleShow=function(e){if(e.detail.id===o.props.id){var t=e.detail.position,n=t.x,r=t.y,i=e.detail,s=i.currentObject,a=i.menuList;o.setState({isVisible:!0,x:n,y:r,currentObject:s,menuList:a}),o.registerHandlers(),(0,d._N)(o.props.onShowMenu,e)}},o.handleHide=function(e){!o.state.isVisible||e.detail&&e.detail.id&&e.detail.id!==o.props.id||(o.unregisterHandlers(),o.setState({isVisible:!1}),(0,d._N)(o.props.onHideMenu,e))},o.handleOutsideClick=function(e){o.menu.contains(e.target)||(0,c.SC)()},o.handleMouseLeave=function(e){e.preventDefault(),o.props.hideOnLeave&&(0,c.SC)()},o.handleContextMenu=function(e){o.handleHide(e)},o.handleKeyNavigation=function(e){!1!==o.state.isVisible&&(e.preventDefault(),o.hideMenu(e))},o.hideMenu=function(e){27!==e.keyCode&&13!==e.keyCode||(0,c.SC)()},o.getMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={top:t,left:e};if(!o.menu)return n;var r=window,i=r.innerWidth,s=r.innerHeight,a=o.menu.getBoundingClientRect();return t+a.height>s&&(n.top-=a.height),e+a.width>i&&(n.left-=a.width),n.top<0&&(n.top=a.height<s?(s-a.height)/2:0),n.left<0&&(n.left=a.width<i?(i-a.width)/2:0),n},o.getRTLMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={top:t,left:e};if(!o.menu)return n;var r=window,i=r.innerWidth,s=r.innerHeight,a=o.menu.getBoundingClientRect();return n.left=e-a.width,t+a.height>s&&(n.top-=a.height),n.left<0&&(n.left+=a.width),n.top<0&&(n.top=a.height<s?(s-a.height)/2:0),n.left+a.width>i&&(n.left=a.width<i?(i-a.width)/2:0),n},o.onMenuItemClick=function(e){e.stopPropagation();var t=u.c.getEventData(e,"operation"),n=o.state.currentObject;o.props.onMenuItemClick(t,n,e)},o.onContextMenu=function(e){e.stopPropagation()},o.state={x:0,y:0,isVisible:!1,currentObject:null,menuList:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.listenId=l.Z.register(this.handleShow,this.handleHide)}},{key:"componentDidUpdate",value:function(){var e=this;if(this.state.isVisible){var t=window.requestAnimationFrame||setTimeout;t((function(){var n=e.state,r=n.x,o=n.y,i=e.props.rtl?e.getRTLMenuPosition(r,o):e.getMenuPosition(r,o),s=i.top,a=i.left;t((function(){e.menu&&(e.menu.style.top="".concat(s,"px"),e.menu.style.left="".concat(a,"px"),e.menu.style.opacity=1,e.menu.style.pointerEvents="auto")}))}))}else{if(!this.menu)return;this.menu.style.opacity=0,this.menu.style.pointerEvents="none"}}},{key:"componentWillUnmount",value:function(){this.listenId&&l.Z.unregister(this.listenId),this.unregisterHandlers()}},{key:"render",value:function(){var e=this;return(0,p.jsx)("div",{role:"menu",className:"seafile-contextmenu dropdown-menu",style:{position:"fixed",opacity:0,pointerEvents:"none",display:"block"},ref:function(t){e.menu=t},children:this.state.menuList.map((function(t,n){return"Divider"===t?(0,p.jsx)("div",{className:"seafile-divider dropdown-divider"},n):(0,p.jsx)("button",{className:"seafile-contextmenu-item dropdown-item","data-operation":t.key,onClick:e.onMenuItemClick,onContextMenu:e.onContextMenu,children:t.value},n)}))})}}]),n}(a.Component);t.Z=h},18760:function(e,t,n){"use strict";var r=n(43144),o=n(15671),i=n(30426),s=n(30171),a=new((0,r.Z)((function e(){var t=this;(0,o.Z)(this,e),this.handleShowEvent=function(e){for(var n in t.callbacks)(0,s.Q$)(t.callbacks,n)&&t.callbacks[n].show(e)},this.handleHideEvent=function(e){for(var n in t.callbacks)(0,s.Q$)(t.callbacks,n)&&t.callbacks[n].hide(e)},this.register=function(e,n){var r=(0,s.EL)();return t.callbacks[r]={show:e,hide:n},r},this.unregister=function(e){e&&t.callbacks[e]&&delete t.callbacks[e]},this.callbacks={},s.Nq&&(window.addEventListener(i.bg,this.handleShowEvent),window.addEventListener(i.cI,this.handleHideEvent))})));t.Z=a},30171:function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"function"===typeof e&&e.apply(void 0,n)}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function i(){return Math.random().toString(36).substring(7)}n.d(t,{EL:function(){return i},Nq:function(){return a},Q$:function(){return o},_N:function(){return r},h:function(){return s}});var s={},a=Boolean("undefined"!==typeof window&&window.document&&window.document.createElement)},99338:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(42995),c=n(12756),d=n(12213),u=n(54105),p=n(85951),h=n(5684),f=n(7764),m=n(21303),g=n(61805),v=n(46417),y=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).toggle=function(){o.props.toggleDialog()},o.executeOperation=function(){o.toggle(),o.props.executeOperation(o.state.isChecked)},o.onInputChange=function(e){o.setState({isChecked:e.target.checked})},o.state={isChecked:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,v.jsxs)(l.Z,{isOpen:!0,toggle:this.toggle,children:[(0,v.jsx)(c.Z,{toggle:this.toggle,children:(0,g.ih)("Unlink device")}),(0,v.jsxs)(d.Z,{children:[(0,v.jsx)("p",{children:(0,g.ih)("Are you sure you want to unlink this device?")}),(0,v.jsx)(u.Z,{check:!0,children:(0,v.jsxs)(p.Z,{check:!0,children:[(0,v.jsx)(h.Z,{type:"checkbox",checked:this.state.isChecked,onChange:this.onInputChange}),(0,v.jsx)("span",{children:(0,g.ih)("Delete files from this device the next time it comes online.")})]})})]}),(0,v.jsxs)(f.Z,{children:[(0,v.jsx)(m.Z,{color:"secondary",onClick:this.toggle,children:(0,g.ih)("Cancel")}),(0,v.jsx)(m.Z,{color:"primary",onClick:this.executeOperation,children:(0,g.ih)("Unlink")})]})]})}}]),n}(a.Component);t.Z=y},88195:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(42995),c=n(12756),d=n(12213),u=n(61805),p=n(46417),h=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.asyncOperationProgress,r=e.asyncOperatedFilesLength,o="move"===t?(0,u.ih)("Move {num} items"):(0,u.ih)("Copy {num} items");o=o.replace("{num}",r);var i={width:n+"%",lineHeight:"40px",textAlign:"left"};return(0,p.jsxs)(l.Z,{isOpen:!0,toggle:this.props.toggleDialog,className:"copy-move-dirent-progress-dialog",children:[(0,p.jsx)(c.Z,{toggle:this.props.toggleDialog,children:o}),(0,p.jsx)(d.Z,{children:(0,p.jsx)("div",{className:"progress",children:(0,p.jsx)("div",{className:"progress-bar pl-2",role:"progressbar",style:i,"aria-valuenow":n,"aria-valuemin":"0","aria-valuemax":"100",children:n+"%"})})})]})}}]),n}(a.Component),f=h},1631:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(42995),c=n(12756),d=n(12213),u=n(74073),p=n(54105),h=n(85951),f=n(5684),m=n(93869),g=n(7764),v=n(21303),y=n(61805),x=n(83854),w=n(46417),b=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).isSdocSuffix=function(e){return e.endsWith(".sdoc")},o.handleChange=function(e){e.target.value.trim()?o.setState({isSubmitBtnActive:!0}):o.setState({isSubmitBtnActive:!1}),o.setState({childName:e.target.value})},o.handleSubmit=function(){if(o.state.isSubmitBtnActive){var e=o.checkDuplicatedName(),t=o.state.childName;if(e){var n=(0,y.ih)('The name "{name}" is already taken. Please choose a different name.');n=n.replace("{name}",x.c.HTMLescape(t)),o.setState({errMessage:n})}else{var r=o.state.parentPath+t;o.props.onAddFile(r),o.props.toggleDialog()}}},o.handleKeyDown=function(e){"Enter"===e.key&&(o.handleSubmit(),e.preventDefault())},o.checkDuplicatedName=function(){return o.props.checkDuplicatedName(o.state.childName)},o.onAfterModelOpened=function(){o.newInput.current&&(o.newInput.current.focus(),o.newInput.current.setSelectionRange(0,0))};var i=e.fileType,s=void 0===i?"":i;return o.state={parentPath:"",childName:s,errMessage:"",isSubmitBtnActive:!!o.isSdocSuffix(s)},o.newInput=a.createRef(),o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this.props.parentPath;"/"===e[e.length-1]?this.setState({parentPath:e}):this.setState({parentPath:e+"/"})}},{key:"render",value:function(){var e=this.props.toggleDialog;return(0,w.jsxs)(l.Z,{isOpen:!0,toggle:e,onOpened:this.onAfterModelOpened,children:[(0,w.jsx)(c.Z,{toggle:e,children:(0,y.ih)("New File")}),(0,w.jsxs)(d.Z,{children:[(0,w.jsx)(u.Z,{children:(0,w.jsxs)(p.Z,{children:[(0,w.jsx)(h.Z,{for:"fileName",children:(0,y.ih)("Name")}),(0,w.jsx)(f.Z,{id:"fileName",onKeyDown:this.handleKeyDown,innerRef:this.newInput,value:this.state.childName,onChange:this.handleChange})]})}),this.state.errMessage&&(0,w.jsx)(m.Z,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,w.jsxs)(g.Z,{children:[(0,w.jsx)(v.Z,{color:"secondary",onClick:e,children:(0,y.ih)("Cancel")}),(0,w.jsx)(v.Z,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,y.ih)("Submit")})]})]})}}]),n}(a.Component);t.Z=b},30166:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(42995),c=n(12756),d=n(12213),u=n(74073),p=n(54105),h=n(85951),f=n(5684),m=n(93869),g=n(7764),v=n(21303),y=n(61805),x=n(83854),w=n(46417),b=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleChange=function(e){e.target.value.trim()?o.setState({isSubmitBtnActive:!0}):o.setState({isSubmitBtnActive:!1}),o.setState({childName:e.target.value})},o.handleSubmit=function(){if(o.state.isSubmitBtnActive){var e=o.state.childName;if(o.checkDuplicatedName()){var t=(0,y.ih)('The name "{name}" is already taken. Please choose a different name.');t=t.replace("{name}",x.c.HTMLescape(e)),o.setState({errMessage:t})}else{var n=o.state.parentPath+e;o.props.onAddFolder(n)}}},o.handleKeyDown=function(e){"Enter"===e.key&&(o.handleSubmit(),e.preventDefault())},o.toggle=function(){o.props.addFolderCancel()},o.checkDuplicatedName=function(){return o.props.checkDuplicatedName(o.state.childName)},o.state={parentPath:"",childName:"",errMessage:"",isSubmitBtnActive:!1},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this.props.parentPath;"/"===e[e.length-1]?this.setState({parentPath:e}):this.setState({parentPath:e+"/"})}},{key:"render",value:function(){return(0,w.jsxs)(l.Z,{isOpen:!0,toggle:this.toggle,autoFocus:!1,children:[(0,w.jsx)(c.Z,{toggle:this.toggle,children:(0,y.ih)("New Folder")}),(0,w.jsxs)(d.Z,{children:[(0,w.jsx)(u.Z,{children:(0,w.jsxs)(p.Z,{children:[(0,w.jsx)(h.Z,{for:"folderName",children:(0,y.ih)("Name")}),(0,w.jsx)(f.Z,{id:"folderName",value:this.state.childName,onKeyDown:this.handleKeyDown,onChange:this.handleChange,autoFocus:!0})]})}),this.state.errMessage&&(0,w.jsx)(m.Z,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,w.jsxs)(g.Z,{children:[(0,w.jsx)(v.Z,{color:"secondary",onClick:this.toggle,children:(0,y.ih)("Cancel")}),(0,w.jsx)(v.Z,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,y.ih)("Submit")})]})]})}}]),n}(a.Component);t.Z=b},9368:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(97326),s=n(60136),a=n(29388),l=n(47313),c=n(61805),d=n(4514),u=n(42995),p=n(12756),h=n(12213),f=n(5684),m=n(7764),g=n(21303),v=n(83854),y=n(46417),x=function(e){(0,s.Z)(n,e);var t=(0,a.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).handleGroupChange=function(e){var t=e.target.value;t.trim()?o.setState({isSubmitBtnActive:!0}):o.setState({isSubmitBtnActive:!1}),o.setState({groupName:t}),o.state.errorMsg&&o.setState({errorMsg:""})},o.handleSubmitGroup=function(){var e=o.state.groupName.trim();if(e){var t=(0,i.Z)(o);d.I.createGroup(e).then((function(e){t.props.onCreateGroup(e.data),o.props.toggleDialog()})).catch((function(e){var t=v.c.getErrorMsg(e);o.setState({errorMsg:t})}))}else o.setState({errorMsg:(0,c.ih)("Name is required")});o.setState({groupName:""})},o.handleKeyDown=function(e){13===e.keyCode&&(o.handleSubmitGroup(),e.preventDefault())},o.state={groupName:"",errorMsg:"",isSubmitBtnActive:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,y.jsxs)(u.Z,{isOpen:!0,toggle:this.props.toggleDialog,autoFocus:!1,children:[(0,y.jsx)(p.Z,{toggle:this.props.toggleDialog,children:(0,c.ih)("New Group")}),(0,y.jsxs)(h.Z,{children:[(0,y.jsx)("label",{htmlFor:"groupName",children:(0,c.ih)("Name")}),(0,y.jsx)(f.Z,{type:"text",id:"groupName",value:this.state.groupName,onChange:this.handleGroupChange,onKeyDown:this.handleKeyDown,autoFocus:!0}),(0,y.jsx)("span",{className:"error",children:this.state.errorMsg})]}),(0,y.jsxs)(m.Z,{children:[(0,y.jsx)(g.Z,{color:"secondary",onClick:this.props.toggleDialog,children:(0,c.ih)("Cancel")}),(0,y.jsx)(g.Z,{color:"primary",onClick:this.handleSubmitGroup,disabled:!this.state.isSubmitBtnActive,children:(0,c.ih)("Submit")})]})]})}}]),n}(l.Component);t.Z=x},40207:function(e,t,n){"use strict";n.d(t,{Z:function(){return L}});var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(61805),c=n(75192),d=n.n(c),u=n(9284),p=n.n(u);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,j(r.key),r)}}function g(e,t,n){return(t=j(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(this,arguments)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function x(e,t){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},x(e,t)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}(this,n)}}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,s,a=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);l=!0);}catch(d){c=!0,o=d}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw o}}return a}}(e,t)||D(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||D(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){if(e){if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function j(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return"";var n=e;return t&&Object.keys(t).forEach((function(e){n=n.replace(e,t[e])})),n}function M(){return"undefined"!==typeof n.g.window?n.g.window.innerWidth:0}function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.g.window.self,t=e.document.referrer;if(e===n.g.window.top||!t)return e;var r=function(e){return e.match(/(.*\/\/.*?)(\/|$)/)[1]};return r(e.location.href)===r(t)?_(e.parent):e}var N=300,R=27,T=37,O=39,E=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}(s,e);var t,r,o,i=b(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),g(w(t=i.call(this,e)),"handleWheel",(function(e){e.preventDefault()})),t.state={isClosing:!e.animationDisabled,shouldAnimate:!1,zoomLevel:0,offsetX:0,offsetY:0,loadErrorStatus:{},rotateDeg:0},t.outerEl=a.createRef(),t.zoomInBtn=a.createRef(),t.zoomOutBtn=a.createRef(),t.caption=a.createRef(),t.closeIfClickInner=t.closeIfClickInner.bind(w(t)),t.handleImageDoubleClick=t.handleImageDoubleClick.bind(w(t)),t.handleImageClick=t.handleImageClick.bind(w(t)),t.handleImageMouseWheel=t.handleImageMouseWheel.bind(w(t)),t.handleKeyInput=t.handleKeyInput.bind(w(t)),t.handleMouseUp=t.handleMouseUp.bind(w(t)),t.handleMouseDown=t.handleMouseDown.bind(w(t)),t.handleMouseMove=t.handleMouseMove.bind(w(t)),t.handleOuterMousewheel=t.handleOuterMousewheel.bind(w(t)),t.handleTouchStart=t.handleTouchStart.bind(w(t)),t.handleTouchMove=t.handleTouchMove.bind(w(t)),t.handleTouchEnd=t.handleTouchEnd.bind(w(t)),t.handlePointerEvent=t.handlePointerEvent.bind(w(t)),t.handleCaptionMousewheel=t.handleCaptionMousewheel.bind(w(t)),t.handleWindowResize=t.handleWindowResize.bind(w(t)),t.handleZoomInButtonClick=t.handleZoomInButtonClick.bind(w(t)),t.handleZoomOutButtonClick=t.handleZoomOutButtonClick.bind(w(t)),t.requestClose=t.requestClose.bind(w(t)),t.requestMoveNext=t.requestMoveNext.bind(w(t)),t.requestMovePrev=t.requestMovePrev.bind(w(t)),t.rotateImage=t.rotateImage.bind(w(t)),t}return t=s,r=[{key:"UNSAFE_componentWillMount",value:function(){this.timeouts=[],this.currentAction=0,this.eventsSource=0,this.pointerList=[],this.preventInnerClose=!1,this.preventInnerCloseTimeout=null,this.keyPressed=!1,this.imageCache={},this.lastKeyDownTime=0,this.resizeTimeout=null,this.wheelActionTimeout=null,this.resetScrollTimeout=null,this.scrollX=0,this.scrollY=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,this.pinchTouchList=null,this.pinchDistance=0,this.keyCounter=0,this.moveRequested=!1,this.props.animationDisabled||this.setState({isClosing:!1})}},{key:"componentDidMount",value:function(){var e=this;this.windowContext=_(),this.listeners={resize:this.handleWindowResize,mouseup:this.handleMouseUp,touchend:this.handleTouchEnd,touchcancel:this.handleTouchEnd,pointerdown:this.handlePointerEvent,pointermove:this.handlePointerEvent,pointerup:this.handlePointerEvent,pointercancel:this.handlePointerEvent},Object.keys(this.listeners).forEach((function(t){e.windowContext.addEventListener(t,e.listeners[t])})),document.addEventListener("wheel",this.handleWheel,{passive:!1}),this.loadAllImages()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,n=!1,r={},o={};this.getSrcTypes().forEach((function(i){t.props[i.name]!==e[i.name]&&(n=!0,r[t.props[i.name]]=!0,o[e[i.name]]=!0)})),(n||this.moveRequested)&&(Object.keys(r).forEach((function(e){!(e in o)&&e in t.imageCache&&(t.imageCache[e].loaded=!1)})),this.moveRequested=!1,this.loadAllImages(e))}},{key:"shouldComponentUpdate",value:function(){return!this.moveRequested}},{key:"componentWillUnmount",value:function(){var e=this;this.didUnmount=!0,Object.keys(this.listeners).forEach((function(t){e.windowContext.removeEventListener(t,e.listeners[t])})),document.removeEventListener("wheel",this.handleWheel,{passive:!1}),this.timeouts.forEach((function(e){return clearTimeout(e)}))}},{key:"setTimeout",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var n=this,r=setTimeout((function(){n.timeouts=n.timeouts.filter((function(e){return e!==r})),e()}),t);return this.timeouts.push(r),r}))},{key:"setPreventInnerClose",value:function(){var e=this;this.preventInnerCloseTimeout&&this.clearTimeout(this.preventInnerCloseTimeout),this.preventInnerClose=!0,this.preventInnerCloseTimeout=this.setTimeout((function(){e.preventInnerClose=!1,e.preventInnerCloseTimeout=null}),100)}},{key:"getBestImageForType",value:function(e){var t=this.props[e],n={};if(this.isImageLoaded(t))n=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height);else{if(!this.isImageLoaded(this.props["".concat(e,"Thumbnail")]))return null;t=this.props["".concat(e,"Thumbnail")],n=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height,!0)}return{src:t,height:this.imageCache[t].height,width:this.imageCache[t].width,targetHeight:n.height,targetWidth:n.width}}},{key:"getFitSizes",value:function(e,t,n){var r=this.getLightboxRect(),o=r.height-2*this.props.imagePadding,i=r.width-2*this.props.imagePadding;return n||(o=Math.min(o,t),i=Math.min(i,e)),i/o>e/t?{width:e*o/t,height:o}:{width:i,height:t*i/e}}},{key:"getMaxOffsets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel,t=this.getBestImageForType("mainSrc");if(null===t)return{maxX:0,minX:0,maxY:0,minY:0};var n=this.getLightboxRect(),r=this.getZoomMultiplier(e),o=0,i=0;return{maxX:o=r*t.width-n.width<0?(n.width-r*t.width)/2:(r*t.width-n.width)/2,maxY:i=r*t.height-n.height<0?(n.height-r*t.height)/2:(r*t.height-n.height)/2,minX:-1*o,minY:-1*i}}},{key:"getSrcTypes",value:function(){return[{name:"mainSrc",keyEnding:"i".concat(this.keyCounter)},{name:"mainSrcThumbnail",keyEnding:"t".concat(this.keyCounter)},{name:"nextSrc",keyEnding:"i".concat(this.keyCounter+1)},{name:"nextSrcThumbnail",keyEnding:"t".concat(this.keyCounter+1)},{name:"prevSrc",keyEnding:"i".concat(this.keyCounter-1)},{name:"prevSrcThumbnail",keyEnding:"t".concat(this.keyCounter-1)}]}},{key:"getZoomMultiplier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel;return Math.pow(1.007,e)}},{key:"getLightboxRect",value:function(){return this.outerEl.current?this.outerEl.current.getBoundingClientRect():{width:M(),height:"undefined"!==typeof n.g.window?n.g.window.innerHeight:0,top:0,right:0,bottom:0,left:0}}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this.timeouts=this.timeouts.filter((function(t){return t!==e})),clearTimeout(e)}))},{key:"changeZoom",value:function(e,t,n){if(this.props.enableZoom){var r=Math.max(0,Math.min(N,e));if(r!==this.state.zoomLevel)if(0!==r){var o=this.getBestImageForType("mainSrc");if(null!==o){var i=this.getZoomMultiplier(),s=this.getZoomMultiplier(r),a=this.getLightboxRect(),l="undefined"!==typeof t?t-a.left:a.width/2,c="undefined"!==typeof n?n-a.top:a.height/2,d=(a.width-o.width*i)/2,u=(a.height-o.height*i)/2,p=l-(l-(d-this.state.offsetX))/i*s,h=c-(c-(u-this.state.offsetY))/i*s,f=(a.width-o.width*s)/2-p,m=(a.height-o.height*s)/2-h;if(3!==this.currentAction){var g=this.getMaxOffsets();this.state.zoomLevel>r&&(f=Math.max(g.minX,Math.min(g.maxX,f)),m=Math.max(g.minY,Math.min(g.maxY,m)))}this.setState({zoomLevel:r,offsetX:f,offsetY:m})}}else this.setState({zoomLevel:r,offsetX:0,offsetY:0})}}},{key:"closeIfClickInner",value:function(e){!this.preventInnerClose&&e.target.className.search(/\bril-inner\b/)>-1&&this.requestClose(e)}},{key:"handleKeyInput",value:function(e){if(e.stopPropagation(),!this.isAnimating())if("keyup"!==e.type){var t=e.which||e.keyCode,n=new Date;if(!(n.getTime()-this.lastKeyDownTime<this.props.keyRepeatLimit&&t!==R))switch(this.lastKeyDownTime=n.getTime(),t){case R:e.preventDefault(),this.requestClose(e);break;case T:if(!this.props.prevSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMovePrev(e);break;case O:if(!this.props.nextSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMoveNext(e)}}else this.lastKeyDownTime-=this.props.keyRepeatKeyupBonus}},{key:"handleOuterMousewheel",value:function(e){var t=this;e.stopPropagation(),this.clearTimeout(this.resetScrollTimeout),this.resetScrollTimeout=this.setTimeout((function(){t.scrollX=0,t.scrollY=0}),300)}},{key:"handleImageMouseWheel",value:function(e){if(parseInt(e.deltaY)!==parseFloat(e.deltaY)){if(Math.abs(e.deltaY)>=Math.abs(e.deltaX)){if(e.stopPropagation(),Math.abs(e.deltaY)<1)return;this.scrollX=0,this.scrollY+=e.deltaY,this.changeZoom(this.state.zoomLevel-e.deltaY,e.clientX,e.clientY)}}else if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){var t=this.state.offsetY+e.deltaY;t=t<0?0:t,this.setState({offsetY:t})}else{var n=this.state.offsetX+e.deltaX;n=n<0?0:n,this.setState({offsetX:n})}}},{key:"handleImageDoubleClick",value:function(e){this.state.zoomLevel>0?this.changeZoom(0,e.clientX,e.clientY):this.changeZoom(this.state.zoomLevel+100,e.clientX,e.clientY)}},{key:"handleImageClick",value:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},{key:"shouldHandleEvent",value:function(e){if(this.eventsSource===e)return!0;if(0===this.eventsSource)return this.eventsSource=e,!0;switch(e){case 1:default:return!1;case 2:return this.eventsSource=2,this.filterPointersBySource(),!0;case 3:return 1===this.eventsSource&&(this.eventsSource=3,this.filterPointersBySource(),!0)}}},{key:"addPointer",value:function(e){this.pointerList.push(e)}},{key:"removePointer",value:function(e){this.pointerList=this.pointerList.filter((function(t){return t.id!==e.id}))}},{key:"filterPointersBySource",value:function(){var e=this;this.pointerList=this.pointerList.filter((function(t){return t.source===e.eventsSource}))}},{key:"handleMouseDown",value:function(e){this.shouldHandleEvent(1)&&s.isTargetMatchImage(e.target)&&(this.addPointer(s.parseMouseEvent(e)),this.multiPointerStart(e))}},{key:"handleMouseMove",value:function(e){this.shouldHandleEvent(1)&&this.multiPointerMove(e,[s.parseMouseEvent(e)])}},{key:"handleMouseUp",value:function(e){this.shouldHandleEvent(1)&&(this.removePointer(s.parseMouseEvent(e)),this.multiPointerEnd(e))}},{key:"handlePointerEvent",value:function(e){if(this.shouldHandleEvent(3))switch(e.type){case"pointerdown":s.isTargetMatchImage(e.target)&&(this.addPointer(s.parsePointerEvent(e)),this.multiPointerStart(e));break;case"pointermove":this.multiPointerMove(e,[s.parsePointerEvent(e)]);break;case"pointerup":case"pointercancel":this.removePointer(s.parsePointerEvent(e)),this.multiPointerEnd(e)}}},{key:"handleTouchStart",value:function(e){var t=this;this.shouldHandleEvent(2)&&s.isTargetMatchImage(e.target)&&([].forEach.call(e.changedTouches,(function(e){return t.addPointer(s.parseTouchPointer(e))})),this.multiPointerStart(e))}},{key:"handleTouchMove",value:function(e){this.shouldHandleEvent(2)&&this.multiPointerMove(e,[].map.call(e.changedTouches,(function(e){return s.parseTouchPointer(e)})))}},{key:"handleTouchEnd",value:function(e){var t=this;this.shouldHandleEvent(2)&&([].map.call(e.changedTouches,(function(e){return t.removePointer(s.parseTouchPointer(e))})),this.multiPointerEnd(e))}},{key:"decideMoveOrSwipe",value:function(e){this.state.zoomLevel<=0?this.handleSwipeStart(e):this.handleMoveStart(e)}},{key:"multiPointerStart",value:function(e){switch(this.handleEnd(null),this.pointerList.length){case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"multiPointerMove",value:function(e,t){switch(this.currentAction){case 1:e.preventDefault(),this.handleMove(t[0]);break;case 2:e.preventDefault(),this.handleSwipe(t[0]);break;case 3:e.preventDefault(),this.handlePinch(t)}}},{key:"multiPointerEnd",value:function(e){switch(0!==this.currentAction&&(this.setPreventInnerClose(),this.handleEnd(e)),this.pointerList.length){case 0:this.eventsSource=0;break;case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"handleEnd",value:function(e){switch(this.currentAction){case 1:this.handleMoveEnd(e);break;case 2:this.handleSwipeEnd(e);break;case 3:this.handlePinchEnd(e)}}},{key:"handleMoveStart",value:function(e){var t=e.x,n=e.y;this.props.enableZoom&&(this.currentAction=1,this.moveStartX=t,this.moveStartY=n,this.moveStartOffsetX=this.state.offsetX,this.moveStartOffsetY=this.state.offsetY)}},{key:"handleMove",value:function(e){var t=e.x,n=e.y,r=this.moveStartX-t+this.moveStartOffsetX,o=this.moveStartY-n+this.moveStartOffsetY;this.state.offsetX===r&&this.state.offsetY===o||this.setState({offsetX:r,offsetY:o})}},{key:"handleMoveEnd",value:function(){var e=this;this.currentAction=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0;var t=this.getMaxOffsets(),n=Math.max(t.minX,Math.min(t.maxX,this.state.offsetX)),r=Math.max(t.minY,Math.min(t.maxY,this.state.offsetY));n===this.state.offsetX&&r===this.state.offsetY||(this.setState({offsetX:n,offsetY:r,shouldAnimate:!0}),this.setTimeout((function(){e.setState({shouldAnimate:!1})}),this.props.animationDuration))}},{key:"handleSwipeStart",value:function(e){var t=e.x,n=e.y;this.currentAction=2,this.swipeStartX=t,this.swipeStartY=n,this.swipeEndX=t,this.swipeEndY=n}},{key:"handleSwipe",value:function(e){var t=e.x,n=e.y;this.swipeEndX=t,this.swipeEndY=n}},{key:"handleSwipeEnd",value:function(e){var t=this.swipeEndX-this.swipeStartX,n=Math.abs(t),r=Math.abs(this.swipeEndY-this.swipeStartY);if(this.currentAction=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,!(!e||this.isAnimating()||n<1.5*r)){if(n<200&&n<this.getLightboxRect().width/4)return;t>0&&this.props.prevSrc?(e.preventDefault(),this.requestMovePrev()):t<0&&this.props.nextSrc&&(e.preventDefault(),this.requestMoveNext())}}},{key:"calculatePinchDistance",value:function(){var e=S(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,2),t=e[0],n=e[1];return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}},{key:"calculatePinchCenter",value:function(){var e=S(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,2),t=e[0],n=e[1];return{x:t.x-(t.x-n.x)/2,y:t.y-(t.y-n.y)/2}}},{key:"handlePinchStart",value:function(e){this.props.enableZoom&&(this.currentAction=3,this.pinchTouchList=e.map((function(e){return{id:e.id,x:e.x,y:e.y}})),this.pinchDistance=this.calculatePinchDistance())}},{key:"handlePinch",value:function(e){this.pinchTouchList=this.pinchTouchList.map((function(t){for(var n=0;n<e.length;n+=1)if(e[n].id===t.id)return e[n];return t}));var t=this.calculatePinchDistance(),n=this.state.zoomLevel+t-this.pinchDistance;this.pinchDistance=t;var r=this.calculatePinchCenter(this.pinchTouchList),o=r.x,i=r.y;this.changeZoom(n,o,i)}},{key:"handlePinchEnd",value:function(){this.currentAction=0,this.pinchTouchList=null,this.pinchDistance=0}},{key:"handleWindowResize",value:function(){this.clearTimeout(this.resizeTimeout),this.resizeTimeout=this.setTimeout(this.forceUpdate.bind(this),100)}},{key:"handleZoomInButtonClick",value:function(){var e=this.state.zoomLevel+100;this.changeZoom(e),e===N&&this.zoomOutBtn.current.focus()}},{key:"handleZoomOutButtonClick",value:function(){var e=this.state.zoomLevel-100;this.changeZoom(e),0===e&&this.zoomInBtn.current.focus()}},{key:"handleCaptionMousewheel",value:function(e){if(e.stopPropagation(),this.caption.current){var t=this.caption.current.getBoundingClientRect().height,n=this.caption.current,r=n.scrollHeight,o=n.scrollTop;(e.deltaY>0&&t+o>=r||e.deltaY<0&&o<=0)&&e.preventDefault()}}},{key:"isAnimating",value:function(){return this.state.shouldAnimate||this.state.isClosing}},{key:"isImageLoaded",value:function(e){return e&&e in this.imageCache&&this.imageCache[e].loaded}},{key:"loadImage",value:function(e,t,r){var o=this;if(this.isImageLoaded(t))this.setTimeout((function(){r()}),1);else{var i=new n.g.Image;this.props.imageCrossOrigin&&(i.crossOrigin=this.props.imageCrossOrigin),i.onerror=function(n){o.props.onImageLoadError(t,e,n),o.setState((function(t){return{loadErrorStatus:f(f({},t.loadErrorStatus),{},g({},e,!0))}})),r(n)},i.onload=function(){o.props.onImageLoad(t,e,i),o.imageCache[t]={loaded:!0,width:i.width,height:i.height},r()},i.src=t}}},{key:"loadAllImages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;this.getSrcTypes().forEach((function(n){var r=n.name;t[r]&&e.state.loadErrorStatus[r]&&e.setState((function(e){return{loadErrorStatus:f(f({},e.loadErrorStatus),{},g({},r,!1))}})),t[r]&&!e.isImageLoaded(t[r])&&e.loadImage(r,t[r],function(t,n){return function(r){r||e.props[t]!==n||e.didUnmount||e.forceUpdate()}}(r,t[r]))}))}},{key:"requestClose",value:function(e){var t=this,n=function(){t.saveRotateImage(),t.props.onCloseRequest(e)};this.props.animationDisabled||"keydown"===e.type&&!this.props.animationOnKeyInput?n():(this.setState({isClosing:!0}),this.setTimeout(n,this.props.animationDuration))}},{key:"requestMove",value:function(e,t){var n=this,r={zoomLevel:0,offsetX:0,offsetY:0};this.props.animationDisabled||this.keyPressed&&!this.props.animationOnKeyInput||(r.shouldAnimate=!0,this.setTimeout((function(){return n.setState({shouldAnimate:!1})}),this.props.animationDuration)),this.keyPressed=!1,this.moveRequested=!0,this.saveRotateImage(),"prev"===e?(this.keyCounter-=1,this.setState(r),this.props.onMovePrevRequest(t)):(this.keyCounter+=1,this.setState(r),this.props.onMoveNextRequest(t))}},{key:"requestMoveNext",value:function(e){this.requestMove("next",e)}},{key:"requestMovePrev",value:function(e){this.requestMove("prev",e)}},{key:"saveRotateImage",value:function(){this.props.onRotateImage&&0!==this.state.rotateDeg&&360!==this.state.rotateDeg&&(this.props.onRotateImage(this.state.rotateDeg),this.setState({rotateDeg:0}))}},{key:"rotateImage",value:function(){var e=this.state.rotateDeg;e=e>=360?this.state.rotateDeg-270:e+90,this.setState({rotateDeg:e})}},{key:"render",value:function(){var e=this,t=this.props,r=t.animationDisabled,o=t.animationDuration,i=t.clickOutsideToClose,l=t.discourageDownloads,c=t.enableZoom,d=t.imageTitle,u=t.nextSrc,h=t.prevSrc,m=t.isDesktop,g=t.toolbarButtons,y=t.reactModalStyle,x=t.onAfterOpen,w=t.imageCrossOrigin,b=t.reactModalProps,S=t.onRotateImage,D=this.state,k=D.zoomLevel,j=D.offsetX,M=D.offsetY,_=D.isClosing,R=D.loadErrorStatus,T=D.rotateDeg,O=this.getLightboxRect(),E={};!r&&this.isAnimating()&&(E=f(f({},E),{},{transition:"transform ".concat(o,"ms")}));var P={};this.getSrcTypes().forEach((function(e){var t=e.name,n=e.keyEnding;P[t]=n}));var Z=[],F=function(t,n,r){if(e.props[t]){var o,i=e.getBestImageForType(t),c=f(f({},E),s.getTransform(f(f({},r),i)));if(k>0&&(c.cursor="move"),c.transform="".concat(c.transform," rotate(").concat(T,"deg)"),null===i&&(o=R,Object.keys(o).some((function(e){return o[e]}))))Z.push(a.createElement("div",{className:"".concat(n," ril__image ril-errored"),style:c,key:e.props[t]+P[t]},a.createElement("div",{className:"ril__errorContainer"},e.props.imageLoadErrorMessage)));else if(null!==i){var u=i.src;l?(c.backgroundImage="url('".concat(u,"')"),Z.push(a.createElement("div",{className:"".concat(n," ril__image ril__imageDiscourager"),onDoubleClick:e.handleImageDoubleClick,onWheel:e.handleImageMouseWheel,style:c,key:u+P[t]},a.createElement("div",{className:"ril-download-blocker ril__downloadBlocker"})))):Z.push(a.createElement("img",v({},w?{crossOrigin:w}:{},{className:"".concat(n," ril__image"),onDoubleClick:e.handleImageDoubleClick,onClick:e.handleImageClick,onWheel:e.handleImageMouseWheel,onDragStart:function(e){return e.preventDefault()},style:c,src:u,key:u+P[t],alt:"string"===typeof d?d:I("Image"),draggable:!1})))}else{var p=a.createElement("div",{className:"ril-loading-circle ril__loadingCircle ril__loadingContainer__icon"},C(new Array(12)).map((function(e,t){return a.createElement("div",{key:t,className:"ril-loading-circle-point ril__loadingCirclePoint"})})));Z.push(a.createElement("div",{className:"".concat(n," ril__image ril-not-loaded"),style:c,key:e.props[t]+P[t]},a.createElement("div",{className:"ril__loadingContainer"},p)))}}},L=this.getZoomMultiplier();F("nextSrc","ril-image-next ril__imageNext",{x:O.width}),F("mainSrc","ril-image-current",{x:-1*j,y:-1*M,zoom:L}),F("prevSrc","ril-image-prev ril__imagePrev",{x:-1*O.width});var A={overlay:f({zIndex:1e3,backgroundColor:"transparent"},y.overlay),content:f({backgroundColor:"transparent",overflow:"hidden",border:"none",borderRadius:0,padding:0,top:0,left:0,right:0,bottom:0},y.content)};return a.createElement(p(),v({isOpen:!0,onRequestClose:i?this.requestClose:void 0,onAfterOpen:function(){e.outerEl.current&&e.outerEl.current.focus(),x()},style:A,contentLabel:I("Lightbox"),appElement:"undefined"!==typeof n.g.window?n.g.window.document.body:void 0},b),a.createElement("div",{className:"ril-outer ril__outer ril__outerAnimating ".concat(this.props.wrapperClassName," ").concat(_?"ril-closing ril__outerClosing":""),style:{transition:"opacity ".concat(o,"ms"),animationDuration:"".concat(o,"ms"),animationDirection:_?"normal":"reverse"},ref:this.outerEl,onWheel:this.handleOuterMousewheel,onMouseMove:this.handleMouseMove,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,tabIndex:"-1",onKeyDown:this.handleKeyInput,onKeyUp:this.handleKeyInput},a.createElement("div",{className:"ril-inner ril__inner",onClick:i?this.closeIfClickInner:void 0},Z),h&&m&&a.createElement("button",{type:"button",className:"ril-prev-button ril__navButtons ril__navButtonPrev",key:"prev","aria-label":this.props.prevLabel,onClick:this.isAnimating()?void 0:this.requestMovePrev}),u&&m&&a.createElement("button",{type:"button",className:"ril-next-button ril__navButtons ril__navButtonNext",key:"next","aria-label":this.props.nextLabel,onClick:this.isAnimating()?void 0:this.requestMoveNext}),a.createElement("div",{className:"ril-toolbar ril__toolbar"},a.createElement("ul",{className:"ril-toolbar-left ril__toolbarSide ril__toolbarLeftSide"},a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},a.createElement("span",{className:"ril-toolbar__item__child ril__toolbarItemChild"},d))),a.createElement("ul",{className:"ril-toolbar-right ril__toolbarSide ril__toolbarRightSide"},g&&g.map((function(e,t){return a.createElement("li",{key:"button_".concat(t+1),className:"ril-toolbar__item ril__toolbarItem"},e)})),a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},a.createElement("button",{type:"button",key:"close","aria-label":this.props.closeLabel,className:"ril-close ril-toolbar__item__child ril__toolbarItemChild ril__builtinButton ril__closeButton",onClick:this.isAnimating()?void 0:this.requestClose})))),a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"ril-caption ril__caption"},c&&a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},a.createElement("button",{type:"button",key:"zoom-in","aria-label":this.props.zoomInLabel,className:["ril-zoom-in","ril__toolbarItemChild","ril__builtinButton","ril__zoomInButton"].concat(C(k===N?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomInBtn,disabled:this.isAnimating()||k===N,onClick:this.isAnimating()||k===N?void 0:this.handleZoomInButtonClick})),c&&a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},a.createElement("button",{type:"button",key:"zoom-out","aria-label":this.props.zoomOutLabel,className:["ril-zoom-out","ril__toolbarItemChild","ril__builtinButton","ril__zoomOutButton"].concat(C(0===k?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomOutBtn,disabled:this.isAnimating()||0===k,onClick:this.isAnimating()||0===k?void 0:this.handleZoomOutButtonClick})),S&&a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},a.createElement("button",{type:"button",className:["ril-rotate","ril__toolbarItemChild","ril__builtinButton","ril__rotateButton","ril_rotateImageButton"].join(" "),onClick:this.rotateImage})))))}}],o=[{key:"isTargetMatchImage",value:function(e){return e&&/ril-image-current/.test(e.className)}},{key:"parseMouseEvent",value:function(e){return{id:"mouse",source:1,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parseTouchPointer",value:function(e){return{id:e.identifier,source:2,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parsePointerEvent",value:function(e){return{id:e.pointerId,source:3,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"getTransform",value:function(e){var t=e.x,n=void 0===t?0:t,r=e.y,o=void 0===r?0:r,i=e.zoom,s=void 0===i?1:i,a=e.width,l=e.targetWidth,c=n,d=M();a>d&&(c+=(d-a)/2);var u=s*(l/a);return{transform:"translate3d(".concat(c,"px,").concat(o,"px,0) scale3d(").concat(u,",").concat(u,",1)")}}}],r&&m(t.prototype,r),o&&m(t,o),Object.defineProperty(t,"prototype",{writable:!1}),s}(a.Component);E.propTypes={isDesktop:d().bool,mainSrc:d().string.isRequired,prevSrc:d().string,nextSrc:d().string,mainSrcThumbnail:d().string,prevSrcThumbnail:d().string,nextSrcThumbnail:d().string,onCloseRequest:d().func.isRequired,onMovePrevRequest:d().func,onMoveNextRequest:d().func,onImageLoadError:d().func,onImageLoad:d().func,onAfterOpen:d().func,discourageDownloads:d().bool,animationDisabled:d().bool,animationOnKeyInput:d().bool,animationDuration:d().number,keyRepeatLimit:d().number,keyRepeatKeyupBonus:d().number,imageTitle:d().node,imageCaption:d().node,imageCrossOrigin:d().string,reactModalStyle:d().object,imagePadding:d().number,wrapperClassName:d().string,toolbarButtons:d().arrayOf(d().node),clickOutsideToClose:d().bool,enableZoom:d().bool,reactModalProps:d().shape({}),nextLabel:d().string,prevLabel:d().string,zoomInLabel:d().string,zoomOutLabel:d().string,closeLabel:d().string,imageLoadErrorMessage:d().node,onRotateImage:d().func},E.defaultProps={isDesktop:!0,imageTitle:null,imageCaption:null,toolbarButtons:null,reactModalProps:{},animationDisabled:!1,animationDuration:300,animationOnKeyInput:!1,clickOutsideToClose:!0,closeLabel:"Close lightbox",discourageDownloads:!1,enableZoom:!0,imagePadding:10,imageCrossOrigin:null,keyRepeatKeyupBonus:40,keyRepeatLimit:180,mainSrcThumbnail:null,nextLabel:"Next image",nextSrc:null,nextSrcThumbnail:null,onAfterOpen:function(){},onImageLoadError:function(){},onImageLoad:function(){},onMoveNextRequest:function(){},onMovePrevRequest:function(){},prevLabel:"Previous image",prevSrc:null,prevSrcThumbnail:null,reactModalStyle:{},wrapperClassName:"",zoomInLabel:"Zoom in",zoomOutLabel:"Zoom out",imageLoadErrorMessage:"This image failed to load",onRotateImage:null};var P=E,Z=n(46417),F=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.imageItems,t=this.props.imageIndex,n=e.length,r=e[t].name,o="".concat(r," (").concat(t+1,"/").concat(n,")");return(0,Z.jsx)(P,{imageTitle:o,mainSrc:e[t].src,nextSrc:e[(t+1)%n].src,prevSrc:e[(t+n-1)%n].src,onCloseRequest:this.props.closeImagePopup,onMovePrevRequest:this.props.moveToPrevImage,onMoveNextRequest:this.props.moveToNextImage,imagePadding:70,imageLoadErrorMessage:(0,l.ih)("The image could not be loaded."),prevLabel:(0,l.ih)("Previous (Left arrow key)"),nextLabel:(0,l.ih)("Next (Right arrow key)"),closeLabel:(0,l.ih)("Close (Esc)"),zoomInLabel:(0,l.ih)("Zoom in"),zoomOutLabel:(0,l.ih)("Zoom out")})}}]),n}(a.Component),L=F},42123:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(42995),c=n(12756),d=n(12213),u=n(7764),p=n(21303),h=n(89915),f=n(61805),m=n(1303),g=n(46417),v=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).copyToClipboard=function(){(0,h.Z)(o.props.link),o.props.toggleDialog(),m.Z.success((0,f.ih)("The link is copied to the clipboard."),{duration:2})},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.link,n=e.toggleDialog;return(0,g.jsxs)(l.Z,{isOpen:!0,toggle:n,children:[(0,g.jsx)(c.Z,{toggle:n,children:(0,f.ih)("Link")}),(0,g.jsx)(d.Z,{children:(0,g.jsx)("a",{href:t,children:t})}),(0,g.jsxs)(u.Z,{children:[(0,g.jsx)(p.Z,{color:"primary",onClick:this.copyToClipboard,children:(0,f.ih)("Copy")}),(0,g.jsx)(p.Z,{color:"secondary",onClick:n,children:(0,f.ih)("Close")})]})]})}}]),n}(a.Component);t.Z=v},23396:function(e,t,n){"use strict";var r,o=n(15671),i=n(43144),s=n(60136),a=n(29388),l=n(47313),c=n(42995),d=n(12756),u=n(12213),p=n(61805),h=n(4514),f=n(83854),m=n(51282),g=n(46417),v=function(e){(0,s.Z)(n,e);var t=(0,a.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).queryZipProgress=function(){var e=i.state.zipToken;h.I.queryZipProgress(e).then((function(t){var n=t.data;if(1==n.failed){var o;switch(clearInterval(r),n.failed_reason){case"size too large":o=(0,p.ih)("Failed to download. The total size of the files exceeded the limit.");break;case"internal error":o=(0,p.ih)("Internal Server Error");break;default:o=(0,p.ih)("Error")}i.setState({isLoading:!1,errorMsg:o})}else i.setState({zipProgress:0==n.total?"100%":(n.zipped/n.total*100).toFixed(2)+"%"}),n.total==n.zipped&&(clearInterval(r),i.props.toggleDialog(),location.href="".concat(p.gc,"zip/").concat(e))})).catch((function(e){clearInterval(r);var t=f.c.getErrorMsg(e);i.setState({isLoading:!1,errorMsg:t})}))},i.cancelZipTask=function(){var e=i.state.zipToken;h.I.cancelZipTask(e).then((function(e){})).catch((function(e){}))},i.toggleDialog=function(){var e=i.state.zipProgress;e&&"100%"!=e&&(clearInterval(r),i.cancelZipTask()),i.props.toggleDialog()},i.state={isLoading:!0,errorMsg:"",zipProgress:null},i}return(0,i.Z)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.token,o=t.path,i=t.repoID,s=t.target;(n?s.length?h.I.getShareLinkDirentsZipTask(n,o,s):h.I.getShareLinkZipTask(n,o):h.I.zipDownload(i,o,s)).then((function(t){var n=t.data.zip_token;e.setState({isLoading:!1,errorMsg:"",zipToken:n}),e.queryZipProgress(),r=setInterval(e.queryZipProgress,1e3)})).catch((function(t){var n=f.c.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})}))}},{key:"render",value:function(){return(0,g.jsxs)(c.Z,{isOpen:!0,toggle:this.toggleDialog,children:[(0,g.jsx)(d.Z,{toggle:this.toggleDialog,children:(0,p.ih)("Download")}),(0,g.jsx)(u.Z,{children:(0,g.jsx)(y,{data:this.state})})]})}}]),n}(l.Component),y=function(e){(0,s.Z)(n,e);var t=(0,a.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,n=e.errorMsg,r=e.zipProgress;return t?(0,g.jsx)(m.Z,{}):n?(0,g.jsxs)("div",{className:"text-center mt-7 mb-8",children:[(0,g.jsx)("img",{src:"".concat(p.si,"img/error-tip.png"),alt:"",width:"100"}),(0,g.jsx)("p",{className:"mt-3",children:n})]}):(0,g.jsx)("p",{className:"mt-4 text-center",children:"".concat((0,p.ih)("Packaging...")," ").concat(r)})}}]),n}(l.Component);t.Z=v},90299:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(18760),c=n(13380),d=n(25417),u=n(72611),p=n(57124),h=n(61805),f=n(83854),m=n(68164),g=n(46417),v=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onShowMenu=function(){},o.onHideMenu=function(){o.state.isItemMenuShow&&(o.setState({isItemMenuShow:!1}),"function"===typeof o.props.unfreezeItem&&o.props.unfreezeItem())},o.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.onDropdownToggleClick(e)},o.onDropdownToggleClick=function(e){e.preventDefault(),e.stopPropagation(),o.toggleOperationMenu()},o.toggleOperationMenu=function(){o.setState({isItemMenuShow:!o.state.isItemMenuShow},(function(){o.state.isItemMenuShow&&"function"===typeof o.props.freezeItem?o.props.freezeItem():o.state.isItemMenuShow||"function"!==typeof o.props.unfreezeItem||o.props.unfreezeItem()}))},o.onMenuItemKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.onMenuItemClick(e)},o.onMenuItemClick=function(e){var t=f.c.getEventData(e,"toggle"),n=o.props.item;o.props.onMenuItemClick(t,e,n)},o.state={menuList:[],isItemMenuShow:!1},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.props.isHandleContextMenuEvent&&(this.listenerId=l.Z.register(this.onShowMenu,this.onHideMenu));var e=this.props.item,t=this.props.getMenuList(e);this.setState({menuList:t})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.item;if(t.name!==this.props.item.name){var n=this.props.getMenuList(t);this.setState({menuList:n})}}},{key:"componentWillUnmount",value:function(){this.props.isHandleContextMenuEvent&&this.listenerId&&l.Z.unregister(this.listenerId)}},{key:"render",value:function(){var e=this,t=this.state.menuList,n=this.props,r=n.toggleClass,o=n.toggleChildren,i=n.tagName;return r="sf-dropdown-toggle "+r,t.length?i&&"button"===i?(0,g.jsxs)(c.Z,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick,children:[(0,g.jsx)(d.Z,{className:this.props.toggleClass,"data-toggle":"dropdown",title:(0,h.ih)("More operations"),"aria-label":(0,h.ih)("More operations"),"aria-expanded":this.state.isItemMenuShow,onKeyDown:this.onDropdownToggleKeyDown,children:o}),(0,g.jsx)(u.Z,{children:t.map((function(t,n){return"Divider"===t?(0,g.jsx)(p.Z,{divider:!0},n):(0,g.jsx)(p.Z,{"data-toggle":t.key,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:t.value},n)}))})]}):(0,g.jsxs)(c.Z,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick,className:"vam",children:[(0,g.jsx)(d.Z,{tag:i||"i",role:"button",tabIndex:"0",className:r,title:(0,h.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow,"aria-label":(0,h.ih)("More operations"),onKeyDown:this.onDropdownToggleKeyDown}),(0,g.jsx)(m.Z,{children:(0,g.jsx)(u.Z,{children:t.map((function(t,n){return"Divider"===t?(0,g.jsx)(p.Z,{divider:!0},n):(0,g.jsx)(p.Z,{"data-toggle":t.key,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:t.value},n)}))})})]}):""}}]),n}(a.Component);v.defaultProps={isHandleContextMenuEvent:!0,toggleClass:"sf3-font-more sf3-font"},t.Z=v},62429:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(46417),c=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){return(0,l.jsx)("div",{className:"main-panel",children:this.props.children})}}]),n}(a.Component);t.Z=c},57357:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(61805),c=n(4514),d=n(83854),u=n(1303),p=n(46417);var h=function(e){var t=e.callBack,n=e.footerName,r=e.className,o=e.addIconClassName;return(0,p.jsxs)("div",{className:"add-item-btn ".concat(r||""),onClick:function(e){t(e)},children:[(0,p.jsx)("span",{className:"sf3-font sf3-font-enlarge mr-2 ".concat(o||"")}),(0,p.jsx)("span",{className:"add-new-option",title:n,children:n})]})},f=n(46123),m=n.n(f),g=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onCompositionStart=function(){o.isInputtingChinese=!0},o.onChange=function(e){o.timer&&clearTimeout(o.timer);var t=o.props,n=t.onChange,r=t.wait,i=e.target.value;o.setState({searchValue:i||""},(function(){o.isInputtingChinese||(o.timer=setTimeout((function(){n&&n(o.state.searchValue.trim())}),r))}))},o.onCompositionEnd=function(e){o.isInputtingChinese=!1,o.onChange(e)},o.clearSearch=function(){var e=o.props.clearValue;o.setState({searchValue:""},(function(){e&&e()}))},o.setFocus=function(e){if(o.inputRef!==document.activeElement&&(o.inputRef.focus(),e)){var t=o.state.searchValue.length;o.inputRef.setSelectionRange(0,t)}},o.isFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)},o.renderClear=function(){var e=o.props,t=e.isClearable,n=e.clearClassName,r=e.components,i=void 0===r?{}:r,s=o.state.searchValue;if(!t||!s)return null;var l=i.ClearIndicator;return a.isValidElement(l)?a.cloneElement(l,{clearValue:o.clearSearch}):o.isFunction(l)?(0,p.jsx)(l,{clearValue:o.clearSearch}):(0,p.jsx)("i",{className:m()("search-text-clear input-icon-addon",n),onClick:o.clearSearch,children:"\xd7"})},o.state={searchValue:e.value},o.isInputtingChinese=!1,o.timer=null,o.inputRef=null,o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.autoFocus&&this.inputRef&&this.inputRef!==document.activeElement&&setTimeout((function(){e.inputRef.focus()}),0)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({searchValue:e.value})}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null,this.inputRef=null}},{key:"render",value:function(){var e=this,t=this.props,n=t.placeholder,r=t.autoFocus,o=t.className,i=t.onKeyDown,s=t.disabled,l=t.style,c=this.state.searchValue;return(0,p.jsxs)(a.Fragment,{children:[(0,p.jsx)("input",{type:"text",value:c,className:m()("form-control",o),onChange:this.onChange,autoFocus:r,placeholder:n,onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,onKeyDown:i,disabled:s,style:l,ref:function(t){return e.inputRef=t}}),this.renderClear()]})}}]),n}(a.Component);g.defaultProps={wait:100,disabled:!1,value:""};var v=g,y=n(30560),x=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onMouseEnter=function(){e.props.setHighlightIndex(e.props.index)},e.onMouseLeave=function(){e.props.setHighlightIndex(-1)},e.getRepoTagIdList=function(){return(e.props.fileTagList||[]).map((function(e){return e.repo_tag_id}))},e.onEditFileTag=function(){var t=e.props,n=t.repoID,r=t.repoTag,o=t.filePath,i=e.getRepoTagIdList();if(-1===i.indexOf(r.id)){var s=r.id;c.I.addFileTag(n,o,s).then((function(){i=e.getRepoTagIdList(),e.props.onFileTagChanged()})).catch((function(e){var t=d.c.getErrorMsg(e);u.Z.danger(t)}))}else{for(var a=null,l=e.props.fileTagList,p=0;p<l.length;p++)if(l[p].repo_tag_id===r.id){a=l[p];break}c.I.deleteFileTag(n,a.id).then((function(){i=e.getRepoTagIdList(),e.props.onFileTagChanged()})).catch((function(e){var t=d.c.getErrorMsg(e);u.Z.danger(t)}))}},e}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.repoTag,n=e.highlightIndex,r=e.index,o=-1!=this.getRepoTagIdList().indexOf(t.id);return(0,p.jsxs)("li",{className:"tag-list-item cursor-pointer px-3 d-flex justify-content-between align-items-center ".concat(n===r?"hl":""),onClick:this.onEditFileTag,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,p.jsx)("div",{className:"tag-item d-flex align-items-center",style:{backgroundColor:t.color},children:(0,p.jsx)("span",{className:"tag-name",children:t.name})}),o&&(0,p.jsx)("i",{className:"sf2-icon-tick tag-selected-icon"})]})}}]),n}(a.Component),w=x,b=n(78655),S=(n(6251),function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).setHighlightIndex=function(e){o.setState({highlightIndex:e})},o.generateRandomColor=function(){return b.QQ[Math.floor(Math.random()*b.QQ.length)]},o.createNewTag=function(){var e=o.state.searchVal.trim();if(e){var t=o.generateRandomColor(),n=o.props.repoID;c.I.createRepoTag(n,e,t).then((function(e){var t=e.data.repo_tag;o.onRepoTagCreated(t),o.setState({searchVal:"",highlightIndex:-1})})).catch((function(e){var t=d.c.getErrorMsg(e);u.Z.danger(t)}))}},o.onRepoTagCreated=function(e){var t=o.props,n=t.repoID,r=t.filePath,i=e.repo_tag_id;c.I.addFileTag(n,r,i).then((function(){o.props.onFileTagChanged(),o.props.onNewRepoTagAdded&&o.props.onNewRepoTagAdded(e)})).catch((function(e){var t=d.c.getErrorMsg(e);u.Z.danger(t)}))},o.getRepoTagIdList=function(){return(o.props.fileTagList||[]).map((function(e){return e.repo_tag_id}))},o.onEditFileTag=function(e){var t=o.props,n=t.repoID,r=t.filePath,i=o.getRepoTagIdList();if(-1===i.indexOf(e.id))c.I.addFileTag(n,r,e.id).then((function(){i=o.getRepoTagIdList(),o.props.onFileTagChanged()})).catch((function(e){var t=d.c.getErrorMsg(e);u.Z.danger(t)}));else{for(var s=null,a=o.props.fileTagList,l=0;l<a.length;l++)if(a[l].repo_tag_id===e.id){s=a[l];break}c.I.deleteFileTag(n,s.id).then((function(){i=o.getRepoTagIdList(),o.props.onFileTagChanged()})).catch((function(e){var t=d.c.getErrorMsg(e);u.Z.danger(t)}))}},o.onKeyDown=function(e){var t=o.props.repoTags;if(e.keyCode===b.mW.ChineseInputMethod||e.keyCode===b.mW.LeftArrow||e.keyCode===b.mW.RightArrow)e.stopPropagation();else if(e.keyCode===b.mW.Enter){var n=o.state.searchVal.trim(),r=t.filter((function(e){return e.name.includes(n)}))[o.state.highlightIndex];r&&o.onEditFileTag(r)}else if(e.keyCode===b.mW.UpArrow)o.state.highlightIndex>-1&&o.setHighlightIndex(o.state.highlightIndex-1);else if(e.keyCode===b.mW.DownArrow){var i=o.state.searchVal.trim(),s=t.filter((function(e){return e.name.includes(i)}));o.state.highlightIndex<s.length&&o.setHighlightIndex(o.state.highlightIndex+1)}},o.onChangeSearch=function(e){o.setState({searchVal:e}),o.setHighlightIndex(-1)},o.state={searchVal:"",highlightIndex:-1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.state.searchVal.trim(),n=this.props.repoTags,r=n.filter((function(e){return e.name.includes(t)})),o=t&&!n.find((function(e){return e.name===t})),i="";return t?0==r.length&&(i=(0,l.ih)("Tag not found")):0==n.length&&(i=(0,l.ih)("No tags")),(0,p.jsxs)(y.Z,{popoverClassName:"edit-filetag-popover",target:this.props.target,hideSeahubPopover:this.props.toggleCancel,hideSeahubPopoverWithEsc:this.props.toggleCancel,canHideSeahubPopover:!0,children:[(0,p.jsx)(v,{className:"edit-filetag-popover-input",placeholder:(0,l.ih)("Find a tag"),onKeyDown:this.onKeyDown,onChange:this.onChangeSearch,autoFocus:!0}),i?(0,p.jsx)("div",{className:"tag-not-found my-4 mx-1",children:i}):(0,p.jsx)("ul",{className:"tag-list-container",children:r.map((function(t,n){return(0,p.jsx)(w,{index:n,highlightIndex:e.state.highlightIndex,setHighlightIndex:e.setHighlightIndex,repoTag:t,repoID:e.props.repoID,filePath:e.props.filePath,fileTagList:e.props.fileTagList,onFileTagChanged:e.props.onFileTagChanged},t.id)}))}),o&&(0,p.jsx)(h,{callBack:this.createNewTag,footerName:"".concat((0,l.ih)("Create a new tag")," '").concat(t,"'")})]})}}]),n}(a.Component))},18718:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(61805),c=n(83854),d=n(1303),u=n(46417),p=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onClick=function(e){o.inputRef.current.contains(e.target)||o.onRenameConfirm()},o.onChange=function(e){o.setState({name:e.target.value})},o.onKeyDown=function(e){e.keyCode===c.c.keyCodes.enter?o.onRenameConfirm(e):e.keyCode===c.c.keyCodes.esc&&o.onRenameCancel(e),e.nativeEvent.stopImmediatePropagation()},o.onRenameConfirm=function(e){e&&e.nativeEvent.stopImmediatePropagation();var t=o.state.name.trim();if(t!==o.props.name){var n=o.validateInput(),r=n.isValid,i=n.errMessage;r?o.props.onRenameConfirm(t):(d.Z.danger(i),o.props.onRenameCancel())}else o.props.onRenameCancel()},o.onRenameCancel=function(e){e.nativeEvent.stopImmediatePropagation(),o.props.onRenameCancel()},o.validateInput=function(){var e=o.state.name.trim(),t=!0,n="";return e?e.indexOf("/")>-1?{isValid:t=!1,errMessage:n=(0,l.ih)("Name should not include '/'.")}:{isValid:t,errMessage:n}:{isValid:t=!1,errMessage:n=(0,l.ih)("Name is required.")}},o.state={name:e.name},o.inputRef=a.createRef(),o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;if(this.inputRef.current.focus(),this.props.hasSuffix){var t=this.props.name.lastIndexOf(".");this.inputRef.current.setSelectionRange(0,t,"forward")}else this.inputRef.current.setSelectionRange(0,-1);setTimeout((function(){document.addEventListener("click",e.onClick)}),1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onClick)}},{key:"render",value:function(){return(0,u.jsx)("div",{className:"rename-container",children:(0,u.jsx)("input",{ref:this.inputRef,value:this.state.name,onChange:this.onChange,onKeyDown:this.onKeyDown})})}}]),n}(a.Component);t.Z=p},70155:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(68164),c=n(42995),d=n(12756),u=n(12213),p=n(7764),h=n(21303),f=n(70816),m=n.n(f),g=n(61805),v=n(4514),y=n(83854),x=n(1303),w=n(46417),b=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onFileTagChanged=function(e){var t=e.parent_path,n={name:e.filename},r="/"===t?t+e.filename:t+"/"+e.filename;o.props.onFileTagChanged(n,r)},o.onDeleteTaggedFile=function(e){var t=o.props.repoID,n=e.file_tag_id;v.I.deleteFileTag(t,n).then((function(t){o.getTaggedFiles(),o.props.updateUsedRepoTags(),o.props.onFileTagChanged&&!e.file_deleted&&o.onFileTagChanged(e)})).catch((function(e){var t=y.c.getErrorMsg(e);x.Z.danger(t)}))},o.getTaggedFiles=function(){var e=o.props,t=e.repoID,n=e.currentTag,r=e.shareLinkToken;(r?v.I.getShareLinkTaggedFiles(r,n.id):v.I.listTaggedFiles(t,n.id)).then((function(e){var t=[];void 0!==e.data.tagged_files&&e.data.tagged_files.forEach((function(e){var n=e;t.push(n)})),o.setState({taggedFileList:t})})).catch((function(e){var t=y.c.getErrorMsg(e);x.Z.danger(t)}))},o.state={taggedFileList:[]},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.getTaggedFiles()}},{key:"render",value:function(){var e=this,t=this.state.taggedFileList;return(0,w.jsxs)(c.Z,{isOpen:!0,style:{maxWidth:"678px"},children:[(0,w.jsx)(d.Z,{toggle:this.props.onClose,children:(0,g.ih)("Tagged Files")}),(0,w.jsx)(u.Z,{className:"dialog-list-container",children:(0,w.jsxs)("table",{children:[(0,w.jsx)("thead",{children:(0,w.jsxs)("tr",{children:[(0,w.jsx)("th",{width:"50%",className:"ellipsis",children:(0,g.ih)("Name")}),(0,w.jsx)("th",{width:"20%",children:(0,g.ih)("Size")}),(0,w.jsx)("th",{width:"22%",children:(0,g.ih)("Last Update")}),(0,w.jsx)("th",{width:"8%"})]})}),(0,w.jsx)("tbody",{children:t.map((function(t,n){return(0,w.jsx)(S,{repoID:e.props.repoID,taggedFile:t,onDeleteTaggedFile:e.onDeleteTaggedFile,shareLinkToken:e.props.shareLinkToken,enableFileDownload:e.props.enableFileDownload},n)}))})]})}),(0,w.jsx)(p.Z,{children:(0,w.jsx)(h.Z,{color:"secondary",onClick:this.props.toggleCancel,children:(0,g.ih)("Close")})})]})}}]),n}(a.Component),S=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.setState({active:!0})},o.onMouseLeave=function(){o.setState({active:!1})},o.deleteFile=function(e){e.preventDefault(),o.props.onDeleteTaggedFile(o.props.taggedFile)},o.state={active:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.taggedFile,n=e.shareLinkToken,r=e.enableFileDownload,o=t.parent_path?y.c.joinPath(t.parent_path,t.filename):"",i=n?g.ze+"d/"+n+"/files/?p="+y.c.encodePath(o):g.ze+"lib/"+this.props.repoID+"/file"+y.c.encodePath(o);return(0,w.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[t.file_deleted?(0,w.jsx)(a.Fragment,{children:(0,w.jsxs)("td",{colSpan:"3",className:"name",children:[t.filename," ",(0,w.jsx)("span",{style:{color:"red"},children:(0,g.ih)("deleted")})]})}):(0,w.jsxs)(a.Fragment,{children:[(0,w.jsx)("td",{children:(0,w.jsx)("a",{href:i,target:"_blank",className:"d-inline-block w-100 ellipsis",title:t.filename,rel:"noreferrer",children:t.filename})}),(0,w.jsx)("td",{children:y.c.bytesToSize(t.size)}),(0,w.jsx)("td",{children:m().unix(t.mtime).fromNow()})]}),(0,w.jsxs)("td",{children:[!n&&(0,w.jsx)("a",{href:"#",role:"button","aria-label":(0,g.ih)("Delete"),title:(0,g.ih)("Delete"),className:"action-icon sf2-icon-x3".concat(this.state.active?"":" invisible"),onClick:this.deleteFile}),n&&r&&(0,w.jsx)("a",{className:"action-icon sf2-icon-download".concat(this.state.active?"":" invisible"),href:"".concat(i,"&dl=1"),title:(0,g.ih)("Download"),"aria-label":(0,g.ih)("Download")})]})]})}}]),n}(a.Component),C=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).onListTaggedFiles=function(e){o.setState({currentTag:e,isListTaggedFileShow:!o.state.isListTaggedFileShow})},o.onCloseDialog=function(){o.setState({isListTaggedFileShow:!1})},o.state={currentTag:null,isListTaggedFileShow:!1},o}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.repoID,r=t.usedRepoTags,o=t.className;return(0,w.jsxs)("div",{className:"repo-info-bar ".concat(o||""),children:[r.length>0&&(0,w.jsx)("ul",{className:"used-tag-list",children:r.map((function(t){return(0,w.jsxs)("li",{className:"used-tag-item",children:[(0,w.jsx)("span",{className:"used-tag",style:{backgroundColor:t.color}}),(0,w.jsx)("span",{className:"used-tag-name",title:t.name,children:t.name}),(0,w.jsx)("button",{type:"button",className:"used-tag-files border-0 bg-transparent",onClick:e.onListTaggedFiles.bind(e,t),children:t.fileCount>1?t.fileCount+" files":t.fileCount+" file"})]},t.id)}))}),this.state.isListTaggedFileShow&&(0,w.jsx)(l.Z,{children:(0,w.jsx)(b,{repoID:n,currentTag:this.state.currentTag,onClose:this.onCloseDialog,toggleCancel:this.onListTaggedFiles,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged,shareLinkToken:this.props.shareLinkToken,enableFileDownload:this.props.enableFileDownload})})]})}}]),n}(a.Component)},88376:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var r=n(1413),o=n(15671),i=n(43144),s=n(60136),a=n(29388),l=n(47313),c=n(95423),d=n(72970),u=n(98624),p=n(61805),h=n(83854),f=n(51282),m=n(46417),g=function(e){(0,s.Z)(n,e);var t=(0,a.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).onLinkClick=function(e){i.props.onLinkClick(e)},i.changeInlineNode=function(e){var t,n,r=i.props.repoID;if("image"==e.type){if(t=e.data.src,new RegExp(p.xx+"/lib/"+r+"/file.*raw=1").test(t)){var o=t.indexOf("/file"),s=t.indexOf("?");n=t.substring(o+5,s)}else{if(!/^\.\.\/*/.test(t)&&!/^\.\/*/.test(t))return;var a=i.props.path,l=a.slice(0,a.lastIndexOf("/"))+"/"+t;n=h.c.pathNormalize(l)}e.data.src=p.xx+"/view-image-via-public-wiki/?slug="+p.oF+"&path="+n}else if("link"==e.type)if(t=e.url,h.c.isInternalFileLink(t,r))if(h.c.isInternalMarkdownLink(t,r)){var c=h.c.getPathFromInternalMarkdownLink(t,r);e.url=p.xx+"/published/"+p.oF+c}else e.url=t.replace(/(.*)lib\/([-0-9a-f]{36})\/file(.*)/g,(function(e,t,n,r){return"".concat(t,"d/").concat(p.lI,"/files/?p=").concat(r,"&dl=1")}));else if(h.c.isInternalDirLink(t,r)){var d=h.c.getPathFromInternalDirLink(t,r);e.url=p.xx+"/published/"+p.oF+d}return e},i.modifyValueBeforeRender=function(e){return h.c.changeMarkdownNodes(e,i.changeInlineNode)},i.renderMarkdown=function(){var e=i.props,t=e.isTOCShow,n=void 0===t||t,o=e.isWiki,s=e.markdownContent,a=(0,r.Z)({isShowOutline:n,mathJaxSource:"".concat(p.si,"js/mathjax/tex-svg.js"),value:s,scrollRef:i.scrollRef,onLinkClick:i.onLinkClick},o&&{beforeRenderCallback:i.modifyValueBeforeRender});return(0,m.jsx)(d.I18nextProvider,{i18n:u.Z,children:(0,m.jsx)(l.Suspense,{fallback:(0,m.jsx)(f.Z,{}),children:(0,m.jsx)(c.MarkdownViewer,(0,r.Z)({},a))})})},i.scrollRef=l.createRef(),i}return(0,i.Z)(n,[{key:"render",value:function(){if(this.props.isFileLoading)return(0,m.jsx)(f.Z,{});var e=this.props,t=e.isWiki,n=e.containerClassName,r="wiki-page-container ".concat(void 0===n?"":n),o="wiki-page-content ".concat(t?"":"w-100");return(0,m.jsx)("div",{ref:this.scrollRef,className:r,children:(0,m.jsxs)("div",{className:o,children:[this.props.children,this.renderMarkdown(),(0,m.jsxs)("p",{id:"wiki-page-last-modified",children:[(0,p.ih)("Last modified by")," ",this.props.latestContributor,", ",(0,m.jsx)("span",{children:this.props.lastModified})]})]})})}}]),n}(l.Component);g.defaultProps={isWiki:!1};var v=g},77275:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(93564),c=n(97326),d=n(3885),u=n(61805),p=n(4514),h=n(83854),f=n(19778),m=n(1303),g=n(9368),v=n(46417),y=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).shExtend=function(){o.setState({sharedExtended:!o.state.sharedExtended})},o.loadGroups=function(){var e=(0,c.Z)(o);p.I.listGroups().then((function(t){var n=t.data.map((function(e){return new f.Z(e)}));o.filesNavHeight=28*(n.length+(u.Wz?1:0)+(u.cA?1:0)+(u.ei?1:0)+1),e.setState({groupItems:n.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1}))})})).catch((function(e){var t=h.c.getErrorMsg(e);m.Z.danger(t)}))},o.tabItemClick=function(e,t,n){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress){if(!window.confirm((0,u.ih)("A file is being uploaded. Are you sure you want to leave this page?")))return e.preventDefault(),!1;window.uploader.isUploadProgressDialogShow=!1}o.props.tabItemClick(t,n)},o.getActiveClass=function(e){return o.props.currentTab===e?"active":""},o.onCreateGroup=function(e){var t=new f.Z(e),n=o.state.groupItems;n.push(t),o.filesNavHeight+=28,o.setState({groupItems:n})},o.toggleCreateGroupDialog=function(){o.setState({isCreateGroupDialogOpen:!o.state.isCreateGroupDialogOpen})},o.toggleFilesNav=function(e){e.preventDefault(),e.stopPropagation(),o.setState({filesNavUnfolded:!o.state.filesNavUnfolded},(function(){o.state.filesNavUnfolded&&o.loadGroups()}))},o.state={filesNavUnfolded:!1,sharedExtended:!1,closeSideBar:!1,groupItems:[],isCreateGroupDialogOpen:!1},o.adminHeight=0,o.filesNavHeight=0,o}return(0,o.Z)(n,[{key:"renderSharedGroups",value:function(){var e=this;return(0,v.jsxs)(v.Fragment,{children:[this.state.groupItems.map((function(t){return(0,v.jsx)("li",{className:"nav-item ".concat(e.getActiveClass(t.name)),children:(0,v.jsxs)(d.rU,{to:u.ze+"group/"+t.id+"/",className:"nav-link ellipsis ".concat(e.getActiveClass(t.name)),onClick:function(n){return e.tabItemClick(n,t.name,t.id)},children:[(0,v.jsx)("span",{className:"".concat(0==t.parent_group_id?"sf3-font-group":"sf3-font-department"," sf3-font nav-icon"),"aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:t.name})]})},t.id)})),u.Wz&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("li",{className:"nav-item",onClick:this.toggleCreateGroupDialog,children:(0,v.jsxs)("span",{className:"nav-link",role:"button",children:[(0,v.jsx)("i",{className:"sf2-icon-plus nav-icon","aria-hidden":"true"}),(0,u.ih)("New Group")]})}),this.state.isCreateGroupDialogOpen&&(0,v.jsx)(g.Z,{toggleDialog:this.toggleCreateGroupDialog,onCreateGroup:this.onCreateGroup})]})]})}},{key:"renderSharedAdmin",value:function(){var e=this,t=0;this.state.sharedExtended&&(this.adminHeight||(this.adminHeight=84),t=this.adminHeight);var n={height:t,opacity:0===t?0:1},r=null;return u.Fl?r=(0,v.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-share-links")),children:(0,v.jsxs)(d.rU,{to:u.ze+"share-admin-share-links/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-share-links")),title:(0,u.ih)("Links"),onClick:function(t){return e.tabItemClick(t,"share-admin-share-links")},children:[(0,v.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Links")})]})}):u.$g&&(r=(0,v.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-upload-links")),children:(0,v.jsxs)(d.rU,{to:u.ze+"share-admin-upload-links/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-upload-links")),title:(0,u.ih)("Links"),onClick:function(t){return e.tabItemClick(t,"share-admin-upload-links")},children:[(0,v.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Links")})]})})),(0,v.jsxs)("ul",{id:"share-admin-sub-nav",className:"nav sub-nav nav-pills flex-column ".concat(this.state.sharedExtended?"side-panel-slide-share-admin":"side-panel-slide-up-share-admin"),style:n,children:[u.cA&&u.Ki&&(0,v.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-libs")),children:(0,v.jsxs)(d.rU,{to:u.ze+"share-admin-libs/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-libs")),title:(0,u.ih)("Libraries"),onClick:function(t){return e.tabItemClick(t,"share-admin-libs")},children:[(0,v.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Libraries")})]})}),u.Ki&&(0,v.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-folders")),children:(0,v.jsxs)(d.rU,{to:u.ze+"share-admin-folders/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-folders")),title:(0,u.ih)("Folders"),onClick:function(t){return e.tabItemClick(t,"share-admin-folders")},children:[(0,v.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Folders")})]})}),r]})}},{key:"renderCustomNavItems",value:function(){return u.Po.map((function(e,t){return(0,v.jsx)("li",{className:"nav-item",children:(0,v.jsxs)("a",{href:e.link,className:"nav-link ellipsis",title:e.desc,children:[(0,v.jsx)("span",{className:e.icon,"aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:e.desc})]})},t)}))}},{key:"render",value:function(){var e=this,t=u.NT||u._y||!u.m_,n=this.state.filesNavUnfolded;return(0,v.jsx)("div",{className:"side-nav",children:(0,v.jsxs)("div",{className:"side-nav-con",children:[(0,v.jsx)("h2",{className:"mb-2 px-2 font-weight-normal heading",children:(0,u.ih)("Workspace")}),(0,v.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[(0,v.jsxs)("li",{id:"files",className:"nav-item flex-column ".concat(this.getActiveClass("libraries")),children:[(0,v.jsxs)(d.rU,{to:u.ze+"libraries/",className:"nav-link ellipsis ".concat(this.getActiveClass("libraries")),title:(0,u.ih)("Files"),onClick:function(t){return e.tabItemClick(t,"libraries")},children:[(0,v.jsx)("span",{className:"sf3-font-files sf3-font","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Files")}),(0,v.jsx)("span",{className:"toggle-icon sf3-font sf3-font-down ".concat(n?"":"rotate-90"),"aria-hidden":"true",onClick:this.toggleFilesNav})]}),(0,v.jsxs)("ul",{id:"files-sub-nav",className:"nav sub-nav nav-pills flex-column ".concat(n?"side-panel-slide":"side-panel-slide-up"),style:{height:n?this.filesNavHeight:0,opacity:n?1:0},children:[u.cA&&(0,v.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("my-libs")||this.getActiveClass("deleted")),children:(0,v.jsxs)(d.rU,{to:u.ze+"my-libs/",className:"nav-link ellipsis ".concat(this.getActiveClass("my-libs")||this.getActiveClass("deleted")),title:(0,u.ih)("My Libraries"),onClick:function(t){return e.tabItemClick(t,"my-libs")},children:[(0,v.jsx)("span",{className:"sf3-font-mine sf3-font nav-icon","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("My Libraries")})]})}),(0,v.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("shared-libs")),children:(0,v.jsxs)(d.rU,{to:u.ze+"shared-libs/",className:"nav-link ellipsis ".concat(this.getActiveClass("shared-libs")),title:(0,u.ih)("Shared with me"),onClick:function(t){return e.tabItemClick(t,"shared-libs")},children:[(0,v.jsx)("span",{className:"sf3-font-share-with-me sf3-font nav-icon","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Shared with me")})]})}),u.ei&&(0,v.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("org")),onClick:function(t){return e.tabItemClick(t,"org")},children:(0,v.jsxs)(d.rU,{to:u.ze+"org/",className:"nav-link ellipsis ".concat(this.getActiveClass("org")),title:(0,u.ih)("Shared with all"),children:[(0,v.jsx)("span",{className:"sf3-font-share-with-all sf3-font nav-icon","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Shared with all")})]})}),this.renderSharedGroups()]})]}),(0,v.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("starred")),children:(0,v.jsxs)(d.rU,{className:"nav-link ellipsis ".concat(this.getActiveClass("starred")),to:u.ze+"starred/",title:(0,u.ih)("Favorites"),onClick:function(t){return e.tabItemClick(t,"starred")},children:[(0,v.jsx)("span",{className:"sf3-font-starred sf3-font","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Favorites")})]})}),t&&(0,v.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("dashboard")),children:(0,v.jsxs)(d.rU,{className:"nav-link ellipsis ".concat(this.getActiveClass("dashboard")),to:u.ze+"dashboard/",title:(0,u.ih)("Activities"),onClick:function(t){return e.tabItemClick(t,"dashboard")},children:[(0,v.jsx)("span",{className:"sf3-font-activities sf3-font","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Activities")})]})}),(0,v.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("published")),children:(0,v.jsxs)(d.rU,{className:"nav-link ellipsis ".concat(this.getActiveClass("published")),to:u.ze+"published/",title:(0,u.ih)("Wikis"),onClick:function(t){return e.tabItemClick(t,"published")},children:[(0,v.jsx)("span",{className:"sf3-font-wiki sf3-font","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Wikis")})]})}),u.ki&&(0,v.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("invitations")),children:(0,v.jsxs)(d.rU,{className:"nav-link ellipsis ".concat(this.getActiveClass("invitations")),to:u.ze+"invitations/",title:(0,u.ih)("Invite Guest"),onClick:function(t){return e.tabItemClick(t,"invitations")},children:[(0,v.jsx)("span",{className:"sf3-font-invite-visitors sf3-font","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Invite Guest")})]})}),(0,v.jsxs)("li",{id:"share-admin-nav",className:"nav-item flex-column",children:[(0,v.jsxs)("a",{className:"nav-link ellipsis",title:(0,u.ih)("Share Admin"),onClick:this.shExtend,children:[(0,v.jsx)("span",{className:"sf3-font-wrench sf3-font","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Share Admin")}),(0,v.jsx)("span",{className:"toggle-icon sf3-font sf3-font-down ".concat(this.state.sharedExtended?"":"rotate-90"),"aria-hidden":"true"})]}),this.renderSharedAdmin()]}),u.Po&&this.renderCustomNavItems()]}),(0,v.jsx)("h2",{className:"mb-2 pt-1 px-2 font-weight-normal heading",children:(0,u.ih)("Help and resources")}),u.Gl?(0,v.jsx)("div",{className:"side-nav-footer",dangerouslySetInnerHTML:{__html:u.Gl}}):(0,v.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[(0,v.jsx)("li",{className:"nav-item",children:(0,v.jsxs)("a",{className:"nav-link",href:u.ze+"help/",title:(0,u.ih)("Help"),children:[(0,v.jsx)("span",{className:"sf3-font-help sf3-font","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Help")})]})}),u.nD&&(0,v.jsx)("li",{className:"nav-item",children:(0,v.jsxs)("a",{href:"".concat(u.ze,"terms/"),className:"nav-link",children:[(0,v.jsx)("span",{className:"sf3-font-terms sf3-font","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Terms")})]})}),u.ol&&(0,v.jsx)(v.Fragment,{children:Object.keys(u.ol).map((function(e,t){return(0,v.jsxs)("a",{className:"nav-link",href:u.ol[e],children:[(0,v.jsx)("span",{className:"sf3-font-terms sf3-font","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:e})]})}))}),(0,v.jsx)("li",{className:"nav-item",children:(0,v.jsxs)("a",{href:u.ze+"download_client_program/",className:"nav-link",children:[(0,v.jsx)("span",{className:"sf3-font-devices sf3-font","aria-hidden":"true"}),(0,v.jsx)("span",{className:"nav-text",children:(0,u.ih)("Clients")})]})})]})]})})}}]),n}(a.Component),x=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props.children;return(0,v.jsxs)("div",{className:"side-panel ".concat(this.props.isSidePanelClosed?"":"left-zero"),children:[(0,v.jsx)("div",{className:"side-panel-north",children:(0,v.jsx)(l.Z,{onCloseSidePanel:this.props.onCloseSidePanel})}),(0,v.jsx)("div",{className:"side-panel-center",children:e||(0,v.jsx)(y,{tabItemClick:this.props.tabItemClick,currentTab:this.props.currentTab})})]})}}]),n}(a.Component),w=x},86358:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(1781),c=n(46417),d=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.onShowSidePanel,n=e.onSearchedClick,r=e.children,o=e.showSearch;return(0,c.jsxs)("div",{className:"main-panel-north ".concat(r?"border-left-show":""),children:[(0,c.jsxs)("div",{className:"cur-view-toolbar",children:[(0,c.jsx)("span",{title:"Side Nav Menu",onClick:t,className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none"}),this.props.children]}),(0,c.jsx)(l.Z,{showSearch:o,searchPlaceholder:this.props.searchPlaceholder,onSearchedClick:n})]})}}]),n}(a.Component);t.Z=d},20512:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),l=n(39131),c=n(61805),d=n(90299),u=n(83854),p=n(46417),h=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.props.isItemFreezed||o.setState({isShowOperationMenu:!0,isHighlight:!0})},o.onMouseOver=function(){o.props.isItemFreezed||o.setState({isShowOperationMenu:!0,isHighlight:!0})},o.onMouseLeave=function(){o.props.isItemFreezed||o.setState({isShowOperationMenu:!1,isHighlight:!1})},o.onNodeClick=function(){var e=o.props.node.object;if(e.isDir())o.props.onNodeClick(o.props.node);else{var t=u.c.getUserPermission(e.permission),n=t.isCustomPermission,r=t.customPermission;if(n){var i=r.permission,s=i.preview,a=i.modify;if(!s&&!a)return}o.props.onNodeClick(o.props.node)}},o.onLoadToggle=function(e){e.stopPropagation();var t=o.props.node;t.isExpanded?o.props.onNodeCollapse(t):o.props.onNodeExpanded(t)},o.onNodeDragStart=function(e){if(u.c.isIEBrower()||!o.canDrag)return!1;o.props.onNodeDragStart(e,o.props.node)},o.onNodeDragEnter=function(e){if(u.c.isIEBrower()||!o.canDrag)return!1;"dir"===o.props.node.object.type&&o.setState({isNodeDropShow:!0}),o.props.onNodeDragEnter(e,o.props.node)},o.onNodeDragMove=function(e){if(u.c.isIEBrower()||!o.canDrag)return!1;o.props.onNodeDragMove(e)},o.onNodeDragLeave=function(e){if(u.c.isIEBrower()||!o.canDrag)return!1;o.setState({isNodeDropShow:!1}),o.props.onNodeDragLeave(e,o.props.node)},o.onNodeDrop=function(e){if(u.c.isIEBrower()||!o.canDrag)return!1;e.stopPropagation(),o.setState({isNodeDropShow:!1}),o.props.onNodeDrop(e,o.props.node)},o.unfreezeItem=function(){o.setState({isShowOperationMenu:!1}),o.props.unfreezeItem()},o.onMenuItemClick=function(e,t,n){o.props.onMenuItemClick(e,n)},o.onItemMouseDown=function(e){e.stopPropagation(),e.button},o.onItemContextMenu=function(e){o.handleContextClick(e)},o.handleContextClick=function(e){o.props.handleContextClick(e,o.props.node),o.setState({isShowOperationMenu:!1})},o.getNodeTypeAndIcon=function(){var e=o.props.node,t="",n="";if("dir"===e.object.type)t=(0,p.jsx)("i",{className:"sf3-font sf3-font-folder"}),n="dir";else{var r=e.object.name.lastIndexOf(".");if(-1===r)t=(0,p.jsx)("i",{className:"sf3-font sf3-font-file"}),n="file";else{var i=e.object.name.slice(r).toLowerCase();".png"===i||".jpg"===i||".jpeg"===i||".gif"===i||".bmp"===i?(t=(0,p.jsx)("i",{className:"sf3-font sf3-font-image"}),n="image"):".md"===i||".markdown"===i?(t=(0,p.jsx)("i",{className:"sf3-font sf3-font-files2"}),n="file"):(t=(0,p.jsx)("i",{className:"sf3-font sf3-font-file"}),n="file")}}return{icon:t,type:n}},o.calculateMenuList=function(e){var t=l.Z.NEW_FOLDER,n=l.Z.NEW_FILE,r=l.Z.COPY,i=l.Z.MOVE,s=l.Z.RENAME,a=l.Z.DELETE,c=l.Z.OPEN_VIA_CLIENT,d=[s,a,r,i,c];"dir"===e.object.type&&(d=[t,n,r,i,s,a]);var p=o.props.userPerm,h=u.c.getUserPermission(p),f=h.isCustomPermission,m=h.customPermission;if(!f)return d;d=[];var g=m.permission,v=g.create,y=g.modify,x=g.delete,w=g.copy;return"dir"===e.object.type&&v&&d.push(t,n),w&&d.push(r),y&&d.push(i,s),x&&d.push(a),"dir"!==e.object.type&&d.push(c),d},o.renderChildren=function(){var e=o.props.node;return e.hasChildren()?(0,p.jsx)("div",{className:"children",children:e.children.map((function(e){return(0,p.jsx)(n,{node:e,leftIndent:o.props.leftIndent+20,userPerm:o.props.userPerm,currentPath:o.props.currentPath,isNodeMenuShow:o.props.isNodeMenuShow,isItemFreezed:o.props.isItemFreezed,onNodeClick:o.props.onNodeClick,onNodeCollapse:o.props.onNodeCollapse,onNodeExpanded:o.props.onNodeExpanded,freezeItem:o.props.freezeItem,onMenuItemClick:o.props.onMenuItemClick,unfreezeItem:o.unfreezeItem,onNodeDragStart:o.props.onNodeDragStart,onNodeDragMove:o.props.onNodeDragMove,onNodeDrop:o.props.onNodeDrop,onNodeDragEnter:o.props.onNodeDragEnter,onNodeDragLeave:o.props.onNodeDragLeave,handleContextClick:o.props.handleContextClick},e.path)}))}):""},o.state={isHighlight:!1,isShowOperationMenu:!1,isNodeDropShow:!1};var i=e.userPerm;o.canDrag="rw"===i;var s=u.c.getUserPermission(i),a=s.isCustomPermission,c=s.customPermission;if(a){var d=c.permission.modify;o.canDrag=d}return o}return(0,o.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.isItemFreezed||this.setState({isShowOperationMenu:!1,isHighlight:!1})}},{key:"render",value:function(){var e=this.props,t=e.currentPath,n=e.node,r=e.isNodeMenuShow,o=e.userPerm,i=e.leftIndent,s=this.getNodeTypeAndIcon(),a=s.type,l=s.icon,h=this.state.isHighlight?"tree-node-inner-hover ":"";n.path===t&&(h="tree-node-hight-light");var f=u.c.getUserPermission(o).isCustomPermission;return(0,p.jsxs)("div",{className:"tree-node",children:[(0,p.jsxs)("div",{type:a,className:"tree-node-inner text-nowrap ".concat(h," ").concat("/"===n.path?"hide":""," ").concat(this.state.isNodeDropShow?"tree-node-drop":""),title:n.object.name,onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu,onClick:this.onNodeClick,children:[(0,p.jsx)("div",{className:"tree-node-text",draggable:this.canDrag,onDragStart:this.onNodeDragStart,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onDragOver:this.onNodeDragMove,onDrop:this.onNodeDrop,style:{paddingLeft:i+5},children:n.object.name}),(0,p.jsxs)("div",{className:"left-icon",style:{left:i-40},children:["dir"===a&&(!n.isLoaded||n.isLoaded&&n.hasChildren())&&(0,p.jsx)("i",{className:"folder-toggle-icon sf3-font sf3-font-down ".concat(n.isExpanded?"":"rotate-270"),onMouseDown:function(e){return e.stopPropagation()},onClick:this.onLoadToggle}),(0,p.jsx)("i",{className:"tree-node-icon",children:l})]}),r&&(0,p.jsx)("div",{className:"right-icon",children:("rw"===o||c.rd||f)&&this.state.isShowOperationMenu&&(0,p.jsx)(d.Z,{item:this.props.node,toggleClass:"sf3-font sf3-font-more-vertical",getMenuList:this.calculateMenuList,onMenuItemClick:this.onMenuItemClick,freezeItem:this.props.freezeItem,unfreezeItem:this.unfreezeItem})})]}),n.isExpanded&&this.renderChildren()]})}}]),n}(a.Component),f=n(92161),m=n(30426),g=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;(0,r.Z)(this,n),(o=t.call(this,e)).onItemMove=function(e,t,n,r){o.props.onItemMove(e,t,n,r)},o.onNodeDragStart=function(e,t){if(u.c.isIEBrower())return!1;var n={nodeDirent:t.object,nodeParentPath:t.parentNode.path,nodeRootPath:t.path};n=JSON.stringify(n),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("applicaiton/drag-item-info",n)},o.onNodeDragEnter=function(e,t){if(u.c.isIEBrower()||!o.canDrop)return!1;e.persist(),"tree-view tree "===e.target.className&&o.setState({isTreeViewDropTipShow:!0})},o.onNodeDragMove=function(e){if(u.c.isIEBrower()||!o.canDrop)return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},o.onNodeDragLeave=function(e,t){if(u.c.isIEBrower()||!o.canDrop)return!1;"tree-view tree tree-view-drop"===e.target.className&&o.setState({isTreeViewDropTipShow:!1})},o.onContainerClick=function(e){(0,m.SC)()},o.onNodeClick=function(e){(0,m.SC)(),o.props.onNodeClick(e)},o.onNodeDrop=function(e,t){if(u.c.isIEBrower()||!o.canDrop)return!1;if(!e.dataTransfer.files.length){var n=e.dataTransfer.getData("applicaiton/drag-item-info"),r=n=JSON.parse(n),i=r.nodeDirent,s=r.nodeParentPath,a=r.nodeRootPath,l=t;if(Array.isArray(n))return l?void o.onMoveItems(n,l,o.props.currentRepoInfo,l.path):("/"===n[0].nodeParentPath||o.props.onItemsMove(o.props.currentRepoInfo,"/"),void o.setState({isTreeViewDropTipShow:!1}));if(!l)return"/"===s||o.onItemMove(o.props.currentRepoInfo,i,"/",s),void o.setState({isTreeViewDropTipShow:!1});if("dir"===l.object.type&&s!==l.path&&(s!==l.parentNode.path||l.object.name!==i.name)){if("dir"===l.object.type&&"dir"===i.type)if(l.parentNode.path!==s)if(u.c.getPaths(l.path).includes(a))return;o.onItemMove(o.props.currentRepoInfo,i,l.path,s)}}},o.onMoveItems=function(e,t,n,r){var i=[],s=u.c.getPaths(r);(e.forEach((function(e){var t=e.nodeRootPath;i.push(t)})),"dir"===t.object.type)&&(i.some((function(e){return e===r}))||e[0].nodeParentPath&&e[0].nodeParentPath===t.path||i.some((function(e){return s.includes(e)}))||o.props.onItemsMove(n,r))},o.freezeItem=function(){o.setState({isItemFreezed:!0})},o.unfreezeItem=function(){o.setState({isItemFreezed:!1})},o.onMenuItemClick=function(e,t){o.props.onMenuItemClick(e,t),(0,m.SC)()},o.onMouseDown=function(e){e.stopPropagation(),e.button},o.onContextMenu=function(e){e.preventDefault();var t=o.props.currentRepoInfo;if("admin"!==t.permission&&"rw"!==t.permission)return"";o.handleContextClick(e)},o.handleContextClick=function(e,t){if(e.preventDefault(),e.stopPropagation(),o.props.isNodeMenuShow){var n=e.clientX||e.touches&&e.touches[0].pageX,r=e.clientY||e.touches&&e.touches[0].pageY;o.props.posX&&(n-=o.props.posX),o.props.posY&&(r-=o.props.posY),(0,m.SC)();var i=o.getMenuList(t),s={id:"tree-node-contextmenu",position:{x:n,y:r},target:e.target,currentObject:t,menuList:i};(0,m.AE)(s)}},o.getMenuList=function(e){var t=[],n=l.Z.NEW_FOLDER,r=l.Z.NEW_FILE,i=l.Z.COPY,s=l.Z.MOVE,a=l.Z.RENAME,c=l.Z.DELETE,d=l.Z.OPEN_VIA_CLIENT;if(!e)return[n,r];t="dir"===e.object.type?[n,r,i,s,a,c]:[a,c,i,s,d];var p=o.props.userPerm,h=u.c.getUserPermission(p),f=h.isCustomPermission,m=h.customPermission;if(!f)return t;t=[];var g=m.permission,v=g.create,y=g.modify,x=g.delete,w=g.copy;return e?("dir"===e.object.type&&v&&t.push(n,r),w&&t.push(i),y&&t.push(s,a),x&&t.push(c),"dir"!==e.object.type&&t.push(d),t):(v&&t.push(n,r),t)},o.onShowMenu=function(){o.freezeItem()},o.onHideMenu=function(){o.unfreezeItem()},o.state={isItemFreezed:!1,isTreeViewDropTipShow:!1};var i=e.userPerm;o.canDrop="rw"===i;var s=u.c.getUserPermission(i),a=s.isCustomPermission,c=s.customPermission;if(a){var d=c.permission.modify;o.canDrop=d}return o}return(0,o.Z)(n,[{key:"render",value:function(){return(0,p.jsxs)("div",{className:"tree-view tree ".concat(this.state.isTreeViewDropTipShow&&this.canDrop?"tree-view-drop":""),onDrop:this.onNodeDrop,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onMouseDown:this.onMouseDown,onContextMenu:this.onContextMenu,onClick:this.onContainerClick,children:[(0,p.jsx)(h,{userPerm:this.props.userPerm,node:this.props.treeData.root,currentPath:this.props.currentPath,leftIndent:20,isNodeMenuShow:this.props.isNodeMenuShow,isItemFreezed:this.state.isItemFreezed,onNodeClick:this.onNodeClick,onMenuItemClick:this.props.onMenuItemClick,onNodeExpanded:this.props.onNodeExpanded,onNodeCollapse:this.props.onNodeCollapse,onNodeDragStart:this.onNodeDragStart,freezeItem:this.freezeItem,unfreezeItem:this.unfreezeItem,onNodeDragMove:this.onNodeDragMove,onNodeDrop:this.onNodeDrop,onNodeDragEnter:this.onNodeDragEnter,onNodeDragLeave:this.onNodeDragLeave,handleContextClick:this.handleContextClick}),(0,p.jsx)(f.Z,{id:"tree-node-contextmenu",onMenuItemClick:this.onMenuItemClick,onHideMenu:this.onHideMenu,onShowMenu:this.onShowMenu})]})}}]),n}(a.Component)},21128:function(e){e.exports={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,PauseBreak:19,CapsLock:20,Escape:27,Esc:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,LeftWindowKey:91,RightWindowKey:92,SelectKey:93,NumPad0:96,NumPad1:97,NumPad2:98,NumPad3:99,NumPad4:100,NumPad5:101,NumPad6:102,NumPad7:103,NumPad8:104,NumPad9:105,Multiply:106,Add:107,Subtract:109,DecimalPoint:110,Divide:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F12:123,NumLock:144,ScrollLock:145,SemiColon:186,EqualSign:187,Comma:188,Dash:189,Period:190,ForwardSlash:191,GraveAccent:192,OpenBracket:219,BackSlash:220,CloseBracket:221,SingleQuote:222,ChineseInputMethod:229}},19778:function(e,t,n){"use strict";var r=n(43144),o=n(15671),i=(0,r.Z)((function e(t){(0,o.Z)(this,e),this.id=t.id,this.name=t.name,this.owner=t.owner,this.admins=t.admins||[],this.avatar_url=t.avatar_url,this.created_at=t.created_at,this.parent_group_id=t.parent_group_id,this.wiki_enabled=t.wiki_enabled,this.repos=t.repos||[],this.group_quota=t.group_quota,this.group_quota_usage=t.group_quota_usage}));t.Z=i},60354:function(e,t,n){"use strict";var r=n(15671),o=n(43144),i=n(11621),s=n(35662),a=n(74521),l=n.n(a),c=n(61805),d=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,o=e.token;return this.server=t,this.username=n,this.password=r,this.token=o,this.token&&this.server&&(this.req=s.Z.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=s.Z.create({headers:{"X-CSRFToken":n}}),this}},{key:"_sendPostRequest",value:function(e,t){return t.getHeaders?this.req.post(e,t,{headers:t.getHeaders()}):this.req.post(e,t)}},{key:"listWikiDepartments",value:function(){var e=this.server+"/api/v2.1/departments/";return this.req.get(e,{params:{can_admin:!0}})}},{key:"listWikiDir",value:function(e,t,n){var r=encodeURIComponent(t),o=this.server+"/api/v2.1/wikis/"+e+"/dir/?p="+r;return n&&(o=this.server+"/api/v2.1/wikis/"+e+"/dir/?p="+r+"&with_parents="+n),this.req.get(o)}},{key:"getWikiFileContent",value:function(e,t){var n=encodeURIComponent(t),r=(new Date).getTime(),o=this.server+"/api/v2.1/wikis/"+e+"/content/?p="+n+"&_="+r;return this.req.get(o)}},{key:"listWikis",value:function(e){var t=this.server+"/api/v2.1/wikis/";return e?this.req.get(t,{params:e,paramsSerializer:{serialize:function(e){var t=[];for(var n in e)if(Array.isArray(e[n]))for(var r=0,o=e[n].length;r<o;r++)t.push(n+"="+encodeURIComponent(e[n][r]));else t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}}}):this.req.get(t)}},{key:"addWiki",value:function(e){var t=this.server+"/api/v2.1/wikis/",n=new(l());return n.append("name",e),this._sendPostRequest(t,n)}},{key:"renameWiki",value:function(e,t){var n=this.server+"/api/v2.1/wikis/"+e+"/",r=new(l());return r.append("wiki_name",t),this._sendPostRequest(n,r)}},{key:"deleteWiki",value:function(e){var t=this.server+"/api/v2.1/wikis/"+e+"/";return this.req.delete(t)}},{key:"listWikis2",value:function(e){var t=this.server+"/api/v2.1/wikis2/";return e?this.req.get(t,{params:e,paramsSerializer:{serialize:function(e){var t=[];for(var n in e)if(Array.isArray(e[n]))for(var r=0,o=e[n].length;r<o;r++)t.push(n+"="+encodeURIComponent(e[n][r]));else t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}}}):this.req.get(t)}},{key:"addWiki2",value:function(e,t){var n=this.server+"/api/v2.1/wikis2/",r=new(l());return r.append("name",e),t&&r.append("owner",t),this._sendPostRequest(n,r)}},{key:"deleteWiki2",value:function(e){var t=this.server+"/api/v2.1/wiki2/"+e+"/";return this.req.delete(t)}},{key:"updateWiki2Config",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/config/",r={wiki_config:t};return this.req.put(n,r)}},{key:"getWiki2Config",value:function(e){var t=this.server+"/api/v2.1/wiki2/"+e+"/config/";return this.req.get(t)}},{key:"createWiki2Page",value:function(e,t,n){var r=this.server+"/api/v2.1/wiki2/"+e+"/pages/",o=new(l());return o.append("page_name",t),n&&o.append("current_id",n),this._sendPostRequest(r,o)}},{key:"deleteWiki2Page",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/page/"+t+"/";return this.req.delete(n)}},{key:"deleteWiki2Folder",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/folder/"+t+"/";return this.req.delete(n)}},{key:"getWiki2Page",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/page/"+t+"/";return this.req.get(n)}},{key:"renameWiki2",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/",r={wiki_name:t};return this.req.put(n,r)}},{key:"duplicateWiki2Page",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/duplicate-page/",r=new(l());return r.append("page_id",t),this._sendPostRequest(n,r)}}]),e}(),u=new d,p=i.ZP.load("sfcsrftoken");u.initForSeahubUsage({siteRoot:c.ze,xcsrfHeaders:p}),t.Z=u},90950:function(e,t,n){"use strict";var r=n(56690).default,o=n(89728).default,i=n(61655).default,s=n(26389).default,a=n(64836).default,l=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(47313)),d=a(n(71306)),u=a(n(64123)),p=n(96914),h=a(n(7463)),f=a(n(47071));n(4815),n(5239),n(58606),n(42397);var m=(0,h.default)(),g=function(e){i(n,e);var t=s(n);function n(e){var o;return r(this,n),(o=t.call(this,e)).handleMouseDown=function(e){e.preventDefault()},o.onChange=function(e){var t=o.props.onChange;o.setState({value:e},(function(){o.state.value&&t(o.state.value.format("YYYY-MM-DD"))}))},o.onClear=function(){o.setState({value:null},(function(){o.setState({open:!0})}))},o.onOpenChange=function(e){o.setState({open:e})},o.onReadOnlyFocus=function(){!o.state.open&&o.state.isMouseDown?o.setState({isMouseDown:!1}):o.setState({open:!0})},o.getCalendarContainer=function(){return o.calendarContainerRef.current},o.getCalendarFormat=function(){var e=[];if(o.columnDataFormat.indexOf("YYYY-MM-DD")>-1){var t=o.columnDataFormat.replace("YYYY-MM-DD","YYYY-M-D");e=[o.columnDataFormat,t]}else if(o.columnDataFormat.indexOf("DD/MM/YYYY")>-1){var n=o.columnDataFormat.replace("DD/MM/YYYY","D/M/YYYY");e=[o.columnDataFormat,n]}else e=[o.columnDataFormat];return e},o.state={open:!1,value:null},o.columnDataFormat=e.format.split(" ")[0],o.calendarContainerRef=c.default.createRef(),o.defaultCalendarValue=null,o}return o(n,[{key:"componentDidMount",value:function(){var e="zh-cn"===this.props.lang;m=e?m.locale("zh-cn"):m.locale("en-gb"),this.defaultCalendarValue=m.clone();var t=this.props.value;if(t&&(0,h.default)(t).isValid()){var n=(0,h.default)(t).isValid()?(0,h.default)(t):(0,h.default)(this.defaultCalendarValue);this.setState({value:e?(0,h.default)(n).locale("zh-cn"):(0,h.default)(n).locale("en-gb")})}}},{key:"render",value:function(){var e=this,t=this.props,n=t.isReadOnly,r=t.lang,o=this.state;if(n)return c.default.createElement("input",{className:"ant-calendar-picker-input ant-input form-control",value:o.value?o.value.format(this.columnDataFormat):"",disabled:!0});var i=this.getCalendarFormat(),s=c.default.createElement(d.default,{className:"sf-metadata-rc-calendar",locale:(0,p.translateCalendar)(r),style:{zIndex:1001},dateInputPlaceholder:"please enter date",format:i,defaultValue:this.defaultCalendarValue,showDateInput:!0,focusablePanel:!1,onClear:this.onClear,clearIcon:c.default.createElement(f.default,{iconName:"close",className:"sf-metadata-rc-calendar-clear"})});return c.default.createElement("div",{className:"date-picker-container"},c.default.createElement(u.default,{calendar:s,value:o.value,onChange:this.onChange,getCalendarContainer:this.getCalendarContainer,onOpenChange:this.onOpenChange,open:o.open,style:{zIndex:1001}},(function(t){var n=t.value;return c.default.createElement("span",{tabIndex:"0",onFocus:e.onReadOnlyFocus},c.default.createElement("input",{tabIndex:"-1",readOnly:!0,className:"ant-calendar-picker-input ant-input form-control",value:n?n.format(e.columnDataFormat):"",onMouseDown:e.handleMouseDown}),c.default.createElement("div",{ref:e.calendarContainerRef}))})))}}]),n}(c.Component);g.defaultProps={format:"YYYY-MM-DD",lang:"zh-cn",isReadOnly:!1};t.default=g},96914:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.translateCalendar=function(e){var t;switch(e||"en"){case"zh-cn":t=r;break;case"zh-tw":t=o;break;case"en":default:t=i;break;case"fr":t=s;break;case"de":t=a;break;case"es":case"es-ar":case"es-mx":t=l;break;case"pl":t=c;break;case"cs":t=d;break;case"ru":t=u}return t};var r=n(18166),o=n(91449),i=n(44613),s=n(60675),a=n(52961),l=n(52017),c=n(99949),d=n(91795),u=n(12250)},6563:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(47313)),i=r(n(46123)),s=r(n(45150));n(95993);t.default=function(e){return o.default.createElement("div",{className:(0,i.default)("sf-metadata-centered-loading",e.className)},o.default.createElement(s.default,null))}},36706:function(e,t,n){"use strict";var r=n(56690).default,o=n(89728).default,i=n(61655).default,s=n(26389).default,a=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(n(47313)),c=function(e){i(n,e);var t=s(n);function n(){var e;return r(this,n),(e=t.apply(this,arguments)).isClickedInside=!1,e.handleDocumentClick=function(t){e.isClickedInside?e.isClickedInside=!1:e.props.onClickOutside(t)},e.handleMouseDown=function(){e.isClickedInside=!0},e}return o(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleDocumentClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleDocumentClick)}},{key:"render",value:function(){return l.default.cloneElement(l.default.Children.only(this.props.children),{onMouseDownCapture:this.handleMouseDown})}}]),n}(l.default.Component);t.default=c},47284:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"CellType",{enumerable:!0,get:function(){return o.default}});var o=r(n(49908))},49908:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={DEFAULT:"default",TEXT:"text",CREATOR:"creator",CTIME:"ctime",LAST_MODIFIER:"last-modifier",MTIME:"mtime",FILE_NAME:"file-name"}},97173:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(47313)),i=r(n(99531));n(24717);t.default=function(e){var t=e.callBack,n=e.footerName,r=e.className,s=e.addIconClassName,a=e.hideIcon,l=e.style;return o.default.createElement("div",{className:"sf-metadata-ui add-item-btn ".concat(r||""),style:l,onClick:function(e){t(e)}},!a&&o.default.createElement(i.default,{iconName:"add-table",className:s}),o.default.createElement("span",{className:"text-truncate"},n))}},44725:function(e,t,n){"use strict";var r=n(56690).default,o=n(89728).default,i=n(61655).default,s=n(26389).default,a=n(64836).default,l=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(47313)),d=a(n(46123)),u=a(n(99531)),p=a(n(50406)),h=a(n(94582));n(76525);var f=n(64694),m=function(e){i(n,e);var t=s(n);function n(e){var o;return r(this,n),(o=t.call(this,e)).onSelectToggle=function(e){e.preventDefault(),o.state.isShowSelectOptions&&e.stopPropagation();var t=(0,f.getEventClassName)(e);o.props.isLocked||t.indexOf("option-search-control")>-1||"option-group-search"===t||""!==e.target.value&&o.setState({isShowSelectOptions:!o.state.isShowSelectOptions})},o.onClick=function(e){o.props.isShowSelected&&e.target.className.includes("icon-fork-number")||o.selector.contains(e.target)||o.closeSelect()},o.closeSelect=function(){o.setState({isShowSelectOptions:!1})},o.getSelectedOptionTop=function(){return o.selector?o.selector.getBoundingClientRect().height:38},o.getFilterOptions=function(e){var t=o.props,n=t.options;if(!t.searchable)return n||[];var r=e.trim().toLowerCase();return r?n.filter((function(e){var t=e.value,n=e.name;return"string"===typeof n?n.toLowerCase().indexOf(r)>-1:"object"===typeof t&&(t.column?t.column.name.toLowerCase().indexOf(r)>-1:t.name?t.name.toLowerCase().indexOf(r)>-1:t.columnOption&&t.columnOption.name.toLowerCase().indexOf(r)>-1)})):n||[]},o.state={isShowSelectOptions:!1},o}return o(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.value,o=t.options,i=t.placeholder,s=t.searchable,a=t.searchPlaceholder,l=t.noOptionsPlaceholder,f=t.isLocked,m=t.isInModal,g=t.addOptionAble,v=t.component;return c.default.createElement("div",{ref:function(t){return e.selector=t},className:(0,d.default)("sf-metadata-select custom-select",{focus:this.state.isShowSelectOptions},{disabled:f},n),onClick:this.onSelectToggle},c.default.createElement("div",{className:"selected-option"},r&&r.label?c.default.createElement("span",{className:"selected-option-show"},r.label):c.default.createElement("span",{className:"select-placeholder"},i),!f&&c.default.createElement(u.default,{iconName:"drop-down"})),this.state.isShowSelectOptions&&!m&&c.default.createElement(p.default,{value:r,addOptionAble:g,component:v,isShowSelected:this.props.isShowSelected,top:this.getSelectedOptionTop(),options:o,onSelectOption:this.props.onSelectOption,searchable:s,searchPlaceholder:a,noOptionsPlaceholder:l,onClickOutside:this.onClick,closeSelect:this.closeSelect,getFilterOptions:this.getFilterOptions,supportMultipleSelect:this.props.supportMultipleSelect}),this.state.isShowSelectOptions&&m&&c.default.createElement(h.default,null,c.default.createElement(p.default,{className:n,value:r,addOptionAble:g,component:v,isShowSelected:this.props.isShowSelected,position:this.selector.getBoundingClientRect(),isInModal:m,top:this.getSelectedOptionTop(),options:o,onSelectOption:this.props.onSelectOption,searchable:s,searchPlaceholder:a,noOptionsPlaceholder:l,onClickOutside:this.onClick,closeSelect:this.closeSelect,getFilterOptions:this.getFilterOptions,supportMultipleSelect:this.props.supportMultipleSelect})))}}]),n}(c.Component);t.default=m},28639:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(47313)),i=r(n(46123)),s=r(n(44725)),a=n(64694);n(33198);t.default=function(e){var t=e.className,n=e.value,r=e.options,l=e.onChange;return o.default.createElement(s.default,{className:(0,i.default)("sf-metadata-select-field",t),value:r.find((function(e){return e.value.column.key===n})),placeholder:(0,a.gettext)("Select_a_field"),options:r,onSelectOption:l,searchable:!0,isInModal:!0,searchPlaceholder:(0,a.gettext)("Search_fields"),noOptionsPlaceholder:(0,a.gettext)("No_fields")})}},54800:function(e,t,n){"use strict";var r=n(27424).default,o=n(64836).default,i=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(n(47313)),a=n(64694),l=o(n(66270));t.default=function(e){var t=e.value,n=e.mediaUrl,o=e.api,i=e.collaborators,c=e.collaboratorsCache,d=e.updateCollaboratorsCache,u=(0,s.useState)(null),p=r(u,2),h=p[0],f=p[1];return(0,s.useEffect)((function(){var e=!0;if(!t)return e&&f(null),function(){return e=!1};var r=i&&i.find((function(e){return e.email===t}));if(r)return e&&f(r),function(){return e=!1};var s="".concat(n,"/avatars/default.png");return"anonymous"===t?(r={name:"anonymous",avatar_url:s},e&&f(r),function(){return e=!1}):(r=c[t])?(e&&f(r),function(){return e=!1}):(0,a.isValidEmail)(t)?(o&&o(t,(function(n){r=n[t],d(r),e&&f(r)})),function(){return e=!1}):(d(r={email:t,name:t,avatar_url:s}),e&&f(r),function(){return e=!1})}),[]),h?s.default.createElement(l.default,{collaborator:h}):null}},66270:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(47313)),i=r(n(99531));n(42988);t.default=function(e){var t=e.enableDelete,n=void 0!==t&&t,r=e.collaborator,s=e.onDelete;return r?o.default.createElement("div",{className:"sf-metadata-ui collaborator-item"},o.default.createElement("span",{className:"collaborator-avatar"},o.default.createElement("img",{className:"collaborator-avatar-icon",alt:r.name,src:r.avatar_url})),o.default.createElement("span",{className:"collaborator-name"},r.name),n&&o.default.createElement("span",{className:"collaborator-remove",onClick:s},o.default.createElement(i.default,{iconName:"delete"}))):null}},39565:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(47313)),i=r(n(46123)),s=r(n(54800));t.default=function(e){var t=e.value,n=e.className,r=e.children;return Array.isArray(t)&&0!==t.length?0===t.filter((function(e){return e})).length?r||null:o.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container collaborator-formatter",n)},t.map((function(e){return o.default.createElement(s.default,{key:e,value:e})}))):r||null}},40544:function(e,t,n){"use strict";var r=n(27424).default,o=n(64836).default,i=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(n(47313)),a=o(n(46123)),l=n(64694),c=o(n(66270));t.default=function(e){var t=e.value,n=e.mediaUrl,o=e.className,i=e.api,d=e.collaborators,u=void 0===d?[]:d,p=e.collaboratorsCache,h=void 0===p?{}:p,f=e.updateCollaboratorsCache,m=e.children,g=(0,s.useState)(null),v=r(g,2),y=v[0],x=v[1];return(0,s.useEffect)((function(){var e=!0;if(!t)return e&&x(null),function(){return e=!1};var r=u&&u.find((function(e){return e.email===t}));if(r)return e&&x(r),function(){return e=!1};var o="".concat(n,"/avatars/default.png");return"anonymous"===t?(r={name:"anonymous",avatar_url:o},e&&x(r),function(){return e=!1}):(r=h[t])?(e&&x(r),function(){return e=!1}):(0,l.isValidEmail)(t)?(i&&i(t,(function(n){r=n[t],Object.values(n).forEach((function(e){f&&f(e)})),e&&x(r)})),function(){return e=!1}):(r={email:t,name:t,avatar_url:o},f&&f(r),e&&x(r),function(){return e=!1})}),[]),y?s.default.createElement("div",{className:(0,a.default)("sf-metadata-ui cell-formatter-container creator-formatter",o)},s.default.createElement(c.default,{collaborator:y})):m||null}},3908:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(47313)),i=r(n(46123)),s=r(n(78644));t.default=function(e){var t=e.value,n=e.className,r=e.children;if(!t)return r||null;var a=(0,s.default)(t).format("YYYY-MM-DD HH:mm:ss");return o.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container ctime-formatter",n)},a)}},38682:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(47313));t.default=function(e){var t=e.fieldType;return o.default.createElement("span",{className:"sf-metadata-record-cell-empty sf-metadata-record-".concat(t,"-cell-empty")})}},69449:function(e,t,n){"use strict";var r=n(64836).default,o=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(47313)),s=r(n(46123)),a=r(n(99531)),l=n(48191);n(33034);t.default=function(e){var t=e.value,n=e.isDir,r=e.className,o=e.children,c=(0,i.useMemo)((function(){return(0,l.getFileIconName)(t,n)}),[t,n]);return t?i.default.createElement("div",{className:(0,s.default)("sf-metadata-ui cell-formatter-container file-name-formatter",r)},i.default.createElement(a.default,{iconName:c}),i.default.createElement("span",{className:"sf-metadata-file-name"},t)):o||null}},48191:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileIconName=void 0;t.getFileIconName=function(e,t){if(t)return"folder";if(!e)return"file";var n=e.lastIndexOf(".");if(-1===n)return"file";var r=e.slice(n+1).toLowerCase();return["gif","jpeg","jpg","png","ico","bmp","tif","tiff","jfif"].includes()?"image":"md"===r||"markdown"===r?"markdown":"file"}},50377:function(e,t,n){"use strict";var r=n(70215).default,o=["field","value","isSample","queryUserAPI"],i=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(n(47313)),a=n(47284),l=i(n(17543)),c=i(n(40544)),d=i(n(3908)),u=i(n(38682)),p=i(n(69449));n(77634);t.default=function(e){var t=e.field,n=e.value,i=(e.isSample,e.queryUserAPI),h=r(e,o),f=(t||{}).type,m="sf-metadata-".concat(f,"-formatter");switch(f){case a.CellType.TEXT:return s.default.createElement(l.default,{value:n,className:m},s.default.createElement(u.default,{fieldType:f}));case a.CellType.CTIME:case a.CellType.MTIME:return s.default.createElement(d.default,{value:n,className:m},s.default.createElement(u.default,{fieldType:f}));case a.CellType.CREATOR:case a.CellType.LAST_MODIFIER:return s.default.createElement(c.default,Object.assign({value:n,className:m,api:i},h),s.default.createElement(u.default,{fieldType:f}));case a.CellType.FILE_NAME:return s.default.createElement(p.default,Object.assign({value:n,className:m},h),s.default.createElement(u.default,{fieldType:f}));default:return s.default.createElement(l.default,{value:n,className:m},s.default.createElement(u.default,{fieldType:f}))}}},29061:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"CTimeFormatter",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"CollaboratorFormatter",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"CollaboratorsFormatter",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"CreatorFormatter",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"TextFormatter",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"URLFormatter",{enumerable:!0,get:function(){return c.default}}),t.default=void 0;var o=r(n(66270)),i=r(n(39565)),s=r(n(40544)),a=r(n(3908)),l=r(n(17543)),c=r(n(30715)),d=r(n(50377));n(39279);t.default=d.default},17543:function(e,t,n){"use strict";var r=n(64836).default,o=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(47313)),s=r(n(46123)),a=n(64694);t.default=function(e){var t=e.value,n=e.className,r=e.children,o=(0,i.useMemo)((function(){return"object"===typeof t?null:"Boolean"===(0,a.getType)(t)?t+"":t}),[t]);return o?i.default.createElement("div",{className:(0,s.default)("sf-metadata-ui cell-formatter-container text-formatter",n)},o):r||null}},30715:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(47313)),i=r(n(46123));n(92602);t.default=function(e){var t=e.value,n=e.className,r=e.children;return t?o.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container url-formatter",n)},t):r||null}},47071:function(e,t,n){"use strict";var r=n(70215).default,o=["size","className","iconClassName","iconName","onClick"],i=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(n(47313)),a=i(n(46123)),l=i(n(99531));n(10057);t.default=function(e){var t=e.size,n=void 0===t?20:t,i=e.className,c=e.iconClassName,d=e.iconName,u=e.onClick,p=r(e,o);return s.default.createElement("div",Object.assign({className:(0,a.default)("sf-metadata-icon-btn","sf-metadata-icon-btn-".concat(n),i),onClick:u||function(){}},p),s.default.createElement(l.default,{iconName:d,className:c}))}},99531:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(47313)),i=r(n(46123));n(82106);t.default=function(e){var t=e.className,n=e.iconName;return o.default.createElement("svg",{className:(0,i.default)("sf-metadata-icon","sf-metadata-icon-".concat(n),t)},o.default.createElement("use",{xlinkHref:"#".concat(n)}))}},43950:function(e,t,n){"use strict";var r=n(75263).default,o=n(64836).default;Object.defineProperty(t,"f",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(t,"sM",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"$R",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"fg",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"Mb",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"JO",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"a5",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"gb",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"Hv",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(t,"QS",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"Mj",{enumerable:!0,get:function(){return g.default}});var i=o(n(6563)),s=o(n(36706)),a=o(n(97173)),l=o(n(44725)),c=o(n(28639)),d=r(n(29061)),u=o(n(99531)),p=o(n(47071)),h=o(n(45150)),f=o(n(20016)),m=o(n(89839)),g=o(n(40452)),v=o(n(28058)),y=o(n(66829)),x=o(n(94582)),w=o(n(78730)),b=o(n(90950))},48343:function(e,t,n){"use strict";var r=n(56690).default,o=n(89728).default,i=n(75263).default,s=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(n(47313)),l=s(n(51511)),c=s(n(30405)),d=s(n(36486)),u=s(n(36993)),p=i(n(14413)),h=s(n(79305));if(!String.prototype.defaultMessage){var f=function(e){return this||e||""};String.prototype.defaultMessage=f,String.prototype.d=f}var m=function(){function e(){r(this,e),this.options={currentLocale:null,locales:{},warningHandler:function(){var e;(e=console).warn.apply(e,arguments)},escapeHtml:!0,fallbackLocale:null,debug:!1,dataKey:"data-i18n-key"}}return o(e,[{key:"_getFormattedMessage",value:function(e,t){if(this.options.intlGetHook)try{this.options.intlGetHook(e,this.options.currentLocale)}catch(f){console.log("intl get hook error: ",f)}(0,u.default)(e,"key is required");var n=this.options,r=n.locales,o=n.currentLocale,i=n.formats;if(!r||!r[o]){var s='react-intl-universal locales data "'.concat(o,'" not exists.');return o||(s+=" More info: https://github.com/alibaba/react-intl-universal/issues/144#issuecomment-1345193138"),this.options.warningHandler(s),""}var a=this.getDescendantProp(r[o],e);if(null==a){if(!this.options.fallbackLocale)return this.options.warningHandler('react-intl-universal key "'.concat(e,'" not defined in ').concat(o)),"";if(null==(a=this.getDescendantProp(r[this.options.fallbackLocale],e)))return this.options.warningHandler('react-intl-universal key "'.concat(e,'" not defined in ').concat(o," or the fallback locale, ").concat(this.options.fallbackLocale)),""}if(t)for(var d in t=Object.assign({},t)){var p=t[d];!0===this.options.escapeHtml&&("string"===typeof p||p instanceof String)&&p.indexOf("<")>=0&&(p=(0,c.default)(p)),t[d]=p}try{var h;if(t)h=new l.default(a,o,i).format(t);else h=a;return h}catch(m){return this.options.warningHandler("react-intl-universal format message failed for key='".concat(e,"'."),m.message),a}}},{key:"get",value:function(e,t){var n=this._getFormattedMessage(e,t);return this.options.debug?this._getSpanElementMessage(e,n):n}},{key:"getHTML",value:function(e,t){var n=this._getFormattedMessage(e,t);return n?this._getSpanElementMessage(e,n):""}},{key:"formatMessage",value:function(e,t){var n=e.id,r=e.defaultMessage;return this.get(n,t).defaultMessage(r)}},{key:"formatHTMLMessage",value:function(e,t){var n=e.id,r=e.defaultMessage;return this.getHTML(n,t).defaultMessage(r)}},{key:"determineLocale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getLocaleFromURL(e)||this.getLocaleFromCookie(e)||this.getLocaleFromLocalStorage(e)||this.getLocaleFromBrowser()}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,u.default)(e.currentLocale,"options.currentLocale is required"),(0,u.default)(e.locales,"options.locales is required"),Object.assign(this.options,e),this.options.formats=Object.assign({},this.options.formats,p.defaultFormats),new Promise((function(e,t){e()}))}},{key:"getInitOptions",value:function(){return this.options}},{key:"load",value:function(e){(0,h.default)(this.options.locales,e)}},{key:"getLocaleFromCookie",value:function(e){var t=e.cookieLocaleKey;if(t){var n=d.default.parse(document.cookie);return n&&n[t]}}},{key:"getLocaleFromLocalStorage",value:function(e){var t=e.localStorageLocaleKey;if(t&&window.localStorage)return localStorage.getItem(t)}},{key:"getLocaleFromURL",value:function(e){var t=e.urlLocaleKey;if(t){var n=window.location.search.split("?");if(n.length>=2){var r=new URLSearchParams(n[1]);if(r.has(t))return r.get(t)}}}},{key:"getDescendantProp",value:function(e,t){return e[t]?e[t]:t.split(".").reduce((function(e,t){return void 0!==e?e[t]:e}),e)}},{key:"getLocaleFromBrowser",value:function(){return navigator.language||navigator.userLanguage}},{key:"_getSpanElementMessage",value:function(e,t){var n={dangerouslySetInnerHTML:{__html:t}};this.options.debug&&(n[this.options.dataKey]=e);var r=a.default.createElement("span",n),o=function(){return r};return Object.assign({defaultMessage:o,d:o},r)}}]),e}();t.default=m},14413:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFormats=void 0;for(var n=["AFN","EUR","ALL","DZD","USD","AOA","XCD","ARS","AMD","AWG","AUD","AZN","BSD","BHD","BDT","BBD","BYN","BZD","XOF","BMD","INR","BTN","BOB","BOV","BAM","BWP","NOK","BRL","BND","BGN","BIF","CVE","KHR","XAF","CAD","KYD","CLP","CLF","CNY","COP","COU","KMF","CDF","NZD","CRC","HRK","CUP","CUC","ANG","CZK","DKK","DJF","DOP","EGP","SVC","ERN","ETB","FKP","FJD","XPF","GMD","GEL","GHS","GIP","GTQ","GBP","GNF","GYD","HTG","HNL","HKD","HUF","ISK","IDR","XDR","IRR","IQD","ILS","JMD","JPY","JOD","KZT","KES","KPW","KRW","KWD","KGS","LAK","LBP","LSL","ZAR","LRD","LYD","CHF","MOP","MKD","MGA","MWK","MYR","MVR","MRO","MUR","XUA","MXN","MXV","MDL","MNT","MAD","MZN","MMK","NAD","NPR","NIO","NGN","OMR","PKR","PAB","PGK","PYG","PEN","PHP","PLN","QAR","RON","RUB","RWF","SHP","WST","STD","SAR","RSD","SCR","SLL","SGD","XSU","SBD","SOS","SSP","LKR","SDG","SRD","SZL","SEK","CHE","CHW","SYP","TWD","TJS","TZS","THB","TOP","TTD","TND","TRY","TMT","UGX","UAH","AED","USN","UYU","UYI","UZS","VUV","VEF","VND","YER","ZMW","ZWL","XBA","XBB","XBC","XBD","XTS","XXX","XAU","XPD","XPT","XAG"],r={},o=0;o<n.length;o++)r[n[o]]={style:"currency",currency:n[o]};t.defaultFormats={number:r}},8089:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReactIntlUniversal",{enumerable:!0,get:function(){return o.default}}),t.load=t.init=t.getLocaleFromURL=t.getLocaleFromLocalStorage=t.getLocaleFromCookie=t.getLocaleFromBrowser=t.getInitOptions=t.getHTML=t.getDescendantProp=t.get=t.formatMessage=t.formatHTMLMessage=t.determineLocale=t.default=void 0;var o=r(n(48343)),i=t.default=new o.default;i.ReactIntlUniversal=o.default;t.get=i.get.bind(i),t.getHTML=i.getHTML.bind(i),t.formatMessage=i.formatMessage.bind(i),t.formatHTMLMessage=i.formatHTMLMessage.bind(i),t.determineLocale=i.determineLocale.bind(i),t.init=i.init.bind(i),t.getInitOptions=i.getInitOptions.bind(i),t.load=i.load.bind(i),t.getLocaleFromCookie=i.getLocaleFromCookie.bind(i),t.getLocaleFromLocalStorage=i.getLocaleFromLocalStorage.bind(i),t.getLocaleFromURL=i.getLocaleFromURL.bind(i),t.getDescendantProp=i.getDescendantProp.bind(i),t.getLocaleFromBrowser=i.getLocaleFromBrowser.bind(i)},45150:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.default.createElement("span",{className:"loading-icon loading-tip"})};var o=r(n(47313));n(80130)},94582:function(e,t,n){"use strict";var r=n(56690).default,o=n(89728).default,i=n(61655).default,s=n(26389).default,a=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(n(47313)),c=a(n(1168)),d=document.getElementById("modal-wrapper"),u=function(e){i(n,e);var t=s(n);function n(e){var o;return r(this,n),(o=t.call(this,e)).el=document.createElement("div"),o}return o(n,[{key:"componentDidMount",value:function(){d.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){d.removeChild(this.el)}},{key:"render",value:function(){return c.default.createPortal(this.props.children,this.el)}}]),n}(l.default.Component);t.default=u},20016:function(e,t,n){"use strict";var r=n(70215).default,o=["record","columns","openRecord"],i=n(64836).default,s=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(n(47313)),l=i(n(29061));n(17096);t.default=function(e){var t,n=e.record,i=e.columns,s=e.openRecord,c=r(e,o),d=(0,a.useCallback)((function(){s&&s(n)}),[n,s]);return a.default.createElement("div",{className:"sf-metadata-record",onClick:d},a.default.createElement("div",{className:"sf-metadata-record-container"},a.default.createElement("div",{className:"sf-metadata-record-header"},a.default.createElement("div",{className:"sf-metadata-record-cell sf-metadata-record-cell-name"},a.default.createElement(l.default,Object.assign({value:n[null===(t=i[0])||void 0===t?void 0:t.key],field:i[0]},c)))),a.default.createElement("div",{className:"sf-metadata-record-content"},i.slice(1).map((function(e){return a.default.createElement("div",{className:"sf-metadata-record-cell",key:e.key,style:{width:e.width||200}},a.default.createElement(l.default,Object.assign({isSample:!0,value:n[e.key],field:e},c)))})))))}},97840:function(e,t,n){"use strict";var r=n(64836).default,o=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(47313)),s=n(26213),a=r(n(47071)),l=r(n(99531));n(13539);t.default=function(e){var t=e.field,n=e.fieldIconConfig,r=t.type,o=t.name,c=t.description,d=t.key,u=(0,i.useRef)(null);return i.default.createElement(s.Col,{md:3,className:"d-flex sf-metadata-record-details-item-label"},i.default.createElement("div",{className:"d-flex justify-content-between"},i.default.createElement("div",{className:"field-description-section"},i.default.createElement("span",{className:"header-icon",id:"header-icon-".concat(d)},i.default.createElement(l.default,{iconName:n[r]})),i.default.createElement("span",{className:"field-description-section-field-name"},o||""),c&&i.default.createElement(i.default.Fragment,null,i.default.createElement(a.default,{ref:u,iconName:"description",className:"field-uneditable-tip ml-2"}),u.current&&i.default.createElement(s.UncontrolledTooltip,{target:u.current,fade:!1,placement:"right",modifiers:{preventOverflow:{boundariesElement:document.body}}},c)))))}},89839:function(e,t,n){"use strict";var r=n(27424).default,o=n(70215).default,i=["fields","record","onToggle","fieldIconConfig"],s=n(64836).default,a=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(n(47313)),c=n(26213),d=n(64694),u=s(n(6563)),p=s(n(97840)),h=s(n(29061)),f=s(n(47071));n(826);t.default=function(e){var t=e.fields,n=e.record,s=e.onToggle,a=e.fieldIconConfig,m=o(e,i),g=(0,l.useState)(!0),v=r(g,2),y=v[0],x=v[1],w=(0,l.useState)(!0),b=r(w,2),S=b[0],C=b[1],D=(0,l.useRef)(null),k=(0,l.useMemo)((function(){return{width:"".concat(window.innerWidth-80,"px"),maxWidth:"".concat(window.innerWidth-80,"px"),marginLeft:"".concat(80,"px"),height:"".concat(100,"px"),marginRight:"".concat(80,"px"),marginTop:"30%",transition:"all .3s"}}),[]),j=(0,l.useMemo)((function(){return{width:800,maxWidth:800,marginLeft:(window.innerWidth-800)/2,height:"calc(100% - 56px)"}}),[]);(0,l.useEffect)((function(){setTimeout((function(){var e=D.current.firstChild,t=j.width,n=j.maxWidth,r=j.marginLeft,o=j.height;e.style.width="".concat(t,"px"),e.style.maxWidth="".concat(n,"px"),e.style.marginLeft="".concat(r,"px"),e.style.height=o,e.style.marginRight="unset",e.style.marginTop="28px",setTimeout((function(){x(!1),e.style.transition="none",C(!1)}),280)}),1)}),[]);var I=(0,l.useCallback)((function(){s()}),[s]),M=(0,l.useCallback)((function(e){var t=e.key;return l.default.createElement(h.default,Object.assign({field:e,value:n[t]},m))}),[n,m]),_=(0,l.useCallback)((function(){return S?l.default.createElement(u.default,null):Array.isArray(t)&&0!==t.length?l.default.createElement(l.default.Fragment,null,t.map((function(e){return l.default.createElement("div",{className:"sf-metadata-record-details-item sf-metadata-record-details-item-field-".concat(e.type),key:e.key},l.default.createElement("div",{className:"pb-4 row"},l.default.createElement(p.default,{field:e,fieldIconConfig:a}),l.default.createElement(c.Col,{md:9,className:"d-flex align-items-center sf-metadata-record-details-item-col"},M(e))))}))):null}),[S,t,a,M]);return l.default.createElement(c.Modal,{isOpen:!0,toggle:I,className:"sf-metadata-record-details-dialog",style:y?k:j,zIndex:1048,contentClassName:"sf-metadata-record-details-content",modalClassName:"sf-metadata-record-details-modal",fade:!1,innerRef:D,keyboard:!1},!y&&l.default.createElement("div",{className:"sf-metadata-record-details"},l.default.createElement(c.ModalHeader,{close:l.default.createElement("div",{className:"header-close-list"},l.default.createElement(f.default,{iconName:"close",size:24,onClick:I}))},l.default.createElement("div",{className:"sf-metadata-record-details-left-btns"},l.default.createElement("div",{className:"sf-metadata-record-details-title text-truncate"},(0,d.gettext)("Details")))),l.default.createElement(c.ModalBody,{className:"sf-metadata-record-details-container"},_())))}},40452:function(e,t,n){"use strict";var r=n(56690).default,o=n(89728).default,i=n(61655).default,s=n(26389).default,a=n(64836).default,l=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(47313)),d=a(n(46123)),u=n(64694),p=function(e){i(n,e);var t=s(n);function n(e){var o;return r(this,n),(o=t.call(this,e)).onCompositionStart=function(){o.isInputtingChinese=!0},o.onChange=function(e){o.timer&&clearTimeout(o.timer);var t=o.props,n=t.onChange,r=t.wait,i=e.target.value;o.setState({searchValue:i||""},(function(){o.isInputtingChinese||(o.timer=setTimeout((function(){n&&n(o.state.searchValue.trim())}),r))}))},o.onCompositionEnd=function(e){o.isInputtingChinese=!1,o.onChange(e)},o.clearSearch=function(){var e=o.props.clearValue;o.setState({searchValue:""},(function(){e&&e()}))},o.setFocus=function(e){if(o.inputRef!==document.activeElement&&(o.inputRef.focus(),e)){var t=o.state.searchValue.length;o.inputRef.setSelectionRange(0,t)}},o.renderClear=function(){var e=o.props,t=e.isClearable,n=e.clearClassName,r=e.components,i=void 0===r?{}:r,s=o.state.searchValue;if(!t||!s)return null;var a=i.ClearIndicator;return c.default.isValidElement(a)?c.default.cloneElement(a,{clearValue:o.clearSearch}):(0,u.isFunction)(a)?c.default.createElement(a,{clearValue:o.clearSearch}):c.default.createElement("i",{className:(0,d.default)("search-text-clear input-icon-addon",n),onClick:o.clearSearch},"\xd7")},o.state={searchValue:e.value},o.isInputtingChinese=!1,o.timer=null,o.inputRef=null,o}return o(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({searchValue:e.value})}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null,this.inputRef=null}},{key:"render",value:function(){var e=this,t=this.props,n=t.placeholder,r=t.autoFocus,o=t.className,i=t.onKeyDown,s=t.disabled,a=t.style,l=this.state.searchValue;return c.default.createElement(c.Fragment,null,c.default.createElement("input",{type:"text",value:l,className:(0,d.default)("form-control",o),onChange:this.onChange,autoFocus:r,placeholder:n,onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,onKeyDown:i,disabled:s,style:a,ref:function(t){return e.inputRef=t}}),this.renderClear())}}]),n}(c.Component);p.defaultProps={wait:100,disabled:!1,value:""};t.default=p},38432:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Enter:13,Tab:9,Escape:27,Esc:27}},50406:function(e,t,n){"use strict";var r=n(56690).default,o=n(89728).default,i=n(61655).default,s=n(26389).default,a=n(64836).default,l=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(47313)),d=a(n(46123)),u=a(n(20901)),p=a(n(40452)),h=a(n(38432)),f=a(n(36706));n(97744);var m=function(e){i(n,e);var t=s(n);function n(e){var o;return r(this,n),(o=t.call(this,e)).resetMenuStyle=function(){var e=o.props,t=e.isInModal,n=e.position,r=o.optionGroupRef.getBoundingClientRect(),i=r.top,s=r.height;if(t)n.y+n.height+s>window.innerHeight&&(o.optionGroupRef.style.top=n.y-s+"px"),o.optionGroupRef.style.opacity=1;else if(s+i>window.innerHeight){o.optionGroupRef.style.top=-1*(s+2)+"px"}},o.onHotKey=function(e){var t=e.keyCode;if(t===h.default.UpArrow)o.onPressUp();else if(t===h.default.DownArrow)o.onPressDown();else if(t===h.default.Enter){var n=o.filterOptions&&o.filterOptions[o.state.activeIndex];n&&(o.props.onSelectOption(n.value),o.props.supportMultipleSelect||o.props.closeSelect())}else t!==h.default.Tab&&t!==h.default.Escape||o.props.closeSelect()},o.onPressUp=function(){o.state.activeIndex>0&&o.setState({activeIndex:o.state.activeIndex-1},(function(){o.scrollContent()}))},o.onPressDown=function(){o.filterOptions&&o.state.activeIndex<o.filterOptions.length-1&&o.setState({activeIndex:o.state.activeIndex+1},(function(){o.scrollContent()}))},o.onMouseDown=function(e){o.props.isInModal&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},o.scrollContent=function(){var e=o.optionGroupContentRef,t=e.offsetHeight,n=e.scrollTop;o.setState({disableHover:!0}),o.timer=setTimeout((function(){o.setState({disableHover:!1})}),500),32*o.state.activeIndex!==0?32*o.state.activeIndex<n?o.optionGroupContentRef.scrollTop=n-32:32*o.state.activeIndex>t+n&&(o.optionGroupContentRef.scrollTop=n+32):o.optionGroupContentRef.scrollTop=0},o.changeIndex=function(e){o.setState({activeIndex:e})},o.onChangeSearch=function(e){var t=e||"";t!==o.state.searchVal&&o.setState({searchVal:t,activeIndex:-1})},o.renderOptGroup=function(e){var t=o.props,n=t.noOptionsPlaceholder,r=t.onSelectOption;return o.filterOptions=o.props.getFilterOptions(e),0===o.filterOptions.length?c.default.createElement("div",{className:"none-search-result"},n):o.filterOptions.map((function(e,t){var n=e.value.column?e.value.column.key:t,i=o.state.activeIndex===t;return c.default.createElement(u.default,{key:n,index:t,isActive:i,value:e.value,onSelectOption:r,changeIndex:o.changeIndex,supportMultipleSelect:o.props.supportMultipleSelect,disableHover:o.state.disableHover},e.label)}))},o.state={searchVal:"",activeIndex:-1,disableHover:!1},o.filterOptions=null,o.timer=null,o}return o(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keydown",this.onHotKey),setTimeout((function(){e.resetMenuStyle()}),1)}},{key:"componentWillUnmount",value:function(){this.filterOptions=null,this.timer&&clearTimeout(this.timer),window.removeEventListener("keydown",this.onHotKey)}},{key:"render",value:function(){var e=this,t=this.props,n=t.searchable,r=t.searchPlaceholder,o=t.top,i=t.left,s=t.minWidth,a=t.value,l=t.isShowSelected,u=t.isInModal,h=t.position,m=t.className,g=t.addOptionAble,v=(t.component||{}).AddOption,y=this.state.searchVal,x={top:o||0,left:i||0};return s&&(x={top:o||0,left:i||0,minWidth:s}),u&&(x={position:"fixed",left:h.x,top:h.y+h.height,minWidth:h.width,opacity:0}),c.default.createElement(f.default,{onClickOutside:this.props.onClickOutside},c.default.createElement("div",{className:(0,d.default)("option-group",m?"option-group-"+m:"",{"pt-0":l,"create-new-option-group":g}),ref:function(t){return e.optionGroupRef=t},style:x,onMouseDown:this.onMouseDown},l&&c.default.createElement("div",{className:"editor-list-delete mb-2",onClick:function(e){return e.stopPropagation()}},a.label||""),n&&c.default.createElement("div",{className:"option-group-search"},c.default.createElement(p.default,{className:"option-search-control",placeholder:r,onChange:this.onChangeSearch,autoFocus:!0})),c.default.createElement("div",{className:"option-group-content",ref:function(t){return e.optionGroupContentRef=t}},this.renderOptGroup(y)),g&&v))}}]),n}(c.Component);t.default=m},20901:function(e,t,n){"use strict";var r=n(56690).default,o=n(89728).default,i=n(61655).default,s=n(26389).default,a=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(n(47313)),c=function(e){i(n,e);var t=s(n);function n(){var e;return r(this,n),(e=t.apply(this,arguments)).onSelectOption=function(t,n){e.props.supportMultipleSelect&&n.stopPropagation(),e.props.onSelectOption(t,n)},e.onMouseEnter=function(){e.props.disableHover||e.props.changeIndex(e.props.index)},e.onMouseLeave=function(){e.props.disableHover||e.props.changeIndex(-1)},e}return o(n,[{key:"render",value:function(){return l.default.createElement("div",{className:this.props.isActive?"option option-active":"option",onClick:this.onSelectOption.bind(this,this.props.value),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},this.props.children)}}]),n}(l.Component);t.default=c},28058:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(47313));t.default=function(e){var t=e.onChange,n=e.checked,r=e.placeholder,i=e.disabled,s=e.switchClassName;return o.default.createElement("div",{className:"sf-metadata-switch position-relative ".concat(s||"")},o.default.createElement("label",{className:"custom-switch"},o.default.createElement("input",{className:"custom-switch-input",type:"checkbox",checked:n,onChange:t,name:"custom-switch-checkbox",disabled:i}),o.default.createElement("span",{className:"custom-switch-description text-truncate"},r),o.default.createElement("span",{className:"custom-switch-indicator"})))}},23265:function(e,t,n){"use strict";var r=n(56690).default,o=n(89728).default,i=n(61655).default,s=n(26389).default,a=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(n(47313)),c=n(23015),d=function(e){i(n,e);var t=s(n);function n(e){var o;return r(this,n),(o=t.call(this,e)).containerStyle=(0,c.css)({borderRadius:"3px",backgroundColor:"#fff",padding:"10px 16px",display:"flex",boxSizing:"border-box",boxShadow:"rgba(67, 90, 111, 0.3) 0px 0px 1px, rgba(67, 90, 111, 0.47) 0px 8px 10px -4px",justifyContent:"space-between",flexDirection:"row"}),o.containerBorderSuccess=(0,c.css)({borderLeft:"3px solid rgb(71, 184, 129)"}),o.containerBorderWarn=(0,c.css)({borderLeft:"3px solid rgb(217, 130, 43)"}),o.containerBorderDanger=(0,c.css)({borderLeft:"3px solid rgb(236, 76, 71)"}),o.containerBorderNotify=(0,c.css)({borderLeft:"3px solid rgb(16, 112, 202)"}),o.toastTextTitle=(0,c.css)({fontWeight:"600",fontSize:"14px",color:"#435a6f",margin:"0"}),o.toastTextChild=(0,c.css)({fontSize:"14px",color:"#999",margin:"0"}),o.toastClose=(0,c.css)({marginLeft:"15px",height:"24px",width:"24px",lineHeight:"22px",fontWeight:"700",textAlign:"center",fontSize:"20px",color:"#000",cursor:"pointer",opacity:"0.5",":hover":{opacity:1}}),o.toastIcon=(0,c.css)({marginRight:"10px",width:"14px",height:"20px",lineHeight:"20px"}),o}return o(n,[{key:"getContainerStyle",value:function(e){switch(e){case"success":return{borderStyle:this.containerBorderSuccess,iconColor:(0,c.css)({color:"rgb(71, 184, 129)"}),iconClass:"fa fa-check-circle"};case"warning":return{borderStyle:this.containerBorderWarn,iconColor:(0,c.css)({color:"rgb(217, 130, 43)"}),iconClass:"fa fa-exclamation-triangle"};case"none":return{borderStyle:this.containerBorderNotify,iconColor:(0,c.css)({color:"rgb(16, 112, 202)"}),iconClass:"fa fa-exclamation-circle"};case"notify-in-progress":return{borderStyle:this.containerBorderNotify,iconColor:(0,c.css)({width:"15px",height:"15px",margin:"3px"}),iconClass:"loading-icon"};case"danger":return{borderStyle:this.containerBorderDanger,iconColor:(0,c.css)({color:"rgb(236, 76, 71)"}),iconClass:"fa fa-exclamation-circle"};default:return{}}}},{key:"render",value:function(){var e=this.getContainerStyle(this.props.intent);return l.default.createElement("div",(0,c.css)(e.borderStyle,this.containerStyle),l.default.createElement("div",{className:this.toastIcon},l.default.createElement("i",Object.assign({className:e.iconClass},e.iconColor))),l.default.createElement("div",{className:this.toastTextContainer},l.default.createElement("p",{className:this.toastTextTitle},this.props.title),this.props.children?l.default.createElement("p",{className:this.toastTextChild},this.props.children):null),l.default.createElement("div",{onClick:this.props.onRemove,className:this.toastClose},l.default.createElement("span",null,"\xd7")))}}]),n}(l.default.PureComponent);t.default=d},66829:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=new(r(n(589)).default);t.default=o},70263:function(e,t,n){"use strict";var r=n(56690).default,o=n(89728).default,i=n(61655).default,s=n(26389).default,a=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(n(47313)),c=n(23015),d=a(n(58946)),u=a(n(23265)),p="cubic-bezier(0.0, 0.0, 0.2, 1)",h="cubic-bezier(0.4, 0.0, 1, 1)",f="cubic-bezier(0.175, 0.885, 0.320, 1.175)",m=c.css.keyframes("openAnimation",{from:{opacity:0,transform:"translateY(-120%)"},to:{transform:"translateY(0)"}}),g=c.css.keyframes("closeAnimation",{from:{transform:"scale(1)",opacity:1},to:{transform:"scale(0.9)",opacity:0}}),v=(0,c.css)({display:"flex",flexDirection:"column",alignItems:"center",height:0,transition:"all ".concat(240,"ms ").concat(p),'&[data-state="entering"], &[data-state="entered"]':{animation:"".concat(m," ").concat(240,"ms ").concat(f," both")},'&[data-state="exiting"]':{animation:"".concat(g," 120ms ").concat(h," both")}}),y=function(e){i(n,e);var t=s(n);function n(){var e;return r(this,n),(e=t.apply(this,arguments)).state={isShown:!0,height:0},e.close=function(){e.clearCloseTimer(),e.setState({isShown:!1})},e.startCloseTimer=function(){e.props.duration&&(e.closeTimer=setTimeout((function(){e.close()}),1e3*e.props.duration))},e.clearCloseTimer=function(){e.closeTimer&&(clearTimeout(e.closeTimer),e.closeTimer=null)},e.handleMouseEnter=function(){e.clearCloseTimer()},e.handleMouseLeave=function(){e.startCloseTimer()},e.onRef=function(t){if(null!==t){var n=t.getBoundingClientRect().height;e.setState({height:n})}},e}return o(n,[{key:"componentDidUpdate",value:function(e){e.isShown!==this.props.isShown&&this.setState({isShown:this.props.isShown})}},{key:"componentDidMount",value:function(){this.startCloseTimer()}},{key:"componentWillUnmount",value:function(){this.clearCloseTimer()}},{key:"render",value:function(){var e=this;return l.default.createElement(d.default,{appear:!0,unmountOnExit:!0,timeout:240,in:this.state.isShown,onExited:this.props.onRemove},(function(t){return l.default.createElement("div",{"data-state":t,className:v,onMouseEnter:e.handleMouseEnter,onMouseLeave:e.handleMouseLeave,style:{height:e.state.height,zIndex:e.props.zIndex,marginBottom:e.state.isShown?0:-e.state.height}},l.default.createElement("div",{ref:e.onRef,style:{padding:8}},l.default.createElement(u.default,{intent:e.props.intent,title:e.props.title,children:e.props.children,isRemoveable:e.props.hasCloseButton,onRemove:function(){return e.close()}})))}))}}]),n}(l.default.PureComponent);t.default=y,y.defaultProps={intent:"none"}},42369:function(e,t,n){"use strict";var r=n(70215).default,o=n(42122).default,i=n(861).default,s=n(74704).default,a=n(56690).default,l=n(89728).default,c=n(61655).default,d=n(26389).default,u=["id","description"],p=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var h=p(n(47313)),f=n(23015),m=p(n(70263)),g=(0,f.css)({maxWidth:560,margin:"0 auto",top:0,left:0,right:0,position:"fixed",zIndex:999999}),v=function(e){return Object.hasOwnProperty.call(e,"id")},y=function(e){c(n,e);var t=d(n);function n(e,r){var l;return a(this,n),(l=t.call(this,e,r)).getToasts=function(){return l.state.toasts},l.closeAll=function(){l.getToasts().forEach((function(e){return e.close()}))},l.notify=function(e,t){if(v(t)){var n,r=s(l.state.toasts);try{for(r.s();!(n=r.n()).done;){var o=n.value;String(o.id).startsWith(t.id)&&l.closeToast(o.id)}}catch(c){r.e(c)}finally{r.f()}}var a=l.createToastInstance(e,t);return l.setState((function(e){return{toasts:[a].concat(i(e.toasts))}})),a},l.createToastInstance=function(e,t){var r=++n.idCounter,o=v(t)?"".concat(t.id,"-").concat(r):r;return{id:o,title:e,description:t.description,hasCloseButton:t.hasCloseButton||!0,duration:t.duration||2,close:function(){return l.closeToast(o)},intent:t.intent}},l.closeToast=function(e){l.setState((function(t){return{toasts:t.toasts.map((function(t){return t.id===e?o(o({},t),{},{isShown:!1}):t}))}}))},l.removeToast=function(e){l.setState((function(t){return{toasts:t.toasts.filter((function(t){return t.id!==e}))}}))},e.bindNotify(l.notify),e.bindGetToasts(l.getToasts),e.bindCloseAll(l.closeAll),l.state={toasts:[]},l}return l(n,[{key:"render",value:function(){var e=this;return h.default.createElement("span",{className:g},this.state.toasts.map((function(t){var n=t.id,o=t.description,i=r(t,u);return h.default.createElement(m.default,Object.assign({key:n,onRemove:function(){return e.removeToast(n)}},i),o)})))}}]),n}(h.default.PureComponent);t.default=y,y.idCounter=0},589:function(e,t,n){"use strict";var r=n(42122).default,o=n(89728).default,i=n(56690).default,s=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(n(47313)),l=s(n(1168)),c=s(n(42369)),d="undefined"!==typeof window&&"undefined"!==typeof window.document,u=o((function e(){var t=this;i(this,e);var n=this;if(this._bindNotify=function(e){t.notifyHandler=e},this._bindGetToasts=function(e){t.getToastsHandler=e},this._bindCloseAll=function(e){t.closeAllHandler=e},this.getToasts=function(){return t.getToastsHandler()},this.closeAll=function(){return t.closeAllHandler()},this.notify=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.notifyHandler(e,r(r({},t),{},{intent:"none"}))},this.notifyInProgress=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.notifyHandler(e,r(r({},t),{},{intent:"notify-in-progress"}))},this.success=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.notifyHandler(e,r(r({},t),{},{intent:"success"}))},this.warning=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.notifyHandler(e,r(r({},t),{},{intent:"warning"}))},this.danger=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.notifyHandler(e,r(r({},t),{},{intent:"danger"}))},d){var o=document.createElement("div");o.setAttribute("data-evergreen-toaster-container",""),document.body.appendChild(o),l.default.render(a.default.createElement(c.default,{bindNotify:this._bindNotify,bindGetToasts:this._bindGetToasts,bindCloseAll:this._bindCloseAll}),o)}}));t.default=u},72573:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=t.isValidEmail=t.isMac=t.isFunction=t.getType=t.getEventClassName=t.debounce=void 0;t.debounce=function(e,t){var n=null;return function(){null!==n&&clearTimeout(n),n=setTimeout(e,t)}};t.throttle=function(e,t){var n=null,r=Date.now();return function(){var o=Date.now(),i=t-(o-r),s=arguments;clearTimeout(n),i<=0?(e.apply(this,s),r=Date.now()):n=setTimeout(e,i)}};t.isMac=function(){var e=navigator.platform;return"Mac68K"==e||"MacPPC"==e||"Macintosh"==e||"MacIntel"==e};t.getEventClassName=function(e){return e&&e.target&&e.target.getAttribute("class")||""};t.isValidEmail=function(e){return/^[A-Za-z0-9]+([-_.][A-Za-z0-9]+)*@([A-Za-z0-9]+[-.])+[A-Za-z0-9]{2,20}$/.test(e)};t.isFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)};t.getType=function(e){return Object.prototype.toString.call(e).slice(8,-1)}},7463:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(78644)),i=r(n(57823));o.default.extend(i.default);t.default=o.default},64694:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return o.debounce}}),Object.defineProperty(t,"getEventClassName",{enumerable:!0,get:function(){return o.getEventClassName}}),Object.defineProperty(t,"getHTML",{enumerable:!0,get:function(){return r.getHTML}}),Object.defineProperty(t,"getType",{enumerable:!0,get:function(){return o.getType}}),Object.defineProperty(t,"gettext",{enumerable:!0,get:function(){return r.gettext}}),Object.defineProperty(t,"isFunction",{enumerable:!0,get:function(){return o.isFunction}}),Object.defineProperty(t,"isMac",{enumerable:!0,get:function(){return o.isMac}}),Object.defineProperty(t,"isValidEmail",{enumerable:!0,get:function(){return o.isValidEmail}}),Object.defineProperty(t,"throttle",{enumerable:!0,get:function(){return o.throttle}});var r=n(91602),o=n(72573)},91602:function(e,t,n){"use strict";var r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.gettext=t.getHTML=void 0;var o=r(n(8089));t.gettext=function(e,t){return e?o.default.get(e,t)||e:""};t.getHTML=function(e,t){return e?o.default.getHTML(e,t)||e:""}},78730:function(e,t,n){"use strict";var r=n(42122).default,o=n(56690).default,i=n(89728).default,s=n(61655).default,a=n(26389).default,l=n(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(47313));t.default=function(e){var t;return t=function(t){s(l,t);var n=a(l);function l(){return o(this,l),n.apply(this,arguments)}return i(l,[{key:"render",value:function(){var t=r({},this.props);return"function"===typeof this.props.getInstance&&(t.ref=this.props.getInstance),c.default.createElement(e,t)}}]),l}(c.Component),t.displayName="withRef(".concat(e.displayName||e.name||"Component",")"),t}},71306:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Ee}});var r=n(14646),o=n(50420),i=n(56583),s=n(74401),a=n(47313),l=n(1168),c=n(75192),d=n.n(c),u=n(49242),p=n(65886),h=n(78644),f=n.n(h),m=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,e.apply(this,arguments))}return(0,s.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.value.localeData(),n=e.prefixCls,r=void 0,o=t.weekdaysMin(),i=t.weekdaysShort();e.showWeekNumber&&(r=a.createElement("th",{role:"columnheader",className:n+"-column-header "+n+"-week-number-header"},a.createElement("span",{className:n+"-column-header-inner"},"x")));var s=i.map((function(e,t){return a.createElement("th",{key:t,role:"columnheader",title:e,className:n+"-column-header"},a.createElement("span",{className:n+"-column-header-inner"},o[t]))}));return a.createElement("thead",null,a.createElement("tr",{role:"row"},r,s))},t}(a.Component),g=m,v=n(46123),y=n.n(v),x=6,w=7,b=n(14063),S=n.n(b);f().extend(S());var C={disabledHours:function(){return[]},disabledMinutes:function(){return[]},disabledSeconds:function(){return[]}};function D(e){var t=f()();return t=t.locale(e.locale()).utcOffset(e.utcOffset())}function k(e){return e.format("LL")}function j(e){return k(D(e))}function I(e){var t=e.locale();return e.localeData()["zh-cn"===t?"months":"monthsShort"](e)}function M(e,t){var n=t?t(e):{};return n=(0,r.default)({},C,n)}function _(e,t,n){return(!t||!t(e))&&!(n&&!function(e,t){return function(e,t){var n=!1;if(e){var r=e.hour(),o=e.minute(),i=e.second();n=-1!==t.disabledHours().indexOf(r)||-1!==t.disabledMinutes(r).indexOf(o)||-1!==t.disabledSeconds(r,o).indexOf(i)}return!n}(e,M(e,t))}(e,n))}function N(e,t){return e?(Array.isArray(t)&&(t=t[0]),e.format(t)):""}function R(e,t){return e&&t&&e.isSame(t,"day")}function T(e,t){return e.year()<t.year()?1:e.year()===t.year()&&e.month()<t.month()}function O(e,t){return e.year()>t.year()?1:e.year()===t.year()&&e.month()>t.month()}var E=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,e.apply(this,arguments))}return(0,s.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.contentRender,n=e.prefixCls,r=e.selectedValue,o=e.value,i=e.showWeekNumber,s=e.dateRender,l=e.disabledDate,c=e.hoverValue,d=void 0,u=void 0,p=void 0,h=[],f=D(o),m=n+"-cell",g=n+"-week-number-cell",v=n+"-date",b=n+"-today",S=n+"-selected-day",C=n+"-selected-date",j=n+"-selected-start-date",I=n+"-selected-end-date",M=n+"-in-range-cell",_=n+"-last-month-cell",N=n+"-next-month-btn-day",E=n+"-disabled-cell",P=n+"-disabled-cell-first-of-row",Z=n+"-disabled-cell-last-of-row",F=n+"-last-day-of-month",L=o.clone(),A=((L=L.date(1)).day()+7-7)%7,U=L.clone();U=U.add(0-A,"days");var z=0;for(d=0;d<x;d++)for(u=0;u<w;u++)p=U,z&&(p=(p=p.clone()).add(z,"days")),h.push(p),z++;var B,G=[];for(z=0,d=0;d<x;d++){var H,Y=void 0,V=void 0,W=!1,K=[];for(i&&(V=a.createElement("td",{key:h[z].week(),role:"gridcell",className:g},h[z].week())),u=0;u<w;u++){var q=null,$=null;p=h[z],u<w-1&&(q=h[z+1]),u>0&&($=h[z-1]);var X=m,J=!1,Q=!1;R(p,f)&&(X+=" "+b,Y=!0);var ee=T(p,o),te=O(p,o);if(r&&Array.isArray(r)){var ne=c.length?c:r;if(!ee&&!te){var re=ne[0],oe=ne[1];re&&R(p,re)&&(Q=!0,W=!0,X+=" "+j),(re||oe)&&(R(p,oe)?(Q=!0,W=!0,X+=" "+I):(null!==re&&void 0!==re||!p.isBefore(oe,"day"))&&(null!==oe&&void 0!==oe||!p.isAfter(re,"day"))?p.isAfter(re,"day")&&p.isBefore(oe,"day")&&(X+=" "+M):X+=" "+M)}}else R(p,o)&&(Q=!0,W=!0);R(p,r)&&(X+=" "+C),ee&&(X+=" "+_),te&&(X+=" "+N),p.clone().endOf("month").date()===p.date()&&(X+=" "+F),l&&l(p,o)&&(J=!0,$&&l($,o)||(X+=" "+P),q&&l(q,o)||(X+=" "+Z)),Q&&(X+=" "+S),J&&(X+=" "+E);var ie=void 0;if(s)ie=s(p,o);else{var se=t?t(p,o):p.date();ie=a.createElement("div",{key:(B=p,"rc-calendar-"+B.year()+"-"+B.month()+"-"+B.date()),className:v,"aria-selected":Q,"aria-disabled":J},se)}K.push(a.createElement("td",{key:z,onClick:J?void 0:e.onSelect.bind(null,p),onMouseEnter:J?void 0:e.onDayHover&&e.onDayHover.bind(null,p)||void 0,role:"gridcell",title:k(p),className:X},ie)),z++}G.push(a.createElement("tr",{key:d,role:"row",className:y()((H={},H[n+"-current-week"]=Y,H[n+"-active-week"]=W,H))},V,K))}return a.createElement("tbody",{className:n+"-tbody"},G)},t}(a.Component);E.propTypes={contentRender:d().func,dateRender:d().func,disabledDate:d().func,prefixCls:d().string,selectedValue:d().oneOfType([d().object,d().arrayOf(d().object)]),value:d().object,hoverValue:d().any,showWeekNumber:d().bool},E.defaultProps={hoverValue:[]};var P=E,Z=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,e.apply(this,arguments))}return(0,s.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls;return a.createElement("table",{className:t+"-table",cellSpacing:"0",role:"grid"},a.createElement(g,e),a.createElement(P,e))},t}(a.Component),F=Z,L=n(12200);function A(e){var t=this.state.value.clone();t=t.month(e),this.setAndSelectValue(t)}var U=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return r.state={value:n.value},r}return(0,s.default)(t,e),t.prototype.componentWillReceiveProps=function(e){"value"in e&&this.setState({value:e.value})},t.prototype.setAndSelectValue=function(e){this.setState({value:e}),this.props.onSelect(e)},t.prototype.months=function(){for(var e=this.state.value.clone(),t=[],n=0,r=0;r<4;r++){t[r]=[];for(var o=0;o<3;o++){var i=I(e=e.month(n));t[r][o]={value:n,content:i,title:i},n++}}return t},t.prototype.render=function(){var e=this,t=this.props,n=this.state.value,r=D(n),o=this.months(),i=n.month(),s=t.prefixCls,l=t.locale,c=t.contentRender,d=t.cellRender,u=o.map((function(o,u){var p=o.map((function(o){var u,p=!1;if(t.disabledDate){var h=n.clone();h=h.month(o.value),p=t.disabledDate(h)}var f=((u={})[s+"-cell"]=1,u[s+"-cell-disabled"]=p,u[s+"-selected-cell"]=o.value===i,u[s+"-current-cell"]=r.year()===n.year()&&o.value===r.month(),u),m=void 0;if(d){var g=n.clone();g=g.month(o.value),m=d(g,l)}else{var v=void 0;if(c){var x=n.clone();x=x.month(o.value),v=c(x,l)}else v=o.content;m=a.createElement("a",{className:s+"-month"},v)}return a.createElement("td",{role:"gridcell",key:o.value,onClick:p?null:A.bind(e,o.value),title:o.title,className:y()(f)},m)}));return a.createElement("tr",{key:u,role:"row"},p)}));return a.createElement("table",{className:s+"-table",cellSpacing:"0",role:"grid"},a.createElement("tbody",{className:s+"-tbody"},u))},t}(a.Component);U.defaultProps={onSelect:function(){}},U.propTypes={onSelect:d().func,cellRender:d().func,prefixCls:d().string,value:d().object};var z=U;function B(e){this.props.changeYear(e)}function G(){}var H=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return r.setAndSelectValue=function(e){r.setValue(e),r.props.onSelect(e)},r.setValue=function(e){"value"in r.props&&r.setState({value:e})},r.nextYear=B.bind(r,1),r.previousYear=B.bind(r,-1),r.prefixCls=n.rootPrefixCls+"-month-panel",r.state={value:n.value||n.defaultValue},r}return(0,s.default)(t,e),t.getDerivedStateFromProps=function(e){var t={};return"value"in e&&(t={value:e.value}),t},t.prototype.render=function(){var e=this.props,t=this.state.value,n=e.locale,r=e.cellRender,o=e.contentRender,i=e.renderFooter,s=t.year(),l=this.prefixCls,c=i&&i("month");return a.createElement("div",{className:l,style:e.style},a.createElement("div",null,a.createElement("div",{className:l+"-header"},a.createElement("a",{className:l+"-prev-year-btn",role:"button",onClick:this.previousYear,title:n.previousYear}),a.createElement("a",{className:l+"-year-select",role:"button",onClick:e.onYearPanelShow,title:n.yearSelect},a.createElement("span",{className:l+"-year-select-content"},s),a.createElement("span",{className:l+"-year-select-arrow"},"x")),a.createElement("a",{className:l+"-next-year-btn",role:"button",onClick:this.nextYear,title:n.nextYear})),a.createElement("div",{className:l+"-body"},a.createElement(z,{disabledDate:e.disabledDate,onSelect:this.setAndSelectValue,locale:n,value:t,cellRender:r,contentRender:o,prefixCls:l})),c&&a.createElement("div",{className:l+"-footer"},c)))},t}(a.Component);H.propTypes={onChange:d().func,disabledDate:d().func,onSelect:d().func,renderFooter:d().func,rootPrefixCls:d().string,value:d().object,defaultValue:d().object},H.defaultProps={onChange:G,onSelect:G},(0,p.polyfill)(H);var Y=H;function V(e){var t=this.state.value.clone();t=t.add(e,"year"),this.setState({value:t})}function W(e){var t=this.state.value.clone();t=(t=t.year(e)).month(this.state.value.month()),this.setState({value:t}),this.props.onSelect(t)}var K=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return r.prefixCls=n.rootPrefixCls+"-year-panel",r.state={value:n.value||n.defaultValue},r.nextDecade=V.bind(r,10),r.previousDecade=V.bind(r,-10),r}return(0,s.default)(t,e),t.prototype.years=function(){for(var e=this.state.value.year(),t=10*parseInt(e/10,10)-1,n=[],r=0,o=0;o<4;o++){n[o]=[];for(var i=0;i<3;i++){var s=t+r,a=String(s);n[o][i]={content:a,year:s,title:a},r++}}return n},t.prototype.render=function(){var e=this,t=this.props,n=this.state.value,r=t.locale,o=t.renderFooter,i=this.years(),s=n.year(),l=10*parseInt(s/10,10),c=l+9,d=this.prefixCls,u=i.map((function(t,n){var r=t.map((function(t){var n,r=((n={})[d+"-cell"]=1,n[d+"-selected-cell"]=t.year===s,n);return a.createElement("td",{role:"gridcell",title:t.title,key:t.content,onClick:W.bind(e,t.year),className:y()(r)},a.createElement("a",{className:d+"-year"},t.content))}));return a.createElement("tr",{key:n,role:"row"},r)})),p=o&&o("year");return a.createElement("div",{className:this.prefixCls},a.createElement("div",null,a.createElement("div",{className:d+"-header"},a.createElement("a",{className:d+"-prev-decade-btn",role:"button",onClick:this.previousDecade,title:r.previousDecade}),a.createElement("a",{className:d+"-decade-select",role:"button",onClick:t.onDecadePanelShow,title:r.decadeSelect},a.createElement("span",{className:d+"-decade-select-content"},l,"-",c),a.createElement("span",{className:d+"-decade-select-arrow"},"x")),a.createElement("a",{className:d+"-next-decade-btn",role:"button",onClick:this.nextDecade,title:r.nextDecade})),a.createElement("div",{className:d+"-body"},a.createElement("table",{className:d+"-table",cellSpacing:"0",role:"grid"},a.createElement("tbody",{className:d+"-tbody"},u))),p&&a.createElement("div",{className:d+"-footer"},p)))},t}(a.Component),q=K;K.propTypes={rootPrefixCls:d().string,value:d().object,defaultValue:d().object,renderFooter:d().func},K.defaultProps={onSelect:function(){}};function $(e){var t=this.state.value.clone();t=t.add(e,"years"),this.setState({value:t})}function X(e,t){var n=this.state.value.clone();n=(n=n.year(e)).month(this.state.value.month()),this.props.onSelect(n),t.preventDefault()}var J=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return r.state={value:n.value||n.defaultValue},r.prefixCls=n.rootPrefixCls+"-decade-panel",r.nextCentury=$.bind(r,100),r.previousCentury=$.bind(r,-100),r}return(0,s.default)(t,e),t.prototype.render=function(){for(var e=this,t=this.state.value,n=this.props,r=n.locale,o=n.renderFooter,i=t.year(),s=100*parseInt(i/100,10),l=s-10,c=s+99,d=[],u=0,p=this.prefixCls,h=0;h<4;h++){d[h]=[];for(var f=0;f<3;f++){var m=l+10*u,g=l+10*u+9;d[h][f]={startDecade:m,endDecade:g},u++}}var v=o&&o("decade"),x=d.map((function(t,n){var r=t.map((function(t){var n,r=t.startDecade,o=t.endDecade,l=r<s,d=o>c,u=((n={})[p+"-cell"]=1,n[p+"-selected-cell"]=r<=i&&i<=o,n[p+"-last-century-cell"]=l,n[p+"-next-century-cell"]=d,n),h=r+"-"+o,f=void 0;return f=l?e.previousCentury:d?e.nextCentury:X.bind(e,r),a.createElement("td",{key:r,onClick:f,role:"gridcell",className:y()(u)},a.createElement("a",{className:p+"-decade"},h))}));return a.createElement("tr",{key:n,role:"row"},r)}));return a.createElement("div",{className:this.prefixCls},a.createElement("div",{className:p+"-header"},a.createElement("a",{className:p+"-prev-century-btn",role:"button",onClick:this.previousCentury,title:r.previousCentury}),a.createElement("div",{className:p+"-century"},s,"-",c),a.createElement("a",{className:p+"-next-century-btn",role:"button",onClick:this.nextCentury,title:r.nextCentury})),a.createElement("div",{className:p+"-body"},a.createElement("table",{className:p+"-table",cellSpacing:"0",role:"grid"},a.createElement("tbody",{className:p+"-tbody"},x))),v&&a.createElement("div",{className:p+"-footer"},v))},t}(a.Component),Q=J;function ee(e){var t=this.props.value.clone();t=t.add(e,"months"),this.props.onValueChange(t)}function te(e){var t=this.props.value.clone();t=t.add(e,"years"),this.props.onValueChange(t)}function ne(e,t){return e?t:null}J.propTypes={locale:d().object,value:d().object,defaultValue:d().object,rootPrefixCls:d().string,renderFooter:d().func},J.defaultProps={onSelect:function(){}};var re=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return oe.call(r),r.nextMonth=ee.bind(r,1),r.previousMonth=ee.bind(r,-1),r.nextYear=te.bind(r,1),r.previousYear=te.bind(r,-1),r.state={yearPanelReferer:null},r}return(0,s.default)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.prefixCls,r=t.locale,o=t.mode,i=t.value,s=t.showTimePicker,l=t.enableNext,c=t.enablePrev,d=t.disabledMonth,u=t.renderFooter,p=null;return"month"===o&&(p=a.createElement(Y,{locale:r,value:i,rootPrefixCls:n,onSelect:this.onMonthSelect,onYearPanelShow:function(){return e.showYearPanel("month")},disabledDate:d,cellRender:t.monthCellRender,contentRender:t.monthCellContentRender,renderFooter:u,changeYear:this.changeYear})),"year"===o&&(p=a.createElement(q,{locale:r,defaultValue:i,rootPrefixCls:n,onSelect:this.onYearSelect,onDecadePanelShow:this.showDecadePanel,renderFooter:u})),"decade"===o&&(p=a.createElement(Q,{locale:r,defaultValue:i,rootPrefixCls:n,onSelect:this.onDecadeSelect,renderFooter:u})),a.createElement("div",{className:n+"-header"},a.createElement("div",{style:{position:"relative"}},ne(c&&!s,a.createElement("a",{className:n+"-prev-year-btn",role:"button",onClick:this.previousYear,title:r.previousYear})),ne(c&&!s,a.createElement("a",{className:n+"-prev-month-btn",role:"button",onClick:this.previousMonth,title:r.previousMonth})),this.monthYearElement(s),ne(l&&!s,a.createElement("a",{className:n+"-next-month-btn",onClick:this.nextMonth,title:r.nextMonth})),ne(l&&!s,a.createElement("a",{className:n+"-next-year-btn",onClick:this.nextYear,title:r.nextYear}))),p)},t}(a.Component);re.propTypes={prefixCls:d().string,value:d().object,onValueChange:d().func,showTimePicker:d().bool,onPanelChange:d().func,locale:d().object,enablePrev:d().any,enableNext:d().any,disabledMonth:d().func,renderFooter:d().func,onMonthSelect:d().func},re.defaultProps={enableNext:1,enablePrev:1,onPanelChange:function(){},onValueChange:function(){}};var oe=function(){var e=this;this.onMonthSelect=function(t){e.props.onPanelChange(t,"date"),e.props.onMonthSelect?e.props.onMonthSelect(t):e.props.onValueChange(t)},this.onYearSelect=function(t){var n=e.state.yearPanelReferer;e.setState({yearPanelReferer:null}),e.props.onPanelChange(t,n),e.props.onValueChange(t)},this.onDecadeSelect=function(t){e.props.onPanelChange(t,"year"),e.props.onValueChange(t)},this.changeYear=function(t){t>0?e.nextYear():e.previousYear()},this.monthYearElement=function(t){var n=e.props,r=n.prefixCls,o=n.locale,i=n.value,s=i.localeData(),l=o.monthBeforeYear,c=r+"-"+(l?"my-select":"ym-select"),d=t?" "+r+"-time-status":"",u=a.createElement("a",{className:r+"-year-select"+d,role:"button",onClick:t?null:function(){return e.showYearPanel("date")},title:t?null:o.yearSelect},i.format(o.yearFormat)),p=a.createElement("a",{className:r+"-month-select"+d,role:"button",onClick:t?null:e.showMonthPanel,title:t?null:o.monthSelect},o.monthFormat?i.format(o.monthFormat):s.monthsShort(i)),h=void 0;t&&(h=a.createElement("a",{className:r+"-day-select"+d,role:"button"},i.format(o.dayFormat)));var f=[];return f=l?[p,h,u]:[u,p,h],a.createElement("span",{className:c},(0,L.Z)(f))},this.showMonthPanel=function(){e.props.onPanelChange(null,"month")},this.showYearPanel=function(t){e.setState({yearPanelReferer:t}),e.props.onPanelChange(null,"year")},this.showDecadePanel=function(){e.props.onPanelChange(null,"decade")}},ie=re;function se(e){var t=e.prefixCls,n=e.locale,r=e.value,o=e.timePicker,i=e.disabled,s=e.disabledDate,l=e.onToday,c=e.text,d=(!c&&o?n.now:c)||n.today,u=s&&!_(D(r),s)||i,p=u?t+"-today-btn-disabled":"";return a.createElement("a",{className:t+"-today-btn "+p,role:"button",onClick:u?null:l,title:j(r)},d)}function ae(e){var t=e.prefixCls,n=e.locale,r=e.okDisabled,o=e.onOk,i=t+"-ok-btn";return r&&(i+=" "+t+"-ok-btn-disabled"),a.createElement("a",{className:i,role:"button",onClick:r?null:o},n.ok)}function le(e){var t,n=e.prefixCls,r=e.locale,o=e.showTimePicker,i=e.onOpenTimePicker,s=e.onCloseTimePicker,l=e.timePickerDisabled,c=y()(((t={})[n+"-time-picker-btn"]=!0,t[n+"-time-picker-btn-disabled"]=l,t)),d=null;return l||(d=o?s:i),a.createElement("a",{className:c,role:"button",onClick:d},o?r.dateSelect:r.timeSelect)}var ce=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,e.apply(this,arguments))}return(0,s.default)(t,e),t.prototype.onSelect=function(e){this.props.onSelect(e)},t.prototype.getRootDOMNode=function(){return l.findDOMNode(this)},t.prototype.render=function(){var e=this.props,t=e.value,n=e.prefixCls,o=e.showOk,i=e.timePicker,s=e.renderFooter,l=e.mode,c=null,d=s&&s(l);if(e.showToday||i||d){var u,p=void 0;e.showToday&&(p=a.createElement(se,(0,r.default)({},e,{value:t})));var h=void 0;(!0===o||!1!==o&&e.timePicker)&&(h=a.createElement(ae,e));var f=void 0;e.timePicker&&(f=a.createElement(le,e));var m=void 0;(p||f||h||d)&&(m=a.createElement("span",{className:n+"-footer-btn"},d,(0,L.Z)([p,f,h])));var g=y()(n+"-footer",((u={})[n+"-footer-show-ok"]=h,u));c=a.createElement("div",{className:g},m)}return c},t}(a.Component);ce.propTypes={prefixCls:d().string,showDateInput:d().bool,disabledTime:d().any,timePicker:d().element,selectedValue:d().any,showOk:d().bool,onSelect:d().func,value:d().object,renderFooter:d().func,defaultValue:d().object,mode:d().string};var de=ce,ue=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return r.onSelect=function(e){r.setState({highlightTime:e}),r.props.onSelect(e),r.props.onClickRightPanelTime()},r.getTimes=function(){for(var e=[],t=0;t<24;t++){var n=(String(t)+":00").padStart(5,"0"),r=(String(t)+":30").padStart(5,"0");e.push(n),e.push(r)}return e},r.scrollUp=function(){r.timeRef.current.scrollBy(0,-200)},r.scrollDown=function(){r.timeRef.current.scrollBy(0,200)},r.state={highlightTime:r.props.value||null},r.timeRef=a.createRef(),r.times=r.getTimes(),r}return(0,s.default)(t,e),t.prototype.componentDidMount=function(){var e=this.props.defaultMinutesTime,t=this.times.findIndex((function(t){return t===e})),n=t>-1?t:16;this.timeRef.current.scrollTo(0,34*n)},t.prototype.render=function(){var e=this,t=this.props,n=t.value,r=t.prefixCls,o=t.locale,i=n.format().slice(0,10),s=this.state.highlightTime,l=s?s.format().slice(11,16):null,c=o&&"\u4eca\u5929"===o.today;return a.createElement("div",{className:r+"-right-panel"},a.createElement("div",{className:r+"-right-panel-header",onClick:this.scrollUp},a.createElement("span",null)),a.createElement("div",{className:r+"-right-panel-body",ref:this.timeRef},a.createElement("ul",null,this.times.map((function(t){var n=f()(i+" "+t);return n=c?n.locale("zh-cn"):n.locale("en-gb"),a.createElement("li",{key:t,onClick:e.onSelect.bind(e,n),className:l===t?r+"-selected-time":""},t)})))),a.createElement("div",{className:r+"-right-panel-footer",onClick:this.scrollDown},a.createElement("span",null)))},t}(a.Component);ue.propTypes={prefixCls:d().string,value:d().object,onSelect:d().func,onClickRightPanelTime:d().func,locale:d().object,defaultMinutesTime:d().string};var pe=ue;function he(e){return e?D(e):f()()}var fe={value:d().object,defaultValue:d().object,onKeyDown:d().func},me={onKeyDown:function(){}};function ge(){}var ve={className:d().string,locale:d().object,style:d().object,visible:d().bool,onSelect:d().func,prefixCls:d().string,onChange:d().func,onOk:d().func},ye={locale:{today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},style:{},visible:!0,prefixCls:"rc-calendar",className:"",onSelect:ge,onChange:ge,onClear:ge,renderFooter:function(){return null},renderSidebar:function(){return null}},xe=void 0,we=void 0,be=void 0,Se=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));Ce.call(r);var s=n.selectedValue;return r.state={str:N(s,r.props.format),invalid:!1,hasFocus:!1},r}return(0,s.default)(t,e),t.prototype.componentDidUpdate=function(){!be||!this.state.hasFocus||this.state.invalid||0===xe&&0===we||be.setSelectionRange(xe,we)},t.getDerivedStateFromProps=function(e,t){var n={};be&&(xe=be.selectionStart,we=be.selectionEnd);var r=e.selectedValue;return t.hasFocus||(n={str:N(r,e.format),invalid:!1}),n},t.getInstance=function(){return be},t.prototype.render=function(){var e=this.props,t=this.state,n=t.invalid,r=t.str,o=e.locale,i=e.prefixCls,s=e.placeholder,l=e.clearIcon,c=e.inputMode,d=n?i+"-input-invalid":"";return a.createElement("div",{className:i+"-input-wrap"},a.createElement("div",{className:i+"-date-input-wrap"},a.createElement("input",{ref:this.saveDateInput,className:i+"-input "+d,value:r,disabled:e.disabled,placeholder:s,onChange:this.onInputChange,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,inputMode:c})),e.showClear?a.createElement("a",{role:"button",title:o.clear,onClick:this.onClear},l||a.createElement("span",{className:i+"-clear-btn"})):null)},t}(a.Component);Se.propTypes={prefixCls:d().string,timePicker:d().object,value:d().object,disabledTime:d().any,format:d().oneOfType([d().string,d().arrayOf(d().string)]),locale:d().object,disabledDate:d().func,onChange:d().func,onClear:d().func,placeholder:d().string,onSelect:d().func,selectedValue:d().object,clearIcon:d().node,inputMode:d().string};var Ce=function(){var e=this;this.onClear=function(){e.setState({str:""}),e.props.onClear(null)},this.onInputChange=function(t){var n=t.target.value,r=e.props,o=r.disabledDate,i=r.format,s=r.onChange,a=r.selectedValue;if(!n)return s(null),void e.setState({invalid:!1,str:n});var l=f()(n,i,!0);if(l.isValid()){var c=e.props.value.clone();!(c=c.year(l.year()).month(l.month()).date(l.date()).hour(l.hour()).minute(l.minute()).second(l.second()))||o&&o(c)?e.setState({invalid:!0,str:n}):(a!==c||a&&c&&!a.isSame(c))&&(e.setState({invalid:!1,str:n}),s(c))}else e.setState({invalid:!0,str:n})},this.onFocus=function(){e.setState({hasFocus:!0})},this.onBlur=function(){e.setState((function(e,t){return{hasFocus:!1,str:N(t.value,t.format)}}))},this.onKeyDown=function(t){var n=t.keyCode,r=e.props,o=r.onSelect,i=r.value,s=r.disabledDate;n===u.Z.ENTER&&o&&((!s||!s(i))&&o(i.clone()),t.preventDefault())},this.getRootDOMNode=function(){return l.findDOMNode(e)},this.focus=function(){be&&be.focus()},this.saveDateInput=function(e){be=e}};(0,p.polyfill)(Se);var De=Se;var ke=n(86527),je=n.n(ke),Ie=n(33959),Me=n.n(Ie);function _e(){}f().extend(S()),f().extend(je()),f().extend(Me());var Ne=function(e){return!(!f().isDayjs(e)||!e.isValid())&&e},Re=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return Te.call(r),r.state={mode:r.props.mode||"date",value:Ne(n.value)||Ne(n.defaultValue)||f()(),selectedValue:n.selectedValue||n.defaultSelectedValue},r}return(0,s.default)(t,e),t.prototype.componentDidMount=function(){this.props.showDateInput&&this.saveFocusElement(De.getInstance())},t.getDerivedStateFromProps=function(e,t){var n=e.value,r=e.selectedValue,o={};return"mode"in e&&t.mode!==e.mode&&(o={mode:e.mode}),"value"in e&&(o.value=Ne(n)||Ne(e.defaultValue)||he(t.value)),"selectedValue"in e&&(o.selectedValue=r),o},t.prototype.render=function(){var e=this.props,t=this.state,n=e.locale,o=e.prefixCls,i=e.disabledDate,s=e.dateInputPlaceholder,l=e.timePicker,c=e.onClickRightPanelTime,d=e.disabledTime,u=e.clearIcon,p=e.renderFooter,h=e.inputMode,f=e.showHourAndMinute,m=t.value,g=t.selectedValue,v=t.mode,y="time"===v,x=y&&d&&l?M(g,d):null,w=null;if(l&&y){var b=(0,r.default)({showHour:!0,showSecond:!0,showMinute:!0},l.props,x,{onChange:this.onDateInputChange,value:g,disabledTime:d});void 0!==l.props.defaultValue&&(b.defaultOpenValue=l.props.defaultValue),w=a.cloneElement(l,b)}var S=e.showDateInput?a.createElement(De,{format:this.getFormat(),key:"date-input",value:m,locale:n,placeholder:s,showClear:!0,disabledTime:d,disabledDate:i,onClear:this.onClear,prefixCls:o,selectedValue:g,onChange:this.onDateInputChange,onSelect:this.onDateInputSelect,clearIcon:u,inputMode:h}):null,C=[];return e.renderSidebar&&C.push(e.renderSidebar()),C.push(a.createElement("div",{className:o+"-panel",key:"panel"},S,a.createElement("div",{className:o+"-date-panel-container"},a.createElement("div",{tabIndex:this.props.focusablePanel?0:void 0,className:o+"-date-panel"},a.createElement(ie,{locale:n,mode:v,value:m,onValueChange:this.setValue,onPanelChange:this.onPanelChange,renderFooter:p,showTimePicker:y,prefixCls:o}),l&&y?a.createElement("div",{className:o+"-time-picker"},a.createElement("div",{className:o+"-time-picker-panel"},w)):null,a.createElement("div",{className:o+"-body"},a.createElement(F,{locale:n,value:m,selectedValue:g,prefixCls:o,dateRender:e.dateRender,onSelect:this.onDateTableSelect,disabledDate:i,showWeekNumber:e.showWeekNumber})),a.createElement(de,{showOk:e.showOk,mode:v,renderFooter:e.renderFooter,locale:n,prefixCls:o,showToday:e.showToday,disabledTime:d,showTimePicker:y,showDateInput:e.showDateInput,timePicker:l,selectedValue:g,value:m,disabledDate:i,okDisabled:!1!==e.showOk&&(!g||!this.isAllowedDate(g)),onOk:this.onOk,onSelect:this.onSelect,onToday:this.onToday,onOpenTimePicker:this.openTimePicker,onCloseTimePicker:this.closeTimePicker})),f&&a.createElement(pe,{prefixCls:o,value:m,locale:n,onSelect:this.onDateTableSelect,onClickRightPanelTime:c,defaultMinutesTime:this.props.defaultMinutesTime})))),this.renderRoot({children:C,className:e.showWeekNumber?o+"-week-number":""})},t}(a.Component);Re.propTypes=(0,r.default)({},fe,ve,{prefixCls:d().string,className:d().string,style:d().object,defaultValue:d().object,value:d().object,selectedValue:d().object,defaultSelectedValue:d().object,mode:d().oneOf(["time","date","month","year","decade"]),locale:d().object,showDateInput:d().bool,showWeekNumber:d().bool,showToday:d().bool,showOk:d().bool,showHourAndMinute:d().bool,defaultMinutesTime:d().string,onSelect:d().func,onOk:d().func,onKeyDown:d().func,timePicker:d().element,dateInputPlaceholder:d().any,onClear:d().func,onChange:d().func,onPanelChange:d().func,disabledDate:d().func,disabledTime:d().any,dateRender:d().func,renderFooter:d().func,renderSidebar:d().func,clearIcon:d().node,focusablePanel:d().bool,inputMode:d().string,onBlur:d().func,onClickRightPanelTime:d().func}),Re.defaultProps=(0,r.default)({},me,ye,{showToday:!0,showDateInput:!0,showHourAndMinute:!1,timePicker:null,onOk:_e,onPanelChange:_e,onClickRightPanelTime:_e,focusablePanel:!0});var Te=function(){var e=this;this.onPanelChange=function(t,n){var r=e.props,o=e.state;"mode"in r||e.setState({mode:n}),r.onPanelChange(t||o.value,n)},this.onKeyDown=function(t){if("input"!==t.target.nodeName.toLowerCase()){var n=t.keyCode,r=t.ctrlKey||t.metaKey,o=e.props.disabledDate,i=e.state.value;switch(n){case u.Z.DOWN:return e.goTime(1,"weeks"),t.preventDefault(),1;case u.Z.UP:return e.goTime(-1,"weeks"),t.preventDefault(),1;case u.Z.LEFT:return r?e.goTime(-1,"years"):e.goTime(-1,"days"),t.preventDefault(),1;case u.Z.RIGHT:return r?e.goTime(1,"years"):e.goTime(1,"days"),t.preventDefault(),1;case u.Z.HOME:return e.setValue(e.state.value.clone().startOf("month")),t.preventDefault(),1;case u.Z.END:return e.setValue(function(e){return e.clone().endOf("month")}(e.state.value)),t.preventDefault(),1;case u.Z.PAGE_DOWN:return e.goTime(1,"month"),t.preventDefault(),1;case u.Z.PAGE_UP:return e.goTime(-1,"month"),t.preventDefault(),1;case u.Z.ENTER:return o&&o(i)||e.onSelect(i,{source:"keyboard"}),t.preventDefault(),1;default:return e.props.onKeyDown(t),1}}},this.onClear=function(){e.onSelect(null),e.props.onClear()},this.onOk=function(){var t=e.state.selectedValue;e.isAllowedDate(t)&&e.props.onOk(t)},this.onDateInputChange=function(t){e.onSelect(t,{source:"dateInput"})},this.onDateInputSelect=function(t){e.onSelect(t,{source:"dateInputSelect"})},this.onDateTableSelect=function(t){var n,r,o=e.props.timePicker;if(!e.state.selectedValue&&o){var i=o.props.defaultValue;i&&(n=i,r=t,f().isDayjs(n)&&f().isDayjs(r)&&(r=(r=(r=(r=r.hour(n.hour())).minute(n.minute())).second(n.second())).millisecond(n.millisecond())))}e.onSelect(t)},this.onToday=function(){var t=D(e.state.value);e.onSelect(t,{source:"todayButton"})},this.onBlur=function(t){setTimeout((function(){var n=De.getInstance(),r=e.rootInstance;!r||r.contains(document.activeElement)||n&&n.contains(document.activeElement)||e.props.onBlur&&e.props.onBlur(t)}),0)},this.getRootDOMNode=function(){return l.findDOMNode(e)},this.openTimePicker=function(){e.onPanelChange(null,"time")},this.closeTimePicker=function(){e.onPanelChange(null,"date")},this.goTime=function(t,n){e.setValue(function(e,t,n){return e.clone().add(t,n)}(e.state.value,t,n))}};(0,p.polyfill)(Re);var Oe=function(e){var t,n;return n=t=function(t){function n(){var e,r,s;(0,o.default)(this,n);for(var l=arguments.length,c=Array(l),d=0;d<l;d++)c[d]=arguments[d];return e=r=(0,i.default)(this,t.call.apply(t,[this].concat(c))),r.onSelect=function(e,t){e&&r.setValue(e),r.setSelectedValue(e,t)},r.renderRoot=function(e){var t,n=r.props,o=n.prefixCls,i=((t={})[o]=1,t[o+"-hidden"]=!n.visible,t[n.className]=!!n.className,t[e.className]=!!e.className,t);return a.createElement("div",{ref:r.saveRoot,className:""+y()(i),style:r.props.style,tabIndex:"0",onKeyDown:r.onKeyDown,onBlur:r.onBlur},e.children)},r.setSelectedValue=function(e,t){"selectedValue"in r.props||r.setState({selectedValue:e}),r.props.onSelect&&r.props.onSelect(e,t)},r.setValue=function(e){var t=r.state.value;"value"in r.props||r.setState({value:e}),(t&&e&&!t.isSame(e)||!t&&e||t&&!e)&&r.props.onChange(e)},r.isAllowedDate=function(e){return _(e,r.props.disabledDate,r.props.disabledTime)},s=e,(0,i.default)(r,s)}return(0,s.default)(n,t),n.getDerivedStateFromProps=function(t,n){if(e.getDerivedStateFromProps)return e.getDerivedStateFromProps(t,n);var r=t.value,o=t.selectedValue,i={};return"value"in t&&(i.value=r||t.defaultValue||he(n.value)),"selectedValue"in t&&(i.selectedValue=o),i},n}(e),t.displayName="CalendarMixinWrapper",t.defaultProps=e.defaultProps,n}(function(e){var t,n;return n=t=function(e){function t(){var n,r,s;(0,o.default)(this,t);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return n=r=(0,i.default)(this,e.call.apply(e,[this].concat(l))),r.getFormat=function(){var e=r.props.format,t=r.props,n=t.locale,o=t.timePicker;return e||(e=o?n.dateTimeFormat:n.dateFormat),e},r.focus=function(){r.focusElement?r.focusElement.focus():r.rootInstance&&r.rootInstance.focus()},r.saveFocusElement=function(e){r.focusElement=e},r.saveRoot=function(e){r.rootInstance=e},s=n,(0,i.default)(r,s)}return(0,s.default)(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.visible||e.visible},t}(e),t.displayName="CommonMixinWrapper",t.defaultProps=e.defaultProps,t.getDerivedStateFromProps=e.getDerivedStateFromProps,n}(Re)),Ee=Oe},64123:function(e,t,n){"use strict";t.__esModule=!0;var r=f(n(50420)),o=f(n(56583)),i=f(n(74401)),s=f(n(47313)),a=f(n(1168)),l=f(n(75192)),c=n(65886),d=f(n(49378)),u=f(n(83149)),p=f(n(3e3)),h=f(n(14147));function f(e){return e&&e.__esModule?e:{default:e}}function m(){}function g(e,t){this[e]=t}var v=function(e){function t(n){(0,r.default)(this,t);var i=(0,o.default)(this,e.call(this,n));y.call(i);var s=void 0;s="open"in n?n.open:n.defaultOpen;var a=n.value||n.defaultValue;return i.saveCalendarRef=g.bind(i,"calendarInstance"),i.state={open:s,value:a},i}return(0,i.default)(t,e),t.prototype.componentDidUpdate=function(e,t){!t.open&&this.state.open&&(this.focusTimeout=setTimeout(this.focusCalendar,0,this))},t.prototype.componentWillUnmount=function(){clearTimeout(this.focusTimeout)},t.getDerivedStateFromProps=function(e){var t={},n=e.value,r=e.open;return"value"in e&&(t.value=n),void 0!==r&&(t.open=r),t},t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.placement,r=e.style,o=e.getCalendarContainer,i=e.align,a=e.animation,l=e.disabled,c=e.dropdownClassName,d=e.transitionName,u=e.children,f=this.state;return s.default.createElement(h.default,{popup:this.getCalendarElement(),popupAlign:i,builtinPlacements:p.default,popupPlacement:n,action:l&&!f.open?[]:["click"],destroyPopupOnHide:!0,getPopupContainer:o,popupStyle:r,popupAnimation:a,popupTransitionName:d,popupVisible:f.open,onPopupVisibleChange:this.onVisibleChange,prefixCls:t,popupClassName:c},s.default.cloneElement(u(f,e),{onKeyDown:this.onKeyDown}))},t}(s.default.Component);v.propTypes={animation:l.default.oneOfType([l.default.func,l.default.string]),disabled:l.default.bool,transitionName:l.default.string,onChange:l.default.func,onOpenChange:l.default.func,children:l.default.func,getCalendarContainer:l.default.func,calendar:l.default.element,style:l.default.object,open:l.default.bool,defaultOpen:l.default.bool,prefixCls:l.default.string,placement:l.default.any,value:l.default.oneOfType([l.default.object,l.default.array]),defaultValue:l.default.oneOfType([l.default.object,l.default.array]),align:l.default.object,dateRender:l.default.func,onBlur:l.default.func},v.defaultProps={prefixCls:"rc-calendar-picker",style:{},align:{},placement:"bottomLeft",defaultOpen:!1,onChange:m,onOpenChange:m,onBlur:m};var y=function(){var e=this;this.onCalendarKeyDown=function(t){t.keyCode===u.default.ESC&&(t.stopPropagation(),e.close(e.focus))},this.onCalendarSelect=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.props;"value"in r||e.setState({value:t}),("keyboard"===n.source||"dateInputSelect"===n.source||!r.calendar.props.timePicker&&"dateInput"!==n.source||"todayButton"===n.source)&&e.close(e.focus),r.onChange(t)},this.onKeyDown=function(t){e.state.open||t.keyCode!==u.default.DOWN&&t.keyCode!==u.default.ENTER||(e.open(),t.preventDefault())},this.onCalendarOk=function(){e.close(e.focus)},this.onCalendarClear=function(){e.close(e.focus)},this.onCalendarBlur=function(){e.setOpen(!1)},this.onVisibleChange=function(t){e.setOpen(t)},this.getCalendarElement=function(){var t=e.props,n=e.state,r=t.calendar.props,o=n.value,i=o,a={ref:e.saveCalendarRef,defaultValue:i||r.defaultValue,selectedValue:o,onKeyDown:e.onCalendarKeyDown,onOk:(0,d.default)(r.onOk,e.onCalendarOk),onSelect:(0,d.default)(r.onSelect,e.onCalendarSelect),onClear:(0,d.default)(r.onClear,e.onCalendarClear),onBlur:(0,d.default)(r.onBlur,e.onCalendarBlur)};return s.default.cloneElement(t.calendar,a)},this.setOpen=function(t,n){var r=e.props.onOpenChange;e.state.open!==t&&("open"in e.props||e.setState({open:t},n),r(t))},this.open=function(t){e.setOpen(!0,t)},this.close=function(t){e.setOpen(!1,t)},this.focus=function(){e.state.open||a.default.findDOMNode(e).focus()},this.focusCalendar=function(){e.state.open&&e.calendarInstance&&e.calendarInstance.focus()}};(0,c.polyfill)(v),t.default=v,e.exports=t.default},91795:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Dnes",now:"Nyn\xed",backToToday:"Zp\u011bt na dne\u0161ek",ok:"Ok",clear:"Vymazat",month:"M\u011bs\xedc",year:"Rok",timeSelect:"Vybrat \u010das",dateSelect:"Vybrat datum",monthSelect:"Vyberte m\u011bs\xedc",yearSelect:"Vyberte rok",decadeSelect:"Vyberte dek\xe1du",yearFormat:"YYYY",dateFormat:"D.M.YYYY",dayFormat:"D",dateTimeFormat:"D.M.YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"P\u0159edchoz\xed m\u011bs\xedc (PageUp)",nextMonth:"N\xe1sleduj\xedc\xed (PageDown)",previousYear:"P\u0159edchoz\xed rok (Control + left)",nextYear:"N\xe1sleduj\xedc\xed rok (Control + right)",previousDecade:"P\u0159edchoz\xed dek\xe1da",nextDecade:"N\xe1sleduj\xedc\xed dek\xe1da",previousCentury:"P\u0159edchoz\xed stolet\xed",nextCentury:"N\xe1sleduj\xedc\xed stolet\xed"},e.exports=t.default},52961:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Heute",now:"Jetzt",backToToday:"Zur\xfcck zu Heute",ok:"OK",clear:"Zur\xfccksetzen",month:"Monat",year:"Jahr",timeSelect:"Zeit w\xe4hlen",dateSelect:"Datum w\xe4hlen",monthSelect:"W\xe4hle einen Monat",yearSelect:"W\xe4hle ein Jahr",decadeSelect:"W\xe4hle ein Jahrzehnt",yearFormat:"YYYY",dateFormat:"D.M.YYYY",dayFormat:"D",dateTimeFormat:"D.M.YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Vorheriger Monat (PageUp)",nextMonth:"N\xe4chster Monat (PageDown)",previousYear:"Vorheriges Jahr (Ctrl + left)",nextYear:"N\xe4chstes Jahr (Ctrl + right)",previousDecade:"Vorheriges Jahrzehnt",nextDecade:"N\xe4chstes Jahrzehnt",previousCentury:"Vorheriges Jahrhundert",nextCentury:"N\xe4chstes Jahrhundert"},e.exports=t.default},44613:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},e.exports=t.default},52017:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Hoy",now:"Ahora",backToToday:"Volver a hoy",ok:"Aceptar",clear:"Limpiar",month:"Mes",year:"A\xf1o",timeSelect:"Seleccionar hora",dateSelect:"Seleccionar fecha",monthSelect:"Elegir un mes",yearSelect:"Elegir un a\xf1o",decadeSelect:"Elegir una d\xe9cada",yearFormat:"YYYY",dateFormat:"D/M/YYYY",dayFormat:"D",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Mes anterior (PageUp)",nextMonth:"Mes siguiente (PageDown)",previousYear:"A\xf1o anterior (Control + left)",nextYear:"A\xf1o siguiente (Control + right)",previousDecade:"D\xe9cada anterior",nextDecade:"D\xe9cada siguiente",previousCentury:"Siglo anterior",nextCentury:"Siglo siguiente"},e.exports=t.default},60675:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Aujourd'hui",now:"Maintenant",backToToday:"Aujourd'hui",ok:"Ok",clear:"R\xe9tablir",month:"Mois",year:"Ann\xe9e",timeSelect:"S\xe9lectionner l'heure",dateSelect:"S\xe9lectionner la date",monthSelect:"Choisissez un mois",yearSelect:"Choisissez une ann\xe9e",decadeSelect:"Choisissez une d\xe9cennie",yearFormat:"YYYY",dateFormat:"DD/MM/YYYY",dayFormat:"DD",dateTimeFormat:"DD/MM/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Mois pr\xe9c\xe9dent (PageUp)",nextMonth:"Mois suivant (PageDown)",previousYear:"Ann\xe9e pr\xe9c\xe9dente (Ctrl + gauche)",nextYear:"Ann\xe9e prochaine (Ctrl + droite)",previousDecade:"D\xe9cennie pr\xe9c\xe9dente",nextDecade:"D\xe9cennie suivante",previousCentury:"Si\xe8cle pr\xe9c\xe9dent",nextCentury:"Si\xe8cle suivant"},e.exports=t.default},99949:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Dzisiaj",now:"Teraz",backToToday:"Ustaw dzisiaj",ok:"Ok",clear:"Wyczy\u015b\u0107",month:"Miesi\u0105c",year:"Rok",timeSelect:"Ustaw czas",dateSelect:"Ustaw dat\u0119",monthSelect:"Wybierz miesi\u0105c",yearSelect:"Wybierz rok",decadeSelect:"Wybierz dekad\u0119",yearFormat:"YYYY",dateFormat:"D/M/YYYY",dayFormat:"D",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Poprzedni miesi\u0105c (PageUp)",nextMonth:"Nast\u0119pny miesi\u0105c (PageDown)",previousYear:"Ostatni rok (Ctrl + left)",nextYear:"Nast\u0119pny rok (Ctrl + right)",previousDecade:"Ostatnia dekada",nextDecade:"Nast\u0119pna dekada",previousCentury:"Ostatni wiek",nextCentury:"Nast\u0119pny wiek"},e.exports=t.default},12250:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",now:"\u0421\u0435\u0439\u0447\u0430\u0441",backToToday:"\u0422\u0435\u043a\u0443\u0449\u0430\u044f \u0434\u0430\u0442\u0430",ok:"Ok",clear:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c",month:"\u041c\u0435\u0441\u044f\u0446",year:"\u0413\u043e\u0434",timeSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f",dateSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0430\u0442\u0443",monthSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043c\u0435\u0441\u044f\u0446",yearSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0433\u043e\u0434",decadeSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",yearFormat:"YYYY",dateFormat:"D-M-YYYY",dayFormat:"D",dateTimeFormat:"D-M-YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446 (PageUp)",nextMonth:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446 (PageDown)",previousYear:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u0433\u043e\u0434 (Control + left)",nextYear:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0433\u043e\u0434 (Control + right)",previousDecade:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0435 \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",nextDecade:"\u0421\u043b\u0435\u0434\u0443\u0449\u0435\u0435 \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",previousCentury:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u0432\u0435\u043a",nextCentury:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0432\u0435\u043a"},e.exports=t.default},18166:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u4eca\u5929",now:"\u6b64\u523b",backToToday:"\u8fd4\u56de\u4eca\u5929",ok:"\u786e\u5b9a",timeSelect:"\u9009\u62e9\u65f6\u95f4",dateSelect:"\u9009\u62e9\u65e5\u671f",weekSelect:"\u9009\u62e9\u5468",clear:"\u6e05\u9664",month:"\u6708",year:"\u5e74",previousMonth:"\u4e0a\u4e2a\u6708 (\u7ffb\u9875\u4e0a\u952e)",nextMonth:"\u4e0b\u4e2a\u6708 (\u7ffb\u9875\u4e0b\u952e)",monthSelect:"\u9009\u62e9\u6708\u4efd",yearSelect:"\u9009\u62e9\u5e74\u4efd",decadeSelect:"\u9009\u62e9\u5e74\u4ee3",yearFormat:"YYYY\u5e74",dayFormat:"D\u65e5",dateFormat:"YYYY\u5e74M\u6708D\u65e5",dateTimeFormat:"YYYY\u5e74M\u6708D\u65e5 HH\u65f6mm\u5206ss\u79d2",previousYear:"\u4e0a\u4e00\u5e74 (Control\u952e\u52a0\u5de6\u65b9\u5411\u952e)",nextYear:"\u4e0b\u4e00\u5e74 (Control\u952e\u52a0\u53f3\u65b9\u5411\u952e)",previousDecade:"\u4e0a\u4e00\u5e74\u4ee3",nextDecade:"\u4e0b\u4e00\u5e74\u4ee3",previousCentury:"\u4e0a\u4e00\u4e16\u7eaa",nextCentury:"\u4e0b\u4e00\u4e16\u7eaa"},e.exports=t.default},91449:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u4eca\u5929",now:"\u6b64\u523b",backToToday:"\u8fd4\u56de\u4eca\u5929",ok:"\u78ba\u5b9a",timeSelect:"\u9078\u64c7\u6642\u9593",dateSelect:"\u9078\u64c7\u65e5\u671f",clear:"\u6e05\u9664",month:"\u6708",year:"\u5e74",previousMonth:"\u4e0a\u500b\u6708 (\u7ffb\u9801\u4e0a\u9375)",nextMonth:"\u4e0b\u500b\u6708 (\u7ffb\u9801\u4e0b\u9375)",monthSelect:"\u9078\u64c7\u6708\u4efd",yearSelect:"\u9078\u64c7\u5e74\u4efd",decadeSelect:"\u9078\u64c7\u5e74\u4ee3",yearFormat:"YYYY\u5e74",dayFormat:"D\u65e5",dateFormat:"YYYY\u5e74M\u6708D\u65e5",dateTimeFormat:"YYYY\u5e74M\u6708D\u65e5 HH\u6642mm\u5206ss\u79d2",previousYear:"\u4e0a\u4e00\u5e74 (Control\u9375\u52a0\u5de6\u65b9\u5411\u9375)",nextYear:"\u4e0b\u4e00\u5e74 (Control\u9375\u52a0\u53f3\u65b9\u5411\u9375)",previousDecade:"\u4e0a\u4e00\u5e74\u4ee3",nextDecade:"\u4e0b\u4e00\u5e74\u4ee3",previousCentury:"\u4e0a\u4e00\u4e16\u7d00",nextCentury:"\u4e0b\u4e00\u4e16\u7d00"},e.exports=t.default},3e3:function(e,t){"use strict";t.__esModule=!0;var n={adjustX:1,adjustY:1},r=[0,0],o={bottomLeft:{points:["tl","tl"],overflow:n,offset:[0,-3],targetOffset:r},bottomRight:{points:["tr","tr"],overflow:n,offset:[0,-3],targetOffset:r},topRight:{points:["br","br"],overflow:n,offset:[0,3],targetOffset:r},topLeft:{points:["bl","bl"],overflow:n,offset:[0,3],targetOffset:r}};t.default=o,e.exports=t.default},78644:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,r="millisecond",o="second",i="minute",s="hour",a="day",l="week",c="month",d="quarter",u="year",p="date",h="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},v=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},y={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),o=n%60;return(t<=0?"+":"-")+v(r,2,"0")+":"+v(o,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),o=t.clone().add(r,c),i=n-o<0,s=t.clone().add(r+(i?-1:1),c);return+(-(r+(n-o)/(i?o-s:s-o))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:l,d:a,D:p,h:s,m:i,s:o,ms:r,Q:d}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},x="en",w={};w[x]=g;var b=function(e){return e instanceof k},S=function(e,t,n){var r;if(!e)return x;if("string"==typeof e)w[e]&&(r=e),t&&(w[e]=t,r=e);else{var o=e.name;w[o]=e,r=o}return!n&&r&&(x=r),r||!n&&x},C=function(e,t){if(b(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new k(n)},D=y;D.l=S,D.i=b,D.w=function(e,t){return C(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var k=function(){function g(e){this.$L=S(e.locale,null,!0),this.parse(e)}var v=g.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(D.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(f);if(r){var o=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return D},v.isValid=function(){return!(this.$d.toString()===h)},v.isSame=function(e,t){var n=C(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return C(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<C(e)},v.$g=function(e,t,n){return D.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,r=!!D.u(t)||t,d=D.p(e),h=function(e,t){var o=D.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?o:o.endOf(a)},f=function(e,t){return D.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(d){case u:return r?h(1,0):h(31,11);case c:return r?h(1,g):h(0,g+1);case l:var x=this.$locale().weekStart||0,w=(m<x?m+7:m)-x;return h(r?v-w:v+(6-w),g);case a:case p:return f(y+"Hours",0);case s:return f(y+"Minutes",1);case i:return f(y+"Seconds",2);case o:return f(y+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,l=D.p(e),d="set"+(this.$u?"UTC":""),h=(n={},n[a]=d+"Date",n[p]=d+"Date",n[c]=d+"Month",n[u]=d+"FullYear",n[s]=d+"Hours",n[i]=d+"Minutes",n[o]=d+"Seconds",n[r]=d+"Milliseconds",n)[l],f=l===a?this.$D+(t-this.$W):t;if(l===c||l===u){var m=this.clone().set(p,1);m.$d[h](f),m.init(),this.$d=m.set(p,Math.min(this.$D,m.daysInMonth())).$d}else h&&this.$d[h](f);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[D.p(e)]()},v.add=function(r,d){var p,h=this;r=Number(r);var f=D.p(d),m=function(e){var t=C(h);return D.w(t.date(t.date()+Math.round(e*r)),h)};if(f===c)return this.set(c,this.$M+r);if(f===u)return this.set(u,this.$y+r);if(f===a)return m(1);if(f===l)return m(7);var g=(p={},p[i]=t,p[s]=n,p[o]=e,p)[f]||1,v=this.$d.getTime()+r*g;return D.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var r=e||"YYYY-MM-DDTHH:mm:ssZ",o=D.z(this),i=this.$H,s=this.$m,a=this.$M,l=n.weekdays,c=n.months,d=function(e,n,o,i){return e&&(e[n]||e(t,r))||o[n].substr(0,i)},u=function(e){return D.s(i%12||12,e,"0")},p=n.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},f={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:D.s(a+1,2,"0"),MMM:d(n.monthsShort,a,c,3),MMMM:d(c,a),D:this.$D,DD:D.s(this.$D,2,"0"),d:String(this.$W),dd:d(n.weekdaysMin,this.$W,l,2),ddd:d(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(i),HH:D.s(i,2,"0"),h:u(1),hh:u(2),a:p(i,s,!0),A:p(i,s,!1),m:String(s),mm:D.s(s,2,"0"),s:String(this.$s),ss:D.s(this.$s,2,"0"),SSS:D.s(this.$ms,3,"0"),Z:o};return r.replace(m,(function(e,t){return t||f[e]||o.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(r,p,h){var f,m=D.p(p),g=C(r),v=(g.utcOffset()-this.utcOffset())*t,y=this-g,x=D.m(this,g);return x=(f={},f[u]=x/12,f[c]=x,f[d]=x/3,f[l]=(y-v)/6048e5,f[a]=(y-v)/864e5,f[s]=y/n,f[i]=y/t,f[o]=y/e,f)[m]||y,h?x:D.a(x)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return w[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=S(e,t,!0);return r&&(n.$L=r),n},v.clone=function(){return D.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},g}(),j=k.prototype;return C.prototype=j,[["$ms",r],["$s",o],["$m",i],["$H",s],["$W",a],["$M",c],["$y",u],["$D",p]].forEach((function(e){j[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),C.extend=function(e,t){return e.$i||(e(t,k,C),e.$i=!0),C},C.locale=S,C.isDayjs=b,C.unix=function(e){return C(1e3*e)},C.en=w[x],C.Ls=w,C.p={},C}()},5239:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r={name:"en-gb",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekStart:1,yearStart:4,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}};return n.default.locale(r,null,!0),r}(n(78644))},4815:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r={name:"zh-cn",weekdays:"\u661f\u671f\u65e5_\u661f\u671f\u4e00_\u661f\u671f\u4e8c_\u661f\u671f\u4e09_\u661f\u671f\u56db_\u661f\u671f\u4e94_\u661f\u671f\u516d".split("_"),weekdaysShort:"\u5468\u65e5_\u5468\u4e00_\u5468\u4e8c_\u5468\u4e09_\u5468\u56db_\u5468\u4e94_\u5468\u516d".split("_"),weekdaysMin:"\u65e5_\u4e00_\u4e8c_\u4e09_\u56db_\u4e94_\u516d".split("_"),months:"\u4e00\u6708_\u4e8c\u6708_\u4e09\u6708_\u56db\u6708_\u4e94\u6708_\u516d\u6708_\u4e03\u6708_\u516b\u6708_\u4e5d\u6708_\u5341\u6708_\u5341\u4e00\u6708_\u5341\u4e8c\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),ordinal:function(e,t){return"W"===t?e+"\u5468":e+"\u65e5"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5e74M\u6708D\u65e5",LLL:"YYYY\u5e74M\u6708D\u65e5Ah\u70b9mm\u5206",LLLL:"YYYY\u5e74M\u6708D\u65e5ddddAh\u70b9mm\u5206",l:"YYYY/M/D",ll:"YYYY\u5e74M\u6708D\u65e5",lll:"YYYY\u5e74M\u6708D\u65e5 HH:mm",llll:"YYYY\u5e74M\u6708D\u65e5dddd HH:mm"},relativeTime:{future:"%s\u5185",past:"%s\u524d",s:"\u51e0\u79d2",m:"1 \u5206\u949f",mm:"%d \u5206\u949f",h:"1 \u5c0f\u65f6",hh:"%d \u5c0f\u65f6",d:"1 \u5929",dd:"%d \u5929",M:"1 \u4e2a\u6708",MM:"%d \u4e2a\u6708",y:"1 \u5e74",yy:"%d \u5e74"},meridiem:function(e,t){var n=100*e+t;return n<600?"\u51cc\u6668":n<900?"\u65e9\u4e0a":n<1100?"\u4e0a\u5348":n<1300?"\u4e2d\u5348":n<1800?"\u4e0b\u5348":"\u665a\u4e0a"}};return n.default.locale(r,null,!0),r}(n(78644))},57823:function(e){e.exports=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,n=/\d\d/,r=/\d\d?/,o=/\d*[^\s\d-_:/()]+/,i={},s=function(e){return(e=+e)+(e>68?1900:2e3)},a=function(e){return function(t){this[e]=+t}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),n=60*t[1]+(+t[2]||0);return 0===n?0:"+"===t[0]?-n:n}(e)}],c=function(e){var t=i[e];return t&&(t.indexOf?t:t.s.concat(t.f))},d=function(e,t){var n,r=i.meridiem;if(r){for(var o=1;o<=24;o+=1)if(e.indexOf(r(o,0,t))>-1){n=o>12;break}}else n=e===(t?"pm":"PM");return n},u={A:[o,function(e){this.afternoon=d(e,!1)}],a:[o,function(e){this.afternoon=d(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[n,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[r,a("seconds")],ss:[r,a("seconds")],m:[r,a("minutes")],mm:[r,a("minutes")],H:[r,a("hours")],h:[r,a("hours")],HH:[r,a("hours")],hh:[r,a("hours")],D:[r,a("day")],DD:[n,a("day")],Do:[o,function(e){var t=i.ordinal,n=e.match(/\d+/);if(this.day=n[0],t)for(var r=1;r<=31;r+=1)t(r).replace(/\[|\]/g,"")===e&&(this.day=r)}],M:[r,a("month")],MM:[n,a("month")],MMM:[o,function(e){var t=c("months"),n=(c("monthsShort")||t.map((function(e){return e.substr(0,3)}))).indexOf(e)+1;if(n<1)throw new Error;this.month=n%12||n}],MMMM:[o,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,a("year")],YY:[n,function(e){this.year=s(e)}],YYYY:[/\d{4}/,a("year")],Z:l,ZZ:l};function p(n){var r,o;r=n,o=i&&i.formats;for(var s=(n=r.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,n,r){var i=r&&r.toUpperCase();return n||o[r]||e[r]||o[i].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))).match(t),a=s.length,l=0;l<a;l+=1){var c=s[l],d=u[c],p=d&&d[0],h=d&&d[1];s[l]=h?{regex:p,parser:h}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},n=0,r=0;n<a;n+=1){var o=s[n];if("string"==typeof o)r+=o.length;else{var i=o.regex,l=o.parser,c=e.substr(r),d=i.exec(c)[0];l.call(t,d),e=e.replace(d,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var n=e.hours;t?n<12&&(e.hours+=12):12===n&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,n){n.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(s=e.parseTwoDigitYear);var r=t.prototype,o=r.parse;r.parse=function(e){var t=e.date,r=e.utc,s=e.args;this.$u=r;var a=s[1];if("string"==typeof a){var l=!0===s[2],c=!0===s[3],d=l||c,u=s[2];c&&(u=s[2]),i=this.$locale(),!l&&u&&(i=n.Ls[u]),this.$d=function(e,t,n){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var r=p(t)(e),o=r.year,i=r.month,s=r.day,a=r.hours,l=r.minutes,c=r.seconds,d=r.milliseconds,u=r.zone,h=new Date,f=s||(o||i?1:h.getDate()),m=o||h.getFullYear(),g=0;o&&!i||(g=i>0?i-1:h.getMonth());var v=a||0,y=l||0,x=c||0,w=d||0;return u?new Date(Date.UTC(m,g,f,v,y,x,w+60*u.offset*1e3)):n?new Date(Date.UTC(m,g,f,v,y,x,w)):new Date(m,g,f,v,y,x,w)}catch(e){return new Date("")}}(t,a,r),this.init(),u&&!0!==u&&(this.$L=this.locale(u).$L),d&&t!=this.format(a)&&(this.$d=new Date("")),i={}}else if(a instanceof Array)for(var h=a.length,f=1;f<=h;f+=1){s[1]=a[f-1];var m=n.apply(this,s);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}f===h&&(this.$d=new Date(""))}else o.call(this,e)}}}()},86527:function(e){e.exports=function(){"use strict";return function(e,t,n){var r=t.prototype,o=function(e){return e&&(e.indexOf?e:e.s)},i=function(e,t,n,r,i){var s=e.name?e:e.$locale(),a=o(s[t]),l=o(s[n]),c=a||l.map((function(e){return e.substr(0,r)}));if(!i)return c;var d=s.weekStart;return c.map((function(e,t){return c[(t+(d||0))%7]}))},s=function(){return n.Ls[n.locale()]},a=function(e,t){return e.formats[t]||function(e){return e.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}(e.formats[t.toUpperCase()])},l=function(){var e=this;return{months:function(t){return t?t.format("MMMM"):i(e,"months")},monthsShort:function(t){return t?t.format("MMM"):i(e,"monthsShort","months",3)},firstDayOfWeek:function(){return e.$locale().weekStart||0},weekdays:function(t){return t?t.format("dddd"):i(e,"weekdays")},weekdaysMin:function(t){return t?t.format("dd"):i(e,"weekdaysMin","weekdays",2)},weekdaysShort:function(t){return t?t.format("ddd"):i(e,"weekdaysShort","weekdays",3)},longDateFormat:function(t){return a(e.$locale(),t)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};r.localeData=function(){return l.bind(this)()},n.localeData=function(){var e=s();return{firstDayOfWeek:function(){return e.weekStart||0},weekdays:function(){return n.weekdays()},weekdaysShort:function(){return n.weekdaysShort()},weekdaysMin:function(){return n.weekdaysMin()},months:function(){return n.months()},monthsShort:function(){return n.monthsShort()},longDateFormat:function(t){return a(e,t)},meridiem:e.meridiem,ordinal:e.ordinal}},n.months=function(){return i(s(),"months")},n.monthsShort=function(){return i(s(),"monthsShort","months",3)},n.weekdays=function(e){return i(s(),"weekdays",null,null,e)},n.weekdaysShort=function(e){return i(s(),"weekdaysShort","weekdays",3,e)},n.weekdaysMin=function(e){return i(s(),"weekdaysMin","weekdays",2,e)}}}()},14063:function(e){e.exports=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(r,o,i){var s=o.prototype;i.utc=function(e){return new o({date:e,utc:!0,args:arguments})},s.utc=function(t){var n=i(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},s.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var a=s.parse;s.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),a.call(this,e)};var l=s.init;s.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var c=s.utcOffset;s.utcOffset=function(r,o){var i=this.$utils().u;if(i(r))return this.$u?0:i(this.$offset)?c.call(this):this.$offset;if("string"==typeof r&&null===(r=function(e){void 0===e&&(e="");var r=e.match(t);if(!r)return null;var o=(""+r[0]).match(n)||["-",0,0],i=o[0],s=60*+o[1]+ +o[2];return 0===s?0:"+"===i?s:-s}(r)))return this;var s=Math.abs(r)<=16?60*r:r,a=this;if(o)return a.$offset=s,a.$u=0===r,a;if(0!==r){var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(a=this.local().add(s+l,e)).$offset=s,a.$x.$localOffset=l}else a=this.utc();return a};var d=s.format;s.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return d.call(this,t)},s.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||(new Date).getTimezoneOffset());return this.$d.valueOf()-6e4*e},s.isUTC=function(){return!!this.$u},s.toISOString=function(){return this.toDate().toISOString()},s.toString=function(){return this.toDate().toUTCString()};var u=s.toDate;s.toDate=function(e){return"s"===e&&this.$offset?i(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():u.call(this)};var p=s.diff;s.diff=function(e,t,n){if(e&&this.$u===e.$u)return p.call(this,e,t,n);var r=this.local(),o=i(e).local();return p.call(r,o,t,n)}}}()},33959:function(e){e.exports=function(){"use strict";var e="week",t="year";return function(n,r,o){var i=r.prototype;i.week=function(n){if(void 0===n&&(n=null),null!==n)return this.add(7*(n-this.week()),"day");var r=this.$locale().yearStart||1;if(11===this.month()&&this.date()>25){var i=o(this).startOf(t).add(1,t).date(r),s=o(this).endOf(e);if(i.isBefore(s))return 1}var a=o(this).startOf(t).date(r).startOf(e).subtract(1,"millisecond"),l=this.diff(a,e,!0);return l<0?o(this).startOf("week").week():Math.ceil(l)},i.weeks=function(e){return void 0===e&&(e=null),this.week(e)}}}()},41433:function(e){function t(){}e.exports=function(e,n,r){var o=!1;return r=r||t,i.count=e,0===e?n():i;function i(e,t){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,n(e),n=r):0!==i.count||o||n(null,t)}}},72855:function(e){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)i[a]=o[s];return i.buffer}},79375:function(e){function t(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=t,t.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},t.prototype.reset=function(){this.attempts=0},t.prototype.setMin=function(e){this.ms=e},t.prototype.setMax=function(e){this.max=e},t.prototype.setJitter=function(e){this.jitter=e}},55354:function(e,t){!function(e){"use strict";t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,i="";for(n=0;n<o;n+=3)i+=e[r[n]>>2],i+=e[(3&r[n])<<4|r[n+1]>>4],i+=e[(15&r[n+1])<<2|r[n+2]>>6],i+=e[63&r[n+2]];return o%3===2?i=i.substring(0,i.length-1)+"=":o%3===1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(t){var n,r,o,i,s,a=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var d=new ArrayBuffer(a),u=new Uint8Array(d);for(n=0;n<l;n+=4)r=e.indexOf(t[n]),o=e.indexOf(t[n+1]),i=e.indexOf(t[n+2]),s=e.indexOf(t[n+3]),u[c++]=r<<2|o>>4,u[c++]=(15&o)<<4|i>>2,u[c++]=(3&i)<<6|63&s;return d}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},86202:function(e){var t="undefined"!==typeof t?t:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder&&MozBlobBuilder,n=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),r=n&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),o=t&&t.prototype.append&&t.prototype.getBlob;function i(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e}))}function s(e,n){n=n||{};var r=new t;return i(e).forEach((function(e){r.append(e)})),n.type?r.getBlob(n.type):r.getBlob()}function a(e,t){return new Blob(i(e),t||{})}"undefined"!==typeof Blob&&(s.prototype=Blob.prototype,a.prototype=Blob.prototype),e.exports=n?r?Blob:a:o?s:void 0},51813:function(e){var t=[].slice;e.exports=function(e,n){if("string"==typeof n&&(n=e[n]),"function"!=typeof n)throw new Error("bind() requires a function");var r=t.call(arguments,2);return function(){return n.apply(e,r.concat(t.call(arguments)))}}},69380:function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}},20690:function(e){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},1969:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e)};var r,o=n(13901),i=(r=o)&&r.__esModule?r:{default:r};e.exports=t.default},11024:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"===typeof e&&n.test(e)};var n=/-webkit-|-moz-|-ms-/;e.exports=t.default},91635:function(e){e.exports=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(r,o,i){var s=o.prototype;i.utc=function(e){return new o({date:e,utc:!0,args:arguments})},s.utc=function(t){var n=i(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},s.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var a=s.parse;s.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),a.call(this,e)};var l=s.init;s.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var c=s.utcOffset;s.utcOffset=function(r,o){var i=this.$utils().u;if(i(r))return this.$u?0:i(this.$offset)?c.call(this):this.$offset;if("string"==typeof r&&(r=function(e){void 0===e&&(e="");var r=e.match(t);if(!r)return null;var o=(""+r[0]).match(n)||["-",0,0],i=o[0],s=60*+o[1]+ +o[2];return 0===s?0:"+"===i?s:-s}(r),null===r))return this;var s=Math.abs(r)<=16?60*r:r,a=this;if(o)return a.$offset=s,a.$u=0===r,a;if(0!==r){var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(a=this.local().add(s+l,e)).$offset=s,a.$x.$localOffset=l}else a=this.utc();return a};var d=s.format;s.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return d.call(this,t)},s.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},s.isUTC=function(){return!!this.$u},s.toISOString=function(){return this.toDate().toISOString()},s.toString=function(){return this.toDate().toUTCString()};var u=s.toDate;s.toDate=function(e){return"s"===e&&this.$offset?i(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():u.call(this)};var p=s.diff;s.diff=function(e,t,n){if(e&&this.$u===e.$u)return p.call(this,e,t,n);var r=this.local(),o=i(e).local();return p.call(r,o,t,n)}}}()},87925:function(e){e.exports="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")()},64331:function(e,t,n){e.exports=n(92829),e.exports.parser=n(46211)},92829:function(e,t,n){var r=n(88011),o=n(69380),i=n(53489)("engine.io-client:socket"),s=n(69272),a=n(46211),l=n(45176),c=n(31905);function d(e,t){if(!(this instanceof d))return new d(e,t);t=t||{},e&&"object"===typeof e&&(t=e,e=null),e?(e=l(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=l(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"===typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||void 0,this.key=t.key||void 0,this.passphrase=t.passphrase||void 0,this.cert=t.cert||void 0,this.ca=t.ca||void 0,this.ciphers=t.ciphers||void 0,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"===typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=d,d.priorWebsocketSuccess=!1,o(d.prototype),d.protocol=a.protocol,d.Socket=d,d.Transport=n(21776),d.transports=n(88011),d.parser=n(46211),d.prototype.createTransport=function(e){i('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=a.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},d.prototype.open=function(){var e;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(n){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},d.prototype.setTransport=function(e){i("setting transport %s",e.name);var t=this;this.transport&&(i("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},d.prototype.probe=function(e){i('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function o(){if(r.onlyBinaryUpgrades){var o=!this.supportsBinary&&r.transport.supportsBinary;n=n||o}n||(i('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(i('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;d.priorWebsocketSuccess="websocket"===t.name,i('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(i("changing transport and sending upgrade packet"),p(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{i('probe transport "%s" failed',e);var s=new Error("probe error");s.transport=t.name,r.emit("upgradeError",s)}})))}function s(){n||(n=!0,p(),t.close(),t=null)}function a(n){var o=new Error("probe error: "+n);o.transport=t.name,s(),i('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",o)}function l(){a("transport closed")}function c(){a("socket closed")}function u(e){t&&e.name!==t.name&&(i('"%s" works - aborting "%s"',e.name,t.name),s())}function p(){t.removeListener("open",o),t.removeListener("error",a),t.removeListener("close",l),r.removeListener("close",c),r.removeListener("upgrading",u)}d.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",a),t.once("close",l),this.once("close",c),this.once("upgrading",u),t.open()},d.prototype.onOpen=function(){if(i("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){i("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},d.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(i('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else i('packet received with socket readyState "%s"',this.readyState)},d.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},d.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},d.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){i("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},d.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},d.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},d.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(i("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},d.prototype.write=d.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},d.prototype.sendPacket=function(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},d.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()}function t(){e.onClose("forced close"),i("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},d.prototype.onError=function(e){i("socket error %j",e),d.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},d.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){i('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},d.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~s(this.transports,e[n])&&t.push(e[n]);return t}},21776:function(e,t,n){var r=n(46211),o=n(69380);function i(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=i,o(i.prototype),i.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},i.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},i.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},i.prototype.onPacket=function(e){this.emit("packet",e)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},88011:function(e,t,n){var r=n(38832),o=n(13233),i=n(18833),s=n(86177);t.polling=function(e){var t=!1,n=!1,s=!1!==e.jsonp;if("undefined"!==typeof location){var a="https:"===location.protocol,l=location.port;l||(l=a?443:80),t=e.hostname!==location.hostname||l!==e.port,n=e.secure!==a}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new o(e);if(!s)throw new Error("JSONP disabled");return new i(e)},t.websocket=s},18833:function(e,t,n){var r=n(91450),o=n(20690),i=n(87925);e.exports=d;var s,a=/\n/g,l=/\\n/g;function c(){}function d(e){r.call(this,e),this.query=this.query||{},s||(s=i.___eio=i.___eio||[]),this.index=s.length;var t=this;s.push((function(e){t.onData(e)})),this.query.j=this.index,"function"===typeof addEventListener&&addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=c)}),!1)}o(d,r),d.prototype.supportsBinary=!1,d.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},d.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},d.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,o=document.createElement("form"),i=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=s,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),this.form=o,this.area=i}function c(){d(),t()}function d(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(t){n.onError("jsonp polling iframe removal error",t)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(t){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),d(),e=e.replace(l,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(u){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&c()}:this.iframe.onload=c}},13233:function(e,t,n){var r=n(38832),o=n(91450),i=n(69380),s=n(20690),a=n(53489)("engine.io-client:polling-xhr"),l=n(87925);function c(){}function d(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!==typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function u(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=d,e.exports.Request=u,s(d,o),d.prototype.supportsBinary=!0,d.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new u(e)},d.prototype.doWrite=function(e,t){var n="string"!==typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",(function(e){o.onError("xhr post error",e)})),this.sendXhr=r},d.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},i(u.prototype),u.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{a("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(i){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{t.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(i){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"===typeof t.status?t.status:0)}),0))},a("xhr data %s",this.data),t.send(this.data)}catch(i){return void setTimeout((function(){n.onError(i)}),0)}"undefined"!==typeof document&&(this.index=u.requestsCount++,u.requests[this.index]=this)},u.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},u.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},u.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},u.prototype.cleanup=function(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete u.requests[this.index],this.xhr=null}},u.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(n){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(n){this.onError(n)}null!=e&&this.onData(e)},u.prototype.hasXDR=function(){return"undefined"!==typeof XDomainRequest&&!this.xs&&this.enablesXDR},u.prototype.abort=function(){this.cleanup()},u.requestsCount=0,u.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",p);else if("function"===typeof addEventListener){addEventListener("onpagehide"in l?"pagehide":"unload",p,!1)}function p(){for(var e in u.requests)u.requests.hasOwnProperty(e)&&u.requests[e].abort()}},91450:function(e,t,n){var r=n(21776),o=n(31905),i=n(46211),s=n(20690),a=n(40276),l=n(53489)("engine.io-client:polling");e.exports=d;var c=null!=new(n(38832))({xdomain:!1}).responseType;function d(e){var t=e&&e.forceBase64;c&&!t||(this.supportsBinary=!1),r.call(this,e)}s(d,r),d.prototype.name="polling",d.prototype.doOpen=function(){this.poll()},d.prototype.pause=function(e){var t=this;function n(){l("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(l("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){l("pre-pause polling complete"),--r||n()}))),this.writable||(l("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){l("pre-pause writing complete"),--r||n()})))}else n()},d.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},d.prototype.onData=function(e){var t=this;l("polling got data %s",e);i.decodePayload(e,this.socket.binaryType,(function(e,n,r){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},d.prototype.doClose=function(){var e=this;function t(){l("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(l("transport open - closing"),t()):(l("transport not open - deferring close"),this.once("open",t))},d.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};i.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},d.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},86177:function(e,t,n){var r,o,i=n(40918).lW,s=n(21776),a=n(46211),l=n(31905),c=n(20690),d=n(40276),u=n(53489)("engine.io-client:websocket");if("undefined"!==typeof WebSocket?r=WebSocket:"undefined"!==typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"===typeof window)try{o=n(77020)}catch(f){}var p=r||o;function h(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(p=o),s.call(this,e)}e.exports=h,c(h,s),h.prototype.name="websocket",h.prototype.supportsBinary=!0,h.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={};this.isReactNative||(n.agent=this.agent,n.perMessageDeflate=this.perMessageDeflate,n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new p(e,t):new p(e):new p(e,t,n)}catch(r){return this.emit("error",r)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},h.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},h.prototype.write=function(e){var t=this;this.writable=!1;for(var n=e.length,r=0,o=n;r<o;r++)!function(e){a.encodePacket(e,t.supportsBinary,(function(r){if(!t.usingBrowserWebSocket){var o={};if(e.options&&(o.compress=e.options.compress),t.perMessageDeflate)("string"===typeof r?i.byteLength(r):r.length)<t.perMessageDeflate.threshold&&(o.compress=!1)}try{t.usingBrowserWebSocket?t.ws.send(r):t.ws.send(r,o)}catch(f){u("websocket closed before onclose event")}--n||s()}))}(e[r]);function s(){t.emit("flush"),setTimeout((function(){t.writable=!0,t.emit("drain")}),0)}},h.prototype.onClose=function(){s.prototype.onClose.call(this)},h.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()},h.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=d()),this.supportsBinary||(e.b64=1),(e=l.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},h.prototype.check=function(){return!!p&&!("__initialize"in p&&this.name===h.prototype.name)}},38832:function(e,t,n){var r=n(12457),o=n(87925);e.exports=function(e){var t=e.xdomain,n=e.xscheme,i=e.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(s){}try{if("undefined"!==typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(s){}if(!t)try{return new(o[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(s){}}},53489:function(e,t,n){var r=n(7490);function o(){var e;try{e=t.storage.debug}catch(n){}return!e&&"undefined"!==typeof r&&"env"in r&&(e={NODE_ENV:"production",PUBLIC_URL:"http://0.0.0.0:3000/assets/bundles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG),e}(t=e.exports=n(90197)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}},t.load=o,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(o())},90197:function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,i=o-(n||o);e.diff=i,e.prev=n,e.curr=o,n=o;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!==typeof s[0]&&s.unshift("%O");var l=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;l++;var o=t.formatters[r];if("function"===typeof o){var i=s[l];n=o.call(e,i),s.splice(l,1),l--}return n})),t.formatArgs.call(e,s),(r.log||t.log||console.log.bind(console)).apply(e,s)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"===typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(98400),t.instances=[],t.names=[],t.skips=[],t.formatters={}},98400:function(e){var t=1e3,n=60*t,r=60*n,o=24*r,i=365.25*o;function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,a){a=a||{};var l,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var s=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!s)return;var a=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*i;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===c&&!1===isNaN(e))return a.long?s(l=e,o,"day")||s(l,r,"hour")||s(l,n,"minute")||s(l,t,"second")||l+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},46211:function(e,t,n){var r,o=n(61899),i=n(60224),s=n(72855),a=n(41433),l=n(16097);"undefined"!==typeof ArrayBuffer&&(r=n(55354));var c="undefined"!==typeof navigator&&/Android/i.test(navigator.userAgent),d="undefined"!==typeof navigator&&/PhantomJS/i.test(navigator.userAgent),u=c||d;t.protocol=3;var p=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},h=o(p),f={type:"error",data:"parser error"},m=n(86202);function g(e,t,n){for(var r=new Array(e.length),o=a(e.length,n),i=function(e,n,o){t(n,(function(t,n){r[e]=n,o(t,r)}))},s=0;s<e.length;s++)i(s,e[s],o)}t.encodePacket=function(e,n,r,o){"function"===typeof n&&(o=n,n=!1),"function"===typeof r&&(o=r,r=null);var i=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!==typeof ArrayBuffer&&i instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,i=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=p[e.type];for(var a=0;a<i.length;a++)s[a+1]=i[a];return r(s.buffer)}(e,n,o);if("undefined"!==typeof m&&i instanceof m)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(u)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},n,!0,r)},o.readAsArrayBuffer(e.data)}(e,n,r);var o=new Uint8Array(1);o[0]=p[e.type];var i=new m([o.buffer,e.data]);return r(i)}(e,n,o);if(i&&i.base64)return function(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}(e,o);var s=p[e.type];return void 0!==e.data&&(s+=r?l.encode(String(e.data),{strict:!1}):String(e.data)),o(""+s)},t.encodeBase64Packet=function(e,n){var r,o="b"+t.packets[e.type];if("undefined"!==typeof m&&e.data instanceof m){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];n(o+e)},i.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(c){for(var s=new Uint8Array(e.data),a=new Array(s.length),l=0;l<s.length;l++)a[l]=s[l];r=String.fromCharCode.apply(null,a)}return o+=btoa(r),n(o)},t.decodePacket=function(e,n,r){if(void 0===e)return f;if("string"===typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=l.decode(e,{strict:!1})}catch(t){return!1}return e}(e)))return f;var o=e.charAt(0);return Number(o)==o&&h[o]?e.length>1?{type:h[o],data:e.substring(1)}:{type:h[o]}:f}o=new Uint8Array(e)[0];var i=s(e,1);return m&&"blob"===n&&(i=new m([i])),{type:h[o],data:i}},t.decodeBase64Packet=function(e,t){var n=h[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var o=r.decode(e.substr(1));return"blob"===t&&m&&(o=new m([o])),{type:n,data:o}},t.encodePayload=function(e,n,r){"function"===typeof n&&(r=n,n=null);var o=i(e);if(n&&o)return m&&!u?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");g(e,(function(e,r){t.encodePacket(e,!!o&&n,!1,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))}))},t.decodePayload=function(e,n,r){if("string"!==typeof e)return t.decodePayloadAsBinary(e,n,r);var o;if("function"===typeof n&&(r=n,n=null),""===e)return r(f,0,1);for(var i,s,a="",l=0,c=e.length;l<c;l++){var d=e.charAt(l);if(":"===d){if(""===a||a!=(i=Number(a)))return r(f,0,1);if(a!=(s=e.substr(l+1,i)).length)return r(f,0,1);if(s.length){if(o=t.decodePacket(s,n,!1),f.type===o.type&&f.data===o.data)return r(f,0,1);if(!1===r(o,l+i,c))return}l+=i,a=""}else a+=d}return""!==a?r(f,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var r=t.reduce((function(e,t){var n;return e+(n="string"===typeof t?t.length:t.byteLength).toString().length+n+2}),0),o=new Uint8Array(r),i=0;return t.forEach((function(e){var t="string"===typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),s=0;s<e.length;s++)r[s]=e.charCodeAt(s);n=r.buffer}o[i++]=t?0:1;var a=n.byteLength.toString();for(s=0;s<a.length;s++)o[i++]=parseInt(a[s]);o[i++]=255;for(r=new Uint8Array(n),s=0;s<r.length;s++)o[i++]=r[s]})),n(o.buffer)}))},t.encodePayloadAsBlob=function(e,n){g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"===typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),s=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)s[o]=parseInt(i[o]);if(s[i.length]=255,m){var a=new m([t.buffer,s.buffer,e]);n(null,a)}}))}),(function(e,t){return n(new m(t))}))},t.decodePayloadAsBinary=function(e,n,r){"function"===typeof n&&(r=n,n=null);for(var o=e,i=[];o.byteLength>0;){for(var a=new Uint8Array(o),l=0===a[0],c="",d=1;255!==a[d];d++){if(c.length>310)return r(f,0,1);c+=a[d]}o=s(o,2+c.length),c=parseInt(c);var u=s(o,0,c);if(l)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(m){var p=new Uint8Array(u);u="";for(d=0;d<p.length;d++)u+=String.fromCharCode(p[d])}i.push(u),o=s(o,c)}var h=i.length;i.forEach((function(e,o){r(t.decodePacket(e,n,!0),o,h)}))}},61899:function(e){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},16097:function(e){var t,n,r,o=String.fromCharCode;function i(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function s(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function a(e,t){return o(e>>t&63|128)}function l(e,t){if(0==(4294967168&e))return o(e);var n="";return 0==(4294965248&e)?n=o(e>>6&31|192):0==(4294901760&e)?(s(e,t)||(e=65533),n=o(e>>12&15|224),n+=a(e,6)):0==(4292870144&e)&&(n=o(e>>18&7|240),n+=a(e,12),n+=a(e,6)),n+=o(63&e|128)}function c(){if(r>=n)throw Error("Invalid byte index");var e=255&t[r];if(r++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function d(e){var o,i;if(r>n)throw Error("Invalid byte index");if(r==n)return!1;if(o=255&t[r],r++,0==(128&o))return o;if(192==(224&o)){if((i=(31&o)<<6|c())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&o)){if((i=(15&o)<<12|c()<<6|c())>=2048)return s(i,e)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&o)&&(i=(7&o)<<18|c()<<12|c()<<6|c())>=65536&&i<=1114111)return i;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=i(e),o=r.length,s=-1,a="";++s<o;)a+=l(r[s],n);return a},decode:function(e,s){var a=!1!==(s=s||{}).strict;t=i(e),n=t.length,r=0;for(var l,c=[];!1!==(l=d(a));)c.push(l);return function(e){for(var t,n=e.length,r=-1,i="";++r<n;)(t=e[r])>65535&&(i+=o((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=o(t);return i}(c)}}},30405:function(e){"use strict";var t=/["'&<>]/;e.exports=function(e){var n,r=""+e,o=t.exec(r);if(!o)return r;var i="",s=0,a=0;for(s=o.index;s<r.length;s++){switch(r.charCodeAt(s)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#39;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}a!==s&&(i+=r.substring(a,s)),a=s+1,i+=n}return a!==s?i+r.substring(a,s):i}},74700:function(e){"use strict";var t=/-(.)/g;e.exports=function(e){return e.replace(t,(function(e,t){return t.toUpperCase()}))}},57100:function(e,t,n){"use strict";var r=n(74700),o=/^-ms-/;e.exports=function(e){return r(e.replace(o,"ms-"))}},840:function(e){"use strict";function t(e){return function(){return e}}var n=function(){};n.thatReturns=t,n.thatReturnsFalse=t(!1),n.thatReturnsTrue=t(!0),n.thatReturnsNull=t(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},68415:function(e){"use strict";var t=/([A-Z])/g;e.exports=function(e){return e.replace(t,"-$1").toLowerCase()}},38214:function(e,t,n){"use strict";var r=n(68415),o=/^ms-/;e.exports=function(e){return r(e).replace(o,"-ms-")}},63786:function(e){"use strict";e.exports=function(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}},64265:function(e,t,n){"use strict";var r=n(840);e.exports=r},74521:function(e){e.exports="object"==typeof self?self.FormData:window.FormData},8688:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};var r=["Webkit","ms","Moz","O"];Object.keys(n).forEach((function(e){r.forEach((function(t){n[function(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}(t,e)]=n[e]}))}));var o={isUnitlessNumber:n,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};t.default=o},35598:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(8688));o(n(64265));function o(e){return e&&e.__esModule?e:{default:e}}var i=r.default.isUnitlessNumber;t.default=function(e,t,n){return null==t||"boolean"===typeof t||""===t?"":isNaN(t)||0===t||i.hasOwnProperty(e)&&i[e]?""+t:("string"===typeof t&&(t=t.trim()),t+"px")}},56425:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processStyleName=void 0,t.createMarkupForStyles=function(e,t){var n="";for(var o in e){var i=0===o.indexOf("--");if(e.hasOwnProperty(o)&&"label"!==o){var s=e[o];0,null!=s&&(i?n+=o+":"+s+";":(n+=a(o)+":",n+=(0,r.default)(o,s,t)+";"))}}return n||null};s(n(57100));var r=s(n(35598)),o=s(n(38214)),i=s(n(63786));s(n(64265));function s(e){return e&&e.__esModule?e:{default:e}}var a=t.processStyleName=(0,i.default)(o.default)},29479:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e){if(function(e){return null===e||void 0===e||!1===e||"object"===("undefined"===typeof e?"undefined":n(e))&&0===Object.keys(e).length}(e))return null;if("object"!==("undefined"===typeof e?"undefined":n(e)))return e;for(var t={},r=Object.keys(e),i=!1,s=0;s<r.length;s++){var a=e[r[s]],l=o(a);null!==l&&l===a||(i=!0),null!==l&&(t[r[s]]=l)}return 0===Object.keys(t).length?null:i?t:e}function o(e){return Array.isArray(e)?function(e){var t=!1,n=[];return e.forEach((function(e){var r=o(e);null!==r&&r===e||(t=!0),null!==r&&n.push(r)})),0==n.length?null:t?n:e}(e):r(e)}t.default=o},85472:function(e,t){"use strict";function n(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function r(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function o(e,t){return(65535&(e|=0))*(t|=0)+(((e>>>16)*t&65535)<<16)|0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var i=1540483477,s=t^e.length,a=e.length,l=0;for(;a>=4;){var c=n(e,l);c=o(c,i),c=o(c^=c>>>24,i),s=o(s,i),s^=c,l+=4,a-=4}switch(a){case 3:s^=r(e,l),s=o(s^=e.charCodeAt(l+2)<<16,i);break;case 2:s=o(s^=r(e,l),i);break;case 1:s=o(s^=e.charCodeAt(l),i)}return s=o(s^=s>>>13,i),(s^=s>>>15)>>>0}},23015:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compose=t.merge=t.$=t.style=t.presets=t.keyframes=t.fontFace=t.insertGlobal=t.insertRule=t.plugins=t.styleSheet=void 0,t.speedy=function(e){return u.speedy(e)},t.simulations=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];g=!!e},t.simulate=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!(t=(0,s.default)(t)))return{};if(!g)return v||(console.warn("can't simulate without once calling simulations(true)"),v=!0),h||f||y||(console.warn("don't use simulation outside dev"),y=!0),{};return t.reduce((function(e,t){return e["data-simulate-"+w(t)]="",e}),{})},t.cssLabels=function(e){x=!!e},t.isLikeRule=S,t.idFor=C,t.css=V,t.rehydrate=function(e){(0,r.default)(N,e.reduce((function(e,t){return e[t]=!0,e}),{}))},t.flush=function(){N=u.inserted={},R=u.registered={},O={},u.flush(),u.inject()},t.select=K,t.parent=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(d({},e+" &",n))},t.media=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(d({},"@media "+e,n))},t.pseudo=q,t.active=function(e){return q(":active",e)},t.any=function(e){return q(":any",e)},t.checked=function(e){return q(":checked",e)},t.disabled=function(e){return q(":disabled",e)},t.empty=function(e){return q(":empty",e)},t.enabled=function(e){return q(":enabled",e)},t._default=function(e){return q(":default",e)},t.first=function(e){return q(":first",e)},t.firstChild=function(e){return q(":first-child",e)},t.firstOfType=function(e){return q(":first-of-type",e)},t.fullscreen=function(e){return q(":fullscreen",e)},t.focus=function(e){return q(":focus",e)},t.hover=function(e){return q(":hover",e)},t.indeterminate=function(e){return q(":indeterminate",e)},t.inRange=function(e){return q(":in-range",e)},t.invalid=function(e){return q(":invalid",e)},t.lastChild=function(e){return q(":last-child",e)},t.lastOfType=function(e){return q(":last-of-type",e)},t.left=function(e){return q(":left",e)},t.link=function(e){return q(":link",e)},t.onlyChild=function(e){return q(":only-child",e)},t.onlyOfType=function(e){return q(":only-of-type",e)},t.optional=function(e){return q(":optional",e)},t.outOfRange=function(e){return q(":out-of-range",e)},t.readOnly=function(e){return q(":read-only",e)},t.readWrite=function(e){return q(":read-write",e)},t.required=function(e){return q(":required",e)},t.right=function(e){return q(":right",e)},t.root=function(e){return q(":root",e)},t.scope=function(e){return q(":scope",e)},t.target=function(e){return q(":target",e)},t.valid=function(e){return q(":valid",e)},t.visited=function(e){return q(":visited",e)},t.dir=function(e,t){return q(":dir("+e+")",t)},t.lang=function(e,t){return q(":lang("+e+")",t)},t.not=function(e,t){var n=e.split(",").map((function(e){return e.trim()})).map((function(e){return":not("+e+")"}));if(1===n.length)return q(":not("+e+")",t);return K(n.join(""),t)},t.nthChild=function(e,t){return q(":nth-child("+e+")",t)},t.nthLastChild=function(e,t){return q(":nth-last-child("+e+")",t)},t.nthLastOfType=function(e,t){return q(":nth-last-of-type("+e+")",t)},t.nthOfType=function(e,t){return q(":nth-of-type("+e+")",t)},t.after=function(e){return q("::after",e)},t.before=function(e){return q("::before",e)},t.firstLetter=function(e){return q("::first-letter",e)},t.firstLine=function(e){return q("::first-line",e)},t.selection=function(e){return q("::selection",e)},t.backdrop=function(e){return q("::backdrop",e)},t.placeholder=function(e){return V({"::placeholder":e})},t.cssFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(t=(0,s.default)(t))?t.map((function(e){var t={label:[]};return A(t,{src:e}),_(b(t),M(t)).join("")})).join(""):""},t.attribsFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(t=(0,s.default)(t))?t.map((function(e){C(e);var t=Object.keys(e)[0];return t+'="'+(e[t]||"")+'"'})).join(" "):""};var r=c(n(71843)),o=n(28172),i=n(56425),s=c(n(29479)),a=n(83406),l=c(n(85472));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=t.styleSheet=new o.StyleSheet;u.inject();var p=t.plugins=u.plugins=new a.PluginSet([a.prefixes,a.contentWrap,a.fallbacks]);p.media=new a.PluginSet,p.fontFace=new a.PluginSet,p.keyframes=new a.PluginSet([a.prefixes,a.fallbacks]);var h=!1,f=!1,m="undefined"!==typeof window,g=h,v=!1,y=!1;var x=h;function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function b(e){var t=JSON.stringify(e),n=(0,l.default)(t).toString(36);return e.label&&e.label.length>0&&h?w(e.label.join("."),"-")+"-"+n:n}function S(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));return 1===t.length&&!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function C(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));if(1!==t.length)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0]);if(!n)throw new Error("not a rule");return n[1]}var D=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function k(e){if(-1===e.indexOf(","))return[e];for(var t,n=[],r=[],o=0;t=D.exec(e);)switch(t[0]){case"(":o++;break;case")":o--;break;case",":if(o)break;n.push(t.index)}for(t=n.length;t--;)r.unshift(e.slice(n[t]+1)),e=e.slice(0,n[t]);return r.unshift(e),r}function j(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=k(t).map((function(t){return t.indexOf("&")>=0?[t.replace(/\&/gm,".css-"+e),t.replace(/\&/gm,"[data-css-"+e+"]")].join(","):".css-"+e+t+",[data-css-"+e+"]"+t})).join(",");return g&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+w(t)+"],[data-css-"+e+"][data-simulate-"+w(t)+"]"),n}function I(e){var t=e.selector,n=e.style,r=p.transform({selector:t,style:n});return r.selector+"{"+(0,i.createMarkupForStyles)(r.style)+"}"}function M(e){var t=void 0,n=void 0,r=void 0,o=void 0;return Object.keys(e).forEach((function(i){i.indexOf("&")>=0?(n=n||{})[i]=e[i]:0===i.indexOf("@media")?(r=r||{})[i]=M(e[i]):0===i.indexOf("@supports")?(o=o||{})[i]=M(e[i]):"label"===i?e.label.length>0&&((t=t||{}).label=x?e.label.join("."):""):(t=t||{})[i]=e[i]})),{plain:t,selects:n,medias:r,supports:o}}function _(e,t){var n=[],r=t.plain,o=t.selects,i=t.medias,s=t.supports;return r&&n.push(I({style:r,selector:j(e)})),o&&Object.keys(o).forEach((function(t){return n.push(I({style:o[t],selector:j(e,t)}))})),i&&Object.keys(i).forEach((function(t){return n.push(t+"{"+_(e,i[t]).join("")+"}")})),s&&Object.keys(s).forEach((function(t){return n.push(t+"{"+_(e,s[t]).join("")+"}")})),n}var N=u.inserted={};var R=u.registered={};function T(e){R[e.id]||(R[e.id]=e)}var O={};function E(e){if(T(e),function(e){if(!N[e.id]){N[e.id]=!0;var t=M(e.style),n=_(e.id,t);N[e.id]=!!m||n,n.forEach((function(e){return u.insert(e)}))}}(e),O[e.id])return O[e.id];var t=d({},"data-css-"+e.id,x&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),O[e.id]=t,t}function P(e,t){var n=k(e).map((function(e){return e.indexOf("&")>=0?e:"&"+e})),r=k(t).map((function(e){return e.indexOf("&")>=0?e:"&"+e}));return r.reduce((function(e,t){return e.concat(n.map((function(e){return t.replace(/\&/g,e)})))}),[]).join(",")}function Z(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function F(e){for(var t=[],n=0;n<e.length;n++)t=Array.isArray(e[n])?t.concat(F(e[n])):t.concat(e[n]);return t}var L={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function A(e,t){var n=t.selector,r=void 0===n?"":n,o=t.mq,i=void 0===o?"":o,a=t.supp,l=void 0===a?"":a,c=t.src,d=void 0===c?{}:c;Array.isArray(d)||(d=[d]),(d=F(d)).forEach((function(t){if(S(t)){var n=function(e){if(S(e)){var t=R[C(e)];if(null==t)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}(t);if("css"!==n.type)throw new Error("cannot merge this rule");t=n.style}(t=(0,s.default)(t))&&t.composes&&A(e,{selector:r,mq:i,supp:l,src:t.composes}),Object.keys(t||{}).forEach((function(n){if(function(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),o=0;o<t.length;o++)if(r===t[o]){n=!0;break}return n||e.indexOf("&")>=0}(n))L[n]&&L[n].forEach((function(o){return A(e,{selector:P(r,o),mq:i,supp:l,src:t[n]})})),A(e,{selector:P(r,n),mq:i,supp:l,src:t[n]});else if(function(e){return 0===e.indexOf("@media")}(n))A(e,{selector:r,mq:(s=i,a=n,s?"@media "+s.substring(6)+" and "+a.substring(6):a),supp:l,src:t[n]});else if(function(e){return 0===e.indexOf("@supports")}(n))A(e,{selector:r,mq:i,supp:Z(l,n),src:t[n]});else if("composes"===n);else{var o=e;l&&(o[l]=o[l]||{},o=o[l]),i&&(o[i]=o[i]||{},o=o[i]),r&&(o[r]=o[r]||{},o=o[r]),"label"===n?x&&(e.label=e.label.concat(t.label)):o[n]=t[n]}var s,a}))}))}function U(e){var t={label:[]};return A(t,{src:e}),E({id:b(t),style:t,label:x?t.label.join("."):"",type:"css"})}var z={};Object.defineProperty(z,"toString",{enumerable:!1,value:function(){return"css-nil"}});var B="undefined"!==typeof WeakMap?[z,new WeakMap,new WeakMap,new WeakMap]:[z],G=!1;var H,Y="undefined"!==typeof WeakMap?(H=U,function(e){if(B[e.length]){for(var t=B[e.length],n=0;n<e.length-1;)t.has(e[n])||t.set(e[n],new WeakMap),t=t.get(e[n]),n++;if(t.has(e[e.length-1])){var r=t.get(e[n]);if(R[r.toString().substring(4)])return r}}var o=H(e);if(B[e.length]){for(var i=0,s=B[e.length];i<e.length-1;)s=s.get(e[i]),i++;try{s.set(e[i],o)}catch(l){var a;h&&!G&&(G=!0,(a=console).warn.apply(a,["failed setting the WeakMap cache for args:"].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e))),console.warn("this should NOT happen, please file a bug on the github repo."))}}return o}):U;function V(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return(t=(0,s.default)(t))?Y(t):z}V.insert=function(e){var t={id:b(e),css:e,type:"raw"};T(t),N[t.id]||(u.insert(t.css),N[t.id]=!!m||[t.css])};t.insertRule=V.insert;V.global=function(e,t){if(t=(0,s.default)(t))return V.insert(I({selector:e,style:t}))};t.insertGlobal=V.global;V.keyframes=function(e,t){t||(t=e,e="animation");var n={id:b({name:e,kfs:t=(0,s.default)(t)||{}}),type:"keyframes",name:e,keyframes:t};return T(n),function(e){if(!N[e.id]){var t=Object.keys(e.keyframes).map((function(t){var n=p.keyframes.transform({id:e.id,name:t,style:e.keyframes[t]});return n.name+"{"+(0,i.createMarkupForStyles)(n.style)+"}"})).join(""),n=["-webkit-","-moz-","-o-",""].map((function(n){return"@"+n+"keyframes "+e.name+"_"+e.id+"{"+t+"}"}));n.forEach((function(e){return u.insert(e)})),N[e.id]=!!m||n}}(n),e+"_"+n.id},V.fontFace=function(e){var t={id:b(e=(0,s.default)(e)),type:"font-face",font:e};return T(t),function(e){if(!N[e.id]){var t="@font-face{"+(0,i.createMarkupForStyles)(e.font)+"}";u.insert(t),N[e.id]=!!m||[t]}}(t),e.fontFamily};t.fontFace=V.fontFace,t.keyframes=V.keyframes;t.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var W=t.style=V;function K(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?V(d({},e,n)):W(n)}t.$=K;t.merge=V,t.compose=V;function q(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(d({},e,n))}},83406:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.PluginSet=l,t.fallbacks=function(e){if(Object.keys(e.style).map((function(t){return Array.isArray(e.style[t])})).indexOf(!0)>=0){var t=e.style,n=Object.keys(t).reduce((function(e,n){return e[n]=Array.isArray(t[n])?t[n].join("; "+(0,i.processStyleName)(n)+": "):t[n],e}),{});return(0,o.default)({},e,{style:n})}return e},t.contentWrap=function(e){if(e.style.content){var t=e.style.content;return c.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)?e:t.charAt(0)!==t.charAt(t.length-1)||'"'!==t.charAt(0)&&"'"!==t.charAt(0)?r({},e,{style:r({},e.style,{content:'"'+t+'"'})}):e}return e},t.prefixes=function(e){return(0,o.default)({},e,{style:(0,s.default)(r({},e.style))})};var o=a(n(71843)),i=n(56425),s=a(n(68751));function a(e){return e&&e.__esModule?e:{default:e}}function l(e){this.fns=e||[]}(0,o.default)(l.prototype,{add:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){e.fns.indexOf(t)>=0||(e.fns=[t].concat(e.fns))}))},remove:function(e){this.fns=this.fns.filter((function(t){return t!==e}))},clear:function(){this.fns=[]},transform:function(e){return this.fns.reduce((function(e,t){return t(e)}),e)}});var c=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"]},68751:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t in e){var n=e[t],r=(0,i.default)(v,t,n,e,y);r&&(e[t]=r),(0,o.default)(y,t,e)}return e};var r=g(n(50339)),o=g(n(37215)),i=g(n(71217)),s=g(n(5015)),a=g(n(3684)),l=g(n(68960)),c=g(n(20504)),d=g(n(13742)),u=g(n(26023)),p=g(n(65773)),h=g(n(46535)),f=g(n(86557)),m=g(n(86395));function g(e){return e&&e.__esModule?e:{default:e}}var v=[a.default,s.default,l.default,d.default,u.default,p.default,h.default,f.default,m.default,c.default],y=r.default.prefixMap},28172:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StyleSheet=h;var r,o=n(71843),i=(r=o)&&r.__esModule?r:{default:r};function s(e){return e[e.length-1]}function a(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var l="undefined"!==typeof window,c=!1,d=!1,u=function(){if(l){var e=document.createElement("div");return e.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1===e.getElementsByTagName("i").length}}();function p(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.speedy,n=void 0===t?!c&&!d:t,r=e.maxLength,o=void 0===r?l&&u?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=o,this.ctr=0}(0,i.default)(h.prototype,{getSheet:function(){return a(s(this.tags))},inject:function(){var e=this;if(this.injected)throw new Error("already injected stylesheet!");l?this.tags[0]=p():this.sheet={cssRules:[],insertRule:function(t){e.sheet.cssRules.push({cssText:t})}},this.injected=!0},speedy:function(e){if(0!==this.ctr)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+e+") earlier in your app, or call flush() before speedy("+e+")");this.isSpeedy=!!e},_insert:function(e){try{var t=this.getSheet();t.insertRule(e,-1!==e.indexOf("@import")?0:t.cssRules.length)}catch(n){c&&console.warn("whoops, illegal rule inserted",e)}},insert:function(e){if(l)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(e);else if(-1!==e.indexOf("@import")){var t=s(this.tags);t.insertBefore(document.createTextNode(e),t.firstChild)}else s(this.tags).appendChild(document.createTextNode(e));else this.sheet.insertRule(e,-1!==e.indexOf("@import")?0:this.sheet.cssRules.length);return this.ctr++,l&&this.ctr%this.maxLength===0&&this.tags.push(p()),this.ctr-1},delete:function(e){return this.replace(e,"")},flush:function(){l?(this.tags.forEach((function(e){return e.parentNode.removeChild(e)})),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!l)return this.sheet.cssRules;var e=[];return this.tags.forEach((function(t){return e.splice.apply(e,[e.length,0].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Array.from(a(t).cssRules))))})),e}})},60224:function(e,t,n){var r=n(40918).lW,o=n(12833),i=Object.prototype.toString,s="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===i.call(Blob),a="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===i.call(File);e.exports=function e(t){if(!t||"object"!==typeof t)return!1;if(o(t)){for(var n=0,i=t.length;n<i;n++)if(e(t[n]))return!0;return!1}if("function"===typeof r&&r.isBuffer&&r.isBuffer(t)||"function"===typeof ArrayBuffer&&t instanceof ArrayBuffer||s&&t instanceof Blob||a&&t instanceof File)return!0;if(t.toJSON&&"function"===typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)&&e(t[l]))return!0;return!1}},12833:function(e){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},12457:function(e){try{e.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},13901:function(e,t,n){"use strict";n.r(t);var r=/[A-Z]/g,o=/^ms-/,i={};function s(e){return"-"+e.toLowerCase()}t.default=function(e){if(i.hasOwnProperty(e))return i[e];var t=e.replace(r,s);return i[e]=o.test(t)?"-"+t:t}},69272:function(e){var t=[].indexOf;e.exports=function(e,n){if(t)return e.indexOf(n);for(var r=0;r<e.length;++r)if(e[r]===n)return r;return-1}},3684:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("cross-fade(")>-1)return s.map((function(e){return t.replace(/cross-fade\(/g,e+"cross-fade(")}))};var r,o=n(11024),i=(r=o)&&r.__esModule?r:{default:r};var s=["-webkit-",""];e.exports=t.default},5015:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("cursor"===e&&r.hasOwnProperty(t))return n.map((function(e){return e+t}))};var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};e.exports=t.default},68960:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("filter(")>-1)return s.map((function(e){return t.replace(/filter\(/g,e+"filter(")}))};var r,o=n(11024),i=(r=o)&&r.__esModule?r:{default:r};var s=["-webkit-",""];e.exports=t.default},20504:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("display"===e&&n.hasOwnProperty(t))return n[t]};var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};e.exports=t.default},13742:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){"flexDirection"===e&&"string"===typeof t&&(t.indexOf("column")>-1?o.WebkitBoxOrient="vertical":o.WebkitBoxOrient="horizontal",t.indexOf("reverse")>-1?o.WebkitBoxDirection="reverse":o.WebkitBoxDirection="normal");r.hasOwnProperty(e)&&(o[r[e]]=n[t]||t)};var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};e.exports=t.default},26023:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&a.test(t))return s.map((function(e){return e+t}))};var r,o=n(11024),i=(r=o)&&r.__esModule?r:{default:r};var s=["-webkit-","-moz-",""],a=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;e.exports=t.default},65773:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("image-set(")>-1)return s.map((function(e){return t.replace(/image-set\(/g,e+"image-set(")}))};var r,o=n(11024),i=(r=o)&&r.__esModule?r:{default:r};var s=["-webkit-",""];e.exports=t.default},46535:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("position"===e&&"sticky"===t)return["-webkit-sticky","sticky"]},e.exports=t.default},86557:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(r.hasOwnProperty(e)&&o.hasOwnProperty(t))return n.map((function(e){return e+t}))};var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},o={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};e.exports=t.default},86395:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,s){if("string"===typeof t&&a.hasOwnProperty(e)){var c=function(e,t){if((0,o.default)(e))return e;for(var n=e.split(/,(?![^()]*(?:\([^()]*\))?\))/g),i=0,s=n.length;i<s;++i){var a=n[i],c=[a];for(var d in t){var u=(0,r.default)(d);if(a.indexOf(u)>-1&&"order"!==u)for(var p=t[d],h=0,f=p.length;h<f;++h)c.unshift(a.replace(u,l[p[h]]+u))}n[i]=c.join(",")}return n.join(",")}(t,s),d=c.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-moz-|-ms-/.test(e)})).join(",");if(e.indexOf("Webkit")>-1)return d;var u=c.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-webkit-|-ms-/.test(e)})).join(",");return e.indexOf("Moz")>-1?u:(n["Webkit"+(0,i.default)(e)]=d,n["Moz"+(0,i.default)(e)]=u,c)}};var r=s(n(1969)),o=s(n(11024)),i=s(n(34872));function s(e){return e&&e.__esModule?e:{default:e}}var a={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},l={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};e.exports=t.default},50339:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],o=["ms"],i=["Webkit","Moz"],s=["Webkit","ms"],a=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:i,userSelect:a,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:a,breakBefore:a,breakInside:a,columnCount:i,columnFill:i,columnGap:i,columnRule:i,columnRuleColor:i,columnRuleStyle:i,columnRuleWidth:i,columns:i,columnSpan:i,columnWidth:i,writingMode:s,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:s,scrollSnapPointsX:s,scrollSnapPointsY:s,scrollSnapDestination:s,scrollSnapCoordinate:s,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:a,flowInto:s,flowFrom:s,regionFragment:s,textAlignLast:r,tabSize:r,wrapFlow:o,wrapThrough:o,wrapMargin:o,gridTemplateColumns:o,gridTemplateRows:o,gridTemplateAreas:o,gridTemplate:o,gridAutoColumns:o,gridAutoRows:o,gridAutoFlow:o,grid:o,gridRowStart:o,gridColumnStart:o,gridRowEnd:o,gridRow:o,gridColumn:o,gridColumnEnd:o,gridColumnGap:o,gridRowGap:o,gridArea:o,gridGap:o,textSizeAdjust:s,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default},34872:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.exports=t.default},37215:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e.hasOwnProperty(t))for(var r=e[t],o=0,s=r.length;o<s;++o)n[r[o]+(0,i.default)(t)]=n[t]};var r,o=n(34872),i=(r=o)&&r.__esModule?r:{default:r};e.exports=t.default},71217:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,o){for(var i=0,s=e.length;i<s;++i){var a=e[i](t,n,r,o);if(a)return a}},e.exports=t.default},51511:function(e,t,n){"use strict";var r;function o(e){return e.type===r.literal}function i(e){return e.type===r.argument}function s(e){return e.type===r.number}function a(e){return e.type===r.date}function l(e){return e.type===r.time}function c(e){return e.type===r.select}function d(e){return e.type===r.plural}function u(e){return e.type===r.pound}function p(e){return!(!e||"object"!==typeof e||0!==e.type)}function h(e){return!(!e||"object"!==typeof e||1!==e.type)}n.r(t),n.d(t,{IntlMessageFormat:function(){return J},createDefaultFormatters:function(){return X},default:function(){return Q},formatHTMLMessage:function(){return K},formatToParts:function(){return L},formatToString:function(){return A}}),function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound"}(r||(r={}));var f=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=function(){return m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},m.apply(this,arguments)},g=function(e){function t(n,r,o,i){var s=e.call(this)||this;return s.message=n,s.expected=r,s.found=o,s.location=i,s.name="SyntaxError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(s,t),s}return f(t,e),t.buildMessage=function(e,t){function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function i(e){switch(e.type){case"literal":return'"'+r(e.text)+'"';case"class":var t=e.parts.map((function(e){return Array.isArray(e)?o(e[0])+"-"+o(e[1]):o(e)}));return"["+(e.inverted?"^":"")+t+"]";case"any":return"any character";case"end":return"end of input";case"other":return e.description}}return"Expected "+function(e){var t,n,r=e.map(i);if(r.sort(),r.length>0){for(t=1,n=1;t<r.length;t++)r[t-1]!==r[t]&&(r[n]=r[t],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+(((s=t)?'"'+r(s)+'"':"end of input")+" found.");var s},t}(Error);var v=function(e,t){t=void 0!==t?t:{};var n,o={},i={start:dt},s=dt,a=function(e){return e.join("")},l=function(e){return m({type:r.literal,value:e},Ot())},c="#",d=rt("#",!1),u=function(){return m({type:r.pound},Ot())},p=it("argumentElement"),h="{",f=rt("{",!1),v="}",y=rt("}",!1),x=function(e){return m({type:r.argument,value:e},Ot())},w=it("numberSkeletonId"),b=/^['\/{}]/,S=ot(["'","/","{","}"],!1,!1),C={type:"any"},D=it("numberSkeletonTokenOption"),k="/",j=rt("/",!1),I=function(e){return e},M=it("numberSkeletonToken"),_=function(e,t){return{stem:e,options:t}},N=function(e){return m({type:0,tokens:e},Ot())},R="::",T=rt("::",!1),O=function(e){return e},E=function(){return Rt.push("numberArgStyle"),!0},P=function(e){return Rt.pop(),e.replace(/\s*$/,"")},Z=",",F=rt(",",!1),L="number",A=rt("number",!1),U=function(e,t,n){return m({type:"number"===t?r.number:"date"===t?r.date:r.time,style:n&&n[2],value:e},Ot())},z="'",B=rt("'",!1),G=/^[^']/,H=ot(["'"],!0,!1),Y=/^[^a-zA-Z'{}]/,V=ot([["a","z"],["A","Z"],"'","{","}"],!0,!1),W=/^[a-zA-Z]/,K=ot([["a","z"],["A","Z"]],!1,!1),q=function(e){return m({type:1,pattern:e},Ot())},$=function(){return Rt.push("dateOrTimeArgStyle"),!0},X="date",J=rt("date",!1),Q="time",ee=rt("time",!1),te="plural",ne=rt("plural",!1),re="selectordinal",oe=rt("selectordinal",!1),ie="offset:",se=rt("offset:",!1),ae=function(e,t,n,o){return m({type:r.plural,pluralType:"plural"===t?"cardinal":"ordinal",value:e,offset:n?n[2]:0,options:o.reduce((function(e,t){var n=t.id,r=t.value,o=t.location;return n in e&&nt('Duplicate option "'+n+'" in plural element: "'+et()+'"',tt()),e[n]={value:r,location:o},e}),{})},Ot())},le="select",ce=rt("select",!1),de=function(e,t){return m({type:r.select,value:e,options:t.reduce((function(e,t){var n=t.id,r=t.value,o=t.location;return n in e&&nt('Duplicate option "'+n+'" in select element: "'+et()+'"',tt()),e[n]={value:r,location:o},e}),{})},Ot())},ue="=",pe=rt("=",!1),he=function(e){return Rt.push("select"),!0},fe=function(e,t){return Rt.pop(),m({id:e,value:t},Ot())},me=function(e){return Rt.push("plural"),!0},ge=function(e,t){return Rt.pop(),m({id:e,value:t},Ot())},ve=it("whitespace"),ye=/^[\t-\r \x85\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,xe=ot([["\t","\r"]," ","\x85","\xa0","\u1680",["\u2000","\u200a"],"\u2028","\u2029","\u202f","\u205f","\u3000"],!1,!1),we=it("syntax pattern"),be=/^[!-\/:-@[-\^`{-~\xA1-\xA7\xA9\xAB\xAC\xAE\xB0\xB1\xB6\xBB\xBF\xD7\xF7\u2010-\u2027\u2030-\u203E\u2041-\u2053\u2055-\u205E\u2190-\u245F\u2500-\u2775\u2794-\u2BFF\u2E00-\u2E7F\u3001-\u3003\u3008-\u3020\u3030\uFD3E\uFD3F\uFE45\uFE46]/,Se=ot([["!","/"],[":","@"],["[","^"],"`",["{","~"],["\xa1","\xa7"],"\xa9","\xab","\xac","\xae","\xb0","\xb1","\xb6","\xbb","\xbf","\xd7","\xf7",["\u2010","\u2027"],["\u2030","\u203e"],["\u2041","\u2053"],["\u2055","\u205e"],["\u2190","\u245f"],["\u2500","\u2775"],["\u2794","\u2bff"],["\u2e00","\u2e7f"],["\u3001","\u3003"],["\u3008","\u3020"],"\u3030","\ufd3e","\ufd3f","\ufe45","\ufe46"],!1,!1),Ce=it("optional whitespace"),De=it("number"),ke="-",je=rt("-",!1),Ie=function(e,t){return t?e?-t:t:0},Me=(it("apostrophe"),it("double apostrophes")),_e="''",Ne=rt("''",!1),Re=function(){return"'"},Te=function(e,t){return e+t.replace("''","'")},Oe=function(e){return"{"!==e&&!(Tt()&&"#"===e)&&!(Rt.length>1&&"}"===e)},Ee="\n",Pe=rt("\n",!1),Ze=function(e){return"{"===e||"}"===e||Tt()&&"#"===e},Fe=it("argNameOrNumber"),Le=it("argNumber"),Ae="0",Ue=rt("0",!1),ze=function(){return 0},Be=/^[1-9]/,Ge=ot([["1","9"]],!1,!1),He=/^[0-9]/,Ye=ot([["0","9"]],!1,!1),Ve=function(e){return parseInt(e.join(""),10)},We=it("argName"),Ke=0,qe=0,$e=[{line:1,column:1}],Xe=0,Je=[],Qe=0;if(void 0!==t.startRule){if(!(t.startRule in i))throw new Error("Can't start parsing from rule \""+t.startRule+'".');s=i[t.startRule]}function et(){return e.substring(qe,Ke)}function tt(){return at(qe,Ke)}function nt(e,t){throw function(e,t){return new g(e,[],"",t)}(e,t=void 0!==t?t:at(qe,Ke))}function rt(e,t){return{type:"literal",text:e,ignoreCase:t}}function ot(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function it(e){return{type:"other",description:e}}function st(t){var n,r=$e[t];if(r)return r;for(n=t-1;!$e[n];)n--;for(r={line:(r=$e[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return $e[t]=r,r}function at(e,t){var n=st(e),r=st(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function lt(e){Ke<Xe||(Ke>Xe&&(Xe=Ke,Je=[]),Je.push(e))}function ct(e,t,n){return new g(g.buildMessage(e,t),e,t,n)}function dt(){return ut()}function ut(){var e,t;for(e=[],t=pt();t!==o;)e.push(t),t=pt();return e}function pt(){var t;return(t=function(){var e,t;e=Ke,(t=ht())!==o&&(qe=e,t=l(t));return e=t,e}())===o&&(t=function(){var t,n,r,i;Qe++,t=Ke,123===e.charCodeAt(Ke)?(n=h,Ke++):(n=o,0===Qe&&lt(f));n!==o&&Ct()!==o&&(r=Mt())!==o&&Ct()!==o?(125===e.charCodeAt(Ke)?(i=v,Ke++):(i=o,0===Qe&&lt(y)),i!==o?(qe=t,t=n=x(r)):(Ke=t,t=o)):(Ke=t,t=o);Qe--,t===o&&(n=o,0===Qe&&lt(p));return t}())===o&&(t=function(){var t;t=function(){var t,n,r,i,s,a,l,c,d;t=Ke,123===e.charCodeAt(Ke)?(n=h,Ke++):(n=o,0===Qe&&lt(f));n!==o&&Ct()!==o&&(r=Mt())!==o&&Ct()!==o?(44===e.charCodeAt(Ke)?(i=Z,Ke++):(i=o,0===Qe&&lt(F)),i!==o&&Ct()!==o?(e.substr(Ke,6)===L?(s=L,Ke+=6):(s=o,0===Qe&&lt(A)),s!==o&&Ct()!==o?(a=Ke,44===e.charCodeAt(Ke)?(l=Z,Ke++):(l=o,0===Qe&&lt(F)),l!==o&&(c=Ct())!==o?(d=function(){var t,n,r;t=Ke,e.substr(Ke,2)===R?(n=R,Ke+=2):(n=o,0===Qe&&lt(T));n!==o?(r=function(){var e,t,n;if(e=Ke,t=[],n=gt(),n!==o)for(;n!==o;)t.push(n),n=gt();else t=o;t!==o&&(qe=e,t=N(t));return e=t,e}(),r!==o?(qe=t,t=n=O(r)):(Ke=t,t=o)):(Ke=t,t=o);t===o&&(t=Ke,qe=Ke,(n=(n=E())?void 0:o)!==o&&(r=ht())!==o?(qe=t,t=n=P(r)):(Ke=t,t=o));return t}(),d!==o?a=l=[l,c,d]:(Ke=a,a=o)):(Ke=a,a=o),a===o&&(a=null),a!==o&&(l=Ct())!==o?(125===e.charCodeAt(Ke)?(c=v,Ke++):(c=o,0===Qe&&lt(y)),c!==o?(qe=t,t=n=U(r,s,a)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o);return t}(),t===o&&(t=function(){var t,n,r,i,s,a,l,c,d;t=Ke,123===e.charCodeAt(Ke)?(n=h,Ke++):(n=o,0===Qe&&lt(f));n!==o&&Ct()!==o&&(r=Mt())!==o&&Ct()!==o?(44===e.charCodeAt(Ke)?(i=Z,Ke++):(i=o,0===Qe&&lt(F)),i!==o&&Ct()!==o?(e.substr(Ke,4)===X?(s=X,Ke+=4):(s=o,0===Qe&&lt(J)),s===o&&(e.substr(Ke,4)===Q?(s=Q,Ke+=4):(s=o,0===Qe&&lt(ee))),s!==o&&Ct()!==o?(a=Ke,44===e.charCodeAt(Ke)?(l=Z,Ke++):(l=o,0===Qe&&lt(F)),l!==o&&(c=Ct())!==o?(d=function(){var t,n,r;t=Ke,e.substr(Ke,2)===R?(n=R,Ke+=2):(n=o,0===Qe&&lt(T));n!==o?(r=function(){var t,n,r,i;t=Ke,n=Ke,r=[],i=vt(),i===o&&(i=yt());if(i!==o)for(;i!==o;)r.push(i),(i=vt())===o&&(i=yt());else r=o;n=r!==o?e.substring(n,Ke):r;n!==o&&(qe=t,n=q(n));return t=n,t}(),r!==o?(qe=t,t=n=O(r)):(Ke=t,t=o)):(Ke=t,t=o);t===o&&(t=Ke,qe=Ke,(n=(n=$())?void 0:o)!==o&&(r=ht())!==o?(qe=t,t=n=P(r)):(Ke=t,t=o));return t}(),d!==o?a=l=[l,c,d]:(Ke=a,a=o)):(Ke=a,a=o),a===o&&(a=null),a!==o&&(l=Ct())!==o?(125===e.charCodeAt(Ke)?(c=v,Ke++):(c=o,0===Qe&&lt(y)),c!==o?(qe=t,t=n=U(r,s,a)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o);return t}());return t}())===o&&(t=function(){var t,n,r,i,s,a,l,c,d,u,p;t=Ke,123===e.charCodeAt(Ke)?(n=h,Ke++):(n=o,0===Qe&&lt(f));if(n!==o)if(Ct()!==o)if((r=Mt())!==o)if(Ct()!==o)if(44===e.charCodeAt(Ke)?(i=Z,Ke++):(i=o,0===Qe&&lt(F)),i!==o)if(Ct()!==o)if(e.substr(Ke,6)===te?(s=te,Ke+=6):(s=o,0===Qe&&lt(ne)),s===o&&(e.substr(Ke,13)===re?(s=re,Ke+=13):(s=o,0===Qe&&lt(oe))),s!==o)if(Ct()!==o)if(44===e.charCodeAt(Ke)?(a=Z,Ke++):(a=o,0===Qe&&lt(F)),a!==o)if(Ct()!==o)if(l=Ke,e.substr(Ke,7)===ie?(c=ie,Ke+=7):(c=o,0===Qe&&lt(se)),c!==o&&(d=Ct())!==o&&(u=Dt())!==o?l=c=[c,d,u]:(Ke=l,l=o),l===o&&(l=null),l!==o)if((c=Ct())!==o){if(d=[],(u=wt())!==o)for(;u!==o;)d.push(u),u=wt();else d=o;d!==o&&(u=Ct())!==o?(125===e.charCodeAt(Ke)?(p=v,Ke++):(p=o,0===Qe&&lt(y)),p!==o?(qe=t,t=n=ae(r,s,l,d)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;return t}())===o&&(t=function(){var t,n,r,i,s,a,l,c,d;t=Ke,123===e.charCodeAt(Ke)?(n=h,Ke++):(n=o,0===Qe&&lt(f));if(n!==o)if(Ct()!==o)if((r=Mt())!==o)if(Ct()!==o)if(44===e.charCodeAt(Ke)?(i=Z,Ke++):(i=o,0===Qe&&lt(F)),i!==o)if(Ct()!==o)if(e.substr(Ke,6)===le?(s=le,Ke+=6):(s=o,0===Qe&&lt(ce)),s!==o)if(Ct()!==o)if(44===e.charCodeAt(Ke)?(a=Z,Ke++):(a=o,0===Qe&&lt(F)),a!==o)if(Ct()!==o){if(l=[],(c=xt())!==o)for(;c!==o;)l.push(c),c=xt();else l=o;l!==o&&(c=Ct())!==o?(125===e.charCodeAt(Ke)?(d=v,Ke++):(d=o,0===Qe&&lt(y)),d!==o?(qe=t,t=n=de(r,l)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;return t}())===o&&(t=function(){var t,n;t=Ke,35===e.charCodeAt(Ke)?(n=c,Ke++):(n=o,0===Qe&&lt(d));n!==o&&(qe=t,n=u());return t=n,t}()),t}function ht(){var e,t,n;if(e=Ke,t=[],(n=kt())===o&&(n=jt())===o&&(n=It()),n!==o)for(;n!==o;)t.push(n),(n=kt())===o&&(n=jt())===o&&(n=It());else t=o;return t!==o&&(qe=e,t=a(t)),e=t}function ft(){var t,n,r,i,s;if(Qe++,t=Ke,n=[],r=Ke,i=Ke,Qe++,(s=bt())===o&&(b.test(e.charAt(Ke))?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(S))),Qe--,s===o?i=void 0:(Ke=i,i=o),i!==o?(e.length>Ke?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(C)),s!==o?r=i=[i,s]:(Ke=r,r=o)):(Ke=r,r=o),r!==o)for(;r!==o;)n.push(r),r=Ke,i=Ke,Qe++,(s=bt())===o&&(b.test(e.charAt(Ke))?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(S))),Qe--,s===o?i=void 0:(Ke=i,i=o),i!==o?(e.length>Ke?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(C)),s!==o?r=i=[i,s]:(Ke=r,r=o)):(Ke=r,r=o);else n=o;return t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(w)),t}function mt(){var t,n,r;return Qe++,t=Ke,47===e.charCodeAt(Ke)?(n=k,Ke++):(n=o,0===Qe&&lt(j)),n!==o&&(r=ft())!==o?(qe=t,t=n=I(r)):(Ke=t,t=o),Qe--,t===o&&(n=o,0===Qe&&lt(D)),t}function gt(){var e,t,n,r;if(Qe++,e=Ke,Ct()!==o)if((t=ft())!==o){for(n=[],r=mt();r!==o;)n.push(r),r=mt();n!==o?(qe=e,e=_(t,n)):(Ke=e,e=o)}else Ke=e,e=o;else Ke=e,e=o;return Qe--,e===o&&(o,0===Qe&&lt(M)),e}function vt(){var t,n,r,i;if(t=Ke,39===e.charCodeAt(Ke)?(n=z,Ke++):(n=o,0===Qe&&lt(B)),n!==o){if(r=[],(i=kt())===o&&(G.test(e.charAt(Ke))?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(H))),i!==o)for(;i!==o;)r.push(i),(i=kt())===o&&(G.test(e.charAt(Ke))?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(H)));else r=o;r!==o?(39===e.charCodeAt(Ke)?(i=z,Ke++):(i=o,0===Qe&&lt(B)),i!==o?t=n=[n,r,i]:(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;if(t===o)if(t=[],(n=kt())===o&&(Y.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(V))),n!==o)for(;n!==o;)t.push(n),(n=kt())===o&&(Y.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(V)));else t=o;return t}function yt(){var t,n;if(t=[],W.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(K)),n!==o)for(;n!==o;)t.push(n),W.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(K));else t=o;return t}function xt(){var t,n,r,i,s;return t=Ke,Ct()!==o&&(n=Nt())!==o&&Ct()!==o?(123===e.charCodeAt(Ke)?(r=h,Ke++):(r=o,0===Qe&&lt(f)),r!==o?(qe=Ke,(he(n)?void 0:o)!==o&&(i=ut())!==o?(125===e.charCodeAt(Ke)?(s=v,Ke++):(s=o,0===Qe&&lt(y)),s!==o?(qe=t,t=fe(n,i)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o),t}function wt(){var t,n,r,i,s;return t=Ke,Ct()!==o?(n=function(){var t,n,r,i;return t=Ke,n=Ke,61===e.charCodeAt(Ke)?(r=ue,Ke++):(r=o,0===Qe&&lt(pe)),r!==o&&(i=Dt())!==o?n=r=[r,i]:(Ke=n,n=o),(t=n!==o?e.substring(t,Ke):n)===o&&(t=Nt()),t}(),n!==o&&Ct()!==o?(123===e.charCodeAt(Ke)?(r=h,Ke++):(r=o,0===Qe&&lt(f)),r!==o?(qe=Ke,(me(n)?void 0:o)!==o&&(i=ut())!==o?(125===e.charCodeAt(Ke)?(s=v,Ke++):(s=o,0===Qe&&lt(y)),s!==o?(qe=t,t=ge(n,i)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o),t}function bt(){var t;return Qe++,ye.test(e.charAt(Ke))?(t=e.charAt(Ke),Ke++):(t=o,0===Qe&&lt(xe)),Qe--,t===o&&(o,0===Qe&&lt(ve)),t}function St(){var t;return Qe++,be.test(e.charAt(Ke))?(t=e.charAt(Ke),Ke++):(t=o,0===Qe&&lt(Se)),Qe--,t===o&&(o,0===Qe&&lt(we)),t}function Ct(){var t,n,r;for(Qe++,t=Ke,n=[],r=bt();r!==o;)n.push(r),r=bt();return t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(Ce)),t}function Dt(){var t,n,r;return Qe++,t=Ke,45===e.charCodeAt(Ke)?(n=ke,Ke++):(n=o,0===Qe&&lt(je)),n===o&&(n=null),n!==o&&(r=_t())!==o?(qe=t,t=n=Ie(n,r)):(Ke=t,t=o),Qe--,t===o&&(n=o,0===Qe&&lt(De)),t}function kt(){var t,n;return Qe++,t=Ke,e.substr(Ke,2)===_e?(n=_e,Ke+=2):(n=o,0===Qe&&lt(Ne)),n!==o&&(qe=t,n=Re()),Qe--,(t=n)===o&&(n=o,0===Qe&&lt(Me)),t}function jt(){var t,n,r,i,s,a;if(t=Ke,39===e.charCodeAt(Ke)?(n=z,Ke++):(n=o,0===Qe&&lt(B)),n!==o)if(r=function(){var t,n,r,i;t=Ke,n=Ke,e.length>Ke?(r=e.charAt(Ke),Ke++):(r=o,0===Qe&&lt(C));r!==o?(qe=Ke,(i=(i=Ze(r))?void 0:o)!==o?n=r=[r,i]:(Ke=n,n=o)):(Ke=n,n=o);t=n!==o?e.substring(t,Ke):n;return t}(),r!==o){for(i=Ke,s=[],e.substr(Ke,2)===_e?(a=_e,Ke+=2):(a=o,0===Qe&&lt(Ne)),a===o&&(G.test(e.charAt(Ke))?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(H)));a!==o;)s.push(a),e.substr(Ke,2)===_e?(a=_e,Ke+=2):(a=o,0===Qe&&lt(Ne)),a===o&&(G.test(e.charAt(Ke))?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(H)));(i=s!==o?e.substring(i,Ke):s)!==o?(39===e.charCodeAt(Ke)?(s=z,Ke++):(s=o,0===Qe&&lt(B)),s===o&&(s=null),s!==o?(qe=t,t=n=Te(r,i)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;else Ke=t,t=o;return t}function It(){var t,n,r,i;return t=Ke,n=Ke,e.length>Ke?(r=e.charAt(Ke),Ke++):(r=o,0===Qe&&lt(C)),r!==o?(qe=Ke,(i=(i=Oe(r))?void 0:o)!==o?n=r=[r,i]:(Ke=n,n=o)):(Ke=n,n=o),n===o&&(10===e.charCodeAt(Ke)?(n=Ee,Ke++):(n=o,0===Qe&&lt(Pe))),t=n!==o?e.substring(t,Ke):n}function Mt(){var t,n;return Qe++,t=Ke,(n=_t())===o&&(n=Nt()),t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(Fe)),t}function _t(){var t,n,r,i,s;if(Qe++,t=Ke,48===e.charCodeAt(Ke)?(n=Ae,Ke++):(n=o,0===Qe&&lt(Ue)),n!==o&&(qe=t,n=ze()),(t=n)===o){if(t=Ke,n=Ke,Be.test(e.charAt(Ke))?(r=e.charAt(Ke),Ke++):(r=o,0===Qe&&lt(Ge)),r!==o){for(i=[],He.test(e.charAt(Ke))?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(Ye));s!==o;)i.push(s),He.test(e.charAt(Ke))?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(Ye));i!==o?n=r=[r,i]:(Ke=n,n=o)}else Ke=n,n=o;n!==o&&(qe=t,n=Ve(n)),t=n}return Qe--,t===o&&(n=o,0===Qe&&lt(Le)),t}function Nt(){var t,n,r,i,s;if(Qe++,t=Ke,n=[],r=Ke,i=Ke,Qe++,(s=bt())===o&&(s=St()),Qe--,s===o?i=void 0:(Ke=i,i=o),i!==o?(e.length>Ke?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(C)),s!==o?r=i=[i,s]:(Ke=r,r=o)):(Ke=r,r=o),r!==o)for(;r!==o;)n.push(r),r=Ke,i=Ke,Qe++,(s=bt())===o&&(s=St()),Qe--,s===o?i=void 0:(Ke=i,i=o),i!==o?(e.length>Ke?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(C)),s!==o?r=i=[i,s]:(Ke=r,r=o)):(Ke=r,r=o);else n=o;return t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(We)),t}var Rt=["root"];function Tt(){return"plural"===Rt[Rt.length-1]}function Ot(){return t&&t.captureLocation?{location:tt()}:{}}if((n=s())!==o&&Ke===e.length)return n;throw n!==o&&Ke<e.length&&lt({type:"end"}),ct(Je,Xe<e.length?e.charAt(Xe):null,Xe<e.length?at(Xe,Xe+1):at(Xe,Xe))},y=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},x=/(^|[^\\])#/g;function w(e){e.forEach((function(e){(d(e)||c(e))&&Object.keys(e.options).forEach((function(t){for(var n,r=e.options[t],i=-1,s=void 0,a=0;a<r.value.length;a++){var l=r.value[a];if(o(l)&&x.test(l.value)){i=a,s=l;break}}if(s){var c=s.value.replace(x,"$1{"+e.value+", number}"),d=v(c);(n=r.value).splice.apply(n,y([i,1],d))}w(r.value)}))}))}function b(e,t){var n=v(e,t);return t&&!1===t.normalizeHashtagInPlural||w(n),n}var S=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r};function C(e){return JSON.stringify(e.map((function(e){return e&&"object"===typeof e?(t=e,Object.keys(t).sort().map((function(e){var n;return(n={})[e]=t[e],n}))):e;var t})))}var D=function(e,t){return void 0===t&&(t={}),function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=C(r),s=i&&t[i];return s||(s=new((n=e).bind.apply(n,S([void 0],r))),i&&(t[i]=s)),s}},k=function(){return k=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},k.apply(this,arguments)},j=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function I(e){var t={};return e.replace(j,(function(e){var n=e.length;switch(e[0]){case"G":t.era=4===n?"long":5===n?"narrow":"short";break;case"y":t.year=2===n?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][n-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][n-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=4===n?"short":5===n?"narrow":"short";break;case"e":if(n<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"c":if(n<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][n-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][n-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][n-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][n-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][n-1];break;case"s":t.second=["numeric","2-digit"][n-1];break;case"S":case"A":throw new RangeError("`S/A` (second) pattenrs are not supported, use `s` instead");case"z":t.timeZoneName=n<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) pattenrs are not supported, use `z` instead")}return""})),t}var M=/^\.(?:(0+)(\+|#+)?)?$/g,_=/^(@+)?(\+|#+)?$/g;function N(e){var t={};return e.replace(_,(function(e,n,r){return"string"!==typeof r?(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length):"+"===r?t.minimumSignificantDigits=n.length:"#"===n[0]?t.maximumSignificantDigits=n.length:(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length+("string"===typeof r?r.length:0)),""})),t}function R(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":return{currencySign:"accounting"};case"sign-always":return{signDisplay:"always"};case"sign-accounting-always":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":return{signDisplay:"never"}}}function T(e){var t=R(e);return t||{}}function O(e){for(var t={},n=0,r=e;n<r.length;n++){var o=r[n];switch(o.stem){case"percent":t.style="percent";continue;case"currency":t.style="currency",t.currency=o.options[0];continue;case"group-off":t.useGrouping=!1;continue;case"precision-integer":t.maximumFractionDigits=0;continue;case"measure-unit":t.style="unit",t.unit=o.options[0].replace(/^(.*?)-/,"");continue;case"compact-short":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=k(k(k({},t),{notation:"scientific"}),o.options.reduce((function(e,t){return k(k({},e),T(t))}),{}));continue;case"engineering":t=k(k(k({},t),{notation:"engineering"}),o.options.reduce((function(e,t){return k(k({},e),T(t))}),{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue}if(M.test(o.stem)){if(o.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");o.stem.replace(M,(function(e,n,r){return"."===e?t.maximumFractionDigits=0:"+"===r?t.minimumFractionDigits=r.length:"#"===n[0]?t.maximumFractionDigits=n.length:(t.minimumFractionDigits=n.length,t.maximumFractionDigits=n.length+("string"===typeof r?r.length:0)),""})),o.options.length&&(t=k(k({},t),N(o.options[0])))}else if(_.test(o.stem))t=k(k({},t),N(o.stem));else{var i=R(o.stem);i&&(t=k(k({},t),i))}}return t}var E,P=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Z=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},F=function(e){function t(t,n){var r=e.call(this,t)||this;return r.variableId=n,r}return P(t,e),t}(Error);function L(e,t,n,r,f,m,g){if(1===e.length&&o(e[0]))return[{type:0,value:e[0].value}];for(var v,y=[],x=0,w=e;x<w.length;x++){var b=w[x];if(o(b))y.push({type:0,value:b.value});else if(u(b))"number"===typeof m&&y.push({type:0,value:n.getNumberFormat(t).format(m)});else{var S=b.value;if(!f||!(S in f))throw new F('The intl string context variable "'+S+'" was not provided to the string "'+g+'"');var C=f[S];if(i(b))C&&"string"!==typeof C&&"number"!==typeof C||(C="string"===typeof C||"number"===typeof C?String(C):""),y.push({type:1,value:C});else if(a(b)){var D="string"===typeof b.style?r.date[b.style]:void 0;y.push({type:0,value:n.getDateTimeFormat(t,D).format(C)})}else if(l(b)){D="string"===typeof b.style?r.time[b.style]:h(b.style)?I(b.style.pattern):void 0;y.push({type:0,value:n.getDateTimeFormat(t,D).format(C)})}else if(s(b)){D="string"===typeof b.style?r.number[b.style]:p(b.style)?O(b.style.tokens):void 0;y.push({type:0,value:n.getNumberFormat(t,D).format(C)})}else if(c(b)){if(!(k=b.options[C]||b.options.other))throw new RangeError('Invalid values for "'+b.value+'": "'+C+'". Options are "'+Object.keys(b.options).join('", "')+'"');y.push.apply(y,L(k.value,t,n,r,f))}else if(d(b)){var k;if(!(k=b.options["="+C])){if(!Intl.PluralRules)throw new F('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n');var j=n.getPluralRules(t,{type:b.pluralType}).select(C-(b.offset||0));k=b.options[j]||b.options.other}if(!k)throw new RangeError('Invalid values for "'+b.value+'": "'+C+'". Options are "'+Object.keys(b.options).join('", "')+'"');y.push.apply(y,L(k.value,t,n,r,f,C-(b.offset||0)))}else;}}return(v=y).length<2?v:v.reduce((function(e,t){var n=e[e.length-1];return n&&0===n.type&&0===t.type?n.value+=t.value:e.push(t),e}),[])}function A(e,t,n,r,o,i){var s=L(e,t,n,r,o,void 0,i);return 1===s.length?s[0].value:s.reduce((function(e,t){return e+t.value}),"")}var U="@@",z=/@@(\d+_\d+)@@/g,B=0;function G(e,t){return e.split(z).filter(Boolean).map((function(e){return null!=t[e]?t[e]:e})).reduce((function(e,t){return e.length&&"string"===typeof t&&"string"===typeof e[e.length-1]?e[e.length-1]+=t:e.push(t),e}),[])}var H=/(<([0-9a-zA-Z-_]*?)>(.*?)<\/([0-9a-zA-Z-_]*?)>)|(<[0-9a-zA-Z-_]*?\/>)/,Y=Date.now()+"@@",V=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];function W(e,t,n){var r=e.tagName,o=e.outerHTML,i=e.textContent,s=e.childNodes;if(!r)return G(i||"",t);r=r.toLowerCase();var a=~V.indexOf(r),l=n[r];if(l&&a)throw new F(r+" is a self-closing tag and can not be used, please use another tag name.");if(!s.length)return[o];var c=Array.prototype.slice.call(s).reduce((function(e,r){return e.concat(W(r,t,n))}),[]);return l?"function"===typeof l?[l.apply(void 0,c)]:[l]:Z(["<"+r+">"],c,["</"+r+">"])}function K(e,t,n,r,o,i){var s=L(e,t,n,r,o,void 0,i),a={},l=s.reduce((function(e,t){if(0===t.type)return e+t.value;var n=Date.now()+"_"+ ++B;return a[n]=t.value,e+""+U+n+U}),"");if(!H.test(l))return G(l,a);if(!o)throw new F("Message has placeholders but no values was given");if("undefined"===typeof DOMParser)throw new F("Cannot format XML message without DOMParser");E||(E=new DOMParser);var c=E.parseFromString('<formatted-message id="'+Y+'">'+l+"</formatted-message>","text/html").getElementById(Y);if(!c)throw new F("Malformed HTML message "+l);var d=Object.keys(o).filter((function(e){return!!c.getElementsByTagName(e).length}));if(!d.length)return G(l,a);var u=d.filter((function(e){return e!==e.toLowerCase()}));if(u.length)throw new F("HTML tag must be lowercased but the following tags are not: "+u.join(", "));return Array.prototype.slice.call(c.childNodes).reduce((function(e,t){return e.concat(W(t,a,o))}),[])}var q=function(){return q=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},q.apply(this,arguments)};function $(e,t){return t?Object.keys(e).reduce((function(n,r){var o,i;return n[r]=(o=e[r],(i=t[r])?q(q(q({},o||{}),i||{}),Object.keys(o).reduce((function(e,t){return e[t]=q(q({},o[t]),i[t]||{}),e}),{})):o),n}),q({},e)):e}function X(e){return void 0===e&&(e={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:D(Intl.NumberFormat,e.number),getDateTimeFormat:D(Intl.DateTimeFormat,e.dateTime),getPluralRules:D(Intl.PluralRules,e.pluralRules)}}var J=function(){function e(t,n,r,o){var i=this;if(void 0===n&&(n=e.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(e){return A(i.ast,i.locales,i.formatters,i.formats,e,i.message)},this.formatToParts=function(e){return L(i.ast,i.locales,i.formatters,i.formats,e,void 0,i.message)},this.formatHTMLMessage=function(e){return K(i.ast,i.locales,i.formatters,i.formats,e,i.message)},this.resolvedOptions=function(){return{locale:Intl.NumberFormat.supportedLocalesOf(i.locales)[0]}},this.getAst=function(){return i.ast},"string"===typeof t){if(this.message=t,!e.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");this.ast=e.__parse(t,{normalizeHashtagInPlural:!1})}else this.ast=t;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=$(e.formats,r),this.locales=n,this.formatters=o&&o.formatters||X(this.formatterCache)}return e.defaultLocale=(new Intl.NumberFormat).resolvedOptions().locale,e.__parse=b,e.formats={number:{currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},e}(),Q=J},79305:function(e,t,n){e=n.nmd(e);var r="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",s="[object AsyncFunction]",a="[object Function]",l="[object GeneratorFunction]",c="[object Null]",d="[object Object]",u="[object Proxy]",p="[object Undefined]",h=/^\[object .+?Constructor\]$/,f=/^(?:0|[1-9]\d*)$/,m={};m["[object Float32Array]"]=m["[object Float64Array]"]=m["[object Int8Array]"]=m["[object Int16Array]"]=m["[object Int32Array]"]=m["[object Uint8Array]"]=m["[object Uint8ClampedArray]"]=m["[object Uint16Array]"]=m["[object Uint32Array]"]=!0,m[i]=m["[object Array]"]=m["[object ArrayBuffer]"]=m["[object Boolean]"]=m["[object DataView]"]=m["[object Date]"]=m["[object Error]"]=m[a]=m["[object Map]"]=m["[object Number]"]=m[d]=m["[object RegExp]"]=m["[object Set]"]=m["[object String]"]=m["[object WeakMap]"]=!1;var g="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,v="object"==typeof self&&self&&self.Object===Object&&self,y=g||v||Function("return this")(),x=t&&!t.nodeType&&t,w=x&&e&&!e.nodeType&&e,b=w&&w.exports===x,S=b&&g.process,C=function(){try{var e=w&&w.require&&w.require("util").types;return e||S&&S.binding&&S.binding("util")}catch(t){}}(),D=C&&C.isTypedArray;var k,j,I=Array.prototype,M=Function.prototype,_=Object.prototype,N=y["__core-js_shared__"],R=M.toString,T=_.hasOwnProperty,O=function(){var e=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),E=_.toString,P=R.call(Object),Z=RegExp("^"+R.call(T).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=b?y.Buffer:void 0,L=y.Symbol,A=y.Uint8Array,U=F?F.allocUnsafe:void 0,z=(k=Object.getPrototypeOf,j=Object,function(e){return k(j(e))}),B=Object.create,G=_.propertyIsEnumerable,H=I.splice,Y=L?L.toStringTag:void 0,V=function(){try{var e=ye(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),W=F?F.isBuffer:void 0,K=Math.max,q=Date.now,$=ye(y,"Map"),X=ye(Object,"create"),J=function(){function e(){}return function(t){if(!Ne(t))return{};if(B)return B(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Q(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ee(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ne(e){var t=this.__data__=new ee(e);this.size=t.size}function re(e,t){var n=ke(e),r=!n&&De(e),o=!n&&!r&&Ie(e),i=!n&&!r&&!o&&Te(e),s=n||r||o||i,a=s?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=a.length;for(var c in e)!t&&!T.call(e,c)||s&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||xe(c,l))||a.push(c);return a}function oe(e,t,n){(void 0!==n&&!Ce(e[t],n)||void 0===n&&!(t in e))&&ae(e,t,n)}function ie(e,t,n){var r=e[t];T.call(e,t)&&Ce(r,n)&&(void 0!==n||t in e)||ae(e,t,n)}function se(e,t){for(var n=e.length;n--;)if(Ce(e[n][0],t))return n;return-1}function ae(e,t,n){"__proto__"==t&&V?V(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}Q.prototype.clear=function(){this.__data__=X?X(null):{},this.size=0},Q.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Q.prototype.get=function(e){var t=this.__data__;if(X){var n=t[e];return n===r?void 0:n}return T.call(t,e)?t[e]:void 0},Q.prototype.has=function(e){var t=this.__data__;return X?void 0!==t[e]:T.call(t,e)},Q.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=X&&void 0===t?r:t,this},ee.prototype.clear=function(){this.__data__=[],this.size=0},ee.prototype.delete=function(e){var t=this.__data__,n=se(t,e);return!(n<0)&&(n==t.length-1?t.pop():H.call(t,n,1),--this.size,!0)},ee.prototype.get=function(e){var t=this.__data__,n=se(t,e);return n<0?void 0:t[n][1]},ee.prototype.has=function(e){return se(this.__data__,e)>-1},ee.prototype.set=function(e,t){var n=this.__data__,r=se(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},te.prototype.clear=function(){this.size=0,this.__data__={hash:new Q,map:new($||ee),string:new Q}},te.prototype.delete=function(e){var t=ve(this,e).delete(e);return this.size-=t?1:0,t},te.prototype.get=function(e){return ve(this,e).get(e)},te.prototype.has=function(e){return ve(this,e).has(e)},te.prototype.set=function(e,t){var n=ve(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},ne.prototype.clear=function(){this.__data__=new ee,this.size=0},ne.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},ne.prototype.get=function(e){return this.__data__.get(e)},ne.prototype.has=function(e){return this.__data__.has(e)},ne.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ee){var r=n.__data__;if(!$||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new te(r)}return n.set(e,t),this.size=n.size,this};var le,ce=function(e,t,n){for(var r=-1,o=Object(e),i=n(e),s=i.length;s--;){var a=i[le?s:++r];if(!1===t(o[a],a,o))break}return e};function de(e){return null==e?void 0===e?p:c:Y&&Y in Object(e)?function(e){var t=T.call(e,Y),n=e[Y];try{e[Y]=void 0;var r=!0}catch(i){}var o=E.call(e);r&&(t?e[Y]=n:delete e[Y]);return o}(e):function(e){return E.call(e)}(e)}function ue(e){return Re(e)&&de(e)==i}function pe(e){return!(!Ne(e)||function(e){return!!O&&O in e}(e))&&(Me(e)?Z:h).test(function(e){if(null!=e){try{return R.call(e)}catch(t){}try{return e+""}catch(t){}}return""}(e))}function he(e){if(!Ne(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=we(e),n=[];for(var r in e)("constructor"!=r||!t&&T.call(e,r))&&n.push(r);return n}function fe(e,t,n,r,o){e!==t&&ce(t,(function(i,s){if(o||(o=new ne),Ne(i))!function(e,t,n,r,o,i,s){var a=be(e,n),l=be(t,n),c=s.get(l);if(c)return void oe(e,n,c);var u=i?i(a,l,n+"",e,t,s):void 0,p=void 0===u;if(p){var h=ke(l),f=!h&&Ie(l),m=!h&&!f&&Te(l);u=l,h||f||m?ke(a)?u=a:Re(g=a)&&je(g)?u=function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(a):f?(p=!1,u=function(e,t){if(t)return e.slice();var n=e.length,r=U?U(n):new e.constructor(n);return e.copy(r),r}(l,!0)):m?(p=!1,u=function(e,t){var n=t?function(e){var t=new e.constructor(e.byteLength);return new A(t).set(new A(e)),t}(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(l,!0)):u=[]:function(e){if(!Re(e)||de(e)!=d)return!1;var t=z(e);if(null===t)return!0;var n=T.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&R.call(n)==P}(l)||De(l)?(u=a,De(a)?u=function(e){return function(e,t,n,r){var o=!n;n||(n={});var i=-1,s=t.length;for(;++i<s;){var a=t[i],l=r?r(n[a],e[a],a,n,e):void 0;void 0===l&&(l=e[a]),o?ae(n,a,l):ie(n,a,l)}return n}(e,Oe(e))}(a):Ne(a)&&!Me(a)||(u=function(e){return"function"!=typeof e.constructor||we(e)?{}:J(z(e))}(l))):p=!1}var g;p&&(s.set(l,u),o(u,l,r,i,s),s.delete(l));oe(e,n,u)}(e,t,s,n,fe,r,o);else{var a=r?r(be(e,s),i,s+"",e,t,o):void 0;void 0===a&&(a=i),oe(e,s,a)}}),Oe)}function me(e,t){return Se(function(e,t,n){return t=K(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=K(r.length-t,0),s=Array(i);++o<i;)s[o]=r[t+o];o=-1;for(var a=Array(t+1);++o<t;)a[o]=r[o];return a[t]=n(s),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,a)}}(e,t,Ze),e+"")}var ge=V?function(e,t){return V(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Ze;function ve(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function ye(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return pe(n)?n:void 0}function xe(e,t){var n=typeof e;return!!(t=null==t?o:t)&&("number"==n||"symbol"!=n&&f.test(e))&&e>-1&&e%1==0&&e<t}function we(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||_)}function be(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}var Se=function(e){var t=0,n=0;return function(){var r=q(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(ge);function Ce(e,t){return e===t||e!==e&&t!==t}var De=ue(function(){return arguments}())?ue:function(e){return Re(e)&&T.call(e,"callee")&&!G.call(e,"callee")},ke=Array.isArray;function je(e){return null!=e&&_e(e.length)&&!Me(e)}var Ie=W||function(){return!1};function Me(e){if(!Ne(e))return!1;var t=de(e);return t==a||t==l||t==s||t==u}function _e(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}function Ne(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Re(e){return null!=e&&"object"==typeof e}var Te=D?function(e){return function(t){return e(t)}}(D):function(e){return Re(e)&&_e(e.length)&&!!m[de(e)]};function Oe(e){return je(e)?re(e,!0):he(e)}var Ee,Pe=(Ee=function(e,t,n){fe(e,t,n)},me((function(e,t){var n=-1,r=t.length,o=r>1?t[r-1]:void 0,i=r>2?t[2]:void 0;for(o=Ee.length>3&&"function"==typeof o?(r--,o):void 0,i&&function(e,t,n){if(!Ne(n))return!1;var r=typeof t;return!!("number"==r?je(n)&&xe(t,n.length):"string"==r&&t in n)&&Ce(n[t],e)}(t[0],t[1],i)&&(o=r<3?void 0:o,r=1),e=Object(e);++n<r;){var s=t[n];s&&Ee(e,s,n,o)}return e})));function Ze(e){return e}e.exports=Pe},31905:function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},45176:function(e){var t=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var r=e,o=e.indexOf("["),i=e.indexOf("]");-1!=o&&-1!=i&&(e=e.substring(0,o)+e.substring(o,i).replace(/:/g,";")+e.substring(i,e.length));for(var s=t.exec(e||""),a={},l=14;l--;)a[n[l]]=s[l]||"";return-1!=o&&-1!=i&&(a.source=r,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=function(e,t){var n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||r.splice(0,1);"/"==t.substr(t.length-1,1)&&r.splice(r.length-1,1);return r}(0,a.path),a.queryKey=function(e,t){var n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,a.query),a}},30207:function(e,t,n){var r=n(12e3),o=n(44684),i=n(9424),s=n(33136)("socket.io-client");e.exports=t=l;var a=t.managers={};function l(e,t){"object"===typeof e&&(t=e,e=void 0),t=t||{};var n,o=r(e),l=o.source,c=o.id,d=o.path,u=a[c]&&d in a[c].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||u?(s("ignoring socket cache for %s",l),n=i(l,t)):(a[c]||(s("new io instance for %s",l),a[c]=i(l,t)),n=a[c]),o.query&&!t.query&&(t.query=o.query),n.socket(o.path,t)}t.protocol=o.protocol,t.connect=l,t.Manager=n(9424),t.Socket=n(52169)},9424:function(e,t,n){var r=n(64331),o=n(52169),i=n(69380),s=n(44684),a=n(10950),l=n(51813),c=n(33136)("socket.io-client:manager"),d=n(69272),u=n(79375),p=Object.prototype.hasOwnProperty;function h(e,t){if(!(this instanceof h))return new h(e,t);e&&"object"===typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new u({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||s;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=h,h.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},h.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},h.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},i(h.prototype),h.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},h.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},h.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},h.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},h.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},h.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},h.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},h.prototype.open=h.prototype.connect=function(e,t){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var i=a(n,"open",(function(){o.onopen(),e&&e()})),s=a(n,"error",(function(t){if(c("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else o.maybeReconnectOnOpen()}));if(!1!==this._timeout){var l=this._timeout;c("connect attempt will timeout after %d",l),0===l&&i.destroy();var d=setTimeout((function(){c("connect attempt timed out after %d",l),i.destroy(),n.close(),n.emit("error","timeout"),o.emitAll("connect_timeout",l)}),l);this.subs.push({destroy:function(){clearTimeout(d)}})}return this.subs.push(i),this.subs.push(s),this},h.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(a(e,"data",l(this,"ondata"))),this.subs.push(a(e,"ping",l(this,"onping"))),this.subs.push(a(e,"pong",l(this,"onpong"))),this.subs.push(a(e,"error",l(this,"onerror"))),this.subs.push(a(e,"close",l(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",l(this,"ondecoded")))},h.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},h.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},h.prototype.ondata=function(e){this.decoder.add(e)},h.prototype.ondecoded=function(e){this.emit("packet",e)},h.prototype.onerror=function(e){c("error",e),this.emitAll("error",e)},h.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new o(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",i),n.on("connect",(function(){n.id=r.generateId(e)})),this.autoConnect&&i()}function i(){~d(r.connecting,n)||r.connecting.push(n)}return n},h.prototype.destroy=function(e){var t=d(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},h.prototype.packet=function(e){c("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()})))},h.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},h.prototype.cleanup=function(){c("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},h.prototype.close=h.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},h.prototype.onclose=function(e){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},h.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();c("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(c("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(c("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(c("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},h.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},10950:function(e){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},52169:function(e,t,n){var r=n(44684),o=n(69380),i=n(19678),s=n(10950),a=n(51813),l=n(33136)("socket.io-client:socket"),c=n(31905),d=n(60224);e.exports=h;var u={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=o.prototype.emit;function h(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}o(h.prototype),h.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",a(this,"onopen")),s(e,"packet",a(this,"onpacket")),s(e,"close",a(this,"onclose"))]}},h.prototype.open=h.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.reconnecting||this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},h.prototype.send=function(){var e=i(arguments);return e.unshift("message"),this.emit.apply(this,e),this},h.prototype.emit=function(e){if(u.hasOwnProperty(e))return p.apply(this,arguments),this;var t=i(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:d(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"===typeof t[t.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},h.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},h.prototype.onopen=function(){if(l("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===typeof this.query?c.encode(this.query):this.query;l("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},h.prototype.onclose=function(e){l("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},h.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},h.prototype.onevent=function(e){var t=e.data||[];l("emitting event %j",t),null!=e.id&&(l("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},h.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=i(arguments);l("sending ack %j",o),t.packet({type:d(o)?r.BINARY_ACK:r.ACK,id:e,data:o})}}},h.prototype.onack=function(e){var t=this.acks[e.id];"function"===typeof t?(l("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):l("bad ack %s",e.id)},h.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emit("connect")},h.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},h.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},h.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},h.prototype.close=h.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},h.prototype.compress=function(e){return this.flags.compress=e,this},h.prototype.binary=function(e){return this.flags.binary=e,this}},12e3:function(e,t,n){var r=n(45176),o=n(33136)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!==typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e="undefined"!==typeof t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=r(e));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port,n.href=n.protocol+"://"+i+(t&&t.port===n.port?"":":"+n.port),n}},33136:function(e,t,n){var r=n(7490);function o(){var e;try{e=t.storage.debug}catch(n){}return!e&&"undefined"!==typeof r&&"env"in r&&(e={NODE_ENV:"production",PUBLIC_URL:"http://0.0.0.0:3000/assets/bundles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG),e}(t=e.exports=n(9266)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}},t.load=o,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(o())},9266:function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,i=o-(n||o);e.diff=i,e.prev=n,e.curr=o,n=o;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!==typeof s[0]&&s.unshift("%O");var l=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;l++;var o=t.formatters[r];if("function"===typeof o){var i=s[l];n=o.call(e,i),s.splice(l,1),l--}return n})),t.formatArgs.call(e,s),(r.log||t.log||console.log.bind(console)).apply(e,s)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"===typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(836),t.instances=[],t.names=[],t.skips=[],t.formatters={}},836:function(e){var t=1e3,n=60*t,r=60*n,o=24*r,i=365.25*o;function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,a){a=a||{};var l,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var s=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!s)return;var a=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*i;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===c&&!1===isNaN(e))return a.long?s(l=e,o,"day")||s(l,r,"hour")||s(l,n,"minute")||s(l,t,"second")||l+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},91343:function(e,t,n){var r=n(56675),o=n(37834),i=Object.prototype.toString,s="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===i.call(Blob),a="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===i.call(File);function l(e,t){if(!e)return e;if(o(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(r(e)){for(var i=new Array(e.length),s=0;s<e.length;s++)i[s]=l(e[s],t);return i}if("object"===typeof e&&!(e instanceof Date)){i={};for(var a in e)i[a]=l(e[a],t);return i}return e}function c(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(r(e))for(var n=0;n<e.length;n++)e[n]=c(e[n],t);else if("object"===typeof e)for(var o in e)e[o]=c(e[o],t);return e}t.deconstructPacket=function(e){var t=[],n=e.data,r=e;return r.data=l(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=c(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,i=e;!function e(l,c,d){if(!l)return l;if(s&&l instanceof Blob||a&&l instanceof File){n++;var u=new FileReader;u.onload=function(){d?d[c]=this.result:i=this.result,--n||t(i)},u.readAsArrayBuffer(l)}else if(r(l))for(var p=0;p<l.length;p++)e(l[p],p,l);else if("object"===typeof l&&!o(l))for(var h in l)e(l[h],h,l)}(i),n||t(i)}},44684:function(e,t,n){var r=n(5349)("socket.io-parser"),o=n(69380),i=n(91343),s=n(56675),a=n(37834);function l(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=l,t.Decoder=u;var c=t.ERROR+'"encode error"';function d(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var o=function(e){try{return JSON.stringify(e)}catch(t){return!1}}(e.data);if(!1===o)return c;n+=o}return r("encoded %j as %s",e,n),n}function u(){this.reconstructor=null}function p(e){this.reconPack=e,this.buffers=[]}function h(e){return{type:t.ERROR,data:"parser error: "+e}}l.prototype.encode=function(e,n){(r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){function n(e){var n=i.deconstructPacket(e),r=d(n.packet),o=n.buffers;o.unshift(r),t(o)}i.removeBlobs(e,n)}(e,n):n([d(e)])},o(u.prototype),u.prototype.add=function(e){var n;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=function(e){var n=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return h("unknown packet type "+o.type);if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var i=n+1;"-"!==e.charAt(++n)&&n!=e.length;);var a=e.substring(i,n);if(a!=Number(a)||"-"!==e.charAt(n))throw new Error("Illegal attachments");o.attachments=Number(a)}if("/"===e.charAt(n+1)){for(i=n+1;++n;){if(","===(c=e.charAt(n)))break;if(n===e.length)break}o.nsp=e.substring(i,n)}else o.nsp="/";var l=e.charAt(n+1);if(""!==l&&Number(l)==l){for(i=n+1;++n;){var c;if(null==(c=e.charAt(n))||Number(c)!=c){--n;break}if(n===e.length)break}o.id=Number(e.substring(i,n+1))}if(e.charAt(++n)){var d=function(e){try{return JSON.parse(e)}catch(t){return!1}}(e.substr(n));if(!(!1!==d&&(o.type===t.ERROR||s(d))))return h("invalid payload");o.data=d}return r("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new p(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n)}else{if(!a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},u.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},p.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=i.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},p.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},37834:function(e,t,n){var r=n(40918).lW;e.exports=function(e){return o&&r.isBuffer(e)||i&&(e instanceof ArrayBuffer||s(e))};var o="function"===typeof r&&"function"===typeof r.isBuffer,i="function"===typeof ArrayBuffer,s=function(e){return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},5349:function(e,t,n){var r=n(7490);function o(){var e;try{e=t.storage.debug}catch(n){}return!e&&"undefined"!==typeof r&&"env"in r&&(e={NODE_ENV:"production",PUBLIC_URL:"http://0.0.0.0:3000/assets/bundles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG),e}(t=e.exports=n(5619)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}},t.load=o,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(o())},5619:function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,i=o-(n||o);e.diff=i,e.prev=n,e.curr=o,n=o;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!==typeof s[0]&&s.unshift("%O");var l=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;l++;var o=t.formatters[r];if("function"===typeof o){var i=s[l];n=o.call(e,i),s.splice(l,1),l--}return n})),t.formatArgs.call(e,s),(r.log||t.log||console.log.bind(console)).apply(e,s)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"===typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(85770),t.instances=[],t.names=[],t.skips=[],t.formatters={}},56675:function(e){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},85770:function(e){var t=1e3,n=60*t,r=60*n,o=24*r,i=365.25*o;function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,a){a=a||{};var l,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var s=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!s)return;var a=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*i;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===c&&!1===isNaN(e))return a.long?s(l=e,o,"day")||s(l,r,"hour")||s(l,n,"minute")||s(l,t,"second")||l+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},19678:function(e){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},40276:function(e){"use strict";var t,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r=64,o={},i=0,s=0;function a(e){var t="";do{t=n[e%r]+t,e=Math.floor(e/r)}while(e>0);return t}function l(){var e=a(+new Date);return e!==t?(i=0,t=e):e+"."+a(i++)}for(;s<r;s++)o[n[s]]=s;l.encode=a,l.decode=function(e){var t=0;for(s=0;s<e.length;s++)t=t*r+o[e.charAt(s)];return t},e.exports=l},42397:function(e,t,n){"use strict";n.r(t),t.default={}},95993:function(e,t,n){"use strict";n.r(t),t.default={}},24717:function(e,t,n){"use strict";n.r(t),t.default={}},76525:function(e,t,n){"use strict";n.r(t),t.default={}},33198:function(e,t,n){"use strict";n.r(t),t.default={}},42988:function(e,t,n){"use strict";n.r(t),t.default={}},33034:function(e,t,n){"use strict";n.r(t),t.default={}},77634:function(e,t,n){"use strict";n.r(t),t.default={}},39279:function(e,t,n){"use strict";n.r(t),t.default={}},92602:function(e,t,n){"use strict";n.r(t),t.default={}},10057:function(e,t,n){"use strict";n.r(t),t.default={}},82106:function(e,t,n){"use strict";n.r(t),t.default={}},80130:function(e,t,n){"use strict";n.r(t),t.default={}},17096:function(e,t,n){"use strict";n.r(t),t.default={}},13539:function(e,t,n){"use strict";n.r(t),t.default={}},826:function(e,t,n){"use strict";n.r(t),t.default={}},97744:function(e,t,n){"use strict";n.r(t),t.default={}},58606:function(e,t,n){"use strict";n.r(t),t.default={}},62012:function(){},6251:function(e,t,n){"use strict";n.r(t),t.default={}},77020:function(){}},function(e){e.O(0,[9351],(function(){return t=78334,e(e.s=t);var t}));e.O()}]);